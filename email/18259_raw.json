{
    "numMessagesInTopic": 1, 
    "nextInTime": 18260, 
    "senderId": "IWr9kJcbtjQ0Il1hm90GJWYd_3S7AwsI9Y1AoEN-YK-pB095EmuQDRlKexL4kYDGpVgMlVwap-YjJeFWAJj4ycn_gqE1m_w1X-ZueOf_vuU", 
    "systemMessage": true, 
    "subject": "XPath asserts against a generated XSLT stylesheet", 
    "from": "&quot;cliftonccraig&quot; &lt;cliftonccraig@...&gt;", 
    "authorName": "cliftonccraig", 
    "msgSnippet": "Help! I m trying to perform XPath asserts against a generated XSLT stylesheet. That is a stylesheet that I generate using a stylesheet. I m using a combination", 
    "msgId": 18259, 
    "rawEmail": "Return-Path: &lt;cliftonccraig@...&gt;\r\nReceived: (qmail 7509 invoked from network); 30 Oct 2006 08:14:37 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m25.grp.scd.yahoo.com with QMQP; 30 Oct 2006 08:14:37 -0000\r\nReceived: from unknown (HELO n6a.bullet.sc5.yahoo.com) (66.163.187.149)\n  by mta1.grp.scd.yahoo.com with SMTP; 30 Oct 2006 08:14:36 -0000\r\nReceived: from [66.163.187.122] by n6.bullet.sc5.yahoo.com with NNFMP; 30 Oct 2006 08:14:13 -0000\r\nReceived: from [66.218.69.6] by t3.bullet.sc5.yahoo.com with NNFMP; 30 Oct 2006 08:14:13 -0000\r\nReceived: from [66.218.66.75] by t6.bullet.scd.yahoo.com with NNFMP; 30 Oct 2006 08:14:13 -0000\r\nX-Sender: cliftonccraig@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 75128 invoked from network); 25 Oct 2006 17:58:10 -0000\r\nReceived: from unknown (66.218.66.217)\n  by m22.grp.scd.yahoo.com with QMQP; 25 Oct 2006 17:58:09 -0000\r\nReceived: from unknown (HELO n10a.bullet.sc5.yahoo.com) (66.163.187.153)\n  by mta2.grp.scd.yahoo.com with SMTP; 25 Oct 2006 17:58:08 -0000\r\nReceived: from [66.163.187.123] by n10.bullet.sc5.yahoo.com with NNFMP; 25 Oct 2006 17:57:59 -0000\r\nReceived: from [66.218.66.59] by t4.bullet.sc5.yahoo.com with NNFMP; 25 Oct 2006 17:57:59 -0000\r\nReceived: from [66.218.66.83] by t8.bullet.scd.yahoo.com with NNFMP; 25 Oct 2006 17:57:59 -0000\r\nDate: Wed, 25 Oct 2006 17:57:55 -0000\r\nTo: junit@yahoogroups.com\r\nMessage-ID: &lt;eho8j3+r9ue@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-system\r\nX-eGroups-Msg-Info: 2:4:8:0\r\nFrom: &quot;cliftonccraig&quot; &lt;cliftonccraig@...&gt;\r\nSubject: XPath asserts against a generated XSLT stylesheet\r\nX-Yahoo-Group-Post: member; u=190580959; y=fbCDo1k73LBE309VLmCCHG4Wk7gZmGFvKTtkXuxtLKXl4U-Oz8YwEA\r\nX-Yahoo-Profile: cliftonccraig\r\nX-Yahoo-Marked-Not-Spam: \r\nX-eGroups-Approved-By: copabella &lt;joe@...&gt; via web; 30 Oct 2006 08:14:12 -0000\r\n\r\nHelp!\n\nI&#39;m trying to perform XPath asserts against a generated XSLT stylesh=\r\neet.\nThat is a stylesheet that I generate using a stylesheet. I&#39;m using a\nc=\r\nombination of XMLUnit, Juxy, and some custom XMLUnit extensions in\nvarious =\r\ntest and in one test I am trying to reduce the fluff of\ncomparing an entire=\r\n resulting XSLT document with an inlined string so I\nlooked at using the XM=\r\nLUnit Xpath assert stuff and it started to look\nlike it was working. So now=\r\n I&#39;ve broken off and wrote my own XPath\nassertions in my custom test case e=\r\nxtension and I get the same\nbehaviour. I believe it&#39;s related to the absenc=\r\ne of a namespace\nassociation but I can&#39;t figure out how to make it work. He=\r\nre&#39;s what I\ngot so far. Below is a test method that tests my custom XML tes=\r\nt case:\n\n     public void testAssertXPathExists() throws Exception\n     {\n =\r\n        Document doc =3D customXMLTestCase.toDocumentNode(\n                =\r\n &quot;&lt;xsl:stylesheet\nxmlns:xsl=3D&#92;&quot;http://www.w3.org/1999/XSL/Transform&#92;&quot;&gt;&quot; +\n=\r\n                         &quot;&lt;xsl:template name=3D&#92;&quot;foo&#92;&quot;&gt;&quot; +\n                =\r\n         &quot;&lt;xsl:call-template name=3D&#92;&quot;foo&#92;&quot;&gt;&quot; +\n                         &quot;&lt;=\r\n/xsl:call-template&gt;&quot; +\n                         &quot;&lt;/xsl:template&gt;&quot; +\n       =\r\n                  &quot;&lt;/xsl:stylesheet&gt;&quot;);\n         try\n         {\n           =\r\n  String nonExistantPath =3D &quot;/xsl:stylesheet/xsl:template[@name\n=3D &#39;foo&#39;]=\r\n/xsl:call-template[@name =3D &#39;foo&#39;]&quot;;\n             customXMLTestCase.assert=\r\nXpathExists(nonExistantPath, doc);\n             fail(&quot;Path &quot; + nonExistantP=\r\nath + &quot; should not exist in the\ninputXml&quot;);\n         }\n         catch(Asser=\r\ntionFailedError e)\n         {\n             String convertedXmlString =3D cu=\r\nstomXMLTestCase.asString(doc);\n             assertTrue(&quot;Error should includ=\r\ne inputXml. Message text: &quot; +\ne, e.getMessage().indexOf(convertedXmlString)=\r\n &gt;=3D 0);\n             throw e;\n         }\n     }\n\nIt reports the following=\r\n (running in the Idea test runner):\njava.lang.RuntimeException: Xpath /xsl:=\r\nstylesheet/xsl:template[@name =3D\n&#39;foo&#39;]/xsl:call-template[@name =3D &#39;foo&#39;]=\r\n could not be evaluated against\ndocument\n     at\ncom.custom.junit.ext.Custo=\r\nmXMLTestCase.evaluateXpath(CustomXMLTestCase.j&#92;\nava:179)\n     at\ncom.custom=\r\n.junit.ext.CustomXMLTestCase.xpathExists(CustomXMLTestCase.jav&#92;\na:166)\n    =\r\n at\ncom.custom.junit.ext.CustomXMLTestCase.assertXpathExists(CustomXMLTestC=\r\na&#92;\nse.java:161)\n     at\ncom.custom.junit.ext.CustomXMLTestCaseTest.testAsse=\r\nrtXPathExists(CustomX&#92;\nMLTestCaseTest.java:33)\n     at sun.reflect.NativeMe=\r\nthodAccessorImpl.invoke0(Native Method)\n     at\nsun.reflect.NativeMethodAcc=\r\nessorImpl.invoke(NativeMethodAccessorImpl.jav&#92;\na:39)\n     at\nsun.reflect.De=\r\nlegatingMethodAccessorImpl.invoke(DelegatingMethodAccessor&#92;\nImpl.java:25)\n =\r\n    at\ncom.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:=\r\n40)\n     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n   =\r\n  at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.j=\r\nav&#92;\na:39)\n     at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(Delegatin=\r\ngMethodAccessor&#92;\nImpl.java:25)\n     at\ncom.intellij.rt.execution.applicatio=\r\nn.AppMain.main(AppMain.java:90)\nCaused by: javax.xml.xpath.XPathExpressionE=\r\nxception\n     at\ncom.sun.org.apache.xpath.internal.jaxp.XPathImpl.evaluate(=\r\nXPathImpl.java&#92;\n:289)\n     at\ncom.custom.junit.ext.CustomXMLTestCase.evalua=\r\nteXpath(CustomXMLTestCase.j&#92;\nava:174)\n     ... 24 more\nCaused by: javax.xml=\r\n.transform.TransformerException: Unknown error in\nXPath.\n     at com.sun.or=\r\ng.apache.xpath.internal.XPath.execute(XPath.java:296)\n     at\ncom.sun.org.a=\r\npache.xpath.internal.jaxp.XPathImpl.eval(XPathImpl.java:213&#92;\n)\n     at\ncom.=\r\nsun.org.apache.xpath.internal.jaxp.XPathImpl.evaluate(XPathImpl.java&#92;\n:275)=\r\n\n     ... 25 more\nCaused by: java.lang.NullPointerException\n     at\ncom.sun=\r\n.org.apache.xpath.internal.axes.AxesWalker.setRoot(AxesWalker.jav&#92;\na:218)\n =\r\n    at\ncom.sun.org.apache.xpath.internal.axes.WalkingIterator.setRoot(Walki=\r\nngIt&#92;\nerator.java:153)\n     at\ncom.sun.org.apache.xpath.internal.axes.NodeS=\r\nequence.setRoot(NodeSequence&#92;\n.java:212)\n     at\ncom.sun.org.apache.xpath.i=\r\nnternal.axes.LocPathIterator.execute(LocPathIt&#92;\nerator.java:211)\n     at co=\r\nm.sun.org.apache.xpath.internal.XPath.execute(XPath.java:268)\n     ... 27 m=\r\nore\n\nBelow is the code in my custom class:\n     public Document toDocumentN=\r\node(String xml) throws SAXException,\nIOException, ParserConfigurationExcept=\r\nion{\n         return delegate.toDocumentNode(xml);\n     }\n\n     public Stri=\r\nng asString(Document document) throws Exception\n     {\n         return new =\r\nJuxyTestCase(){}.asString(document);\n     }\n\n     @Override\n     public voi=\r\nd assertXpathNotExists(String string, Document document)\nthrows Transformer=\r\nException\n     {\n         try{ super.assertXpathNotExists(string, document)=\r\n; }\n         catch(AssertionFailedError e) {\nrethrowAssertionFailedErrorWit=\r\nhDocumentText(e, document); }\n     }\n\n     @Override\n     public void asser=\r\ntXpathExists(String xpath, Document document)\nthrows TransformerException, =\r\nAssertionFailedError\n     {\n         assertTrue(&quot;Expected to find xpath &quot; +=\r\n xpath, xpathExists(xpath,\ndocument));\n     }\n\n     private boolean xpathEx=\r\nists(String xpath, Document document)\n     {\n         return evaluateXpath(=\r\nxpath, document).getLength() &gt; 0;\n     }\n\n     public NodeList evaluateXpat=\r\nh(String xpath, Document document)\n     {\n         NodeList nodeset;\n      =\r\n   try\n         {\n             nodeset =3D (NodeList) XPathFactory.newInsta=\r\nnce().newXPath()\n                     .evaluate(xpath, new DOMSource(docume=\r\nnt),\nXPathConstants.NODESET);\n         }\n         catch(XPathExpressionExce=\r\nption e)\n         {\n             throw new RuntimeException(&quot;Xpath &quot; + xpat=\r\nh + &quot; could not be\nevaluated against document&quot;, e);\n         }\n         ret=\r\nurn nodeset;\n     }\n\n     private void\nrethrowAssertionFailedErrorWithDocum=\r\nentText(AssertionFailedError e,\nDocument document)\n     {\n         try\n    =\r\n     {\n             throw new AssertionFailedError(e.getMessage() + &quot;&#92;n&quot; +\n=\r\nasString(document));\n         }\n         catch(Exception e1)\n         {\n   =\r\n          throw new RuntimeException(&quot;Assertion failed and an error\nwas thr=\r\nown while converting the input &quot; +\n                     &quot;Document object to=\r\n a string. AssertionFailure: &quot; +\ne);\n         }\n     }\n\nYou&#39;ll note my chan=\r\nge in direction where one assert method\n(assertXpathExists) delegates to th=\r\ne XMLUnit counterpart and the other\n(assertXpathExists) reimplements the id=\r\nea using the JDK5 XPath API. I\ntried the idea both ways and it doesn&#39;t seem=\r\n to work. It may be due to\nmy lack of understanding of both the XMLUnit and=\r\n JDK Xpath APIs. I&#39;m\nsure the XPath is valid as I have confirmed it with th=\r\ne Idea XPath\nplugin. (In this scenario I copied the xml to a dummy XML file=\r\n and\ncopied the XPath string directly from the test case and into the XPath=\r\n\nplugin dialog which points me to the single matching node in question.)\nI =\r\nalso noticed that some of my other test cases that use the XMLUnit\nxpath as=\r\nserts throw errors while yielding a green bar. The errors I get\nare below:\n=\r\nSystemId Unknown; Line #1; Column #404; Prefix must resolve to a\nnamespace:=\r\n xslt\nSystemId Unknown; Line #1; Column #404; A location step was expected\n=\r\nfollowing the &#39;/&#39; or &#39;//&#39; token.\nSystemId Unknown; Line #1; Column #404; Ex=\r\ntra illegal tokens: &#39;[&#39;, &#39;@&#39;,\n&#39;name&#39;, &#39;=3D&#39;, &#39;&#39;main&#39;&#39;, &#39;]&#39;, &#39;/&#39;, &#39;descendan=\r\nt&#39;, &#39;::&#39;, &#39;[&#39;, &#39;@&#39;, &#39;name&#39;,\n&#39;=3D&#39;, &#39;&#39;align-right&#39;&#39;, &#39;]&#39;\n\nAny ideas? Is ther=\r\ne another forum or list where my question may be more\nappropriate?\n\n\n\n\n\n", 
    "profile": "cliftonccraig", 
    "topicId": 18259, 
    "spamInfo": {
        "reason": "4", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 190580959, 
    "prevInTime": 18258, 
    "contentTrasformed": false, 
    "postDate": "1161799075", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PGVobzhqMytyOXVlQGVHcm91cHMuY29tPg=="
    }
}