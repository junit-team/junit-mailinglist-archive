{
    "numMessagesInTopic": 18, 
    "nextInTime": 11515, 
    "senderId": "aA6LCI6r3pVKXE5tXCEfMXcbm6EcDGhMXrsrAUZHSSd1FxakR5lET3YayqrXlZQmupXYhNA-2wWsQXzLrjlmx95XhNv4W2KI", 
    "systemMessage": false, 
    "subject": "Re: Did my question get missed, somehow?", 
    "from": "&quot;cypherfox&quot; &lt;cypherfox@...&gt;", 
    "authorName": "cypherfox", 
    "msgSnippet": "Greetings, ... we ... look ... I expected that, it appears to be a common response to issues with the test framework.  The problem with dismissing it like that", 
    "msgId": 11514, 
    "rawEmail": "Return-Path: &lt;cypherfox@...&gt;\r\nX-Sender: cypherfox@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 91680 invoked from network); 16 Jul 2004 00:23:18 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m23.grp.scd.yahoo.com with QMQP; 16 Jul 2004 00:23:18 -0000\r\nReceived: from unknown (HELO n27.grp.scd.yahoo.com) (66.218.66.83)\n  by mta1.grp.scd.yahoo.com with SMTP; 16 Jul 2004 00:23:18 -0000\r\nReceived: from [66.218.67.136] by n27.grp.scd.yahoo.com with NNFMP; 16 Jul 2004 00:23:02 -0000\r\nDate: Fri, 16 Jul 2004 00:23:02 -0000\r\nTo: junit@yahoogroups.com\r\nMessage-ID: &lt;cd7756+l6r4@...&gt;\r\nIn-Reply-To: &lt;40F71183.5070807@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Length: 7355\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-eGroups-Remote-IP: 66.218.66.83\r\nFrom: &quot;cypherfox&quot; &lt;cypherfox@...&gt;\r\nSubject: Re: Did my question get missed, somehow?\r\nX-Yahoo-Group-Post: member; u=174888704\r\nX-Yahoo-Profile: cypherfox\r\n\r\nGreetings,\n\n--- In junit@yahoogroups.com, &quot;J. B. Rainsberger&quot; &lt;jbrains@r...&gt;\nwrote:\n&gt; cypherfox wrote:\n&gt; \n&gt; &gt; Greetings,\n&gt; &gt; Totally reasonable, and I probably made it more complex\n&gt; &gt; than it needed to be.\n&gt; &gt; \n&gt; &gt; I&#39;ll try a simpler question, but still related...\n&gt; &gt; \n&gt; &gt; I have state that I need to track between tests, in this case\n&gt; &gt; it&#39;s the message id that the last test put on the server, so\n&gt; &gt; that the next test can test reading it, and the third test\n&gt; &gt; can test deleting it.\n&gt; \n&gt; You should realize that this is a design smell. I&#39;m not saying that\nwe \n&gt; can&#39;t test it as is, but I /am/ saying that if it were my code, I&#39;d\nlook \n&gt; to change the design so that the tests don&#39;t depend on one another.\n\nI expected that, it appears to be a common response to issues\nwith the test framework.  The problem with dismissing it like\nthat is that if you are putting data onto a server, you WANT\nto test independantly that each of the operations work,\nwithout relying on all the later tests working for basic\noperations to pass.  Also, if earlier tests fail, you know\nimmediately that the rest will fail, so it gives a clear progression\nof fixes.  This, to me, is test isolation.  If a test fails, I know\nwhy it failed, because JUST that functionality isn&#39;t working.\n\nIf I *have to* make testRead() internally depend on doing\ntestPost() and then testDelete() afterwards (and much more\nas I describe later), then suddenly my test is being forced to\ndo way too much, and that smells to me of bad design in the\nframework, and this is totally irrespective of threading.\n\nSure, making tests completely independant is great if you&#39;re not\ntesting against anything ELSE that has state, but if you are, you\nneed to be able to retain something, a session id, a message id,\nthe connection to the server, etc.\n\n&gt; &gt; It appears that a new object is created for each call to a test*\n&gt; &gt; method, so there&#39;s no object-local way to preserve state.\n&gt; \n&gt; Right. At that point, you must do it through class-level data.\n\nOof, see, this is bad.  It makes testing stateful systems very,\nvery difficult, and then testing multi-threaded systems near to\nimpossible.  I&#39;m sure we see things differently, but to me\nthe testing framework forcing me to use &#39;class-level data&#39;\n(i.e. statics) is a code smell of the test framework.\n\n&gt; &gt; Is there any way to override this, making it call the test*\n&gt; &gt; methods all on the same object?\n&gt; \n&gt; Not without rewriting the framework. The framework was written \n&gt; /expressly with the goal/ of isolating tests from one another. The \n&gt; framework achieves this by executing each test in its own instance\nof \n&gt; Test (or TestCase).\n\nThe problem I have with this is it&#39;s completely unlike how code is\nactually used.  It&#39;s forcing a framework on code that makes it much\nless useful to test.  I don&#39;t need (or think it&#39;s right at all) to\ntest all of:\n\nconnect to server\ncreate user\ncreate mailbox\npost message\n*read message*\ndelete message\ndelete mailbox\ndelete user\ndisconnect\n\nall in one test, just in order to test the &#39;read message&#39; in the\nmiddle.\n\nAre you saying this is expressly what is desired?  That all\nthe authors think is appropriate is one single &#39;mega test&#39;\nthat runs all those functions?  Or was testing code that\ntalks to external stateful systems just not considered?\n\n&gt; &gt; My reasoning is that if I write a test which creates, reads,\n&gt; &gt; and deletes the entry from the server, I&#39;m doing too much\n&gt; &gt; in a single test.\n&gt; \n&gt; A test consists of three parts: arrange, act, assert. You need to\nset up \n&gt; the system in a desired, known state (arrange), \n\nDone through the prior tests, and since they&#39;ve presumably\nsucceeded, the next test can run.\n\n&gt; do something of interest (act)\n\nE.g., The &#39;read message&#39;, which is the only thing of interest to the\ntestReadMessage method.\n\n&gt; then check the results (assert).\n\nSee you&#39;re forgetting a few things, when dealing with stateful\nexternal systems.  Namely &#39;reset state&#39;, which should occur\nAFTER assert.  But it needs to be tested also, of course.  And\nsince it needs to be tested, it needs a test, preferrably simple\nbecause simple is good, that runs in the normal sequence of\nthings.   Instead of doing the 9 operations every time, for 9\ntests, the clear process is to do it once, in the prior test, and\nuse that state in the next test.\n\nStatics aren&#39;t an answer, and the framework forcing them on\ntests is a failure in the framework.  I was hoping that wasn&#39;t\nthe answer.\n\n&gt; You are right: your test is \n&gt; doing too much, but I don&#39;t think the test is at fault.\n\nEach test is testing a single, basic unit of functionality.  You\nmisread me, I&#39;m saying that if I have to do all the steps\noutlined above EVERY time I want to do only ONE of those\ntests, then the test is doing far too much, and it&#39;s the\nframework at fault for forcing that kind of test process.\n\n&gt; &gt; The only place that threading comes in is that I can&#39;t use a\n&gt; &gt; static value to keep this data, because then it&#39;s shared among\n&gt; &gt; all the threads.\n&gt; \n&gt; I don&#39;t understand why you need multiple threads while running the \n&gt; tests. Could you run the tests in singlethreaded mode? The fact\nthat you \n&gt; want to test logic in multithreaded mode tells me that you may be\ntrying \n&gt; to test too many things at once.\n\nYes, yes, the test is run once in single-threaded mode,\nto make sure the basic logic is correct.  I do that as a\nsanity test before running the multi-threaded test.  The\nproblem still exists, of course, because state should be\npreserved.  (Actually, there are about a half dozen pre-MT\ntest classes that are run, testing the logic of various layers.)\n\nIt&#39;s then run in a heavily multithreaded context, because\nthat&#39;s the context it&#39;s going to be run in the real world,\nso it tries to hash out any threading issues in the various\nlayers.  This is a test, after all.\n\n&gt;  &gt; Any suggestions?\n&gt; \n&gt; What is your goal? To verify your logic? To test concurrency? At a \n&gt; minimum, do each of these separately, and not together.\n\nI do each of them separately.  I test the logic once, with the\nstorageTest class as a single thread.  I then try to test the\nconcurrency by calling storageTest from one to three hundred\nthreads.\n\nRight now, I have a &#39;massiveTest&#39; class which calls all the methods\nof the storageTest class directly, after doing a hand-setup so that\nthe storageTest object can query some data.  It&#39;s just a hack-around\nfor the problem that the TestSuite instantiates a new object every\ntime.  If it didn&#39;t do that, the code would be vastly cleaner.\n\n&gt; &gt; p.s.  Nope, no extensions yet, although I&#39;m eyeing TestResult\n&gt; &gt; as needing a touch of an upgrade...\n&gt; \n&gt; Interesting... do tell.\n\nCertainly.  The massiveTest I mentioned above has to call each\nmethod on storageTest directly, so when a failure occurs I can&#39;t\neasily determine WHERE it failed, because the only test that\nappears in TestResult is &#39;testMultithreadedStorage&#39;.\n\nIt would be good to have testMultithreadedStorage call the\nsuite.run(myResult) for the storageTest class (if that worked\nproperly with state preservation), and then aggregate the\nresults for all the threads, so it appears more like what really\nhappened, that the storageTest test suite was run 2000 times,\nand which calls failed, asserted, etc.\n\nThis was the part that was probably pretty complex and poorly\ndescribed in my original post, so I left it out initially.\n\n--  Morgan Schweers\n\n\n", 
    "profile": "cypherfox", 
    "topicId": 11495, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 174888704, 
    "prevInTime": 11513, 
    "contentTrasformed": false, 
    "postDate": "1089937382", 
    "canDelete": false, 
    "nextInTopic": 11515, 
    "prevInTopic": 11512, 
    "headers": {
        "inReplyToHeader": "PDQwRjcxMTgzLjUwNzA4MDdAcm9nZXJzLmNvbT4=", 
        "messageIdInHeader": "PGNkNzc1NitsNnI0QGVHcm91cHMuY29tPg=="
    }
}