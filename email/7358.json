{
    "numMessagesInTopic": 7, 
    "nextInTime": 7359, 
    "senderId": "HFF0rtPi7loLA8IeAi_D8wAItGMtDDEurNW27dLKdV-etDtcID6hlmLsEe9TT12_EAcrVb9mhyGXka1Pi9OGRhvG7YhVxKKOKmA", 
    "systemMessage": false, 
    "subject": "Factory adaptor approach", 
    "from": "Kevin Klinemeier &lt;zipwow@...&gt;", 
    "authorName": "Kevin Klinemeier", 
    "msgSnippet": "In response to my own problems and an earlier question, I ve been thinking about how to test classes that retrieve things from static factories. I don t want", 
    "msgId": 7358, 
    "profile": "zipwow", 
    "topicId": 7358, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 82914509, 
    "messageBody": "<div id=\"ygrps-yiv-1663162366\">In response to my own problems and an earlier question, I&#39;ve been<br/>\nthinking about how to test classes that retrieve things from static<br/>\nfactories.<br/>\n<br/>\nI don&#39;t want to give up being able to make these factories, but they<br/>\ntypically are for things that I&#39;d want to use mock objects for<br/>\n(persistence, logging, etc).<br/>\n<br/>\nThe requirements I started with were:<br/>\n<br/>\n1. The public interface to the factory cannot change.<br/>\n2. The factory&#39;s outputs must be editable at runtime by test classes.<br/>\n3. The factory&#39;s outputs must be editable by classes not in the<br/>\nfactory&#39;s package.<br/>\n<br/>\nWhat I came up with was the regular factory, with some extra logic for<br/>\nreplacement.  That satisfied #2.  I made the methods protected in order<br/>\nto fulfill requirement #1.  Lastly, in order to get around the<br/>\nprotected restriction for #3, I made a &#39;FactoryAdaptor&#39; that basically<br/>\nprovided pass-through for those protected methods.<br/>\n<br/>\nHere&#39;s some quick example code:<br/>\n<br/>\npublic class Factory {<br/>\n<br/>\n  private static overrideThing=null;<br/>\n<br/>\n  public static Thing createThing(String thingName) {<br/>\n    Thing returnThing;   <br/>\n    if (overrideThing != null) {<br/>\n      returnThing=overrideThing;<br/>\n    } else {<br/>\n      do what you&#39;d normally do..<br/>\n    }<br/>\n    return returnThing;<br/>\n  }<br/>\n<br/>\n  protected static void ut_setOverrideThing(Thing overrideThing) {<br/>\n    this.overrideThing= overrideThing;<br/>\n  }<br/>\n}<br/>\n<br/>\npublic class FactoryAdaptor extends Factory {<br/>\n  public static setOverrideThing(Thing overrideThing) {<br/>\n    ut_setOverrideTHing(overrideThing);<br/>\n  }<br/>\n}<br/>\n<br/>\n<br/>\nIn the real implementation, I provided methods to &#39;clear&#39; the override,<br/>\nwhich is more straightforward than setting it to null.  I also provided<br/>\nmethods for recording the thingNames that were requested.  In the<br/>\nfuture, if I need it, I may change it to specify a list of things to<br/>\nreturn over several requests, but I didn&#39;t need it this time around.<br/>\n<br/>\nI like this because it doesn&#39;t change the public interface, and the<br/>\ntest interface can reside in the test source folder.  Those parts of<br/>\nthe code that exist for unit test functionality are marked that way,<br/>\nthough I may have gone too far in modifying the method naming<br/>\nconvention for this.<br/>\n<br/>\nUsage is pretty straightforward, calls go to the FactoryAdaptor.<br/>\n<br/>\nHave other folks used this approach, or something similar?  What do you<br/>\nall think of this approach to the problem?<br/>\n<br/>\nKevin Klinemeier<br/>\n<br/>\nPS:  It occurs to me now that if the factory were a little different,<br/>\nwith a single static getCurrent() method and otherwise instance<br/>\nmethods, this would reduce the nefarious intermingling of the &#39;mocking&#39;<br/>\ncode, because the current method could return a completely different<br/>\n(mock) factory altogether.<br/>\n<br/>\n__________________________________________________<br/>\nDo you Yahoo!?<br/>\nYahoo! Tax Center - File online, calculators, forms, and more<br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"http://platinum.yahoo.com\">http://platinum.yahoo.com</a></div>", 
    "prevInTime": 7357, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1049222593", 
    "canDelete": false, 
    "nextInTopic": 7411, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PDIwMDMwNDAxMTg0MzEzLjM2Mzc5LnFtYWlsQHdlYjgwNDAyLm1haWwueWFob28uY29tPg=="
    }
}