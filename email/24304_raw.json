{
    "numMessagesInTopic": 30, 
    "nextInTime": 24305, 
    "senderId": "OL2plDMztHqv4AkRXjwX2vQa2b2o1cQR9iEuoqRMI9XnkH2nZ5WQJ1KaMfNeWj1mGUAEqHWOIYkVwt26Zf6LIwflxHndpg-9", 
    "systemMessage": false, 
    "subject": "Re: Feedback requested: Impending changes to RunListener", 
    "from": "&quot;sschroev&quot; &lt;stephan202@...&gt;", 
    "authorName": "sschroev", 
    "msgSnippet": "At the risk of repeating myself: my only objection is with the package in which said annotation resides: net.jcip.annotations instead of", 
    "msgId": 24304, 
    "rawEmail": "Return-Path: &lt;stephan202@...&gt;\r\nReceived: (qmail 87039 invoked by uid 7800); 12 Feb 2013 10:54:36 -0000\r\nX-Sender: stephan202@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 24675 invoked from network); 12 Feb 2013 08:46:50 -0000\r\nX-Received: from unknown (10.193.84.131)\n  by m9.grp.bf1.yahoo.com with QMQP; 12 Feb 2013 08:46:50 -0000\r\nX-Received: from unknown (HELO ng16-ip1.bullet.mail.ne1.yahoo.com) (98.138.215.243)\n  by mta4.grp.bf1.yahoo.com with SMTP; 12 Feb 2013 08:46:50 -0000\r\nX-Received: from [98.138.217.180] by ng16.bullet.mail.ne1.yahoo.com with NNFMP; 12 Feb 2013 08:46:50 -0000\r\nX-Received: from [10.193.94.110] by tg5.bullet.mail.ne1.yahoo.com with NNFMP; 12 Feb 2013 08:46:50 -0000\r\nDate: Tue, 12 Feb 2013 08:46:49 -0000\r\nTo: junit@yahoogroups.com\r\nMessage-ID: &lt;kfcvhp+d4r1@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Msg-Info: 2:3:4:0:0\r\nFrom: &quot;sschroev&quot; &lt;stephan202@...&gt;\r\nSubject: Re: Feedback requested: Impending changes to RunListener\r\nX-Yahoo-Group-Post: member; u=495664717; y=xZ6VZPtMnXFZAMJjGApJwcD66Bs6xK6GTurO4Xm1nRPH0Y0\r\nX-Yahoo-Profile: sschroev\r\nX-eGroups-Approved-By: dsaff &lt;david@...&gt; via email; 12 Feb 2013 10:54:36 -0000\r\n\r\nAt the risk of repeating myself: my only objection is with the package in w=\r\nhich said annotation resides: net.jcip.annotations instead of javax.annotat=\r\nion.concurrent. But that argument can also be made in reverse. Hence my sug=\r\ngestion to inspect the annotation&#39;s simple name only. That also makes the l=\r\nicencing discussion mood, unless one wishes to depend on jcip-annotation to=\r\n provide a &quot;default&quot; or &quot;preferred&quot; version of the annotation. That&#39;s fine =\r\nof course. :) Though then do please mark the dependency &lt;optional&gt;: otherwi=\r\nse I have to start explicitly excluding it (I derive my annotations from on=\r\ne of the FindBugs modules mentioned in an earlier email; no need to duplica=\r\nte classes on the classpath).\n\nCheers,\nStephan\n\n--- In junit@...=\r\nm, &quot;tibord47&quot;  wrote:\n&gt;\n&gt; Hi all junit guys,\n&gt; \n&gt; Let me turn back to the o=\r\nriginal problem.\n&gt; \n&gt; We knew that it&#39;s a good idea to let the users to ann=\r\notated a custom listener by @ThreadSafe if it&#39;s really thread-safe.\n&gt; \n&gt; In=\r\n every other case the given listener is wrapped in synchronized listener wh=\r\nich is package private class.\n&gt; \n&gt; I am convinced that we should not make s=\r\nynchronized listener public since this is our internal patch.\n&gt; \n&gt; The user=\r\n may have whatever thread-safe listener depending on implementation and sti=\r\nll not having it synchronized. Thus s/he can annotated the clas by @ThreadS=\r\nafe.\n&gt; We are synchronizing the listener&#39;s methods internally in the patch =\r\nonly because the user&#39;s implementation is unknown -listener in not annotate=\r\nd yet.\n&gt; \n&gt; Back to jcip-annotations license. Such library is under Creativ=\r\ne Commons Attribution License (http://creativecommons.org/licenses/by/2.5).=\r\n\n&gt; \n&gt; If we use Maven dependency, we are free to share, distribute and tran=\r\nsmit.\n&gt; So there is no legal issue for the JUnit.\n&gt; \n&gt; Any objections to th=\r\nis lincense?\n&gt; \n&gt; Thx, Tibor\n&gt; \n&gt; \n&gt; \n&gt; --- In junit@yahoogroups.com, &quot;ssch=\r\nroev&quot;  wrote:\n&gt; &gt;\n&gt; &gt; I understand your concerns w.r.t. the intended semant=\r\nics of third-party @ThreadSafe annotations. For that reason I could certain=\r\nly get behind a differently-named annotation such as @Concurrent. Adding on=\r\ne more annotation is cheap, after all ;)\n&gt; &gt; \n&gt; &gt; Cheers,\n&gt; &gt; Stephan\n&gt; &gt; \n=\r\n&gt; &gt; --- In junit@yahoogroups.com, Kevin Cooney  wrote:\n&gt; &gt; &gt;\n&gt; &gt; &gt; On Wed, =\r\nFeb 6, 2013 at 10:06 AM, sschroev  wrote:\n&gt; &gt; &gt; \n&gt; &gt; &gt; &gt; **\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;=\r\n\n&gt; &gt; &gt; &gt; I like the idea, a lot!\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; But would like to ask that=\r\n only the *simple name* of the annotation is\n&gt; &gt; &gt; &gt; considered, without re=\r\ngard for the package in which it resides.\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; Interesting idea.\n&gt;=\r\n &gt; &gt; \n&gt; &gt; &gt; It looks like Guice uses this strategy for @Nullable (\n&gt; &gt; &gt; ht=\r\ntps://code.google.com/p/google-guice/wiki/UseNullable)\n&gt; &gt; &gt; \n&gt; &gt; &gt; That wo=\r\nuld require us to iterate through all of the class&#39;s annotations, vs\n&gt; &gt; &gt; =\r\na simple getAnnotation() call, but listeners are not added and removed very=\r\n\n&gt; &gt; &gt; often.\n&gt; &gt; &gt; \n&gt; &gt; &gt; &gt;  This way one can:\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; 1. Use an a=\r\nlternative third-party annotation, such as\n&gt; &gt; &gt; &gt; javax.annotation.concurr=\r\nent.ThreadSafe from libraries like\n&gt; &gt; &gt; &gt; com.google.code.findbugs:jsr305:=\r\n1.3.9 and\n&gt; &gt; &gt; &gt; com.google.code.findbugs:annotations:2.0.1.\n&gt; &gt; &gt; &gt; 2. De=\r\nfine a private annotation, without adding _any_ additional dependency.\n&gt; &gt; =\r\n&gt; &gt;\n&gt; &gt; &gt; Alternatively, we could add a JUnit-specific annotation (possibly=\r\n named\n&gt; &gt; &gt; &quot;Concurrent&quot;) and you could annotate your class with both anno=\r\ntations (ob\n&gt; &gt; &gt; meme: http://www.quickmeme.com/meme/3svo5h/)\n&gt; &gt; &gt; \n&gt; &gt; &gt;=\r\n One reservation I have with using @ThreadSafe is that usually the\n&gt; &gt; &gt; jc=\r\nip-annotations documents behavior (sure, it is used by findbugs to find\n&gt; &gt;=\r\n &gt; potential bugs, but that&#39;s validation based on behavior documented in\n&gt; =\r\n&gt; &gt; annotations). Here we are proposing using @ThreadSafe to modify behavio=\r\nr.\n&gt; &gt; &gt; Someone might not expect by simply adding an annotation to a class=\r\n they are\n&gt; &gt; &gt; changing the behavior of code that uses instances of the cl=\r\nass.\n&gt; &gt; &gt; \n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; I use javax.annotation.concurrent.ThreadSafe qu=\r\nite a lot in my own code,\n&gt; &gt; &gt; &gt; so (1) is quite important from my perspec=\r\ntive. There are precedents for\n&gt; &gt; &gt; &gt; this approach: IIRC, Eclipse does so=\r\nmething like this for variations on\n&gt; &gt; &gt; &gt; @Nullable and @Nonnull, whereas=\r\n (again, IIRC) Findbugs handles two\n&gt; &gt; &gt; &gt; instances of @SuppressWarnings.=\r\n\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; Cheers,\n&gt; &gt; &gt; &gt; Stephan\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; --- In jun=\r\nit@yahoogroups.com, Kevin Cooney wrote:\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; Hello, everyone=\r\n\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; Short version: we are thinking of adding an optional d=\r\nependency from\n&gt; &gt; &gt; &gt; JUnit\n&gt; &gt; &gt; &gt; &gt; to jcip-annotations and are soliciti=\r\nng feedback.\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; A few people have noticed that when you us=\r\ne ParallelComputer, you got\n&gt; &gt; &gt; &gt; poor\n&gt; &gt; &gt; &gt; &gt; performance because call=\r\ns to registered RunListeners are synchronized. We\n&gt; &gt; &gt; &gt; &gt; would like to f=\r\nix this in the next release of JUnit.\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; In order to preve=\r\nnt affecting existing users, we are proposing having an\n&gt; &gt; &gt; &gt; &gt; annotatio=\r\nn that can be added to RunListener implementations that can\n&gt; &gt; &gt; &gt; safely\n=\r\n&gt; &gt; &gt; &gt; &gt; be called concurrently from multiple threads. If a RunListener pa=\r\nssed to\n&gt; &gt; &gt; &gt; a\n&gt; &gt; &gt; &gt; &gt; RunNotifier is not annotated with this annotati=\r\non, JUnit will wrap it\n&gt; &gt; &gt; &gt; with\n&gt; &gt; &gt; &gt; &gt; a decorator that does synchro=\r\nnization.\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; We would appreciate feedback on thi=\r\ns new annotation.\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; We have two options:\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; =\r\n&gt; &gt; a. Create our own annotation for this\n&gt; &gt; &gt; &gt; &gt; b. Use ThreadSafe (\n&gt; &gt;=\r\n &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; http://grepcode.com/file/repo1.maven.org/maven2/net.jcip/jci=\r\np-annotations/1.0/net/jcip/annotations/ThreadSafe.java\n&gt; &gt; &gt; &gt; &gt; )\n&gt; &gt; &gt; &gt; =\r\n&gt;\n&gt; &gt; &gt; &gt; &gt; The advantages to option b are:\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; 1. It&#39;s a w=\r\nell-known annotation\n&gt; &gt; &gt; &gt; &gt; 2. Users that use JUnit can add this annotat=\r\nion to their thread-safe\n&gt; &gt; &gt; &gt; &gt; RunListener implementations today and ge=\r\nt the benefits &quot;for free&quot; later.\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; Note we can do this wi=\r\nthout requiring that all users of JUnit have the\n&gt; &gt; &gt; &gt; &gt; jcip-annotations=\r\n jar in their classpath as of JDK 1.5.0_06 (see\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; http://st=\r\nackoverflow.com/questions/3567413/why-doesnt-a-missing-annotation-cause-a-c=\r\nlassnotfoundexception-at-runtime\n&gt; &gt; &gt; &gt; ).\n&gt; &gt; &gt; &gt; &gt; If jcip-annotations i=\r\ns not on the classpath then all RunListener\n&gt; &gt; &gt; &gt; &gt; implementations will =\r\nbe treated as not thread-safe.\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; As a specific example, t=\r\nhe Maven Surefire plugin would use this\n&gt; &gt; &gt; &gt; dependency\n&gt; &gt; &gt; &gt; &gt; and in=\r\nclude jcip-annotations.\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; Currently, JUnit only depends o=\r\nn one third-party library (Hamcrest). This\n&gt; &gt; &gt; &gt; &gt; has caused us some pai=\r\nn in the past when the Hamcrest code changed in\n&gt; &gt; &gt; &gt; ways\n&gt; &gt; &gt; &gt; &gt; that=\r\n broke existing users of JUnit. We believe this will not be an issue\n&gt; &gt; &gt; =\r\n&gt; &gt; with jcip-annotations because the JAR only contains annotations, not an=\r\ny\n&gt; &gt; &gt; &gt; &gt; code.\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; One possible concern would be with ot=\r\nher open source libraries that\n&gt; &gt; &gt; &gt; provide\n&gt; &gt; &gt; &gt; &gt; RunListener implem=\r\nentations (they would need to add jcip-annotations to\n&gt; &gt; &gt; &gt; &gt; their compi=\r\nle-time classpath if they have thread-safe annotations, and\n&gt; &gt; &gt; &gt; &gt; docum=\r\nent this to their users).\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; Thoughts?\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt;=\r\n -- Kevin\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; &gt; [Non-text portions of this message =\r\nhave been removed]\n&gt; &gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt;  \n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; \n&gt; &gt; &gt; \n&gt; &gt; &gt; =\r\n[Non-text portions of this message have been removed]\n&gt; &gt; &gt;\n&gt; &gt;\n&gt;\n\n\n\n", 
    "profile": "sschroev", 
    "topicId": 24274, 
    "spamInfo": {
        "reason": "3", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 495664717, 
    "prevInTime": 24303, 
    "contentTrasformed": false, 
    "postDate": "1360658809", 
    "canDelete": false, 
    "nextInTopic": 24305, 
    "prevInTopic": 24303, 
    "headers": {
        "messageIdInHeader": "PGtmY3ZocCtkNHIxQGVHcm91cHMuY29tPg=="
    }
}