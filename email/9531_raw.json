{
    "numMessagesInTopic": 40, 
    "nextInTime": 9532, 
    "senderId": "qgJ4Z2GLmodVOlFTIjymxoye2mAH2It0NlFRl_BxUVdsJ3EqJhsj-AseZSwDhpsZV1X_pf-rSqTGSFyeMZhTcf-e6QkPn_GU5_BzmQ", 
    "systemMessage": false, 
    "subject": "Re: [junit] Re: Recursive TestRunner -- one implementation", 
    "from": "Malcolm Sparks &lt;malcolm@...&gt;", 
    "authorName": "Malcolm Sparks", 
    "msgSnippet": "Hi Jeff. Interesting post! ... If you can t call a class directly (due to incompatibility arising from different class loaders) then you can t call a class", 
    "msgId": 9531, 
    "rawEmail": "Return-Path: &lt;malcolm@...&gt;\r\nReceived: (qmail 52874 invoked by uid 7800); 29 Sep 2003 17:13:12 -0000\r\nX-Sender: malcolm@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 16394 invoked from network); 29 Sep 2003 11:41:50 -0000\r\nReceived: from unknown (66.218.66.167)\n  by m13.grp.scd.yahoo.com with QMQP; 29 Sep 2003 11:41:50 -0000\r\nReceived: from unknown (HELO luthien.congreve.com) (62.221.11.252)\n  by mta6.grp.scd.yahoo.com with SMTP; 29 Sep 2003 11:41:50 -0000\r\nReceived: from [192.168.42.190] (luthien.congreve.com [192.168.42.190])\n\tby luthien.congreve.com (8.12.8/8.12.8) with ESMTP id h8TBhI4q006237\n\tfor &lt;junit@yahoogroups.com&gt;; Mon, 29 Sep 2003 12:43:18 +0100\r\nSubject: Re: [junit] Re: Recursive TestRunner -- one implementation\r\nTo: junit@yahoogroups.com\r\nIn-Reply-To: &lt;bl5cfk+pc9c@...&gt;\r\nReferences: &lt;bl5cfk+pc9c@...&gt;\r\nContent-Type: text/plain\r\nOrganization: \r\nMessage-Id: &lt;1064835798.4330.33.camel@...&gt;\r\nMime-Version: 1.0\r\nX-Mailer: Ximian Evolution 1.2.2 (1.2.2-4) \r\nDate: 29 Sep 2003 12:43:18 +0100\r\nContent-Transfer-Encoding: 7bit\r\nFrom: Malcolm Sparks &lt;malcolm@...&gt;\r\nX-Yahoo-Group-Post: member; u=139420845\r\nX-Yahoo-Profile: xsumeman\r\nX-eGroups-Approved-By: vbossica &lt;vladimir@...&gt; via email; 29 Sep 2003 17:13:12 -0000\r\n\r\nHi Jeff. Interesting post!\n\nOn Sun, 2003-09-28 at 02:11, Jeff Grigg wrote:\n\n&gt; *BUT* for any of this to work, the classes under test must be loaded \n&gt; with a custom class loader.  This is the rub:  Standard JUnit test \n&gt; runners load the TestCase classes using the standard Java class \n&gt; loader.  So when I load the application classes using the \n&gt; jAdvise/javassist class loader, the tests can only communicate with \n&gt; the application objects using Reflection, because classes and \n&gt; interfaces are incompatible when loaded with different class \n&gt; loaders.  Writing all test logic using Reflection would be really \n&gt; unpleasant.  So I need to load the TestCase classes with the \n&gt; jAdvise/javassist class loader.\n\nIf you can&#39;t call a class directly (due to incompatibility arising from\ndifferent class loaders) then you can&#39;t call a class indirectly (using\nreflection). Reflection allows you to call methods dynamically, but not\nto circumvent type checking. You can try, but I think you&#39;ll find it\nimpossible. (Of course, trying it yourself with tests is much better\nthan believing what you read on mailing lists!)\n\n&gt; \n&gt; Hmmm...\n&gt; \n&gt; Here&#39;s what I do:\n&gt; Each test method that needs to run under jAdvise/javassist checks to \n&gt; see if it was loaded by a JUnit runner or jAdvise.  If it was loaded \n&gt; by a JUnit runner, it calls a common method that fires up jAdvise, \n&gt; loads the class with the custom class loader, and then calls the \n&gt; same method in the loaded class.  (It also calls setUp & tearDown in \n&gt; the other class.)\n&gt; \n&gt; Here&#39;s what it looks like:\n&gt; | public class MyTestCase extends TestCase {\n&gt; |    final boolean runningInCustomClassLoader;\n&gt; |    public MyTestCase() { super(&quot;MyTestCase&quot;);\n&gt; |       this.runningInCustomClassLoader = true; }\n&gt; |    public MyTestCase(String name) { super(name);\n&gt; |       this.runningInCustomClassLoader = false; }\n&gt; |\n&gt; |    public void testMethod() {\n&gt; |       if (this.runningInCustomClassLoader) {\n&gt; |          // Do application testing here.\n&gt; |       } else { // called by JUnit\n&gt; |          callSelfInCustomClassLoader();\n&gt; | } } }\n&gt; \n&gt; Crazy, eh?  ;-&gt;\n\nYes, a little ;)\n\n&gt; \n&gt; (In Java 1.4 there&#39;s an easy way to get a useful stack trace -- \n&gt; so &#39;callSelfInCustomClassLoader&#39; can determine the caller&#39;s class \n&gt; and method name.)\n&gt; \n&gt; _ _ _\n&gt; \n&gt; \n&gt; Further  (or worse, if you wish  ;-) ...\n&gt; \n&gt; I often find myself in a related &quot;recursive testing&quot; situation much \n&gt; like this:\n&gt; \n&gt; I&#39;ve written a bunch of really nice test methods in a TestCase.  \n&gt; They work great.  Now I want to run all these tests with a slightly \n&gt; different configuration of the system -- in addition to the existing \n&gt; configuration that they test, not instead of it.  Like, here are a \n&gt; bunch of tests that check sending integers and strings through \n&gt; a &quot;pipe&quot; from client to server.  Now I&#39;d like to run the whole thing \n&gt; again, going from server to client.  (The protocol is asymmetrical.  \n&gt; Don&#39;t blame me; I inherited it!  ;-)  OK, that was great for XML \n&gt; formatted messages, but I&#39;d like to try both directions again with \n&gt; binary formatted messages.  Oh, and one more time, both ways, using \n&gt; Microsoft&#39;s DCOM object serialization.\n&gt; \n&gt; Thus far I&#39;ve been accomplishing these tricks by having each test \n&gt; method call subroutines that try each of the desired permutations.  \n&gt; So I&#39;ll have the &#39;testSendBooleanTrue&#39; method call XML, binary and \n&gt; DCOM methods.  Each of those calls clientToServer and serverToClient \n&gt; methods.  And then, after all that configuration goes on, down at \n&gt; the deepest levels, the test takes place -- often by calling back to \n&gt; anonymous inner classes passed in from the higher levels.\n&gt; \n&gt; It&#39;s icky, but it works.\n&gt; \n&gt; At least I&#39;ve yet to resort to Reflection or rewriting JUnit to \n&gt; accomplish what I need.  ;-&gt;     ...at least /not yet./   ;-&gt;\n\nAs I explained above, I don&#39;t think you could resort reflection anyway,\nso you might want to write your own JUnit clone to force classloading\nthrough Javassist&#39;s class-loader.\n\nMalcolm\n\n&gt; \n&gt; \n&gt; \n&gt; To unsubscribe from this group, send an email to:\n&gt; junit-unsubscribe@yahoogroups.com\n&gt;  \n&gt; \n&gt; Your use of Yahoo! Groups is subject to http://docs.yahoo.com/info/terms/\n-- \nMalcolm Sparks\nCongreve Computing\nhttp://www.congreve.com\n\n\n", 
    "profile": "xsumeman", 
    "topicId": 9399, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 139420845, 
    "prevInTime": 9530, 
    "contentTrasformed": false, 
    "postDate": "1064835798", 
    "canDelete": false, 
    "nextInTopic": 9533, 
    "prevInTopic": 9530, 
    "headers": {
        "inReplyToHeader": "PGJsNWNmaytwYzljQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PDEwNjQ4MzU3OTguNDMzMC4zMy5jYW1lbEBsdXRoaWVuLmNvbmdyZXZlLmNvbT4=", 
        "referencesHeader": "PGJsNWNmaytwYzljQGVHcm91cHMuY29tPg=="
    }
}