{
    "numMessagesInTopic": 125, 
    "nextInTime": 14660, 
    "senderId": "r5Kl8ewG6nMA7tz8SkMoXl14kf_BHMgE01ZDXtLNtte9mhRTe-I2TskQ1zeEN02o4ZCcD9KItfTsT1xs9erpgmC7BWnIsNCNFCatdAm_kyh-", 
    "systemMessage": true, 
    "subject": "RE: [junit] Re: How to test private methods in a class.", 
    "from": "&quot;Iliya Agoshkov&quot; &lt;Iliya.Agoshkov@...&gt;", 
    "authorName": "Iliya Agoshkov", 
    "msgSnippet": "Hi, Robert. Thanks a lot for your design solution. But this QueryBuilder class looks for me more like FlightSearchQueryBuilder, as it doesn t provide any", 
    "msgId": 14659, 
    "rawEmail": "Return-Path: &lt;Iliya.Agoshkov@...&gt;\r\nReceived: (qmail 5485 invoked from network); 5 Sep 2005 13:08:38 -0000\r\nReceived: from unknown (66.218.66.217)\n  by m4.grp.scd.yahoo.com with QMQP; 5 Sep 2005 13:08:38 -0000\r\nReceived: from unknown (HELO n7a.bulk.scd.yahoo.com) (66.94.237.41)\n  by mta2.grp.scd.yahoo.com with SMTP; 5 Sep 2005 13:08:35 -0000\r\nComment: DomainKeys? See http://antispam.yahoo.com/domainkeys\r\nReceived: from [66.218.66.58] by n7.bulk.scd.yahoo.com with NNFMP; 05 Sep 2005 13:02:25 -0000\r\nReceived: from [66.218.66.88] by mailer7.bulk.scd.yahoo.com with NNFMP; 05 Sep 2005 13:02:22 -0000\r\nX-Sender: Iliya.Agoshkov@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 52071 invoked from network); 5 Sep 2005 12:31:35 -0000\r\nReceived: from unknown (66.218.66.172)\n  by m28.grp.scd.yahoo.com with QMQP; 5 Sep 2005 12:31:35 -0000\r\nReceived: from unknown (HELO newton.hq.actis.ru) (212.248.55.201)\n  by mta4.grp.scd.yahoo.com with SMTP; 5 Sep 2005 12:31:31 -0000\r\nContent-class: urn:content-classes:message\r\nMIME-Version: 1.0\r\nX-MimeOLE: Produced By Microsoft Exchange V6.5.7226.0\r\nDate: Mon, 5 Sep 2005 16:31:09 +0400\r\nMessage-ID: &lt;9BEAA1B86783344BA6CF9B95F5B620923C188B@...&gt;\r\nX-MS-Has-Attach: \r\nX-MS-TNEF-Correlator: \r\nThread-Topic: [junit] Re: How to test private methods in a class.\r\nthread-index: AcWyDAJEVgMS3MfRT6yd6PdU4DSeqgABthOg\r\nTo: &lt;junit@yahoogroups.com&gt;\r\nX-eGroups-Msg-Info: 1:12:0:0\r\nFrom: &quot;Iliya Agoshkov&quot; &lt;Iliya.Agoshkov@...&gt;\r\nSubject: RE: [junit] Re: How to test private methods in a class.\r\nX-Yahoo-Group-Post: member; u=234978661; y=gn51SyjlqBcz-P4CN_EIxj_JogjMIqzfJrpyNO5tSviEMxI3kA\r\nX-Yahoo-Profile: agoshkoviv\r\nContent-Type: text/plain; charset=US-ASCII\r\nContent-Transfer-Encoding: 7bit\r\nX-Yahoo-Newman-Property: groups-system\r\nX-eGroups-Approved-By: vbossica &lt;vladimir@...&gt; via web; 05 Sep 2005 13:02:19 -0000\r\n\r\nHi, Robert.\n\n \n\nThanks a lot for your design solution.\n\n \n\nBut this QueryBuilder class looks for me more like\nFlightSearchQueryBuilder, as it doesn&#39;t provide any useful functionality\nfor any places other\n\nthen presented &#39;search&#39; method.\n\n \n\nBut that&#39;s ok anyway. I&#39;ve got the idea.\n\nLooks like &quot;the more you refactor the closer you come to a better\nsolution&quot;.\n\n \n\nConsider the following example (these are methods of the same class\nwhich has the &#39;search(...)&#39; method):\n\n \n\npublic class FlightSearch\n\n{\n\n....\n\n            /**\n\n             * Prints all the cities (and airports) and airlines,\nspecifying &quot;selected&quot; attribute\n\n             * near those cities(airports) and airlines which were\nchosen by user in search parameters.\n\n             * The &quot;selected&quot; attribute is needed to show &quot;search form&quot;\nback to user, with corresponding\n\n             * cities(airports) and airlines selected.\n\n             *\n\n             * @param xmlBuf                     the buffer where to\nprint XML, must be not &lt;code&gt;null&lt;/code&gt;\n\n             * @param searchParams          search parameters specified\nby user, if &lt;code&gt;null&lt;/code&gt;\n\n             *\nthen no &quot;selected&quot; attribute will be appended\n\n             */\n\n            private void printSearchFormXML( XMLBuffer xmlBuf,\nFlightSearchParameters searchParams )\n\n            {\n\n                        xmlBuf.openTag( &quot;search-form&quot; );\n\n                        printCities( xmlBuf, searchParams );\n\n                        printAirlines( xmlBuf, searchParams );\n\n                        xmlBuf.closeTag( &quot;search-form&quot; );\n\n            }\n\n \n\n            /**\n\n             * Prints all airlines, specifying &quot;selected&quot; attribute near\nairlines which were chosen by user\n\n             * in search parameters.\n\n             * The &quot;selected&quot; attribute is needed to show &quot;search form&quot;\nback to user, with corresponding\n\n             * airlines selected.\n\n             * This method is used internally in {@link\n#printSearchFormXML}\n\n             *\n\n             * @param xmlBuf                     the buffer where to\nprint XML, must be not &lt;code&gt;null&lt;/code&gt;\n\n             * @param params                    search parameters\nspecified by user, must be not &lt;code&gt;null&lt;/code&gt;\n\n             * @see              #printSearchFormXML\n\n             */\n\n            private void printAirlines( XMLBuffer xmlBuf,\nFlightSearchParameters params )\n\n            {\n\n                        xmlBuf.openTag( &quot;airlines&quot; );\n\n                        Collection airlines = Airline.getList();\n\n                        Iterator airlinesIt = airlines.iterator();\n\n                        String selectedAirlineId = params != null ?\nparams.getAirlineId() : null;\n\n                        while ( airlinesIt.hasNext() )\n\n                        {\n\n                                    Airline airline = ( Airline )\nairlinesIt.next();\n\n                                    boolean selected = false;\n\n                                    if (\nairline.getId().equalsIgnoreCase( selectedAirlineId ) )\n\n                                    {\n\n                                                selected = true;\n\n                                    }\n\n                                    airline.printXML( xmlBuf, selected\n);\n\n                        }\n\n                        xmlBuf.closeTag( &quot;airlines&quot; );\n\n            }\n\n \n\n            /**\n\n             * Prints all cities(airports), specifying &quot;selected&quot;\nattribute near cities(airports) which were chosen\n\n             * by user in search parameters.\n\n             * The &quot;selected&quot; attribute is needed to show &quot;search form&quot;\nback to user, with corresponding\n\n             * cities(airports) selected.\n\n             * This method is used internally in {@link\n#printSearchFormXML}\n\n             *\n\n             * @param xmlBuf                     the buffer where to\nprint XML, must be not &lt;code&gt;null&lt;/code&gt;\n\n             * @param params                    search parameters\nspecified by user, must be not &lt;code&gt;null&lt;/code&gt;\n\n             * @see              #printSearchFormXML\n\n             */\n\n            private void printCities( XMLBuffer xmlBuf,\nFlightSearchParameters params )\n\n            {\n\n                        xmlBuf.openTag( &quot;cities&quot; );\n\n                        Collection cities = City.getList();\n\n                        Iterator citiesIt = cities.iterator();\n\n                        String selectedAirportId = params != null ?\nparams.getAirportId() : null;\n\n                        String selectedCityId = params != null ?\nparams.getCityId() : null;\n\n                        while ( citiesIt.hasNext() )\n\n                        {\n\n                                    City city = ( City )\ncitiesIt.next();\n\n                                    boolean selected = false;\n\n                                    if ( city.getId().equalsIgnoreCase(\nselectedCityId ) )\n\n                                    {\n\n                                                selected = true;\n\n                                    }\n\n                                    city.printXML( xmlBuf, true,\nselected, selectedAirportId );\n\n                        }\n\n                        xmlBuf.closeTag( &quot;cities&quot; );\n\n            }\n\n...\n\n}\n\n \n\npublic class FlightSearchParameters\n\n{\n\n            private String vnukovoAirportId;\n\n            private String cityId;\n\n            private String airportId;\n\n            private int direction;\n\n            private Date date;\n\n            private String airlineId;\n\n \n\n//// +constructor and lots of getters methods\n\n}\n\n \n\nThe whole idea is that all these methods print XML to XMLBuffer and the\nonly thing changing in this XML from time to time is that\n&#39;selected=&quot;true&quot;&#39; attribute\n\nadded in those nodes which correspond to parameters in\nFlightSearchParameters.\n\nSo when we print collection of Airlines to XML one of them can be\nselected and the selected=&#39;true&#39; is placed in this node. (selected means\nthat flightSearchParameters.getAirlineId().equals(\ncurrentPrintedAirlineId ))\n\nWith cities situation is some more complicated, as each city can have\nmultiple airports inside (and some of airports may be selected), so I\npass selectedAirportId parameters to city.printXML(...).\n\n \n\nCan you suggest any better solution?\n\n \n\nP.S. Sorry for such a large listing.\n\n \n\n-----Original Message-----\nFrom: junit@yahoogroups.com [mailto:junit@yahoogroups.com] On Behalf Of\nRobert\nSent: Monday, September 05, 2005 3:19 PM\nTo: junit@yahoogroups.com\nSubject: [junit] Re: How to test private methods in a class.\n\n \n\n--- In junit@yahoogroups.com, &quot;Iliya Agoshkov&quot; &lt;Iliya.Agoshkov@a...&gt;\nwrote:\n&gt; Continuing about testing private methods.\n&gt; What if a private method represent some kind of functionality that\nis\n&gt; needed only to this concrete class.\n&gt; You know sometimes there is a big method which is not clearly\nreadable.\n&gt; So usually I extract some smaller pieces of code naming them\n&gt; correspondingly.\n&gt; So the code becomes more readable. But these methods are private\nand it\n&gt; seems to me,\n&gt; that there is no way to extract them to a separate class.\n\nI extract private methods out of public methods to improve\nreadability. I transform private methods into methods on new classes\nto improve testability - there are different drivers in force.\n\nIn your particular example, I&#39;d create a QueryBuilder class, and I&#39;d\nprobably put some more smarts into the FlightSearchParameters. Try\nsomething like this:\n\npublic static Collection&lt;Flight&gt; search(FlightSearchParameters\nparams) {\n  QueryBuilder builder = new QueryBuilder(params);\n  builder.addDirections();\n  builder.addAirline();\n  builder.addDate();\n\n  Query&lt;Flight&gt; query = builder.buildQuery(Flight.class);\n  return query.execute();\n}\n\nThis should be reasonably testable - if you need a bit more, consider\nadding a QueryBuilderFactory, which would let you drop in mock\nQueryBuilders to test the construction of the query.\n\nThe &quot;addDirections()&quot;, &quot;addAirline()&quot;, &quot;addDate()&quot; methods would\nessentially do the logic you&#39;ve got in each part of the query\nconstruction. For example, addDirections() would look like this:\n\npublic void addDirections() {\n  if ( params.getCityId() != null ) {          \n    addDirectionFilter( params, whereString, whereParams,\n&quot;T_AIRPORT.XM_CITY_ID&quot;, params.getCityId() );\n  } else {\n    addDirectionFilter( params, whereString, whereParams,\n&quot;T_AIRPORT.M_ID&quot;, params.getAirportId() );\n  }\n}\n\nThe Query class would be constructed with SQL and parameters, as built\nup by the QueryBuilder. The execute method would execute the SQL.\n\nThe first time I did this, it would end up as an inner class of\nwhatever the search() method is in. Over time, as other methods would\nget written, I would extract out bits and pieces. For example, the\nQuery class is extremely re-usable would come out very fast. The\nQueryBuilder class, by contrast, would become public fairly slowly,\nand there may well be a few different implementations to present a\nsuitable specialised interface. It&#39;s also possible that I would move\nthe smarts back to the SearchParameters - this would allow me to have\na reasonable generic QueryBuilder, with customised search parameters.\n\nThe interesting part here is that I can obtain this solution from the\nexisting code fairly easily by applying some simple &quot;Extract Method&quot;\nrefactorings, plus a coulple of &quot;Extract Method Object&quot; refactorings.\nThese tend to be very &quot;safe&quot; refactorings, which means I would be\nconfident enough to do it on a code base with otherwise shaky tests.\n\nHope this helps.\n\n&gt; How do I test these all &#39;addXXXFilter&#39; methods? \n\nAs you&#39;d eat an elephant - one bite at a time.\n\n&gt; Or I don&#39;t need to test em at all (cause they are tested through the\n&gt; test of &#39;public search(...)&#39; method)??\n\nNo, you do need to test them, because they can fail. However, you\ndon&#39;t want to test all the permutations. By breaking them out, you can\neasily see what happens.\n\n&gt; Or may be you can suggest a better design solution?\n\nMaybe. Maybe I didn&#39;t - I don&#39;t have the context to answer the\nquestion. I can confidently say I&#39;ve presented a _different_ design\nsolution, though.\n\nRobert.\n\n\n\n\n\n\n________________________________\n\nYAHOO! GROUPS LINKS \n\n \n\n*          Visit your group &quot;junit &lt;http://groups.yahoo.com/group/junit&gt;\n&quot; on the web.\n  \n\n*          To unsubscribe from this group, send an email to:\n junit-unsubscribe@yahoogroups.com\n&lt;mailto:junit-unsubscribe@yahoogroups.com?subject=Unsubscribe&gt; \n  \n\n*          Your use of Yahoo! Groups is subject to the Yahoo! Terms of\nService &lt;http://docs.yahoo.com/info/terms/&gt; . \n\n \n\n________________________________\n\n\n\n[Non-text portions of this message have been removed]\n\n\n\n\n", 
    "profile": "agoshkoviv", 
    "topicId": 14490, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 234978661, 
    "prevInTime": 14658, 
    "contentTrasformed": false, 
    "postDate": "1125923469", 
    "canDelete": false, 
    "nextInTopic": 14661, 
    "prevInTopic": 14658, 
    "headers": {
        "messageIdInHeader": "PDlCRUFBMUI4Njc4MzM0NEJBNkNGOUI5NUY1QjYyMDkyM0MxODhCQG5ld3Rvbi5ocS5hY3Rpcy5ydT4="
    }
}