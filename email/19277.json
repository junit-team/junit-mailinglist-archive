{
    "numMessagesInTopic": 4, 
    "nextInTime": 19278, 
    "senderId": "P5Pg2NB2dsBJTG1zwdBsF209MSgwtdsr8Q2m6-BIvzU0FqhDLY8rlZxWBm5mgCoyo6EjQIhRBZCwsYPrBAQToDqk", 
    "systemMessage": false, 
    "subject": "Re: [junit] Custom suites with filter", 
    "from": "&quot;David Saff&quot; &lt;saff@...&gt;", 
    "authorName": "David Saff", 
    "msgSnippet": "Matthias, The easiest thing to do is to go ahead and create a suite with all of the tests (call it AllMyTests, for example). Then, you can create a separate", 
    "msgId": 19277, 
    "profile": "dsaff", 
    "topicId": 19276, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 139771899, 
    "messageBody": "<div id=\"ygrps-yiv-513856231\">Matthias,<br/>\n<br/>\nThe easiest thing to do is to go ahead and create a suite with all of the<br/>\ntests (call it AllMyTests, for example).<br/>\n<br/>\nThen, you can create a separate class AllMyTestsFiltered, which looks like<br/>\nthis:<br/>\n<br/>\n@RunWith(FilterRunner.class)<br/>\n@FilteredClass(testClass = AllMyTests.class, filterClass =<br/>\nCategoryFilter.class)<br/>\npublic class AllMyTestsFiltered {}<br/>\n<br/>\nYou&#39;ll need FilterRunner, which I&#39;ve provided below, with tests (the tests<br/>\ncome first--a personal quirk).  I&#39;m not terribly familiar with JUnitExt, so<br/>\nthere might be a CategoryFilter you can immediately grab, or you might have<br/>\nto roll your own.  Good luck,<br/>\n<br/>\n   David Saff<br/>\n<br/>\n<br/>\npackage filter;<br/>\n<br/>\nimport static org.junit.Assert.*;<br/>\n<br/>\nimport java.lang.annotation.Retention;<br/>\nimport java.lang.annotation.RetentionPolicy;<br/>\n<br/>\nimport org.junit.Test;<br/>\nimport org.junit.runner.Description;<br/>\nimport org.junit.runner.JUnitCore;<br/>\nimport org.junit.runner.Request;<br/>\nimport org.junit.runner.Result;<br/>\nimport org.junit.runner.RunWith;<br/>\nimport org.junit.runner.Runner;<br/>\nimport org.junit.runner.manipulation.Filter;<br/>\nimport org.junit.runner.notification.RunNotifier;<br/>\n<br/>\npublic class FilterTest {<br/>\n<br/>\n<br/>\n    // TEST<br/>\n<br/>\n<br/>\n    public static class AFilter extends PrefixFilter {<br/>\n        @Override<br/>\n        protected String getPrefix() {<br/>\n            return &quot;a&quot;;<br/>\n        }<br/>\n    }<br/>\n<br/>\n    public static class BFilter extends PrefixFilter {<br/>\n        @Override<br/>\n        protected String getPrefix() {<br/>\n            return &quot;b&quot;;<br/>\n        }<br/>\n    }<br/>\n<br/>\n    public static class OneAOneB {<br/>\n        @Test<br/>\n        public void a1() {<br/>\n<br/>\n        }<br/>\n<br/>\n        @Test<br/>\n        public void b1() {<br/>\n<br/>\n        }<br/>\n    }<br/>\n<br/>\n    public static class TwoAsOneB extends OneAOneB {<br/>\n        @Test<br/>\n        public void a2() {<br/>\n<br/>\n        }<br/>\n    }<br/>\n<br/>\n    @RunWith(FilterRunner.class)<br/>\n    @FilteredClass(testClass = OneAOneB.class, filterClass = AFilter.class)<br/>\n    public static class OneA {<br/>\n<br/>\n    }<br/>\n<br/>\n    @RunWith(FilterRunner.class)<br/>\n    @FilteredClass(testClass = TwoAsOneB.class, filterClass = AFilter.class)<br/>\n    public static class TwoAs {<br/>\n<br/>\n    }<br/>\n<br/>\n    @RunWith(FilterRunner.class)<br/>\n    @FilteredClass(testClass = TwoAsOneB.class, filterClass = BFilter.class)<br/>\n    public static class OneB {<br/>\n<br/>\n    }<br/>\n<br/>\n    @Test<br/>\n    public void filterRunnerWorksOnTwoAs() {<br/>\n        Result result = JUnitCore.runClasses(TwoAs.class);<br/>\n        assertEquals(2, result.getRunCount());<br/>\n    }<br/>\n<br/>\n    @Test<br/>\n    public void filterRunnerWorksOnB() {<br/>\n        Result result = JUnitCore.runClasses(OneB.class);<br/>\n        assertEquals(1, result.getRunCount());<br/>\n    }<br/>\n<br/>\n    @Test<br/>\n    public void filterRunnerWorksOnA() {<br/>\n        Result result = JUnitCore.runClasses(OneA.class);<br/>\n        assertEquals(1, result.getRunCount());<br/>\n    }<br/>\n<br/>\n<br/>\n<br/>\n<br/>\n    // IMPLEMENTATION<br/>\n<br/>\n<br/>\n<br/>\n<br/>\n    @Retention(RetentionPolicy.RUNTIME)<br/>\n    public @interface FilteredClass {<br/>\n<br/>\n        Class&lt;?&gt; testClass();<br/>\n<br/>\n        Class&lt;? extends Filter&gt; filterClass();<br/>\n<br/>\n    }<br/>\n<br/>\n    public abstract static class PrefixFilter extends Filter {<br/>\n        @Override<br/>\n        public String describe() {<br/>\n            return &quot;methods beginning with &quot; + getPrefix();<br/>\n        }<br/>\n<br/>\n        @Override<br/>\n        public boolean shouldRun(Description description) {<br/>\n            return (description.getDisplayName().startsWith(getPrefix()));<br/>\n        }<br/>\n<br/>\n        protected abstract String getPrefix();<br/>\n    }<br/>\n<br/>\n    public static class FilterRunner extends Runner {<br/>\n        private final Runner delegate;<br/>\n<br/>\n        public FilterRunner(Class&lt;?&gt; testClass) throws Exception {<br/>\n            Request classRequest = Request.aClass(getTestClass(testClass));<br/>\n            Filter filter = getFilter(testClass);<br/>\n            delegate = classRequest.filterWith(filter).getRunner();<br/>\n        }<br/>\n<br/>\n        private Class&lt;?&gt; getTestClass(Class&lt;?&gt; testClass) {<br/>\n            return annotation(testClass).testClass();<br/>\n        }<br/>\n<br/>\n        private Filter getFilter(Class&lt;?&gt; testClass) throws Exception {<br/>\n            return annotation(testClass).filterClass().newInstance();<br/>\n        }<br/>\n<br/>\n        private FilteredClass annotation(Class&lt;?&gt; testClass) {<br/>\n            return testClass.getAnnotation(FilteredClass.class);<br/>\n        }<br/>\n<br/>\n        @Override<br/>\n        public Description getDescription() {<br/>\n            return delegate.getDescription();<br/>\n        }<br/>\n<br/>\n        @Override<br/>\n        public void run(RunNotifier notifier) {<br/>\n            delegate.run(notifier);<br/>\n        }<br/>\n    }<br/>\n}<br/>\n<br/>\n<br/>\n<blockquote><span title=\"qreply\"> On 4/12/07, matthiasluebken &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:matthias.luebken@...\">matthias.luebken@...</a>&gt; wrote:<br/>\n&gt;<br/>\n&gt; Hi<br/>\n&gt;<br/>\n&gt; I&#39;m just exploring JUnit4 for our project.<br/>\n&gt;<br/>\n&gt; What we like to do is to distinguish between integration tests, unit<br/>\n&gt; tests and database tests. Therefor I&#39;m using JUnitExt<br/>\n&gt; (<a rel=\"nofollow\" target=\"_blank\" href=\"http://junitext.sourceforge.net/)\">http://junitext.sourceforge.net/)</a> categories to annotate my tests.<br/>\n&gt;<br/>\n&gt; Now my question is, how I create suites where I can apply a certain<br/>\n&gt; filter. Looking for documentation I always ended up with the example<br/>\n&gt; with @RunWith(Suite.class).<br/>\n&gt;<br/>\n&gt; Thanks<br/>\n&gt; Matthias<br/>\n&gt; BTW: Since we are developing Eclipse-Plugins, we would like to stick<br/>\n&gt; to JUnit4 so we can use the standard run-configurations.<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; Yahoo! Groups Links<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n<br/>\n<br/>\n[Non-text portions of this message have been removed] </span></blockquote></div>", 
    "prevInTime": 19276, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1176388491", 
    "canDelete": false, 
    "nextInTopic": 19282, 
    "prevInTopic": 19276, 
    "headers": {
        "inReplyToHeader": "PGV2a3Y4NCs3ZDNzQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PDRmN2RhNmI5MDcwNDEyMDczNGg3NDVmYWI5ZHZkZjhkNWJkZjkwNzNkMGVhQG1haWwuZ21haWwuY29tPg==", 
        "referencesHeader": "PGV2a3Y4NCs3ZDNzQGVHcm91cHMuY29tPg=="
    }
}