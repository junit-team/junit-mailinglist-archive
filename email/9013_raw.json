{
    "numMessagesInTopic": 24, 
    "nextInTime": 9014, 
    "senderId": "95Bj3wEBriHntf-sSiESckxCqBtrJmKYoKAFzJHYerj8YvUDgF2IzO44xmTRJ76_gohqfbjVA1tqPNC8sMxy87BFEz0", 
    "systemMessage": false, 
    "subject": "RE: [junit] How to test a main(String[] args) method?", 
    "from": "&quot;David&quot; &lt;achepati67@...&gt;", 
    "authorName": "David", 
    "msgSnippet": "See below... ... De: bernd [mailto:berndq@gmx.net] Enviado el: viernes, 01 de agosto de 2003 10:42 Para: junit@yahoogroups.com Asunto: RE: [junit] How to test", 
    "msgId": 9013, 
    "rawEmail": "Return-Path: &lt;achepati67@...&gt;\r\nReceived: (qmail 98264 invoked from network); 4 Aug 2003 14:40:56 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m17.grp.scd.yahoo.com with QMQP; 4 Aug 2003 14:40:56 -0000\r\nReceived: from unknown (HELO n16.grp.scd.yahoo.com) (66.218.66.71)\n  by mta1.grp.scd.yahoo.com with SMTP; 4 Aug 2003 14:40:56 -0000\r\nX-eGroups-Return: achepati67@...\r\nReceived: from [66.218.67.177] by n16.grp.scd.yahoo.com with NNFMP; 04 Aug 2003 14:40:56 -0000\r\nX-Sender: achepati67@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 66854 invoked from network); 4 Aug 2003 07:23:04 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m2.grp.scd.yahoo.com with QMQP; 4 Aug 2003 07:23:04 -0000\r\nReceived: from unknown (HELO smtp018.mail.yahoo.com) (216.136.174.115)\n  by mta1.grp.scd.yahoo.com with SMTP; 4 Aug 2003 07:23:04 -0000\r\nReceived: from unknown (HELO sfpc1059) (achepati67@194.140.67.10 with login)\n  by smtp.mail.vip.sc5.yahoo.com with SMTP; 4 Aug 2003 07:23:03 -0000\r\nTo: &lt;junit@yahoogroups.com&gt;\r\nSubject: RE: [junit] How to test a main(String[] args) method?\r\nDate: Mon, 4 Aug 2003 09:23:12 +0200\r\nMessage-ID: &lt;NFBBLFDNMJLNLJAJJKNACENHFHAA.achepati67@...&gt;\r\nMIME-Version: 1.0\r\nX-Priority: 3 (Normal)\r\nX-MSMail-Priority: Normal\r\nX-Mailer: Microsoft Outlook IMO, Build 9.0.2416 (9.0.2911.0)\r\nX-MimeOLE: Produced By Microsoft MimeOLE V5.50.4522.1200\r\nImportance: Normal\r\nIn-Reply-To: &lt;000e01c35808$d755c150$1f03a8c0@dell&gt;\r\nFrom: &quot;David&quot; &lt;achepati67@...&gt;\r\nX-Yahoo-Group-Post: member; u=152694144\r\nX-Yahoo-Profile: achepati67\r\nContent-Type: text/plain; charset=US-ASCII\r\nContent-Transfer-Encoding: 7bit\r\nX-eGroups-Approved-By: vbossica &lt;vladimir@...&gt; via web; 04 Aug 2003 14:40:55 -0000\r\n\r\nSee below...\n  -----Mensaje original-----\n  De: bernd [mailto:berndq@...]\n  Enviado el: viernes, 01 de agosto de 2003 10:42\n  Para: junit@yahoogroups.com\n  Asunto: RE: [junit] How to test a main(String[] args) method?\n\n\n  Hi,\n\n\n  &gt; -----Original Message-----\n  &gt; From: David [mailto:achepati67@...]\n  &gt; Sent: Wednesday, July 30, 2003 10:57 AM\n  &gt; To: junit@yahoogroups.com\n  &gt; Cc: berndq@...; mike@...; jbrains@...\n  &gt; Subject: RE: [junit] How to test a main(String[] args) method?\n  &gt;\n  &gt;\n  &gt; &gt;Dear Members,\n  &gt; &gt;\n  &gt; &gt;I whould like to test a class with a main(String[] args)\n  &gt; method. Depending\n  &gt; &gt;on the input argument it executes one thing or the other.\n  &gt; The problem is\n  &gt; &gt;that on my main(String[] args) method at the end or when it founds an\n  &gt; error,\n  &gt; &gt;the method System.exit() is invoked. So when I define jUnit\n  &gt; test cases\n  &gt; &gt;(methods with prefix test), jUnits only runs the first test, because\n  &gt; some&gt;System.exit() was invoked.\n  &gt; &gt;Is there any way to test such kind of situations?\n  &gt; &gt;Thanks in advance,\n  &gt;\n  &gt; The solution propoused by Bern was:\n  &gt;\n  &gt; java.lang.System is final and does not implement\n  &gt; interfaces,so there is no\n  &gt; chance to replace ist behaviour.You may want to replace calls to\n  &gt; System.exit() with calls againstan interface you define.\n  &gt; Under test use an\n  &gt; implementation which allowsyourtest code to chech if the exit\n  &gt; method has\n  &gt; been called by main() but whichdoes not exit the VM. In\n  &gt; production use an\n  &gt; implememtation which delegatesto System.exit().\n  &gt;\n  &gt; As far as I know what you mean could be implemented like\n  &gt; this: (see comments\n  &gt; below)\n  &gt;\n  &gt; package com.my.example\n  &gt;\n  &gt; public class Example {\n  &gt;       static Finish _finish = new\n  &gt; Example.ProductionFinish();// private package\n  &gt; (static because it is\n  &gt;\n  &gt;             // going to be used on main.)\n  &gt;       static void setFinish(Finish value){_finish = value;}\n  &gt; // private package\n  &gt;\n  &gt;       static main (String[] args)\n  &gt;\n  &gt;             boolean goOn = true;       // because we don&#39;t\n  &gt; exit on testing mode,\n  &gt;                                     // we need a\n  &gt; way for controling the execution flow.\n  &gt;             if (someCondition) {// first checking (exceptional flow)\n  &gt;                   goOn = finish.do(-1);\n  &gt;             }\n  &gt;             // ... put other checking here\n  &gt;             if (goOn && otherCondition) {// main flow\n  &gt;                   finish.do(0);\n  &gt;             }\n  &gt;       }\n  &gt;\n  &gt;       /* Now we define the interface Finish and its default\n  &gt; implementation (as\n  &gt; inner classes\n  &gt;       with private-package visibility, because we have to\n  &gt; define ONLY for testing\n  &gt; purpose this\n  &gt;       interface!)*/\n  &gt;\n  &gt;       interface Finish {\n  &gt;             boolean do(int i);\n  &gt;       }\n  &gt;\n  &gt;       class ProductionFinish {// its default implementation\n  &gt; (used on production\n  &gt; mode)\n  &gt;             ProductionFinish(){} // default constructor\n  &gt; with private-package\n  &gt; visibility\n  &gt;             boolean do(int i) {\n  &gt;                   System.exit(i);\n  &gt;             }\n  &gt;       }\n  &gt; }\n  &gt;\n  &gt; Now on the testing class defined on the same package:\n  &gt;\n  &gt; package com.my.example\n  &gt;\n  &gt; public class ExampleTest extends TestCase{\n  &gt;       // ...\n  &gt;           protected void setUp (){Example.setFinish(new\n  &gt; ExampleTest.TestingFinish());}\n  &gt;       }\n  &gt;       class TestingFinish implements Example.Finish{\n  &gt;             TestingFinish (){} // default constructor with\n  &gt; private-package visibility\n  &gt;             boolean do(int i) { // We have to stop on every case!\n  &gt;                   return false;\n  &gt;             }\n  &gt;       }\n  &gt; }\n\n  sorry for not reading you code in detail,\n  I was thinking of something like\n\n        interface Finish {\n              void do(int i);\n        }\n\n  we need it for production:\n\n  class ProductionFinish implements Finish{\n      public void do(int exitCode){\n          System.exit(exitCode);\n      }\n  }\n\n\n  and a Mock for tests:\n\n  class MockFinish implements Finish{\n      public void do(int exitCode){\n          mLastExitCode=exitCode;\n          mNumberOfDoCalled++;\n      }\n\n      public int getLastExitCode(){return mLastExitCode;}\n      public int getNumberOfDoCalled(){return mDoWasCalled;}\n\n      private int mLastExitCode;\n      private int mNumberOfDoCalled=0;\n  }\n\n  inside of main, just use the interface.\n  At the very beginnig of main you may use a factory\n  to get an implmentation:\n\n  public static void main(String[] atgs){\n     Finish finish=FinishFactory.getInstance();\n\n     ...\n     finish.do(22);\n     ...\n  }\n\n  depending on production/test the factory will\n  hand out the corresponding implementation.\n\n  a test may look like this:\n\n  public MyTestCase extends TestCase{\n  ...\n  public test_xx(){\n      com.xxx.package.main(argsToBeTested)\n      MockFinish mockFinish=howToGetInstance??\n\n      // make sure exit was called only once\n      assertEquals(1, mockFinish.getNumberOfDoCalled());\n      assertEquals(expectedExitCode, mockFinish.getLastExitCode());\n  }\n\n  But how to get the instance of MockFinsih?\n  Maybe something like\n\n  ...\n  public static MockFinish getInstance(){\n     return mInstance;\n  }\n\n  private static mInstance;\n  ...\n\n\n  hmm, yes really lots of code...\n\n  &gt; COMMENTS:\n  &gt;\n  &gt; - About this suggestion and the corresponding implementation,\n  &gt; because we\n  &gt; need a default implementation ALWAYS (for production), then\n  &gt; instead of using\n  &gt; an INTERFACE, it is BETTER to just define the class Finish as\n  &gt; ABSTRACT (the\n  &gt; do(int i) method should be abstract)\n  &gt;\n  &gt; - You have to write A LOT for makeing a very simple task. I\n  &gt; have implemented\n  &gt; a simpler solution, just do the following steps:\n  &gt;\n  &gt; a) Define on the class to test (Example), the static boolean\n  &gt; field _TEST as\n  &gt; private-package. This field is initialized with default value: false\n  &gt; (production)\n  &gt;\n  &gt; b) Define a STATIC PRIVATE method finish, like this:\n  &gt;             private static boolean finish(int i) {\n  &gt;                   if(!_TEST) {\n  &gt;                         System.exit(i);\n  &gt;                   }\n  &gt;                   return false;\n  &gt;             }\n  &gt; c) On the testing class (ExampleTest), set on the setup()\n  &gt; method, the field\n  &gt; _TEST to true.\n  &gt;\n  &gt;\n  &gt; Now we have:\n  &gt;\n  &gt; package com.my.example\n  &gt;\n  &gt; public class Example {\n  &gt;       static boolean _TEST = false;\n  &gt;\n  &gt;       static main (String[] args)\n  &gt;\n  &gt;             boolean goOn = true;\n  &gt;             if (someCondition) {// fist checking\n  &gt;                   goOn = finish(-1);\n  &gt;             }\n  &gt;             // ... put other checking here\n  &gt;             if (goOn && otherCondition) {// the last\n  &gt; condition (end of the program)\n  &gt;                   finish(-1);\n  &gt;             }\n  &gt;       }\n  &gt;\n  &gt;       private static boolean finish (int i) {\n  &gt;             if (!_TEST) {\n  &gt;                   System.exit(i);\n  &gt;             }\n  &gt;             return false;\n  &gt;       }\n  &gt; }\n  &gt;\n  &gt; package com.my.example\n  &gt;\n  &gt; public class ExampleTest extends TestCase{\n  &gt;       // ...\n  &gt;           protected void setUp (){Example._TEST = true;}\n  &gt;       }\n  &gt; }\n  &gt;\n  &gt; I think this solution is enough. Any suggestion?\n\n  How do you test that finish() really was called?\n  [David Leal] No, I don&#39;t test it.\n  IIRC that was your question in your initial posting?[David Leal]  No my\nquestion was how to avoid System.exit() stop the execution on for testing. I\nwant to test more than one invokation to the main(String[] args) method, but\nbecause my invokation to the method System.exit(), ony one situation was\ntested. Now I have an idea about how to handle this situation.\n\n  Maybe to much modification of the original code: goOn && ... ?\n  Did you try J.B.&#39;s suggestion?\n  [David Leal] It doesn&#39;t work for me, because I have to modify the\nequivalent method to test. My main method has an execution by steps, if the\nprevios step fails, it should stop, that is way I need to control variable\ngoOn, in order to control if I have to stop the program without using\nSystem.exit(), that is way I use such control variable. My suggestion is a\nlittle modification to the J.B.&#39;s suggestion.\n\n  Thanks in advance,\n\n  David\n\n\n[Non-text portions of this message have been removed]\n\n\n\n", 
    "profile": "achepati67", 
    "topicId": 8737, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 152694144, 
    "prevInTime": 9012, 
    "contentTrasformed": false, 
    "postDate": "1059981792", 
    "canDelete": false, 
    "nextInTopic": 9016, 
    "prevInTopic": 8919, 
    "headers": {
        "inReplyToHeader": "PDAwMGUwMWMzNTgwOCRkNzU1YzE1MCQxZjAzYThjMEBkZWxsPg==", 
        "messageIdInHeader": "PE5GQkJMRkROTUpMTkxKQUpKS05BQ0VOSEZIQUEuYWNoZXBhdGk2N0B5YWhvby5lcz4="
    }
}