{
    "numMessagesInTopic": 9, 
    "nextInTime": 16038, 
    "senderId": "E8oy1n0cv8FthwV9dZKM8JCZLAwL83ce6gsnSaGieldbGrVz5MDmKJ39WInLYPpRZtiiSeXI4FNQgu-xStI2G8sYSQqdG80wJw", 
    "systemMessage": true, 
    "subject": "Re: testing private methods in Struts Actions ?", 
    "from": "&quot;frank zou&quot; &lt;frankz1998@...&gt;", 
    "authorName": "frank zou", 
    "msgSnippet": "Rainsberger, thanks for you input here. Please check my comments and further questions inline. ... [Frank] I am not sure what a testing guru would test for", 
    "msgId": 16037, 
    "profile": "frankz1998", 
    "topicId": 16019, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 193176558, 
    "messageBody": "<div id=\"ygrps-yiv-1660972238\">Rainsberger, thanks for you input here. Please check my comments and<br/>\nfurther questions inline. <br/>\n<br/>\n<blockquote><span title=\"qreply\"> --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>, &quot;J. B. Rainsberger&quot; &lt;jbrains@...&gt; wrote:<br/>\n&gt; <br/>\n&gt; What do you want to test here?<br/>\n&gt; <br/>\n&gt; 1. How well your business logic integrates with Struts (reading form <br/>\n&gt; beans, populating error messages, that kind of thing..)<br/>\n&gt; <br/>\n&gt; or<br/>\n&gt; <br/>\n&gt; 2. Your business logic itself<br/>\n<br/>\n<br/>\n[Frank] I am not sure what a testing guru would test for this case.<br/>\nWhat I want to test here include: <br/>\n* the Action code is correct.<br/>\n* the action configration is correct. <br/>\n<br/>\nWhat I do not want to test: <br/>\n* the biz layer code does its work correctly.<br/>\n<br/>\n&gt; Either way, putting the business logic directly into the Struts Action <br/>\n&gt; creates a problem; therefore, create a separate class for your business <br/>\n&gt; logic and have the Struts Action invoke it. It looks somethign like<br/>\nthis:<br/>\n<br/>\n&gt; public ActionForward execute(ActionMapping mapping, ActionForm form,<br/>\n&gt;                    HttpServletRequest request,<br/>\n&gt;                    HttpServletResponse response)<br/>\n&gt;        {<br/>\n&gt; <br/>\n&gt;              createEventLog(request);<br/>\n&gt; <br/>\n&gt;              handleSessionAndToken(request);<br/>\n&gt; <br/>\n&gt;              doBusinessLogic(new BusinessLogicImpl(...));<br/>\n&gt;              ...<br/>\n&gt;              clearUserRelatedCookies(siteId, response);<br/>\n&gt; <br/>\n&gt;              String returnUrl = createReturnUrl(mapping, request);<br/>\n&gt;              request.setAttribute(LOGIN_RETURN_URL, returnUrl);<br/>\n&gt;              return mapping.findForward(PAGE_SUCCESS);<br/>\n&gt;        }<br/>\n&gt; <br/>\n&gt; public void doBusinessLogic(BusinessLogic logic) {<br/>\n&gt;      logic.execute();<br/>\n&gt; }<br/>\n&gt;<br/>\n<br/>\n <br/>\n&gt; Now the interface BusinessLogic represents your transaction script. The <br/>\n&gt; implementation BusinessLogicImpl does the production work. You can test <br/>\n&gt; the business logic on its own by instantiating whatever you need:<br/>\naction <br/>\n&gt; form objects, request objects, whatever. <br/>\n<br/>\n<br/>\n<br/>\n[Frank]<br/>\nI agree with you in that we should extract biz logic from struts<br/>\nactions. However, for this specific case, I am not sure what would be<br/>\nthe approparite way to do it. <br/>\n<br/>\nHere are the brief description of what the 4 private methods do: <br/>\n* createEventLog(...):  insert some logging information to DB. <br/>\n* createReturnUrl(...): create the &quot;return url&quot; based on complex biz<br/>\nlogic. Actually, several biz layer objects support this method. <br/>\n* clearUserRelatedCookies(...): clear user related cookies <br/>\n* handleSessionAndToken(...): take care of something in HttpSession. <br/>\n<br/>\nI guess I can create a separate biz interface and implementation for<br/>\ncreateEventLog(...) and createReturnUrl(...), like you did.<br/>\nHowever,this implies a dedicated biz class is needed to create for<br/>\nthis specific action meanwhile some other biz layer classes are<br/>\nalready involved. Considering we may have hundereds of Action classes,<br/>\nwe will end up with hundereds of dedicated biz classes for every and<br/>\neach Action class. <br/>\n<br/>\nThis way, it seems for every action we have a biz delegate class. Is<br/>\nthat you intend to do ?<br/>\n<br/>\n<br/>\n[Frank] Another concern is about clearUserRelatedCookies(...) and<br/>\nhandleSessionAndToken(...). These 2 private methods do their work on<br/>\nWeb layer and it seems difficult to take them as any biz logic. so it<br/>\nseems not appropriate to put them into any separate biz class. If so,<br/>\nhow should I test them ? Or should I make them protected / public,<br/>\njust in order to make the testing easier ? <br/>\n<br/>\n<br/>\n<br/>\n&gt; You can test the integration <br/>\n&gt; with Struts by faking/mocking the business logic (Google &quot;jmock&quot;).<br/>\n&gt; <br/>\n<br/>\n[Frank] I am not sure how you would do it here. What I was trying to<br/>\ndo is to use StrutsTestCase to test the execute(...) method as a<br/>\nwhole, meanwhile mocking out the biz logic using JMock. Since java<br/>\ndoes not allowed us to inherit 2 parent classes, I wrote a wrapper for<br/>\nStrusTestCase and merge JMock function into it. This way, I can run my<br/>\nStrutsTestCase in isolation of biz / DAO code. <br/>\n<br/>\nHow do you like this apporach ? Or do you think when using<br/>\nStrutsTestCase, there is no need to mock out biz code ? Or do you<br/>\nthink  StrusTestCase does not even do a Unit Testing and is not worth<br/>\ndoing. <br/>\n<br/>\n&gt; The entire technique probably requires 10 pages to describe with <br/>\n&gt; examples, so I won&#39;t be doing that here. :)<br/>\n&gt; <br/>\n<br/>\n[Frank] Maybe the issue is that sometimes I feel it is not so clear<br/>\nwhat is real biz logic code and what is not. If I do not get you<br/>\nwrong, you may extract everything possible to other separate classes,<br/>\nso that there seem nothing interesting left for Action classes<br/>\nthemselves. Is that right ?<br/>\n<br/>\nEnglish is just my second language. I am not sure whether I express<br/>\nmyself clear enough. :(<br/>\n<br/>\n<br/>\n&gt; Good luck.<br/>\n&gt; -- <br/>\n&gt; J. B. (Joe) Rainsberger :: <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.jbrains.info\">http://www.jbrains.info</a><br/>\n&gt; Your guide to software craftsmanship<br/>\n&gt; JUnit Recipes: Practical Methods for Programmer Testing<br/>\n&gt; 2005 Gordon Pask Award for contribution Agile Software Practice<br/>\n&gt; </span></blockquote></div>", 
    "prevInTime": 16036, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1139490900", 
    "canDelete": false, 
    "nextInTopic": 16049, 
    "prevInTopic": 16031, 
    "headers": {
        "inReplyToHeader": "PDQzRUFCOTI5LjIwNjA5MDBAcm9nZXJzLmNvbT4=", 
        "messageIdInHeader": "PGRzZmY4ayt0N3FqQGVHcm91cHMuY29tPg=="
    }
}