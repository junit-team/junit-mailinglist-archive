{
    "numMessagesInTopic": 12, 
    "nextInTime": 18568, 
    "senderId": "50ltaUnfd6JFOkQ6_-A67t4rEf4aGrTUof-xIlcfSlkNFPTr4kZJiC0bqPuK8veWdDaK0Y_qukUvoOvkGvztJAZRWM_E5sp5ODIHargDsnQqcCo", 
    "systemMessage": false, 
    "subject": "Re: Test a remote server", 
    "from": "&quot;Andrew McDonagh&quot; &lt;andrewmcdonagh@...&gt;", 
    "authorName": "Andrew McDonagh", 
    "msgSnippet": "... I am writting  a sample java file which will be doing the same (You can say its a prototype of it.) ... ().toString()); ... sInetAddress); ... JAVA files", 
    "msgId": 18567, 
    "profile": "andy_ipaccess", 
    "topicId": 18546, 
    "spamInfo": {
        "reason": "6", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 283773244, 
    "messageBody": "<div id=\"ygrps-yiv-1883792440\">--- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>, avinash anand &lt;avinash_anand@...&gt; <br/>\nwrote:<br/>\n<blockquote><span title=\"ireply\"> &gt;<br/>\n&gt; Hi <br/>\n&gt;      Posting the real .java file would not  be possible for me but <br/>\n </span></blockquote>I am writting  a sample java file which will be doing the same (You <br/>\ncan say its a prototype of it.)<br/>\n<blockquote><span title=\"ireply\"> &gt; <br/>\n&gt; class server{<br/>\n&gt; private DBConnection _dbconnectoin;<br/>\n&gt; private server _serverinstance = null;<br/>\n&gt; private static VespAlarmService _alarmService;<br/>\n&gt; private static VespUuid _serverUUID;<br/>\n&gt; private server(){<br/>\n&gt; _alarmService = VespAlarmServiceImpl.getInstance();<br/>\n&gt; }<br/>\n&gt; public static server getInstance(){<br/>\n&gt; if (null == _servernstance){<br/>\n&gt; _serverinstance = new server(); <br/>\n&gt; }<br/>\n&gt; return _serverinstance;<br/>\n&gt; }<br/>\n&gt; public static void main(String[] args){ <br/>\n&gt; if (args.length &gt;= 1){<br/>\n&gt; try {<br/>\n&gt; //set the initial environment<br/>\n&gt; AnotherServer.getInstance().setEnvironment();<br/>\n&gt; server obj = server.getInstance();<br/>\n&gt; _serverUUID = new VespUuid(args[0]);<br/>\n&gt; StringBuffer sb = new StringBuffer(_serverUUID.getInetAddress<br/>\n </span></blockquote>().toString());<br/>\n<blockquote><span title=\"ireply\"> &gt; sb.delete(0, 1);<br/>\n&gt; sb.append(&quot;:&quot;);<br/>\n&gt; sb.append(_serverUUID.getPort());<br/>\n&gt; String sInetAddress = sb.toString();<br/>\n&gt; System.setProperty(VespConfigParams.MTT_INSTANCE_HOST_PROPERTY, <br/>\n </span></blockquote>sInetAddress);<br/>\n<blockquote><span title=\"ireply\"> &gt; if(args.length &gt;= 2) { <br/>\n&gt; System.setProperty(VespConfigParams.ORB_UUID_PROPERTY, args[1]);<br/>\n&gt; }<br/>\n&gt; void startserver ()<br/>\n&gt; {<br/>\n&gt; }<br/>\n&gt; void stopserver()<br/>\n&gt; {<br/>\n&gt; }<br/>\n&gt; void isserverready()<br/>\n&gt; {<br/>\n&gt; }<br/>\n&gt; void generatevespAlarm()<br/>\n&gt; {<br/>\n&gt; } <br/>\n&gt; }<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; This is how the main class looks. There are many other supporting <br/>\n </span></blockquote>JAVA files for this main server. It uses a JNI layer to talk to the <br/>\nnative code. Which is implemented elesewhere.<br/>\n<blockquote><span title=\"ireply\"> &gt; <br/>\n&gt; <br/>\n&gt; <br/>\n&gt; For it to run in the actul enviroment, it uses a wrapper .exe <br/>\n </span></blockquote>which calls an xml file where all the server properties are listed <br/>\nin the main method the location of .class files are specified which <br/>\nare already compiled and put in the java&#92;lib folder in the form <br/>\nof .jar. Here is the snippet of xml file where the exe tries to read <br/>\nit.<br/>\n<blockquote><span title=\"ireply\"> &gt; <br/>\n&gt; &lt;stringProperty property=&quot;jloader.server.main.class&quot; <br/>\n </span></blockquote>displayName=&quot;Main class&quot; default=&quot;com/xyz/server/testing&quot; <br/>\nenabled=&quot;false&quot; advanced=&quot;true&quot; /&gt;<br/>\n<blockquote><span title=\"ireply\"> &gt; <br/>\n&gt; <br/>\n&gt; What I am trying is to write a JUnit test suite for this Java <br/>\n </span></blockquote>based server, which will be running in the form of an .exe. And my <br/>\ntest cases will be running in eclipse.<br/>\n<blockquote><span title=\"ireply\"> &gt; <br/>\n&gt; <br/>\n&gt; Hope the entire thing might make the picture a bit clear. <br/>\n&gt; <br/>\n&gt; Thanks<br/>\n&gt; Avinash<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; ----- Original Message ----<br/>\n&gt; From: &quot;andrew.p.mcdonagh@...&quot; &lt;andrew.p.mcdonagh@...&gt;<br/>\n&gt; To: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\n&gt; Sent: Friday, 15 December, 2006 7:25:14 PM<br/>\n&gt; Subject: Re: [junit] Test a remote server<br/>\n&gt; <br/>\n&gt; Hi,<br/>\n&gt; <br/>\n&gt; Not sure why your Java app does not use Java&#39;s corba ability (a <br/>\n </span></blockquote>good Java <br/>\n<blockquote><span title=\"ireply\"> &gt; ORB being <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.jacorb\">http://www.jacorb</a> org/ ), instead of JNI...<br/>\n&gt; <br/>\n&gt; Anyway, onto your real question, how do I test the code that is <br/>\n </span></blockquote>dependant <br/>\n<blockquote><span title=\"ireply\"> &gt; upon the other servers?<br/>\n&gt; <br/>\n&gt; As you are asking on the JUnit list I take it you mean Unit test?<br/>\n&gt; Not System or Integration testing?<br/>\n&gt; <br/>\n&gt; If so, then you will find unit testing much simpler and (imo) <br/>\n </span></blockquote>better, if <br/>\n<blockquote><span title=\"ireply\"> &gt; none of your unit tests need to access any file, network, database <br/>\n </span></blockquote>or UI. <br/>\n<blockquote><span title=\"ireply\"> &gt; This means they run very fast. Once you figure out how to do them, <br/>\n </span></blockquote>you <br/>\n<blockquote><span title=\"ireply\"> &gt; should be able to write lots of them , quickly too.<br/>\n&gt; <br/>\n&gt; We could just give you some simple examples, but I tend to find it <br/>\n </span></blockquote>better <br/>\n<blockquote><span title=\"ireply\"> &gt; to show you how to unit test one of your classes that depend on <br/>\n </span></blockquote>corba or <br/>\n<blockquote><span title=\"ireply\"> &gt; some other system, by using one of your real classes. So, please <br/>\n </span></blockquote>post <br/>\n<blockquote><span title=\"ireply\"> &gt; (just one) class and we&#39;ll knock up a unit test for it.<br/>\n&gt; <br/>\n&gt; Regards<br/>\n&gt; <br/>\n&gt; Andrew<br/>\n&gt; <br/>\n&gt; &quot;avinash anand&quot; &lt;avinash_anand@ yahoo.co. uk&gt; <br/>\n&gt; Sent by: junit@yahoogroups. com<br/>\n&gt; 15-Dec-2006 09:04<br/>\n&gt; Please respond to junit@yahoogroups. com<br/>\n&gt; <br/>\n&gt; To<br/>\n&gt; junit@yahoogroups. com<br/>\n&gt; cc<br/>\n&gt; <br/>\n&gt; Subject<br/>\n&gt; [junit] Test a remote server<br/>\n&gt; <br/>\n&gt; Hi Group<br/>\n&gt; Greetings to all. These days I am writting test suit for a CORBA <br/>\n </span></blockquote>CRM. Let <br/>\n<blockquote><span title=\"ireply\"> &gt; me first introduce the system.<br/>\n&gt; <br/>\n&gt; There is a central ORB server and many other servers which talk to <br/>\n </span></blockquote>each <br/>\n<blockquote><span title=\"ireply\"> &gt; other through vesp. ORB being the central one. Entire code base is <br/>\n </span></blockquote>in C++. <br/>\n<blockquote><span title=\"ireply\"> &gt; I have to test a new server introduced in the system which is <br/>\n </span></blockquote>written in <br/>\n<blockquote><span title=\"ireply\"> &gt; Java. This new server talks to the rest through JNI. As a matter <br/>\n </span></blockquote>of Fact <br/>\n<blockquote><span title=\"ireply\"> &gt; none of the servers can run independently, they neccesirily have <br/>\n </span></blockquote>to log <br/>\n<blockquote><span title=\"ireply\"> &gt; into the central kit and report to the the central ORB server. <br/>\n </span></blockquote>After <br/>\n<blockquote><span title=\"ireply\"> &gt; validation stuff the server starts working.<br/>\n&gt; <br/>\n&gt; Even this new Java based server uses an executable file to work <br/>\n&gt; (Jloader.exe written in c++)<br/>\n&gt; <br/>\n&gt; This .exe loads various .dll files in the system and in its main <br/>\n </span></blockquote>method <br/>\n<blockquote><span title=\"ireply\"> &gt; calls the compiled .class files. This is the way how system <br/>\n </span></blockquote>functions.<br/>\n<blockquote><span title=\"ireply\"> &gt; <br/>\n&gt; My problem is that when I will write a JUnit test case in IDE <br/>\n </span></blockquote>(eclipse) <br/>\n<blockquote><span title=\"ireply\"> &gt; which would operate on the actual code which has 99% dependency <br/>\n </span></blockquote>and cannot <br/>\n<blockquote><span title=\"ireply\"> &gt; be tested isolated. Is there any way to test this server code <br/>\n </span></blockquote>while it is <br/>\n<blockquote><span title=\"ireply\"> &gt; working under the live system and the test suite running in the <br/>\n </span></blockquote>eclipse <br/>\n<blockquote><span title=\"ireply\"> &gt; IDE.<br/>\n&gt; <br/>\n&gt; HELP !!!<br/>\n&gt; <br/>\n&gt; Thanks<br/>\n&gt; Avinash<br/>\n<br/>\n<br/>\n </span></blockquote>Sorry for the delay - Yahoo doesn&#39;t seem to be accepting my emails <br/>\nat the moment!<br/>\n<br/>\nHere&#39;s what I&#39;ve tried to post a few times.....<br/>\n<br/>\n<br/>\n<br/>\n<br/>\n<br/>\nHi, <br/>\n<br/>\nSo I&#39;m still not sure if you mean you want to Unit test or System <br/>\ntest, using the JUnit framework. <br/>\n<br/>\nI&#39;m going to show how I would   Unit Test    the code, using <br/>\nJUnit..... <br/>\n<br/>\n<br/>\nThe code as it stands, makes unit testing difficult because of the <br/>\nuse of Singletons, static methods and raw Corba or RMi objects.  So <br/>\nI&#39;m going to refactor it somewhat to make it testable.  Making it <br/>\ntestable usually makes the design more flexible, finer grained and <br/>\nloosely coupled - all good things. <br/>\n<br/>\nFirst step - move the property setting code into its own class - <br/>\nthen test it there instead of inside the main() method.  This is <br/>\nbecause the main() method has calls to a singleton and creates CORBA <br/>\nobjects, which I can&#39;t easily get around, as this code is inside the <br/>\nstatic &#39;main()&#39; method.  If this code lived inside an instance <br/>\nmethod of Server, then I could inject a mock object for these. <br/>\n<br/>\nSo, here&#39;s the main method, with the MTT Host and UUID property <br/>\nsetting code moved into a new class. The new class&#39;s method also <br/>\nonly knows about normal Java classes (InetAddress) instead of being <br/>\ncoupled to the VestUUID class - this makes unit testing really <br/>\neasy!!!! <br/>\n<br/>\n<br/>\n public static void main(String[] args) { <br/>\n    if (args.length &gt;= 1) { <br/>\n      try { <br/>\n        // set the initial environment <br/>\n        AnotherServer.getInstance().setEnvironment(); <br/>\n<br/>\n        Server obj = Server.getInstance(); <br/>\n<br/>\n        _serverUUID = new VespUuid(args[0]); <br/>\n<br/>\n        InetAddress inetAddress = _serverUUID.getInetAddress(); <br/>\n        SystemPropertyConfigurator.setMttHostProperty(inetAddress, <br/>\nServer._serverUUID.getPort()); <br/>\n<br/>\n        if (args.length &gt;= 2) { <br/>\n          SystemPropertyConfigurator.setOrbUuidProperty(args[1]); <br/>\n        } <br/>\n      } catch (Exception e) { <br/>\n        // todo... <br/>\n        throw new RuntimeException(e); <br/>\n      } <br/>\n    } <br/>\n  } <br/>\n<br/>\n<br/>\nHere&#39;s the new class......(as it currently stands) <br/>\n<br/>\n<br/>\nimport java.net.InetAddress; <br/>\n<br/>\npublic class SystemPropertyConfigurator { <br/>\n<br/>\n  static void setMttHostProperty(InetAddress inetAddress, String <br/>\nport) { <br/>\n    StringBuffer sb = new StringBuffer(inetAddress.toString()); <br/>\n    sb.delete(0, 1); <br/>\n    sb.append(&quot;:&quot;); <br/>\n    sb.append(port); <br/>\n  <br/>\n    String sInetAddress = sb.toString(); <br/>\n    System.setProperty(VespConfigParams.MTT_INSTANCE_HOST_PROPERTY, <br/>\nsInetAddress); <br/>\n  } <br/>\n<br/>\n<br/>\n<br/>\n  static void setOrbUuidProperty(String uuid) { <br/>\n    System.setProperty(VespConfigParams.ORB_UUID_PROPERTY, uuid); <br/>\n  } <br/>\n  <br/>\n} <br/>\n<br/>\n<br/>\n<br/>\n<br/>\nAnd now here&#39;s its unit test!!!!!!!!!!! (these run and pass in my <br/>\neclipse) <br/>\n<br/>\n<br/>\nimport java.net.InetAddress; <br/>\nimport java.net.UnknownHostException; <br/>\n<br/>\nimport junit.framework.TestCase; <br/>\n<br/>\npublic class SystemPropertyConfiguratorTest extends TestCase { <br/>\n<br/>\n  public void testMttHostPropertySetWithoutFirstLetter() throws <br/>\nUnknownHostException { <br/>\n    InetAddress address = InetAddress.getByName(&quot;localhost&quot;); <br/>\n<br/>\n    SystemPropertyConfigurator.setMttHostProperty(address, &quot;8080&quot;); <br/>\n<br/>\n    String actualProperty = System.getProperty<br/>\n(VespConfigParams.MTT_INSTANCE_HOST_PROPERTY); <br/>\n    <br/>\n    String expectedProperty = &quot;ocalhost/127.0.0.1:8080&quot;; <br/>\n    <br/>\n    assertNotNull(&quot;Property not found!&quot;, actualProperty); <br/>\n    assertEquals(&quot;Wrong property value!&quot;, expectedProperty, <br/>\nactualProperty); <br/>\n  } <br/>\n  <br/>\n  <br/>\n public void testOrbUuidPropertySet() { <br/>\n   SystemPropertyConfigurator.setOrbUuidProperty(&quot;a UUID!&quot;); <br/>\n    <br/>\n   String actualProperty = System.getProperty<br/>\n(VespConfigParams.ORB_UUID_PROPERTY); <br/>\n      <br/>\n   assertNotNull(&quot;Property not found!&quot;, actualProperty); <br/>\n   assertEquals(&quot;Wrong property value!&quot;, &quot;a UUID!&quot;, actualProperty); <br/>\n } <br/>\n  <br/>\n} <br/>\n<br/>\n<br/>\n<br/>\n<br/>\nNow, as things stand, I may decide to not unit test the &#39;main()&#39; <br/>\nmethod in Server class at all, as all its doing is calling others to <br/>\ndo things, I might rely upon the normal System and integeration <br/>\ntests to test it.  Or I may decide to refactor the Server class as <br/>\nwell, to allow me to make the main() method more testable (which <br/>\nwill involve similar techniques as I&#39;ve shown here).  The choice <br/>\ncomes down as always to one of time vs payback.   <br/>\n<br/>\nHopefully this is enough to get you started in thinking baout how to <br/>\nchange your design slightly, to enable unit testing of the code, <br/>\nwithout having to have real corba, networks, files, dbs, etc around. <br/>\n<br/>\nFeel free to ask for more help... <br/>\n<br/>\nAndrew</div>", 
    "prevInTime": 18566, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1166728117", 
    "canDelete": false, 
    "nextInTopic": 18571, 
    "prevInTopic": 18560, 
    "headers": {
        "inReplyToHeader": "PDIwMDYxMjE1MTQyMzI4LjgwMDkwLnFtYWlsQHdlYjI2NzEyLm1haWwudWtsLnlhaG9vLmNvbT4=", 
        "messageIdInHeader": "PGVtZW0zbCs5ajlsQGVHcm91cHMuY29tPg=="
    }
}