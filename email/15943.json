{
    "numMessagesInTopic": 74, 
    "nextInTime": 15944, 
    "senderId": "83BfOrzdRktvr9sJEtZws3Q5qCcPoUDwmQwY6gQ4fsJP39SJTjoFEybBfW1WA10CMV-5IQIec9NarDS165L2TJcYBVhixQIO", 
    "systemMessage": false, 
    "subject": "RE: [junit] Re: Observations from a production use of JUnit4", 
    "from": "&quot;Kent Beck&quot; &lt;kentb@...&gt;", 
    "authorName": "Kent Beck", 
    "msgSnippet": "Ben, Once again, thanks for the comments. Responses below. Kent Beck Three Rivers Institute ... The tip-off that you are dealing with a JUnit 4 test is a class", 
    "msgId": 15943, 
    "profile": "kentlbeck", 
    "topicId": 15891, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 173198504, 
    "messageBody": "<div id=\"ygrps-yiv-679395297\">Ben,<br/>\n<br/>\nOnce again, thanks for the comments. Responses below.<br/>\n<br/>\nKent Beck<br/>\nThree Rivers Institute <br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; -----Original Message-----<br/>\n&gt; From: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a> [mailto:<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>] On <br/>\n&gt; Behalf Of Ben Maurer<br/>\n&gt; Sent: Monday, January 30, 2006 1:23 PM<br/>\n&gt; To: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\n&gt; Subject: [junit] Re: Observations from a production use of JUnit4<br/>\n&gt; <br/>\n&gt; Hey,<br/>\n&gt; <br/>\n&gt; --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>, David Saff &lt;saff@m...&gt; wrote:<br/>\n&gt; &gt; Ben Maurer wrote:<br/>\n&gt; &gt; &gt; Ant XML output<br/>\n&gt; &gt; &gt; --------------<br/>\n&gt; &gt; &gt; [...]<br/>\n&gt; &gt; &gt; However, in rc2, it looks like:<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &lt;testcase classname=&quot;junit.framework.JUnit4TestAdapterCache$2$1&quot; <br/>\n&gt; &gt; &gt; name=&quot;unknown&quot; time=&quot;0.018&quot;&gt;&lt;/testcase&gt;<br/>\n&gt; &gt; That doesn&#39;t look good, does it?  If my initial guess as to <br/>\n&gt; this bug&#39;s <br/>\n&gt; &gt; source is correct, this will be easily fixed (back to rc1&#39;s<br/>\n&gt; behavior, at <br/>\n&gt; &gt; least) soon.<br/>\n&gt; <br/>\n&gt; Ok, that&#39;s good. That will at least allow me to upgrade ;-). It&#39;d be<br/>\n&gt; ideal if we could set the classname to the &quot;real&quot; class name.<br/>\n&gt; <br/>\n&gt; Btw, on the topic of JUnit3 tool compat: is it possible to make is so<br/>\n&gt; we don&#39;t have to write:<br/>\n&gt; <br/>\n&gt;         public static junit.framework.Test suite()<br/>\n&gt;         {<br/>\n&gt;                 return new<br/>\n&gt; junit.framework.JUnit4TestAdapter(HashtableTest.class);<br/>\n&gt;         }<br/>\n&gt; <br/>\n&gt; *if* we are using the JUnit4 version of the tools. The logic could be<br/>\n&gt; something like:<br/>\n&gt; <br/>\n&gt; if (I am asked to run a junit3 test on something) {<br/>\n&gt;    if (any methods have the @Test annotation) {<br/>\n&gt;       use junit4 behavior<br/>\n&gt;    }<br/>\n&gt; <br/>\n&gt;    fallback<br/>\n&gt; }<br/>\n&gt; <br/>\n&gt; If this was done and the classname was set correctly, I think we could<br/>\n&gt; simulate almost full compat (for simple cases) with junit3 <br/>\n&gt; based tools.<br/>\n&gt; <br/>\n&gt; If you get both/either of these in cvs, I&#39;d be happy to test them out.<br/>\n<br/>\n </span></blockquote>The tip-off that you are dealing with a JUnit 4 test is a class with<br/>\n@RunWith. A class containing a method with @Test has a @RunWith by<br/>\nimplication.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; <br/>\n&gt; &gt; &gt; Stack Trace Filtering<br/>\n&gt; &gt; &gt; ---------------------<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt; The stack trace from junit messages have always been filed with<br/>\n&gt; junit.*<br/>\n&gt; &gt; &gt; traces. Ant filters these out. However, now there are <br/>\n&gt; org.junit things<br/>\n&gt; &gt; &gt; slipping through. Also, tests with a timeout, have many<br/>\n&gt; &gt; &gt; java.util.concurrent frames in them. Why leave this kind of<br/>\n&gt; filtering up<br/>\n&gt; &gt; &gt; to each tool? JUnit should filter out the frames it knows <br/>\n&gt; are from it.<br/>\n&gt; &gt; &gt; This would make command line output look nicer. I think NUnit does<br/>\n&gt; this.<br/>\n&gt; &gt; This is tricky.  The JUnit API actually reports the Exception<br/>\n&gt; objects to <br/>\n&gt; &gt; the tools, which are then responsible for displaying / <br/>\n&gt; parsing stack <br/>\n&gt; &gt; traces.  I don&#39;t know that there&#39;s anything we could do to make <br/>\n&gt; &gt; pre-JUnit 4 tools automatically filter the org.junit lines, but we<br/>\n&gt; might <br/>\n&gt; &gt; look at something for the future.<br/>\n&gt; <br/>\n&gt; There&#39;s a setStackTrace in Throwable that looks promising. Granted,<br/>\n&gt; this is a bit of a hack, but having the org.junit lines in the test<br/>\n&gt; results gets really, really annoying. At the very least we should<br/>\n&gt; export a polished method that takes care of this.<br/>\n<br/>\n </span></blockquote>It seems to me that stack filtering is a user interface responsibility.<br/>\nEvery time we get into the formatting business we regret it (see<br/>\nComparisonFailure for an example).<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; <br/>\n&gt; &gt; &gt; @Test(expected=) traces<br/>\n&gt; &gt; &gt; -----------------------<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt; When you have an expected exception, and another one gets <br/>\n&gt; thrown, the<br/>\n&gt; &gt; &gt; error trace doesn&#39;t contain the bad exception. You only get:<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt; java.lang.AssertionError: Unexpected exception, <br/>\n&gt; &gt; &gt; expected&lt;java.util.NoSuchElementException&gt; but <br/>\n&gt; &gt; &gt; was&lt;java.lang.NullPointerException&gt;<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt; Having the trace of the bad exception would help TAs debug student<br/>\n&gt; code. <br/>\n<br/>\n </span></blockquote>Does the following test capture what you mean? In other words, an Exception<br/>\nis thrown in JUnit the cause of which is the exception thrown by the test<br/>\ncase. Once again, UIs can format this however they want to.<br/>\n<br/>\n\tpublic static class Unexpected {<br/>\n\t\t@Test(expected= Exception.class) public void expected()<br/>\nthrows Exception {<br/>\n\t\t\tthrow new Error();<br/>\n\t\t}<br/>\n\t}<br/>\n\t@Test public void unexpected() {<br/>\n\t\tResult result= JUnitCore.runClasses(Unexpected.class);<br/>\n\t\tFailure failure= result.getFailures().get(0);<br/>\n\t\tString message= failure.getMessage();<br/>\n\t\tassertTrue(message.contains(&quot;expected&lt;java.lang.Exception&gt;<br/>\nbut was&lt;java.lang.Error&gt;&quot;));<br/>\n\t\tassertEquals(Error.class,<br/>\nfailure.getException().getCause().getClass());<br/>\n\t}<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; <br/>\n&gt; Thanks. This also comes up with timeouts. It&#39;d be really cool to have<br/>\n&gt; a stacktrace from where the thread was hung.<br/>\n<br/>\n </span></blockquote>Can you turn this into a test case? That would help me with the<br/>\nimplementation.<br/>\n<br/>\nSincerely yours,<br/>\n<br/>\nKent Beck<br/>\nThree Rivers Institute</div>", 
    "prevInTime": 15942, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1138946805", 
    "canDelete": false, 
    "nextInTopic": 15944, 
    "prevInTopic": 15942, 
    "headers": {
        "inReplyToHeader": "PGRybTA0OSt1NzJuQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PEUxRjR1NW8tMDAwMHl4LVJRQHNtdHBhdXRoMDcubWFpbC5hdGwuZWFydGhsaW5rLm5ldD4="
    }
}