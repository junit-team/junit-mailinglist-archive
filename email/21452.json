{
    "numMessagesInTopic": 5, 
    "nextInTime": 21453, 
    "senderId": "e7Tx1vp-VuJ1C1a1aVe2RJXPgb1Yln7EeW7ZX7DeQvmJuB_qTWB9-EJYBkFiT_vhmYLO_BHTg7EbNQO2oU3Ophpq", 
    "systemMessage": false, 
    "subject": "Re: [junit] ClasspathSuite, JUnit 3.8 mixed with 4.5, big suites and \tmemory leaks", 
    "from": "David Saff &lt;david@...&gt;", 
    "authorName": "David Saff", 
    "msgSnippet": "Giuliano, Let me see if I have the situation clear: Using all 3.8 tests joined in a 3.8 AllTests suite, there are no problems. Using the same tests, with some", 
    "msgId": 21452, 
    "profile": "dsaff", 
    "topicId": 21449, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 341876227, 
    "messageBody": "<div id=\"ygrps-yiv-673104144\">Giuliano,<br/>\n<br/>\nLet me see if I have the situation clear:<br/>\n<br/>\nUsing all 3.8 tests joined in a 3.8 AllTests suite, there are no problems.<br/>\nUsing the same tests, with some converted to 4.5, joined with<br/>\nClasspathSuite, you run out of memory.<br/>\n<br/>\nIs that right?  If so, it&#39;s certainly troubling.  Some questions to<br/>\nhelp identify a potential JUnit bug:<br/>\n<br/>\n1) Do you run out of memory if you use ClasspathSuite, but skip the 4.5 tests?<br/>\n2) Do you run out of memory if you replace your AllTests suite with a<br/>\n4.5-style Suite?<br/>\n<br/>\nThanks,<br/>\n<br/>\n   David<br/>\n<br/>\n<blockquote><span title=\"qreply\"> On Thu, Mar 26, 2009 at 12:15 PM, pgbossi &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:pgbossi@...\">pgbossi@...</a>&gt; wrote:<br/>\n&gt; Hi all,<br/>\n&gt;<br/>\n&gt; We are in the process of building/modifying some suites on top of a legacy test collections, mostly written with JUnit 3.8. The test code is organized such that every package has an AllTests suite, including all the tests and suites below it.<br/>\n&gt;<br/>\n&gt; This has the obvious disadvantage of requiring manual maintenance every time you add a new test.<br/>\n&gt;<br/>\n&gt; I&#39;d say that the ratio between JUnit 3.8 vs 4.5 tests is 5:1<br/>\n&gt;<br/>\n&gt; Because of the mixed environment, we have decided to use excellent ClasspathSuite from Johannes Link: <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.johanneslink.net/projects/cpsuite.html\">http://www.johanneslink.net/projects/cpsuite.html</a><br/>\n&gt;<br/>\n&gt; The goal is to get rid of AllTests suites.<br/>\n&gt;<br/>\n&gt; At the root of the system we have a big bang suite, running 3 sub-suites of roughly 500 tests each (so roughly 1500 tests in total, half of them are unit tests and the other half are acceptance tests based on HttpUnit). The big suite runs fine with 196 MB of heap.<br/>\n&gt;<br/>\n&gt; We have started the conversion of one of such suites using ClasspathSuite and it worked fine in isolation, but not as part of the big suite: we consistently get an OutOfMemory exception indicating saturation of heap space. That happens even increasing the memory available to JUnit.<br/>\n&gt;<br/>\n&gt; We think that this may be caused by JUnit 3.8 runner holding onto every tests until the end. This has been exacerbated by using ClasspathSuite. We have tried fixing it by patching it with a custom runner as suggested here: <a rel=\"nofollow\" target=\"_blank\" href=\"http://forum.springframework.org/archive/index.php/t-64510.html\">http://forum.springframework.org/archive/index.php/t-64510.html</a><br/>\n&gt;<br/>\n&gt; The patch didn&#39;t seem to help even if the fTest references are nulled and we hint gc to run in the subsuite tearDown.<br/>\n&gt;<br/>\n&gt; Has anybody seen this too?<br/>\n&gt; Any suggested workaround and/or best practice?<br/>\n&gt;<br/>\n&gt; We are currently converting all the 3.8 tests to 4.5 hoping to provide a more consistent environment, but I&#39;d like to know your take on this.<br/>\n&gt;<br/>\n&gt; Thanks,<br/>\n&gt; Giuliano<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; ------------------------------------<br/>\n&gt;<br/>\n&gt; Yahoo! Groups Links<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; </span></blockquote></div>", 
    "prevInTime": 21451, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1238158752", 
    "canDelete": false, 
    "nextInTopic": 21454, 
    "prevInTopic": 21449, 
    "headers": {
        "inReplyToHeader": "PGdxZzluNysxOXA3QGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PDRmN2RhNmI5MDkwMzI3MDU1OXc2ZWE0MGVhOHgzN2Y0NWZiOWEwNGMxYzg1QG1haWwuZ21haWwuY29tPg==", 
        "referencesHeader": "PGdxZzluNysxOXA3QGVHcm91cHMuY29tPg=="
    }
}