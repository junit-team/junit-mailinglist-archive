{
    "numMessagesInTopic": 9, 
    "nextInTime": 22781, 
    "senderId": "jhXdkIONvWWOHZRkrnAs_kVIus9EEdBVqBoxtUu_w10Ng8Vq4HO6dj0PngSkiuiw96tLwZf5QcfYEixRK29WB0e3B7nFRU8n9Azfiq_t5rBv", 
    "systemMessage": false, 
    "subject": "Re: [junit] @BeforeClass method for DBUnit Dataset creation", 
    "from": "&quot;J. B. Rainsberger&quot; &lt;jbrains762@...&gt;", 
    "authorName": "J. B. Rainsberger", 
    "msgSnippet": "... Let me tell you a story. In 2001 I worked on my first XP project at Toyota Canada in Toronto. We ran into exactly the same problem you describe here: we", 
    "msgId": 22780, 
    "rawEmail": "Return-Path: &lt;jbrains762@...&gt;\r\nX-Sender: jbrains762@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 31845 invoked from network); 1 Jul 2010 21:07:48 -0000\r\nX-Received: from unknown (98.137.34.45)\n  by m3.grp.sp2.yahoo.com with QMQP; 1 Jul 2010 21:07:48 -0000\r\nX-Received: from unknown (HELO mail-iw0-f173.google.com) (209.85.214.173)\n  by mta2.grp.sp2.yahoo.com with SMTP; 1 Jul 2010 21:07:48 -0000\r\nX-Received: by iwn6 with SMTP id 6so2545187iwn.4\n        for &lt;junit@yahoogroups.com&gt;; Thu, 01 Jul 2010 14:07:47 -0700 (PDT)\r\nX-Received: by 10.231.32.70 with SMTP id b6mr55442ibd.99.1278018467474;\n        Thu, 01 Jul 2010 14:07:47 -0700 (PDT)\r\nReturn-Path: &lt;jbrains762@...&gt;\r\nX-Received: from mel.local (blk-137-112-251.eastlink.ca [24.137.112.251])\n        by mx.google.com with ESMTPS id 13sm6114078ibo.0.2010.07.01.14.07.44\n        (version=SSLv3 cipher=RC4-MD5);\n        Thu, 01 Jul 2010 14:07:45 -0700 (PDT)\r\nMessage-ID: &lt;4C2D039F.4010605@...&gt;\r\nDate: Thu, 01 Jul 2010 18:07:43 -0300\r\nUser-Agent: Postbox 1.1.5 (Macintosh/20100613)\r\nMIME-Version: 1.0\r\nTo: junit@yahoogroups.com\r\nReferences: &lt;i0gr7d+htvi@...&gt;\r\nIn-Reply-To: &lt;i0gr7d+htvi@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nFrom: &quot;J. B. Rainsberger&quot; &lt;jbrains762@...&gt;\r\nSubject: Re: [junit] @BeforeClass method for DBUnit Dataset creation\r\nX-Yahoo-Group-Post: member; u=282027414; y=gRMxiNqOAw07pZxWR7N0ci5cBeTqNJIqUYHi72-zTDE3zuI\r\nX-Yahoo-Profile: nails762\r\n\r\nhdave321321 wrote:\n\n&gt; My DAO integration tests are taking a long time to run.  I am using\n&gt; Spring Test which automatically does a transaction rollback after\n&gt; each test method.  However, I am also using DBUnit to load the exact\n&gt; same dataset before each test method via the @BeforeTransaction\n&gt; annotation.\n&gt;\n&gt; It has occured to me that I could save a lot of time if I load the\n&gt; DBUnit test data once per test class instead of once per test\n&gt; method.\n&gt;\n&gt; I&#39;ve not used the @BeforeClass and @AfterClass methods before, but\n&gt; apparently they require the annotated method to be static and this is\n&gt; interfering with my normal use of Spring dependency injection that\n&gt; provides an application context, data source, and other things I need\n&gt; to load the correct data set.\n&gt;\n&gt; Anyone experience this before?  What&#39;s a good way to address this\n&gt; problem?\n\nLet me tell you a story.\n\nIn 2001 I worked on my first XP project at Toyota Canada in Toronto. We \nran into exactly the same problem you describe here: we had several \ndozen tests, most of which inserted data in setUp() and rolled \ntransactions back in tearDown(). Back then, of course, computers ran \nmore slowly, so we were running at around 5-10 tests per second when we \nwere lucky. We could see how when we added another 300 tests our test \nsuite would take several minutes to run, and that just wasn&#39;t going to \nwork. We decided to create a single test data set for the entire test \nsuite, then used the tools of the time--DBUnit, in fact--to insert the \ndata set at the start of the test run. For a few weeks, it worked great. \nOur test suite execution time dropped from minutes to tens of seconds \nwhich, back then, we could live with.\n\nThen something annoying happened.\n\nWe added a new feature, which required putting data in a new table, \nwhich itself required adding a row to an old table to set up a foreign \nkey relationship. We got the six new tests to run, but when we ran the \nentire suite just before checkin, 3 tests failed. We discovered that by \nadding a row to the parent table, we changed the expected result for \nthree of our tests: they used to expect 6 rows, and now they needed to \nexpect 7. We considered two options: split the test data into two sets, \nor change the expected results in the tests. We figured that the first \noption would slowly lead us back to loading test data for each test, so \nwe chose the second option and changed the expected results.\n\nA couple of weeks later, it happened again. We added a feature that \nrequired putting data in a new table, which itself required adding rows \nto a few different existing tables to set up foreign key relationships. \nWe got the eight new tests run, but when we ran the whole suite, 10 \ntests failed. We sighed, we checked what happened, and we updated the \nexpected results on the old tests.\n\nA week later, it happened again. This time we had to change 26 tests. It \ntook a day to do it accurately, because each &quot;fix&quot; required running an \n8-minute test suite, and 26 times 8 is already over three hours.\n\nA week later, it happened again. This time we had to change 61 tests. It \ntook three days. We saw where this was going.\n\nWe split the test data back into sensible datasets, with each test \nloading the data it needed. Execution time increased, but maintenance \ntime went to almost zero. We also figured out how to test more of the \nsystem without touching the database at all. Nowadays, when I work on \nsuch a project, only about 20-50 tests touch the database, and the rest \nrun in memory. At today&#39;s machine speeds, I usually get 250-500 tests \nper second. In the ten seconds it takes for my mind to wander, I can run \n15,000-30,000 tests. I can build a pretty good system for 15,000 tests.\n-- \nJ. B. Rainsberger :: http://www.jbrains.ca ::\nhttp://www.thecodewhisperer.com\n\n", 
    "profile": "nails762", 
    "topicId": 22776, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 282027414, 
    "prevInTime": 22779, 
    "contentTrasformed": false, 
    "postDate": "1278018463", 
    "canDelete": false, 
    "nextInTopic": 22783, 
    "prevInTopic": 22779, 
    "headers": {
        "inReplyToHeader": "PGkwZ3I3ZCtodHZpQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PDRDMkQwMzlGLjQwMTA2MDVAZ21haWwuY29tPg==", 
        "referencesHeader": "PGkwZ3I3ZCtodHZpQGVHcm91cHMuY29tPg=="
    }
}