{
    "numMessagesInTopic": 24, 
    "nextInTime": 9014, 
    "senderId": "GGOqWZ_uTKXxgBm3xah5pE89MJbNLBVMhmlQ5pWUUcU1y0bNpZ-oh5DjnUSXKDDyyJ_-qJM_myN0CIqZ1LOE67LIMF0", 
    "systemMessage": false, 
    "subject": "RE: [junit] How to test a main(String[] args) method?", 
    "from": "&quot;David&quot; &lt;achepati67@...&gt;", 
    "authorName": "David", 
    "msgSnippet": "See below... ... De: bernd [mailto:berndq@gmx.net] Enviado el: viernes, 01 de agosto de 2003 10:42 Para: junit@yahoogroups.com Asunto: RE: [junit] How to test", 
    "msgId": 9013, 
    "profile": "achepati67", 
    "topicId": 8737, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 152694144, 
    "messageBody": "<div id=\"ygrps-yiv-913495584\">See below...<br/>\n  -----Mensaje original-----<br/>\n  De: bernd [mailto:<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:berndq@...\">berndq@...</a>]<br/>\n  Enviado el: viernes, 01 de agosto de 2003 10:42<br/>\n  Para: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\n  Asunto: RE: [junit] How to test a main(String[] args) method?<br/>\n<br/>\n<br/>\n  Hi,<br/>\n<br/>\n<br/>\n<blockquote><span title=\"ireply\">   &gt; -----Original Message-----<br/>\n  &gt; From: David [mailto:<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:achepati67@...\">achepati67@...</a>]<br/>\n  &gt; Sent: Wednesday, July 30, 2003 10:57 AM<br/>\n  &gt; To: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\n  &gt; Cc: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:berndq@...\">berndq@...</a>; <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:mike@...\">mike@...</a>; <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:jbrains@...\">jbrains@...</a><br/>\n  &gt; Subject: RE: [junit] How to test a main(String[] args) method?<br/>\n  &gt;<br/>\n  &gt;<br/>\n  &gt; &gt;Dear Members,<br/>\n  &gt; &gt;<br/>\n  &gt; &gt;I whould like to test a class with a main(String[] args)<br/>\n  &gt; method. Depending<br/>\n  &gt; &gt;on the input argument it executes one thing or the other.<br/>\n  &gt; The problem is<br/>\n  &gt; &gt;that on my main(String[] args) method at the end or when it founds an<br/>\n  &gt; error,<br/>\n  &gt; &gt;the method System.exit() is invoked. So when I define jUnit<br/>\n  &gt; test cases<br/>\n  &gt; &gt;(methods with prefix test), jUnits only runs the first test, because<br/>\n  &gt; some&gt;System.exit() was invoked.<br/>\n  &gt; &gt;Is there any way to test such kind of situations?<br/>\n  &gt; &gt;Thanks in advance,<br/>\n  &gt;<br/>\n  &gt; The solution propoused by Bern was:<br/>\n  &gt;<br/>\n  &gt; java.lang.System is final and does not implement<br/>\n  &gt; interfaces,so there is no<br/>\n  &gt; chance to replace ist behaviour.You may want to replace calls to<br/>\n  &gt; System.exit() with calls againstan interface you define.<br/>\n  &gt; Under test use an<br/>\n  &gt; implementation which allowsyourtest code to chech if the exit<br/>\n  &gt; method has<br/>\n  &gt; been called by main() but whichdoes not exit the VM. In<br/>\n  &gt; production use an<br/>\n  &gt; implememtation which delegatesto System.exit().<br/>\n  &gt;<br/>\n  &gt; As far as I know what you mean could be implemented like<br/>\n  &gt; this: (see comments<br/>\n  &gt; below)<br/>\n  &gt;<br/>\n  &gt; package com.my.example<br/>\n  &gt;<br/>\n  &gt; public class Example {<br/>\n  &gt;       static Finish _finish = new<br/>\n  &gt; Example.ProductionFinish();// private package<br/>\n  &gt; (static because it is<br/>\n  &gt;<br/>\n  &gt;             // going to be used on main.)<br/>\n  &gt;       static void setFinish(Finish value){_finish = value;}<br/>\n  &gt; // private package<br/>\n  &gt;<br/>\n  &gt;       static main (String[] args)<br/>\n  &gt;<br/>\n  &gt;             boolean goOn = true;       // because we don&#39;t<br/>\n  &gt; exit on testing mode,<br/>\n  &gt;                                     // we need a<br/>\n  &gt; way for controling the execution flow.<br/>\n  &gt;             if (someCondition) {// first checking (exceptional flow)<br/>\n  &gt;                   goOn = finish.do(-1);<br/>\n  &gt;             }<br/>\n  &gt;             // ... put other checking here<br/>\n  &gt;             if (goOn && otherCondition) {// main flow<br/>\n  &gt;                   finish.do(0);<br/>\n  &gt;             }<br/>\n  &gt;       }<br/>\n  &gt;<br/>\n  &gt;       /* Now we define the interface Finish and its default<br/>\n  &gt; implementation (as<br/>\n  &gt; inner classes<br/>\n  &gt;       with private-package visibility, because we have to<br/>\n  &gt; define ONLY for testing<br/>\n  &gt; purpose this<br/>\n  &gt;       interface!)*/<br/>\n  &gt;<br/>\n  &gt;       interface Finish {<br/>\n  &gt;             boolean do(int i);<br/>\n  &gt;       }<br/>\n  &gt;<br/>\n  &gt;       class ProductionFinish {// its default implementation<br/>\n  &gt; (used on production<br/>\n  &gt; mode)<br/>\n  &gt;             ProductionFinish(){} // default constructor<br/>\n  &gt; with private-package<br/>\n  &gt; visibility<br/>\n  &gt;             boolean do(int i) {<br/>\n  &gt;                   System.exit(i);<br/>\n  &gt;             }<br/>\n  &gt;       }<br/>\n  &gt; }<br/>\n  &gt;<br/>\n  &gt; Now on the testing class defined on the same package:<br/>\n  &gt;<br/>\n  &gt; package com.my.example<br/>\n  &gt;<br/>\n  &gt; public class ExampleTest extends TestCase{<br/>\n  &gt;       // ...<br/>\n  &gt;           protected void setUp (){Example.setFinish(new<br/>\n  &gt; ExampleTest.TestingFinish());}<br/>\n  &gt;       }<br/>\n  &gt;       class TestingFinish implements Example.Finish{<br/>\n  &gt;             TestingFinish (){} // default constructor with<br/>\n  &gt; private-package visibility<br/>\n  &gt;             boolean do(int i) { // We have to stop on every case!<br/>\n  &gt;                   return false;<br/>\n  &gt;             }<br/>\n  &gt;       }<br/>\n  &gt; }<br/>\n<br/>\n </span></blockquote>  sorry for not reading you code in detail,<br/>\n  I was thinking of something like<br/>\n<br/>\n        interface Finish {<br/>\n              void do(int i);<br/>\n        }<br/>\n<br/>\n  we need it for production:<br/>\n<br/>\n  class ProductionFinish implements Finish{<br/>\n      public void do(int exitCode){<br/>\n          System.exit(exitCode);<br/>\n      }<br/>\n  }<br/>\n<br/>\n<br/>\n  and a Mock for tests:<br/>\n<br/>\n  class MockFinish implements Finish{<br/>\n      public void do(int exitCode){<br/>\n          mLastExitCode=exitCode;<br/>\n          mNumberOfDoCalled++;<br/>\n      }<br/>\n<br/>\n      public int getLastExitCode(){return mLastExitCode;}<br/>\n      public int getNumberOfDoCalled(){return mDoWasCalled;}<br/>\n<br/>\n      private int mLastExitCode;<br/>\n      private int mNumberOfDoCalled=0;<br/>\n  }<br/>\n<br/>\n  inside of main, just use the interface.<br/>\n  At the very beginnig of main you may use a factory<br/>\n  to get an implmentation:<br/>\n<br/>\n  public static void main(String[] atgs){<br/>\n     Finish finish=FinishFactory.getInstance();<br/>\n<br/>\n     ...<br/>\n     finish.do(22);<br/>\n     ...<br/>\n  }<br/>\n<br/>\n  depending on production/test the factory will<br/>\n  hand out the corresponding implementation.<br/>\n<br/>\n  a test may look like this:<br/>\n<br/>\n  public MyTestCase extends TestCase{<br/>\n  ...<br/>\n  public test_xx(){<br/>\n      com.xxx.package.main(argsToBeTested)<br/>\n      MockFinish mockFinish=howToGetInstance??<br/>\n<br/>\n      // make sure exit was called only once<br/>\n      assertEquals(1, mockFinish.getNumberOfDoCalled());<br/>\n      assertEquals(expectedExitCode, mockFinish.getLastExitCode());<br/>\n  }<br/>\n<br/>\n  But how to get the instance of MockFinsih?<br/>\n  Maybe something like<br/>\n<br/>\n  ...<br/>\n  public static MockFinish getInstance(){<br/>\n     return mInstance;<br/>\n  }<br/>\n<br/>\n  private static mInstance;<br/>\n  ...<br/>\n<br/>\n<br/>\n  hmm, yes really lots of code...<br/>\n<br/>\n<blockquote><span title=\"ireply\">   &gt; COMMENTS:<br/>\n  &gt;<br/>\n  &gt; - About this suggestion and the corresponding implementation,<br/>\n  &gt; because we<br/>\n  &gt; need a default implementation ALWAYS (for production), then<br/>\n  &gt; instead of using<br/>\n  &gt; an INTERFACE, it is BETTER to just define the class Finish as<br/>\n  &gt; ABSTRACT (the<br/>\n  &gt; do(int i) method should be abstract)<br/>\n  &gt;<br/>\n  &gt; - You have to write A LOT for makeing a very simple task. I<br/>\n  &gt; have implemented<br/>\n  &gt; a simpler solution, just do the following steps:<br/>\n  &gt;<br/>\n  &gt; a) Define on the class to test (Example), the static boolean<br/>\n  &gt; field _TEST as<br/>\n  &gt; private-package. This field is initialized with default value: false<br/>\n  &gt; (production)<br/>\n  &gt;<br/>\n  &gt; b) Define a STATIC PRIVATE method finish, like this:<br/>\n  &gt;             private static boolean finish(int i) {<br/>\n  &gt;                   if(!_TEST) {<br/>\n  &gt;                         System.exit(i);<br/>\n  &gt;                   }<br/>\n  &gt;                   return false;<br/>\n  &gt;             }<br/>\n  &gt; c) On the testing class (ExampleTest), set on the setup()<br/>\n  &gt; method, the field<br/>\n  &gt; _TEST to true.<br/>\n  &gt;<br/>\n  &gt;<br/>\n  &gt; Now we have:<br/>\n  &gt;<br/>\n  &gt; package com.my.example<br/>\n  &gt;<br/>\n  &gt; public class Example {<br/>\n  &gt;       static boolean _TEST = false;<br/>\n  &gt;<br/>\n  &gt;       static main (String[] args)<br/>\n  &gt;<br/>\n  &gt;             boolean goOn = true;<br/>\n  &gt;             if (someCondition) {// fist checking<br/>\n  &gt;                   goOn = finish(-1);<br/>\n  &gt;             }<br/>\n  &gt;             // ... put other checking here<br/>\n  &gt;             if (goOn && otherCondition) {// the last<br/>\n  &gt; condition (end of the program)<br/>\n  &gt;                   finish(-1);<br/>\n  &gt;             }<br/>\n  &gt;       }<br/>\n  &gt;<br/>\n  &gt;       private static boolean finish (int i) {<br/>\n  &gt;             if (!_TEST) {<br/>\n  &gt;                   System.exit(i);<br/>\n  &gt;             }<br/>\n  &gt;             return false;<br/>\n  &gt;       }<br/>\n  &gt; }<br/>\n  &gt;<br/>\n  &gt; package com.my.example<br/>\n  &gt;<br/>\n  &gt; public class ExampleTest extends TestCase{<br/>\n  &gt;       // ...<br/>\n  &gt;           protected void setUp (){Example._TEST = true;}<br/>\n  &gt;       }<br/>\n  &gt; }<br/>\n  &gt;<br/>\n  &gt; I think this solution is enough. Any suggestion?<br/>\n<br/>\n </span></blockquote>  How do you test that finish() really was called?<br/>\n  [David Leal] No, I don&#39;t test it.<br/>\n  IIRC that was your question in your initial posting?[David Leal]  No my<br/>\nquestion was how to avoid System.exit() stop the execution on for testing. I<br/>\nwant to test more than one invokation to the main(String[] args) method, but<br/>\nbecause my invokation to the method System.exit(), ony one situation was<br/>\ntested. Now I have an idea about how to handle this situation.<br/>\n<br/>\n  Maybe to much modification of the original code: goOn && ... ?<br/>\n  Did you try J.B.&#39;s suggestion?<br/>\n  [David Leal] It doesn&#39;t work for me, because I have to modify the<br/>\nequivalent method to test. My main method has an execution by steps, if the<br/>\nprevios step fails, it should stop, that is way I need to control variable<br/>\ngoOn, in order to control if I have to stop the program without using<br/>\nSystem.exit(), that is way I use such control variable. My suggestion is a<br/>\nlittle modification to the J.B.&#39;s suggestion.<br/>\n<br/>\n  Thanks in advance,<br/>\n<br/>\n  David<br/>\n<br/>\n<br/>\n[Non-text portions of this message have been removed]</div>", 
    "prevInTime": 9012, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1059981792", 
    "canDelete": false, 
    "nextInTopic": 9016, 
    "prevInTopic": 8919, 
    "headers": {
        "inReplyToHeader": "PDAwMGUwMWMzNTgwOCRkNzU1YzE1MCQxZjAzYThjMEBkZWxsPg==", 
        "messageIdInHeader": "PE5GQkJMRkROTUpMTkxKQUpKS05BQ0VOSEZIQUEuYWNoZXBhdGk2N0B5YWhvby5lcz4="
    }
}