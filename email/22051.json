{
    "numMessagesInTopic": 5, 
    "nextInTime": 22052, 
    "senderId": "TKIqUQbHYTvxS9mmEb5YYzKc5Ot0w6HotyJpC6B-RbKIvOEiBVxjMcfKgI0GmGJ1pcLWvo6ikxs0eX3m8RQV20SMGgAq", 
    "systemMessage": true, 
    "subject": "Re: [junit] how do I test socket server application?", 
    "from": "Mike Forsberg &lt;bigmike@...&gt;", 
    "authorName": "Mike Forsberg", 
    "msgSnippet": "The following works for me... import java.io.IOException; import java.net.ServerSocket; import java.net.Socket; import org.junit.Before; import org.junit.Test;", 
    "msgId": 22051, 
    "profile": "bigmike_f", 
    "topicId": 21961, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 89428055, 
    "messageBody": "<div id=\"ygrps-yiv-741453588\">The following works for me...<br/>\n<br/>\nimport java.io.IOException;<br/>\nimport java.net.ServerSocket;<br/>\nimport java.net.Socket;<br/>\n<br/>\nimport org.junit.Before;<br/>\nimport org.junit.Test;<br/>\n<br/>\npublic class TestSomethingVersion1 {<br/>\n<br/>\n\t@Before<br/>\n\tpublic void before() {<br/>\n\t\tSystem.out.println(&quot;@Before&quot;);<br/>\n\t\tThread myThread = new Thread() {<br/>\n\t\t\tpublic void run() {<br/>\n\t\t\t\tSystem.out.println(&quot;@Before myThread run()&quot;);<br/>\n\t\t\t\tSocket myServerSocket = null;<br/>\n\t\t\t\ttry {<br/>\n\t\t\t\t\tServerSocket myServer = new ServerSocket(3000);<br/>\n\t\t\t\t\tSystem.out<br/>\n\t\t\t\t\t\t\t.println(&quot;@Before myThread run() - server socket created.&quot;);<br/>\n\t\t\t\t\tmyServerSocket = myServer.accept();<br/>\n\t\t\t\t\tSystem.out<br/>\n\t\t\t\t\t\t\t.println(&quot;@Before myThread run() - accepted connection&quot;);<br/>\n\t\t\t\t} catch (IOException e) {<br/>\n\t\t\t\t\te.printStackTrace();<br/>\n\t\t\t\t}<br/>\n\t\t\t}<br/>\n\t\t};<br/>\n\t\tmyThread.start();<br/>\n\t}<br/>\n<br/>\n\t@Test<br/>\n\tpublic void test1() throws Exception {<br/>\n\t\tSystem.out.println(&quot;test1&quot;);<br/>\n\t\tsynchronized (this) {<br/>\n\t\t\ttry {<br/>\n\t\t\t\twait(1000);<br/>\n\t\t\t} catch (InterruptedException e) {<br/>\n\t\t\t\t// do nothing.<br/>\n\t\t\t}<br/>\n\t\t}<br/>\n\t\tSystem.out.println(&quot;test1 - after wait&quot;);<br/>\n\t\tnew Socket(&quot;localhost&quot;, 3000);<br/>\n\t\tsynchronized (this) {<br/>\n\t\t\ttry {<br/>\n\t\t\t\twait(1000);<br/>\n\t\t\t} catch (InterruptedException e) {<br/>\n\t\t\t\t// do nothing.<br/>\n\t\t\t}<br/>\n\t\t}<br/>\n\t\tSystem.out.println(&quot;test1 - after second wait&quot;);<br/>\n\t}<br/>\n}<br/>\n<br/>\nSome of the things I ran into while writing up this example...<br/>\n- Threading issues: The thread created in the before did not get any<br/>\nprocessor until it was too late.<br/>\n- Port contentions: I didn&#39;t use an unused port.<br/>\n<br/>\n<br/>\nSome things you might run into later on down the line....<br/>\n- Use of the Before annotation will lead to a new ServerSocket thread<br/>\ncreated for each test method.  Which will lead to inability to use the<br/>\nsame address.  The old thread will still be alive.<br/>\n- There will be a ton of test information in the ServerSocket thread<br/>\nrequired for each test.<br/>\n<br/>\n_I think you are testing your client incorrectly_<br/>\n<br/>\nHave you ever thought about testing only one side of the application<br/>\nat a time?  Are you testing the client or the server?  Have you<br/>\nthought about separating the connection portion of the application<br/>\nfrom the reading and writing of data.  For instance the Socket reads<br/>\nand writes over streams.  What if these were the arguments to the main<br/>\nportion of your application?  You could then write and read from these<br/>\nstreams without the socket overhead.<br/>\n<br/>\nHope I helped,<br/>\n<br/>\nBig Mike<br/>\n<br/>\n<br/>\n<blockquote><span title=\"qreply\"> On Mon, Nov 16, 2009 at 12:38 AM, youhaodeyi &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:youhaodeyi@...\">youhaodeyi@...</a>&gt; wrote:<br/>\n&gt;<br/>\n&gt; What my problem is that I create a thread to listen on a port but the program<br/>\n&gt; will exist not block. Below is my code<br/>\n&gt;<br/>\n&gt; @Before<br/>\n&gt; public void setUp() throws Exception{<br/>\n&gt; try {<br/>\n&gt;                        (new Thread(new Runnable(){<br/>\n&gt;                                public void run() {<br/>\n&gt;                                        try{<br/>\n&gt;                                        server=new ServerSocket(3000);<br/>\n&gt;                                        server.accept();<br/>\n&gt;                                        }catch(Exception ex){<br/>\n&gt;                                                ex.printStackTrace();<br/>\n&gt;                                        }<br/>\n&gt;                                };<br/>\n&gt;                        })).start();<br/>\n&gt;                } catch (Exception e) {<br/>\n&gt;                        e.printStackTrace();<br/>\n&gt;                }<br/>\n&gt;<br/>\n&gt;        }<br/>\n&gt; }<br/>\n&gt; @Test<br/>\n&gt; public void test1(){<br/>\n&gt;         ...<br/>\n&gt; }<br/>\n&gt;<br/>\n&gt; Mike Forsberg wrote:<br/>\n&gt;&gt;<br/>\n&gt;&gt; JUnit is agnostic, or doesn&#39;t know, where it runs.<br/>\n&gt;&gt;<br/>\n&gt;&gt; You would write the test cases just as any other test.<br/>\n&gt;&gt;<br/>\n&gt;&gt; If I had some more information I could help a little better.<br/>\n&gt;&gt;<br/>\n&gt;&gt; Big Mike<br/>\n&gt;&gt;<br/>\n&gt;&gt; On Sat, Oct 10, 2009 at 1:41 AM, youhaodeyi &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:youhaodeyi@...\">youhaodeyi@...</a>&gt; wrote:<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; I have a server/client application and want to use junit to test it. How<br/>\n&gt;&gt;&gt; do I setup a server side junit test case?<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; thanks.<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; ------------------------------------<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; Yahoo! Groups Links<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;<br/>\n&gt;&gt;<br/>\n&gt;<br/>\n&gt; --<br/>\n&gt; View this message in context: <a rel=\"nofollow\" target=\"_blank\" href=\"http://old.nabble.com/how-do-I-test-socket-server-application--tp25833711p26367358.html\">http://old.nabble.com/how-do-I-test-socket-server-application--tp25833711p26367358.html</a><br/>\n&gt; Sent from the JUnit - User mailing list archive at Nabble.com.<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; ------------------------------------<br/>\n&gt;<br/>\n&gt; Yahoo! Groups Links<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; </span></blockquote></div>", 
    "prevInTime": 22050, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1258433535", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 22050, 
    "headers": {
        "inReplyToHeader": "PDI2MzY3MzU4LnBvc3RAdGFsay5uYWJibGUuY29tPg==", 
        "messageIdInHeader": "PGE1MjdmZGRmMDkxMTE2MjA1MnA0OWQ0YmViY2gxZTI0ODk5NDhkYmM0N2E4QG1haWwuZ21haWwuY29tPg==", 
        "referencesHeader": "PGhhcGFhZCs1bHJuQGVHcm91cHMuY29tPgkgPGE1MjdmZGRmMDkxMDEwMTA0N3RhNDBlNDU2ajEzMzE1NGM2YzhlNTMwMWVAbWFpbC5nbWFpbC5jb20+CSA8MjYzNjczNTgucG9zdEB0YWxrLm5hYmJsZS5jb20+"
    }
}