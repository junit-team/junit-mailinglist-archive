{
    "numMessagesInTopic": 19, 
    "nextInTime": 21238, 
    "senderId": "ngnJ4GgL9TW9ZhgdLkNXTB6I-eHhOvlPHevP9shM8b1_AFbVfzO8MV4IV4D21YCLvTaXnAOEmbOlqA", 
    "systemMessage": false, 
    "subject": "Re: [junit] Priority of Assertion?", 
    "from": "nat.pryce@...", 
    "authorName": "nat.pryce@gmail.com", 
    "msgSnippet": "Regarding comparability with the assert keyword, I think JUnit is in an odd situation with this already. A failing assertion in a test should be, and is,", 
    "msgId": 21237, 
    "profile": "nat_pryce", 
    "topicId": 21230, 
    "spamInfo": {
        "reason": "2", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 216973656, 
    "messageBody": "<div id=\"ygrps-yiv-753441340\">Regarding comparability with the assert keyword, I think JUnit is in<br/>\nan odd situation with this already. A failing assertion in a test<br/>\nshould be, and is, treated as a test failure, not an error. But a<br/>\nfailing assertion in the code under test should, I think, be treated<br/>\nas an unexpected error, like a null pointer exception or an array<br/>\nindex out of bounds. In JUnit 4 it is impossible to make that<br/>\ndistinction.<br/>\n<br/>\n--Nat.<br/>\n<br/>\n<br/>\n<blockquote><span title=\"qreply\"> On 30/12/2008, kentb &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:kentb@...\">kentb@...</a>&gt; wrote:<br/>\n&gt; Point taken (and props to Yosef for bringing this up). Restating, the fact<br/>\n&gt; that assertion failures are implemented as thrown exceptions should be<br/>\n&gt; invisible to users. So,<br/>\n&gt;<br/>\n&gt; @Test(expected=WhateverException.class) public void whatever() {<br/>\n&gt;     assertTrue(false);<br/>\n&gt; }<br/>\n&gt;<br/>\n&gt; should be reported as an assertion error. Makes sense to me. I was about to<br/>\n&gt; dive in and implement it when I thought of:<br/>\n&gt;<br/>\n&gt; @Test(expected=AssertionError.class) public void whatever() {<br/>\n&gt;     //...call some code which should fail a native Java assertion...<br/>\n&gt; }<br/>\n&gt;<br/>\n&gt; This ought to be reported as an error if the assertion isn&#39;t thrown. Now how<br/>\n&gt; about:<br/>\n&gt;<br/>\n&gt; @Test(expected=AssertionError.class) public void whatever() {<br/>\n&gt;     //...call some code which should fail a native Java assertion...<br/>\n&gt;     assertTrue(false);<br/>\n&gt; }<br/>\n&gt;<br/>\n&gt; This is impossible (given our current implementation) to get right. If the<br/>\n&gt; code doesn&#39;t fail the assertion, the assertion is still thrown by the call<br/>\n&gt; to assertTrue(). The implementation still leaks but only in this strange<br/>\n&gt; case. If we use our own private subclass of Error instead of using<br/>\n&gt; java.lang.AssertionError, we lose compatibility with the assert keyword.<br/>\n&gt;<br/>\n&gt; The optimum resolution seems to me to special case AssertionError in the<br/>\n&gt; &quot;expected=...&quot; code and add a caveat to the documentation.<br/>\n&gt;<br/>\n&gt; Comments?<br/>\n&gt;<br/>\n&gt; Kent Beck<br/>\n&gt; Three Rivers Institute<br/>\n&gt;<br/>\n&gt;   _____<br/>\n&gt;<br/>\n&gt; From: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a> [mailto:<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>] On Behalf Of<br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:nat.pryce@...\">nat.pryce@...</a><br/>\n&gt; Sent: Tuesday, December 30, 2008 10:14 AM<br/>\n&gt; To: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\n&gt; Subject: Re: [junit] Priority of Assertion?<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; I agree. The &quot;expected&quot; construct feels like a form of assertion that<br/>\n&gt; Junit performs after the body of the test has completed. It is<br/>\n&gt; confusing that it does not compose in the same way as other<br/>\n&gt; assertions. If a test has two consecutive assertions, it is not an<br/>\n&gt; error for the first assertion to fail and the second never to be<br/>\n&gt; called. Likewise I&#39;d expect it not to be an error for an assertion to<br/>\n&gt; fail and the &quot;expected&quot; constraint not to be checked.<br/>\n&gt;<br/>\n&gt; What happens when a test with an expected exception throws an<br/>\n&gt; assumption exception?<br/>\n&gt;<br/>\n&gt; --Nat<br/>\n&gt;<br/>\n&gt; On 30/12/2008, Ilja Preu√ü &lt;iljapreuss@googlema<br/>\n&gt; &lt;mailto:iljapreuss%40googlemail.com&gt; il.com&gt; wrote:<br/>\n&gt;&gt; Kent, I agree that it is expected behavior, technically. I think you<br/>\n&gt;&gt; could also make an argument that it would be better if the behavior<br/>\n&gt;&gt; was different.<br/>\n&gt;&gt;<br/>\n&gt;&gt; In my view, the behavior is in fact an artifact of an implementation<br/>\n&gt;&gt; detail - namely that asserts indicate failures by throwing an<br/>\n&gt;&gt; exception. It could be made the case that JUnit &quot;should&quot; report those<br/>\n&gt;&gt; failing asserts as failing asserts, not as unexpected exceptions.<br/>\n&gt;&gt; Basically, the current behavior masks the true test failure.<br/>\n&gt;&gt;<br/>\n&gt;&gt; Frankly, I have a hunch that the best solution to this problem<br/>\n&gt;&gt; actually is to split the test in two, that is, to not mix &quot;expected&quot;<br/>\n&gt;&gt; and &quot;assert&quot; in the same test method.<br/>\n&gt;&gt;<br/>\n&gt;&gt; Cheers, Ilja<br/>\n&gt;&gt;<br/>\n&gt;&gt; 2008/12/30 kentb &lt;kentb@earthlink. &lt;mailto:kentb%40earthlink.net&gt; net&gt;:<br/>\n&gt;&gt;&gt; Yosef,<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; The behavior you describe is what I would expect to see. In the test, you<br/>\n&gt;&gt;&gt; declared that an ArrayIndexOutOfBounds exception would be thrown. It was<br/>\n&gt;&gt;&gt; not<br/>\n&gt;&gt;&gt; thrown, so the test fails. The error message says that the &quot;wrong&quot;<br/>\n&gt;&gt;&gt; exception<br/>\n&gt;&gt;&gt; that was thrown was an AssertionError, which is generated by the<br/>\n&gt;&gt;&gt; assertTrue(false). The &quot;expected=...&quot; means that a test can fail if no<br/>\n&gt;&gt;&gt; exception is thrown or if the wrong exception is thrown.<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; Regards,<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; Kent Beck<br/>\n&gt;&gt;&gt; Three Rivers Institute<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; _____<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; From: junit@yahoogroups. &lt;mailto:junit%40yahoogroups.com&gt; com<br/>\n&gt; [mailto:junit@yahoogroups. &lt;mailto:junit%40yahoogroups.com&gt; com] On Behalf<br/>\n&gt; Of<br/>\n&gt;&gt;&gt; yosefshariat<br/>\n&gt;&gt;&gt; Sent: Tuesday, December 30, 2008 1:10 AM<br/>\n&gt;&gt;&gt; To: junit@yahoogroups. &lt;mailto:junit%40yahoogroups.com&gt; com<br/>\n&gt;&gt;&gt; Subject: [junit] Priority of Assertion?<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; Hi<br/>\n&gt;&gt;&gt; I use &quot;@Test(expected = AnyClassException.class&quot;) and one<br/>\n&gt;&gt;&gt; &quot;assertTrue(false)&quot; together for example following code:<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; @Test(expected = ArrayIndexOutOfBoundsException.class)<br/>\n&gt;&gt;&gt; public void test()<br/>\n&gt;&gt;&gt; {<br/>\n&gt;&gt;&gt; String s[] = new String[]{&quot;1&quot;};<br/>\n&gt;&gt;&gt; assertTrue(false);<br/>\n&gt;&gt;&gt; System.out.println(s[10]);<br/>\n&gt;&gt;&gt; }<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; I expect to see an assertion but I see following error:<br/>\n&gt;&gt;&gt; java.lang.Exception: Unexpected exception,<br/>\n&gt;&gt;&gt; expected&lt;java.lang.ArrayIndexOutOfBoundsException&gt; but<br/>\n&gt;&gt;&gt; was&lt;java.lang.AssertionError&gt;..<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; In your opinion, this test must be Assertion or Exception.<br/>\n&gt;&gt;&gt; In &quot;JUnit&quot; we cannot use &quot;@Test(expected = AnyClassException.class&quot;)<br/>\n&gt;&gt;&gt; and Assertion together at the same time.<br/>\n&gt;&gt;&gt; In my opinion this test must be failed for &quot;assertion&quot; and not for<br/>\n&gt;&gt;&gt; ArrayIndexOutOfBoundsException.<br/>\n&gt;&gt;&gt; Is this a bug in JUnit or my test is wrong and shouldn&#39;t use two item<br/>\n&gt;&gt;&gt; together?<br/>\n&gt;&gt;&gt; Tanks.<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; [Non-text portions of this message have been removed]<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;<br/>\n&gt;<br/>\n&gt; --<br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.natpryce\">http://www.natpryce</a> &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.natpryce.com\">http://www.natpryce.com</a>&gt; .com<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; [Non-text portions of this message have been removed]<br/>\n&gt;<br/>\n&gt;<br/>\n<br/>\n<br/>\n-- <br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.natpryce.com\">http://www.natpryce.com</a> </span></blockquote></div>", 
    "prevInTime": 21236, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1230679039", 
    "canDelete": false, 
    "nextInTopic": 21243, 
    "prevInTopic": 21236, 
    "headers": {
        "inReplyToHeader": "PEQ1MjQ2M0Y3RDYwMzQ4QTRBMzUzNkFCNDk5RURBN0VEQGtlbnRzcGF2aWxpb24+", 
        "messageIdInHeader": "PDE3ZmE1M2QwODEyMzAxNTE3aTNjYjFkNGU1cWY2MGQ2NzU5YzA3NThhZTFAbWFpbC5nbWFpbC5jb20+", 
        "referencesHeader": "PGdqY29oNCthNnY1QGVHcm91cHMuY29tPgkgPEI2RDE1OTcxOUQ5NzQzMENCOURENkNDNERCNUYwREMyQGtlbnRzcGF2aWxpb24+CSA8ZmJhMjk2OTcwODEyMzAwODE4aTRkOTIwZGI0bzQzMjFhYjdkYzZkY2FiMTRAbWFpbC5nbWFpbC5jb20+CSA8MTdmYTUzZDA4MTIzMDEwMTRuNGNlNTBjNDV5YjVmNzJkN2RhYTlkNDE3MUBtYWlsLmdtYWlsLmNvbT4JIDxENTI0NjNGN0Q2MDM0OEE0QTM1MzZBQjQ5OUVEQTdFREBrZW50c3BhdmlsaW9uPg=="
    }
}