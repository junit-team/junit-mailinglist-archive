{
    "numMessagesInTopic": 27, 
    "nextInTime": 17862, 
    "senderId": "lJiV-yM2ZQPnk_G6Bo7mrkTxqswZCued-FPb05a4wUD5L5fG2CSQ8Kb-urFG1UoNmWSKY4l04flihMRB_bC6rj7GNGlj3rVy-aymDCO7GPzuqS28", 
    "systemMessage": false, 
    "subject": "Re: [junit] JUnit Testing Code That Has System.exit(n);", 
    "from": "&quot;Joakim Ohlrogge&quot; &lt;joakim.ohlrogge@...&gt;", 
    "authorName": "Joakim Ohlrogge", 
    "msgSnippet": "I would like to second this idea. It seems most natural to refactor so that System.exit is only called in one place in the application (from the main method). ", 
    "msgId": 17861, 
    "rawEmail": "Return-Path: &lt;joakim.ohlrogge@...&gt;\r\nX-Sender: joakim.ohlrogge@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 57132 invoked from network); 8 Sep 2006 10:02:21 -0000\r\nReceived: from unknown (66.218.66.217)\n  by m34.grp.scd.yahoo.com with QMQP; 8 Sep 2006 10:02:21 -0000\r\nReceived: from unknown (HELO wx-out-0506.google.com) (66.249.82.238)\n  by mta2.grp.scd.yahoo.com with SMTP; 8 Sep 2006 10:02:21 -0000\r\nReceived: by wx-out-0506.google.com with SMTP id h29so545957wxd\n        for &lt;junit@yahoogroups.com&gt;; Fri, 08 Sep 2006 03:01:46 -0700 (PDT)\r\nReceived: by 10.90.105.20 with SMTP id d20mr539783agc;\n        Fri, 08 Sep 2006 03:01:46 -0700 (PDT)\r\nReceived: by 10.90.81.2 with HTTP; Fri, 8 Sep 2006 03:01:46 -0700 (PDT)\r\nMessage-ID: &lt;b9ee5e410609080301n6ee9dd80ta053b07b7a97200d@...&gt;\r\nDate: Fri, 8 Sep 2006 12:01:46 +0200\r\nTo: junit@yahoogroups.com\r\nIn-Reply-To: &lt;4500A307.9080600@...&gt;\r\nMIME-Version: 1.0\r\nReferences: &lt;edq2s9+odek@...&gt; &lt;4500A307.9080600@...&gt;\r\nX-Google-Sender-Auth: 261ead4be5d1654b\r\nX-eGroups-Msg-Info: 1:0:0:0\r\nX-eGroups-From: &quot;Joakim Ohlrogge&quot; &lt;joakim.ohlrogge@...&gt;\r\nFrom: &quot;Joakim Ohlrogge&quot; &lt;joakim.ohlrogge@...&gt;\r\nReply-To: joakim.ohlrogge@...\r\nSubject: Re: [junit] JUnit Testing Code That Has System.exit(n);\r\nX-Yahoo-Group-Post: member; u=261856052; y=aQlR5n2By5LYdRvImN39fk2a6rnrv3WrRyB2FNCbC7emVB0S\r\nX-Yahoo-Profile: j0hlrogge\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nI would like to second this idea. It seems most natural to refactor so that=\r\n\nSystem.exit is only called in one place in the application (from the main\n=\r\nmethod).\n\npublic static void main(String args[]) {\n    MyApplication myAppl=\r\nication =3D new MyApplication();\n    try {\n        myApplication.start();\n =\r\n   }\n    catch(MyExitRuntimeException e) {\n        System.exit(e.getErrorCo=\r\nde());\n    }\n\n}\n\nOr maybe even\n\npublic static void main(String args[]) {\n  =\r\n  MyApplication myApplication =3D new MyApplication();\n    try {\n        my=\r\nApplication.start();\n    }\n    catch(TotalFailureRuntimeException e) {\n    =\r\n    System.exit(TOTAL_FAILURE_CODE);\n    }\n    catch(PartialFailureRuntimeE=\r\nxception e) {\n        System.exit(PARTIAL_FAILURE_CODE);\n    }\n    &lt;etc...&gt;=\r\n\n}\n\n\nIt should be fairly easy to get something flying by just searching for=\r\n a\nregexp in your source and replacing it with &quot;throw new\nMyExitRuntimeExce=\r\nption(&#92;1);&quot; to get you started.\n\nI think having System.exit in only one pla=\r\nce in the code is a sensible rule,\nhandle all other error conditions with e=\r\nxceptions that are caught at the\n&quot;top level&quot;.\n\nWhile mocking can certainly =\r\nwork it needlessly complex since you need to\ninject the &quot;exiter object&quot; in =\r\nevery class that needs to provide an\nerror-code.\n\nC=E9drics suggestion is a=\r\nn interesting one although I generally sort security\npolicies into the &quot;mor=\r\ne trouble than it&#39;s worth category&quot; especially if\nsecurity is not your main=\r\n concern. That is just one mans opinion though. I\ndid try once to run JUnit=\r\n under a custom policy-file since we were deploying\nit to a constrained env=\r\nironment and I thought it was difficult to get this\nto work both in eclipse=\r\n and ant. I=B4m not excluding the possibility that this\nis simpler in test-=\r\nNG\n\n\n\n\n\nOn 9/8/06, Michael Feathers &lt;mfeathers@...&gt; wrote:\n&gt;\n&gt;  =\r\n Bob Russell wrote:\n&gt;\n&gt; &gt;I&#39;m involved on a project as the QA. To improve my=\r\n development\n&gt; &gt;skills and my JUnit skills, I am writing some JUnit tests. =\r\nToday, I\n&gt; &gt;found that the developer had implemented System.exit(n) through=\r\nout\n&gt; &gt;the application whenever there was a trapped exception.\n&gt; &gt;\n&gt; &gt;Now, =\r\nthe requirements call for the application to return some exit\n&gt; &gt;code telli=\r\nng any downstream processes whether this application was\n&gt; &gt;100% successful=\r\n with no warnings (rc=3D0), 100% successful with\n&gt; &gt;warnings (rc=3D4), not =\r\nsuccessful at all (rc=3D8). However, the only\n&gt; &gt;java mechanism for reporti=\r\nng return codes is System.exit(n), based on\n&gt; &gt;my use of Google.\n&gt; &gt;\n&gt; &gt;My =\r\nJUnit dilemma then, is that System.exit(n) gives the required\n&gt; &gt;applicatio=\r\nn behavior but doesn&#39;t seem to be good for running JUnit\n&gt; &gt;tests from a te=\r\nst suite since System.exit(n) ends the JVM.\n&gt; &gt;\n&gt; &gt;Does anyone have any ins=\r\nights they can share? Since this is my first\n&gt; &gt;post to this forum, I&#39;m hap=\r\npy to Google some more if you&#39;ll only give\n&gt; &gt;me some keyword hint(s) beyon=\r\nd what I&#39;ve already tried: &quot;java exit\n&gt; &gt;code&quot;.\n&gt; &gt;\n&gt; &gt;\n&gt; It&#39;s hard to know=\r\n who to be more upset at.. the developer for littering\n&gt; the app with stati=\r\nc calls or Sun for making the call static, and\n&gt; therefore pretty much unmo=\r\nckable.\n&gt;\n&gt; You may want to provide a try block at the entry point of your =\r\napp and\n&gt; then define an unchecked exception that you can throw instead of =\r\ncalling\n&gt; System.exit. The exception can accept the exit code in its constr=\r\nuctor.\n&gt;\n&gt; It&#39;s not an ideal solution, but it will allow you to slowly refa=\r\nctor to\n&gt; something saner. Your entry point can catch the exception, glean =\r\nthe\n&gt; error code and then call System.exit. You can write tests that catch\n=\r\n&gt; the exception so that you can test the cases where you are supposed to\n&gt; =\r\nexit. If you do do this, make sure that you check for finally-blocks in\n&gt; y=\r\nour exception chain. If they do anything unnice, you&#39;ll have to do\n&gt; someth=\r\nng else.\n&gt;\n&gt; Michael Feathers\n&gt; www.objectmentor.com\n&gt;\n&gt;  \n&gt;\n\n\n[Non-text po=\r\nrtions of this message have been removed]\n\n\n", 
    "profile": "j0hlrogge", 
    "topicId": 17851, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 261856052, 
    "prevInTime": 17860, 
    "contentTrasformed": false, 
    "postDate": "1157709706", 
    "canDelete": false, 
    "nextInTopic": 17862, 
    "prevInTopic": 17860, 
    "headers": {
        "inReplyToHeader": "PDQ1MDBBMzA3LjkwODA2MDBAbWluZHNwcmluZy5jb20+", 
        "messageIdInHeader": "PGI5ZWU1ZTQxMDYwOTA4MDMwMW42ZWU5ZGQ4MHRhMDUzYjA3YjdhOTcyMDBkQG1haWwuZ21haWwuY29tPg==", 
        "referencesHeader": "PGVkcTJzOStvZGVrQGVHcm91cHMuY29tPiA8NDUwMEEzMDcuOTA4MDYwMEBtaW5kc3ByaW5nLmNvbT4="
    }
}