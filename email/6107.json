{
    "numMessagesInTopic": 4, 
    "nextInTime": 6108, 
    "senderId": "pOIGeTbBykhtkNcyJN2gphAKOY6_iFAL2bkUvdbFy2ej9EwJBNZquLGdGahrCQVKKq253TX9lOlvH8hizpSBxgy3BZqjZrtS3c0", 
    "systemMessage": false, 
    "subject": "Re: [junit] loader constraints violated", 
    "from": "Timothy Wall &lt;twall@...&gt;", 
    "authorName": "Timothy Wall", 
    "msgSnippet": "This is the real kicker.  How does JUnit specify the classpath for the code under test?  The original assumption was to use the existing classpath (I suppose", 
    "msgId": 6107, 
    "topicId": 6097, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 106503903, 
    "messageBody": "<div id=\"ygrps-yiv-2071216861\">This is the real kicker.  How does JUnit specify the classpath for the  <br/>\ncode under test?  The original assumption was to use the existing  <br/>\nclasspath (I suppose you can call this the simplest thing that could  <br/>\npossibly work at the time).  But it doesn&#39;t work for a certain class of  <br/>\nproblems, so the choice is either re-do an implementation or use  <br/>\nsomething else.<br/>\n<br/>\nI think it&#39;s probably reasonable to require additional setup if you  <br/>\nwant to reload your test classes (since this wouldn&#39;t break existing  <br/>\nstuff).   Maybe a &quot;test.class.path&quot; property set that the TestRunners  <br/>\ncan use to create a new class loader per test case instance.<br/>\n<br/>\nWhile you might argue that you only want the reloading overhead when  <br/>\nyou really need it, the way tests run now they don&#39;t *really* run in a  <br/>\nclean environment each time, although with most small unit tests that&#39;s  <br/>\nnot really an issue.<br/>\n<br/>\n<br/>\n<blockquote><span title=\"qreply\"> On Tuesday, November 5, 2002, at 08:00 PM, Scott Stirling wrote:<br/>\n<br/>\n&gt; This is indeed the solution.  I&#39;ve yet to see any other working  <br/>\n&gt; solution<br/>\n&gt; for a dynamically reloading classloader.  Every J2EE app server and<br/>\n&gt; Servlet container has had to deal with this same problem to make rapid<br/>\n&gt; dev/deploy cycles possible (ditto for Ant).<br/>\n&gt;<br/>\n&gt; I think Erich Gamma took a stab at fixing this, but I&#39;m not sure why he<br/>\n&gt; never followed through on it.  Busy, probably.<br/>\n&gt;<br/>\n&gt; How can it be made as easy as possible for people to set up their<br/>\n&gt; &quot;test-case classpath?&quot;  Some thought should go into how to implement<br/>\n&gt; this.  Most app server have deploy dirs or component packaging  <br/>\n&gt; contracts<br/>\n&gt; that ensure things get loaded by the appropriate custom classloader(s).<br/>\n&gt; What should JUnit do?<br/>\n&gt;<br/>\n&gt; Scott Stirling<br/>\n&gt;<br/>\n&gt;&gt; -----Original Message-----<br/>\n&gt;&gt; From: Timothy Wall [mailto:<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:twall@...\">twall@...</a>]<br/>\n&gt;&gt; Sent: Tuesday, November 05, 2002 7:43 AM<br/>\n&gt;&gt; To: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\n&gt;&gt; Subject: Re: [junit] loader constraints violated<br/>\n&gt;&gt;<br/>\n&gt;&gt;<br/>\n&gt;&gt; I think the real solution to the (broken) class loader is to<br/>\n&gt;&gt; fix it so<br/>\n&gt;&gt; that it only searches a more narrowly specified classpath<br/>\n&gt;&gt; when loading<br/>\n&gt;&gt; test classes, delegating loading of all other classes to the<br/>\n&gt;&gt; app class<br/>\n&gt;&gt; loader (or some other suitably defined parent).<br/>\n&gt;&gt;<br/>\n&gt;&gt; The custom class loader doesn&#39;t even have to &quot;preload&quot; the test<br/>\n&gt;&gt; classes, since its parent will not find the test classes in<br/>\n&gt;&gt; question.<br/>\n&gt;&gt; As long as a new instance is used for each test case, you<br/>\n&gt;&gt; will have a<br/>\n&gt;&gt; fresh load of the class under test on each run.<br/>\n&gt;&gt;<br/>\n&gt;&gt; A URLClassLoader might even be sufficient for this purpose.<br/>\n&gt;&gt;<br/>\n&gt;&gt; If I get some time I&#39;ll submit a patch, since I&#39;m using a similar<br/>\n&gt;&gt; solution for the abbot junit extension...<br/>\n&gt;&gt;<br/>\n&gt;&gt; On Monday, November 4, 2002, at 01:57 AM, Chris wrote:<br/>\n&gt;&gt;<br/>\n&gt;&gt;&gt; Here&#39;s a weird error and the solution, so that the next poor shmuck<br/>\n&gt;&gt;&gt; can find it:<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; When running a junit test suite via Ant, I got this error: [junit]<br/>\n&gt;&gt;&gt; loader constraints violated when linking<br/>\n&gt;&gt; org/xml/sax/InputSource class<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; This appeas to be the same problem with junit&#39;s custom class loader<br/>\n&gt;&gt;&gt; that is widely documented, and solved by adding<br/>\n&gt;&gt;&gt; excluded.6=org.w3c.dom.* and excluded.7=org.xml.sax.* to the file<br/>\n&gt;&gt;&gt; excluded.properties. Only problem is, I already have those lines.<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; The root of the problem for me was that I had jrun.jar in my<br/>\n&gt;&gt;&gt; classpath. jrun.jar is an 8 meg monster that comes with JRun4 and<br/>\n&gt;&gt;&gt; includes its own copy of the sax classes. Taking jrun.jar out of my<br/>\n&gt;&gt;&gt; classpath solved the problem and the tests ran fine.<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; If anyone happens to know why, I&#39;d like to hear it.<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; ------------------------ Yahoo! Groups Sponsor  <br/>\n&gt; ---------------------~--&gt;<br/>\n&gt; Get 128 Bit SSL Encryption!<br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"http://us.click.yahoo.com/JjlUgA/vN2EAA/kG8FAA/5cFolB/TM\">http://us.click.yahoo.com/JjlUgA/vN2EAA/kG8FAA/5cFolB/TM</a><br/>\n&gt; --------------------------------------------------------------------- <br/>\n&gt; ~-&gt;<br/>\n&gt;<br/>\n&gt; To unsubscribe from this group, send an email to:<br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit-unsubscribe@yahoogroups.com\">junit-unsubscribe@yahoogroups.com</a><br/>\n&gt;<br/>\n&gt;<br/>\n&gt; Your use of Yahoo! Groups is subject to  <br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"http://docs.yahoo.com/info/terms/\">http://docs.yahoo.com/info/terms/</a><br/>\n&gt;<br/>\n&gt; </span></blockquote></div>", 
    "prevInTime": 6106, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1036584637", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 6101, 
    "headers": {
        "inReplyToHeader": "PDAwMDAwMWMyODUyZiRlMTJhMmQzMCQwNTAxYThjMEBqYXZhbGFwdG9wPg==", 
        "messageIdInHeader": "PEMyNjA5RURDLUYxODAtMTFENi05NDJFLTAwMzA2NUJGODNEQUBvY3VsdXN0ZWNoLmNvbT4="
    }
}