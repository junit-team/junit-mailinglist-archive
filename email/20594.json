{
    "numMessagesInTopic": 8, 
    "nextInTime": 20595, 
    "senderId": "h7gcbb_70D23I79YfJlb4owozuAWwRN_mlnDVEB8vfiyvvB7PDsiI595Lga0kyARuRazzejKIxoxyxVSSEYyajGi7QGq7LAP", 
    "systemMessage": false, 
    "subject": "Re: [junit] Testing code that depends on today&#39;s date", 
    "from": "&quot;Nat Pryce&quot; &lt;nat.pryce@...&gt;", 
    "authorName": "Nat Pryce", 
    "msgSnippet": "There are two things you can do.  A) separate code that performs calculations on dates from the code that gets the current date.  B) get the current date get", 
    "msgId": 20594, 
    "profile": "nat_pryce", 
    "topicId": 20590, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 216973656, 
    "messageBody": "<div id=\"ygrps-yiv-974724744\">There are two things you can do.  A) separate code that performs<br/>\ncalculations on dates from the code that gets the current date.  B)<br/>\nget the current date get it through an abstract interface.<br/>\n<br/>\nE.g. suppose I have a method like...<br/>\n<br/>\n   Money currentValue() {<br/>\n       Date today = new Date();<br/>\n       ...<br/>\n   }<br/>\n<br/>\nI&#39;d turn that into:<br/>\n<br/>\n    Money valueAt(Date date) {<br/>\n        ...<br/>\n    }<br/>\n<br/>\nand have another object decide what date to pass in.<br/>\n<br/>\nThat other object can get the date through an abstract interface. (I<br/>\nusually call that interface &quot;Clock&quot; to avoid confusion with the<br/>\nexisting java.util.Calendar class).  I find its usually one of the<br/>\nfirst things I write on every project -- if only it was in the<br/>\nstandard library.<br/>\n<br/>\nI find that separating calculation with dates from the choice of date<br/>\nto use means I don&#39;t have to pass the clock around everywhere.  It<br/>\nalso makes the code more flexible.  It can, if asked to, implement<br/>\nwhat-if calculations without major redesign, for example.<br/>\n<br/>\n--Nat<br/>\n<br/>\n<br/>\n2008/6/17 Per Jacobsson &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:perjacobsson@...\">perjacobsson@...</a>&gt;:<br/>\n<blockquote><span title=\"qreply\"> &gt; Hi,<br/>\n&gt; This has been annoying me for a while and I can&#39;t think of a clean solution<br/>\n&gt; for it. Hope this makes sense: I have some code that returns different<br/>\n&gt; results depending on what today&#39;s date is (the number of days since a user<br/>\n&gt; first registered, etc). The simple approach is to just create a new instance<br/>\n&gt; of java.util.Date whenever I need to know the current date, but that tends<br/>\n&gt; to make both unit and automated functional testing difficult.<br/>\n&gt;<br/>\n&gt; I&#39;m currently injecting today&#39;s date into the classes that need it, and then<br/>\n&gt; the tests can just use a static date. It gets pretty ugly though, a lot of<br/>\n&gt; times this date has to be dragged along deep into the domain model.<br/>\n&gt;<br/>\n&gt; An alternative would be to take the old school approach and have a static<br/>\n&gt; factory that everything that needs to know today&#39;s date calls, and allow the<br/>\n&gt; unit tests to override with a test date. Of course, then you run into all<br/>\n&gt; the other issues that dependency injection solves.<br/>\n&gt;<br/>\n&gt; Any thoughts?<br/>\n&gt; Thanks,<br/>\n&gt; / Per<br/>\n&gt;<br/>\n&gt; [Non-text portions of this message have been removed]<br/>\n&gt;<br/>\n&gt; </span></blockquote></div>", 
    "prevInTime": 20593, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1213773984", 
    "canDelete": false, 
    "nextInTopic": 20596, 
    "prevInTopic": 20593, 
    "headers": {
        "inReplyToHeader": "PDg2MEQ0N0Y4OTA0RjYwNDFBRUVFNTVGOUI2ODQ2NjdGMTYyRDQ2RUYwNUBFWENIQU5HRS1WUzEuZWhhcm1vbnkuY29tPg==", 
        "messageIdInHeader": "PDE3ZmE1M2QwODA2MTgwMDI2cjdjMTU2ZmRlaDY4MWRhNTY0YzA1M2I0NjZAbWFpbC5nbWFpbC5jb20+", 
        "referencesHeader": "PDg2MEQ0N0Y4OTA0RjYwNDFBRUVFNTVGOUI2ODQ2NjdGMTYyRDQ2RUYwNUBFWENIQU5HRS1WUzEuZWhhcm1vbnkuY29tPg=="
    }
}