{
    "numMessagesInTopic": 22, 
    "nextInTime": 5079, 
    "senderId": "TTZHRHrh4pL7INr5YC28Bb_7l7sS7beayQxL9LfCmoTrvetEs1gCi-h6JY3pW8ggsJIwVY06X7lqBHbWW4Q4ouOZlbUh1Zgb6mYJtBjs", 
    "systemMessage": false, 
    "subject": "RE: [junit] Re: Asserting Equality Of Collection Elements", 
    "from": "&quot;Berin Loritsch&quot; &lt;bloritsch@...&gt;", 
    "authorName": "Berin Loritsch", 
    "msgSnippet": "... Are you trying to implement a new Map type?  I have some experience doing just that (I implemented the BucketMap in Avalon collections-- a Map that", 
    "msgId": 5078, 
    "rawEmail": "Return-Path: &lt;bloritsch@...&gt;\r\nX-Sender: bloritsch@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (EGP: mail-8_0_3_2); 31 May 2002 15:35:29 -0000\r\nReceived: (qmail 20067 invoked from network); 31 May 2002 15:35:29 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m9.grp.scd.yahoo.com with QMQP; 31 May 2002 15:35:29 -0000\r\nReceived: from unknown (HELO failover.kc.aoindustries.com) (209.15.201.72)\n  by mta1.grp.scd.yahoo.com with SMTP; 31 May 2002 15:35:29 -0000\r\nReceived: from Gabriel ([65.105.132.131])\n\tby failover.kc.aoindustries.com (8.11.6/8.11.0) with ESMTP id g4VFZSI03288\n\tfor &lt;junit@yahoogroups.com&gt;; Fri, 31 May 2002 10:35:28 -0500\r\nTo: &lt;junit@yahoogroups.com&gt;\r\nSubject: RE: [junit] Re: Asserting Equality Of Collection Elements\r\nDate: Fri, 31 May 2002 11:35:12 -0400\r\nMessage-ID: &lt;002f01c208b8$c155de30$ac00a8c0@Gabriel&gt;\r\nMIME-Version: 1.0\r\nContent-Type: text/plain;\n\tcharset=&quot;us-ascii&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Priority: 3 (Normal)\r\nX-MSMail-Priority: Normal\r\nX-Mailer: Microsoft Outlook, Build 10.0.2627\r\nIn-Reply-To: &lt;20020529121324.M56873@...&gt;\r\nX-MimeOLE: Produced By Microsoft MimeOLE V6.00.2600.0000\r\nImportance: Normal\r\nFrom: &quot;Berin Loritsch&quot; &lt;bloritsch@...&gt;\r\nReply-To: &lt;bloritsch@...&gt;\r\nX-Yahoo-Group-Post: member; u=64910131\r\nX-Yahoo-Profile: bloritsch\r\n\r\n&gt; From: J. B. Rainsberger [mailto:jbr@...] \n&gt; &gt; If multiple=\r\n elements hash to the same\n&gt; &gt; value is there a way to tell that their are =\r\nmultiple elements for \n&gt; &gt; that hashvalue? The size() method will only tell=\r\n me how many hash \n&gt; &gt; values there are.\n&gt; \n&gt; It shouldn&#39;t. If it does, you=\r\n&#39;re doing something else wrong. \n&gt; Post sample code \n&gt; if you&#39;re unsure. si=\r\nze() answers the number of distinct \n&gt; (according to equals\n&gt; ()) keys in t=\r\nhe Map.\n&gt; \n&gt; Remember, hashing is only used to get a &quot;good first guess&quot; of =\r\n\n&gt; where an \n&gt; element is located in a collection; other than that, hashing=\r\n \n&gt; means nothing.\n\nAre you trying to implement a new Map type?  I have som=\r\ne experience\ndoing just that (I implemented the BucketMap in Avalon collect=\r\nions--\na Map that internally synchronizes on the unique hash values in the\n=\r\nmap).\n\nHashing is generally most useful on the keys used in the Map.  I\nhav=\r\nen&#39;t found a place where the are genuinely useful outside of that\ncontext.\n=\r\n\nThe Java Map interface does not expose anything about the internal\nstructu=\r\nre of the map, except as the entry set.  You can get it here:\n\nMap myMap =\r\n=3D new HashMap(); // or BucketMap, etc.\nSet entries =3D myMap.entrySet();\n=\r\n\n// entries have Map.Entry interface\n\nIterator I =3D entries.iterator();\nwh=\r\nile( I.hasNext() )\n{\n    Map.Entry e =3D (Map.Entry) I.next();\n\n    long ha=\r\nsh =3D e.hashCode(); // reflects the hashcode for the entry,\n              =\r\n                // typically the key&#39;s hashCode mod # of\nbuckets\n\n    Objec=\r\nt key =3D e.getKey();\n    Object value =3D e.getValue();\n    e.setValue(new=\r\n Object()); // you can change the value, but not the\nkey.\n}\n\n\nNow, when I r=\r\nefer to buckets, I am referring to the internal array\nof hash entries that =\r\nthe map tracks.  In the BucketMap in Avalon, I\nset it up so that the initia=\r\nl size of the BucketMap array was 31, but\nit could be changed to any odd nu=\r\nmber.  Why an odd number?  Because\nthe default algorithm for Object.hashCod=\r\ne() is the memory address\nwhere the Object is located.  Memory objects are =\r\nalways even, and\nvery regular (aligned every four to eight bytes).  If the =\r\nnumber of\nbuckets was even, the objects were stored in one of two buckets--=\r\n\nleaving the rest of them untouched.\n\nThe internal structure was like this:=\r\n\n\nEntry[] m_buckets; // constructor set the entries--for our example\n\nlong =\r\nstoreHash =3D key.hashCode() % m_buckets.length;\nm_buckets[storeHash] //.ad=\r\nd entry....\n\n// storeHash ~ Bucket\n\nThis is just enough to show what I mean=\r\n.\n\nThe storeHash (or Map hash entry) is a smaller number than the\nkey&#39;s has=\r\nhCode.  Knowing the algorithm for the storeHash (rather\nsimplistic, I know)=\r\n allowed me to run some tests on real data.\n\nI created a couple of test cla=\r\nsses (not in the JUnit sense, I\nwas interested in output series, not pass/f=\r\nail testing) to see\nwhy my BucketMap wasn&#39;t performing as well as I had exp=\r\nected.\nI found that if I had an even number (esp. one that was a power\nof 2=\r\n), two of my 32 buckets ware used--and 30 were not!  I then\nchanged the num=\r\nber by one.  Presto!  The hash entries were dispersed\nfar more equally.  It=\r\n is even better when you have an odd prime\nnumber (not 2).\n\nFor the BucketM=\r\nap, it was important to spread the entries across\nthe different buckets bec=\r\nause synchronization was provided at that\nlevel.  I could have two threads =\r\nusing and modifying the BucketMap\nwith fewer opportunities for thread conte=\r\nntion--the whole purpose\nof the BucketMap.\n\nIf you want to see the source c=\r\node, you can get it at\n\nhttp://cvs.apache.org/viewcvs/jakarta-avalon-excali=\r\nbur/collections/src/j\nava/org/apache/avalon/excalibur/collections/BucketMap=\r\n.java?rev=3D1.15&cont\nent-type=3Dtext/vnd.viewcvs-markup\n\nI&#39;m not sure what=\r\n you are testing, but hopefully my experience\nwill help you out.\n\n\n", 
    "profile": "bloritsch", 
    "topicId": 5046, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 64910131, 
    "prevInTime": 5077, 
    "contentTrasformed": false, 
    "postDate": "1022859312", 
    "canDelete": false, 
    "nextInTopic": 5095, 
    "prevInTopic": 5072, 
    "headers": {
        "inReplyToHeader": "PDIwMDIwNTI5MTIxMzI0Lk01Njg3M0BkaWFzcGFyc29mdHdhcmUuY29tPg==", 
        "messageIdInHeader": "PDAwMmYwMWMyMDhiOCRjMTU1ZGUzMCRhYzAwYThjMEBHYWJyaWVsPg=="
    }
}