{
    "numMessagesInTopic": 8, 
    "nextInTime": 9511, 
    "senderId": "2ABm34CCWdNGidomk8vriqXdh8q_qvMNQGxph4gy9Ylum04qb9PCquB60mLWpHhtErf_RZgJTEwhL9F3yjYiegjnIv-J_t0SuVM", 
    "systemMessage": false, 
    "subject": "Re: [junit] How to test threaded method?", 
    "from": "Timothy Wall &lt;twall@...&gt;", 
    "authorName": "Timothy Wall", 
    "msgSnippet": "Do a wait on a shared object; when all events have been fired, do a notify.  On the original wait, set your max timeout, e.g. final Object lock = new Object();", 
    "msgId": 9510, 
    "topicId": 9506, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 106503903, 
    "messageBody": "<div id=\"ygrps-yiv-101298328\">Do a wait on a shared object; when all events have been fired, do a  <br/>\nnotify.  On the original wait, set your max timeout, e.g.<br/>\n<br/>\nfinal Object lock = new Object();<br/>\nsynchronized(lock) {<br/>\n\tlock.wait(TIMEOUT_INTERVAL);<br/>\n}<br/>\nassertEquals(eventsExpected, eventsReceived);<br/>\n<br/>\nOn your event-listening thread:<br/>\n<br/>\nsynchronized(lock) {<br/>\n\t// after all events have been sent<br/>\n\tlock.notifyAll();<br/>\n}<br/>\n<br/>\n<blockquote><span title=\"qreply\"> On Thursday, September 25, 2003, at 07:14 PM, Kris Henderson wrote:<br/>\n<br/>\n&gt; I have a method that when called creates a thread and does all its work<br/>\n&gt; in the new thread.  It looks kind of like this:<br/>\n&gt;<br/>\n&gt; public void doSomething()<br/>\n&gt; {<br/>\n&gt;     Thread requestThread = new Thread()<br/>\n&gt;     {<br/>\n&gt;         public void run()<br/>\n&gt;         {<br/>\n&gt;             fireStartEvent();<br/>\n&gt;<br/>\n&gt;             //do some stuff that takes a long time<br/>\n&gt;<br/>\n&gt;             fireDoneEvent();<br/>\n&gt;         }<br/>\n&gt;     };<br/>\n&gt;     requestThread.start();<br/>\n&gt; }<br/>\n&gt;<br/>\n&gt; I would like to test this method to make sure it sends the correct<br/>\n&gt; events in the correct order and that the EventObject contains the<br/>\n&gt; correct data.<br/>\n&gt;<br/>\n&gt; So I wrote a test that looks like this:<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; public void testDoSomething()<br/>\n&gt; {<br/>\n&gt;     m_eventCount = 0;<br/>\n&gt;     final MockService service = new MockService();<br/>\n&gt;     service.addOperationListener(new OperationAdapter()<br/>\n&gt;     {<br/>\n&gt;         public void operationUpdate(OperationEvent event)<br/>\n&gt;         {<br/>\n&gt;             m_eventCount += 1;<br/>\n&gt;         }<br/>\n&gt;     });<br/>\n&gt;<br/>\n&gt;     service.doSomething();<br/>\n&gt;<br/>\n&gt;     assertEquals(2, m_eventCount);<br/>\n&gt; }<br/>\n&gt;<br/>\n&gt; My test fails because it reaches the assertEquals before all the events<br/>\n&gt; can be fired.  If I add a call to Thread.sleep after the call to<br/>\n&gt; doSomething() then the test succeeds.  Does anyone know a better way to<br/>\n&gt; test this so I don&#39;t have to add a call to Thread.sleep?<br/>\n&gt;<br/>\n&gt; Thanks,<br/>\n&gt; Kris<br/>\n&gt;<br/>\n&gt; ------------------------ Yahoo! Groups Sponsor  <br/>\n&gt; ---------------------~--&gt;<br/>\n&gt; Upgrade to 128-Bit SSL Security!<br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"http://us.click.yahoo.com/p7cEmB/s7qGAA/yigFAA/5cFolB/TM\">http://us.click.yahoo.com/p7cEmB/s7qGAA/yigFAA/5cFolB/TM</a><br/>\n&gt; --------------------------------------------------------------------- <br/>\n&gt; ~-&gt;<br/>\n&gt;<br/>\n&gt; To unsubscribe from this group, send an email to:<br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit-unsubscribe@yahoogroups.com\">junit-unsubscribe@yahoogroups.com</a><br/>\n&gt;<br/>\n&gt;<br/>\n&gt; Your use of Yahoo! Groups is subject to  <br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"http://docs.yahoo.com/info/terms/\">http://docs.yahoo.com/info/terms/</a><br/>\n&gt;<br/>\n&gt; </span></blockquote></div>", 
    "prevInTime": 9509, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1064592062", 
    "canDelete": false, 
    "nextInTopic": 9511, 
    "prevInTopic": 9506, 
    "headers": {
        "inReplyToHeader": "PEY3QjE2RUI4OTg0QjE0NDA5QUNCMDE1RjEzMjZCQjY2MUZGMkE4QEFUTDFWRVhDMDA1LnVzZG9tMDA0LnRjby50Yz4=", 
        "messageIdInHeader": "PEEwNzE0NEEwLUYwM0EtMTFENy05MTlFLTAwMzA2NUJGODNEQUBvY3VsdXN0ZWNoLmNvbT4="
    }
}