{
    "numMessagesInTopic": 8, 
    "nextInTime": 22936, 
    "senderId": "YHTm5uR5D86sLCwKmZBvOYA5lyfEmrHSxEtkTVqOdWk5KGn0uBZYP6ecTeA0580C3f-PnAXmqrkCsWiJcYc-02LBcg1s", 
    "systemMessage": false, 
    "subject": "Re: [junit] Common Test Runner for JVM", 
    "from": "Bill Venners &lt;bill@...&gt;", 
    "authorName": "Bill Venners", 
    "msgSnippet": "Hi Esko, David, ... them is that is that you can make a progress bar that gives feedback to the user as the tests run. That s a really nice feature in GUI test", 
    "msgId": 22935, 
    "profile": "billvenners", 
    "topicId": 22933, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 416990097, 
    "messageBody": "<div id=\"ygrps-yiv-1231203517\">Hi Esko, David,<br/>\n<br/>\n<blockquote><span title=\"qreply\"> On Mon, Sep 13, 2010 at 7:09 AM, David Saff &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:david@...\">david@...</a>&gt; wrote:<br/>\n<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; Esko,<br/>\n&gt;<br/>\n&gt; This is a lot to absorb all at once. I&#39;d love to go down the list and<br/>\n&gt; see what makes sense outside JUnit vs. inside JUnit. I notice that a<br/>\n&gt; number of the issues you&#39;re tackling are mostly about IDE<br/>\n&gt; integration--I wonder if thinking about the interface you wish IDEs<br/>\n&gt; would talk to, and then getting at least one IDE to agree to it, would<br/>\n&gt; be a good approach. I&#39;ve tackled a few of your questions below--going<br/>\n&gt; deep on one of them, of your choice, might be the most productive way<br/>\n&gt; forward, rather than trying to hit all of them at once.<br/>\n&gt;<br/>\n&gt; David Saff<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; On Sat, Sep 11, 2010 at 6:08 PM, Esko Luontola &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:esko.luontola@...\">esko.luontola@...</a>&lt;esko.luontola%40gmail.com&gt;&gt;<br/>\n&gt; wrote:<br/>\n&gt; &gt; I&#39;ll soon start writing a new test runner - a common test runner for the<br/>\n&gt; &gt; JVM, codename CTR4J. It will provide a superset of JUnit&#39;s test runner&#39;s<br/>\n&gt; &gt; features, while at the same time overcoming some of JUnit&#39;s limitations<br/>\n&gt; &gt; and helping integration with development tools. I would like to hear<br/>\n&gt; &gt; your opinions on this project.<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt;        MOTIVATION<br/>\n&gt; &gt;<br/>\n&gt; &gt; JUnit&#39;s test runner - especially the org.junit.runner.RunWith annotation<br/>\n&gt; &gt; - has been very successful in providing a common interface for running<br/>\n&gt; &gt; tests from multiple testing frameworks. If a testing framework provides<br/>\n&gt; &gt; a org.junit.runner.Runner implementation, every Java build tool and IDE<br/>\n&gt; &gt; will automatically support the framework.<br/>\n&gt; &gt;<br/>\n&gt; &gt; However with the rise of Scala testing frameworks (Specs, ScalaTest,<br/>\n&gt; &gt; Specsy - the last one being written by me), some limitations of JUnit&#39;s<br/>\n&gt; &gt; test runner are coming to the fore:<br/>\n&gt; &gt;<br/>\n&gt; &gt; - JUnit makes an implicit assumption that all tests are known before any<br/>\n&gt; &gt; test code is executed. For example IntelliJ IDEA calls<br/>\n&gt; &gt; Runner.getDescription() before calling Runner.run() and has problems if<br/>\n&gt; &gt; the descriptions change during test execution. But in the Scala testing<br/>\n&gt; &gt; frameworks, in order to achieve a concise syntax, test declarations are<br/>\n&gt; &gt; implemented as method calls in the class constructor, which means that<br/>\n&gt; &gt; at least some of the test code must be executed before it is known that<br/>\n&gt; &gt; what tests there are.<br/>\n&gt;<br/>\n&gt; There are advantages to the &quot;declare everything before running<br/>\n&gt; anything&quot; requirement from JUnit, but I agree that it also makes some<br/>\n&gt; things very difficult. I&#39;d love to see a standard way to address this<br/>\n&gt; within JUnit.<br/>\n&gt;<br/>\n&gt; I think the main advantage to being able to count the tests before you run<br/>\nthem is that is that you can make a progress bar that gives feedback to the<br/>\nuser as the tests run. That&#39;s a really nice feature in GUI test runners that<br/>\nis lost if you can&#39;t count tests in advance. It would be possible to make<br/>\nthe advance test count an optional feature, but then when tests can&#39;t be<br/>\ncounted, you couldn&#39;t show a progress bar. And I think that would be a<br/>\npretty big loss.<br/>\n<br/>\nThe downside of the requirement is it becomes difficult to use the same<br/>\ntoken all the way down nested closures (like you use &quot;&gt;&gt;&quot; in Specsy). If you<br/>\nuse a different character to denote leaf nodes, then  those leaf nodes (the<br/>\ntests) can be counted (and their names known, etc.) before they are run.<br/>\nThat&#39;s what I do in ScalaTest. The other thing you can do is run all test<br/>\ncode at construction time, and just store results to be reported later. I<br/>\nthink that&#39;s what Eric Torreborre does in Specs, because he also uses the<br/>\nsame &quot;&gt;&gt;&quot; or &quot;in&quot; token all the way down.<br/>\n<br/>\nThis is a design tradeoff, and I think the world wants to keep their<br/>\nprogress bar and can live with the above two approaches to nested closures<br/>\nin Scala test code.<br/>\n<br/>\n<br/>\n&gt; &gt; - JUnit doesn&#39;t know the concept of nested tests. It knows the concept<br/>\n&gt; &gt; of suites containing suites, but not &quot;test methods&quot; which contain other<br/>\n&gt; &gt; &quot;test methods&quot;. But at least Specs and Specsy allow organizing tests<br/>\n&gt; &gt; into unlimitedly nested closures. For them this limitation means that<br/>\n&gt; &gt; IDEs are not able to show the right mental model of what is really<br/>\n&gt; &gt; happening during test execution, which makes understanding test output<br/>\n&gt; &gt; harder.<br/>\n&gt;<br/>\n&gt; In terms of IDE integration, JUnit just reports a tree of<br/>\n&gt; Descriptions, and results against them. Runners are free to structure<br/>\n&gt; these trees however they wish. Have you run into IDE limitations for<br/>\n&gt; displaying/interacting with these trees?<br/>\n&gt;<br/>\n&gt; I would question the need for nesting tests. I can easily see the benefit<br/>\nof nesting closures in test code. Several traits in ScalaTest do that, but<br/>\nthe model I use in ScalaTest is that each leaf node is one test. The<br/>\nclosures surrounding the leaf nodes are descriptions, not tests themselves.<br/>\nI would think you and Eric could  adopt that approach in Specs and Specsy<br/>\nwithout much trouble.<br/>\n<br/>\nBill<br/>\n<br/>\n<br/>\n&gt; &gt; - There is an implicit assumption that test names are the same as method<br/>\n&gt; &gt; names, and that the tests are implemented as methods. For example in<br/>\n&gt; &gt; IntelliJ IDEA it&#39;s possible to navigate from the test results into test<br/>\n&gt; &gt; methods. But with the Scala frameworks this is not possible, because the<br/>\n&gt; &gt; test names to not correspond any method declaration (and a string search<br/>\n&gt; &gt; is not 100% reliable because the test name could be generated<br/>\n&gt; &gt; dynamically or there could be multiple tests with the same name; at<br/>\n&gt; &gt; least Specsy allows duplicate names).<br/>\n&gt;<br/>\n&gt; That assumption is in the IDE&#39;s. It&#39;s a useful one, but it&#39;s neither<br/>\n&gt; required nor assumed by JUnit itself.<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; &gt; There are also some other limitations which affect all Java testing<br/>\n&gt; &gt; frameworks:<br/>\n&gt; &gt;<br/>\n&gt; &gt; - When a test prints something, IntelliJ IDEA collects what is printed<br/>\n&gt; &gt; to stdout and stderr, so that when you select a test in the test<br/>\n&gt; &gt; results, it will show only what that test printed. This is very useful<br/>\n&gt; &gt; for debugging with println-statements. But because there is no<br/>\n&gt; &gt; synchronization between the test runner and the IDE which reads the<br/>\n&gt; &gt; stdout/err, IDEA doesn&#39;t always associate what a test printed with the<br/>\n&gt; &gt; correct test, especially when the tests are very fast.<br/>\n&gt;<br/>\n&gt; &gt; - No built-in support for executing the tests in parallel. Third-party<br/>\n&gt; &gt; tools are needed for it.<br/>\n&gt;<br/>\n&gt; We&#39;ve taken several stabs at this. The biggest hurdle is how to<br/>\n&gt; extend the test-definition language: while many tests can be<br/>\n&gt; parallelized without cost, and test writers should not depend on<br/>\n&gt; order, they currently might depend on only test being written at the<br/>\n&gt; time.<br/>\n&gt;<br/>\n&gt; &gt; Possibly because of being faced with the above limitations, at least<br/>\n&gt; &gt; Specs, ScalaTest and TestNG have implemented their own test runners.<br/>\n&gt; &gt; This in turn means that the IDEs need to support each test runner<br/>\n&gt; &gt; individually, which results in varying levels of quality and features<br/>\n&gt; &gt; between the integration with different test runners. For example, at<br/>\n&gt; &gt; least some time ago, IDEA&#39;s Scala plugin did not support automatically<br/>\n&gt; &gt; finding all Specs tests in the project and executing them.<br/>\n&gt;<br/>\n&gt; Test discovery seems to be yet another feature of a common IDE interface.<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; &gt; There is also code duplication inside and between all IDEs, build tools<br/>\n&gt; &gt; and CI servers because they have had to write code to keep track of the<br/>\n&gt; &gt; test execution state, and that needs to be repeated for each test runner.<br/>\n&gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt;        THE PROJECT<br/>\n&gt; &gt;<br/>\n&gt; &gt; I&#39;ll soon start writing a test runner to solve the above mentioned<br/>\n&gt; &gt; limitations and to ease the integration with build tools, IDEs, CI<br/>\n&gt; &gt; servers etc. The license will be Apache License 2.0. I&#39;m also thinking<br/>\n&gt; &gt; of making this not only open source, but also &quot;open development&quot;, by<br/>\n&gt; &gt; screencasting similar to <a rel=\"nofollow\" target=\"_blank\" href=\"http://jamesshore.com/Blog/Lets-Play/\">http://jamesshore.com/Blog/Lets-Play/</a><br/>\n&gt; &gt;<br/>\n&gt; &gt; What the test runner will provide to testing frameworks, is a superset<br/>\n&gt; &gt; of the features provided by these JUnit classes: RunWith, Runner,<br/>\n&gt; &gt; Description, RunNotifier. The API will be a bit more generic and with<br/>\n&gt; &gt; new abstractions, in order to support for example nested tests.<br/>\n&gt; &gt;<br/>\n&gt; &gt; What the test runner will provide to IDEs, build tools and CI servers,<br/>\n&gt; &gt; is a library for launching the tests in a new VM instance, monitoring<br/>\n&gt; &gt; the test execution status, collecting the test results and what was<br/>\n&gt; &gt; printed to stdout/err etc. The tools just need to configure the<br/>\n&gt; &gt; classpath and choose which tests to run (e.g. using file name patters).<br/>\n&gt; &gt; I will also provide a reference implementation of an UI for running the<br/>\n&gt; &gt; tests, because running tests as part of the TDD cycle is too important a<br/>\n&gt; &gt; feature for its usability to be left in the hands of programmers without<br/>\n&gt; &gt; interaction design skills.<br/>\n&gt; &gt;<br/>\n&gt; &gt; What the test runner will provide to users, is running tests from all<br/>\n&gt; &gt; testing frameworks (which support this runner or JUnit&#39;s test runner) in<br/>\n&gt; &gt; one suite, running them in parallel on multiple CPU cores (I&#39;ll tackle<br/>\n&gt; &gt; parallelization over multiple machines as a separate project, probably<br/>\n&gt; &gt; as a commercial tool), integration with every development tool on the<br/>\n&gt; &gt; JVM (I intend to contact all tool vendors and gather requirements from<br/>\n&gt; &gt; them to ease the integration) and reliability (backwards compatiblity is<br/>\n&gt; &gt; very important to me, and I plan on making it possible for each tool<br/>\n&gt; &gt; vendor to write integration tests, which will be run as part of the test<br/>\n&gt; &gt; runner&#39;s development builds, to detect any breaking changes).<br/>\n&gt; &gt;<br/>\n&gt; &gt; So, I would like to ask for your opinion on this project. Here are some<br/>\n&gt; &gt; questions:<br/>\n&gt; &gt;<br/>\n&gt; &gt; - Do you find this useful?<br/>\n&gt; &gt;<br/>\n&gt; &gt; - If you had the possibility to rewrite JUnit&#39;s test runner, without<br/>\n&gt; &gt; having to think about backwards compatibility, what would you do<br/>\n&gt; &gt; differently? @RunWith&#39;s javadoc says: &quot;We added this feature late in<br/>\n&gt; &gt; development. While it seems powerful we expect the runner API to change<br/>\n&gt; &gt; as we learn how people really use it. Some of the classes that are<br/>\n&gt; &gt; currently internal will likely be refined and become public.&quot;<br/>\n&gt; &gt;<br/>\n&gt; &gt; - What do you think would be a good name for the project? One suggestion<br/>\n&gt; &gt; is CTR4J (actually named similar to SLF4J) which is googleable, but<br/>\n&gt; &gt; perhaps not very pronounceable or memorable.<br/>\n&gt; &gt;<br/>\n&gt; &gt; - What would be a good name for the annotation which corresponds<br/>\n&gt; &gt; @RunWith? Its name needs to be different to be googleable and to make it<br/>\n&gt; &gt; easy to annotate a class with both JUnit&#39;s and this test runner&#39;s<br/>\n&gt; &gt; annotation.<br/>\n&gt; &gt;<br/>\n&gt; &gt; - Any other thoughts?<br/>\n&gt; &gt;<br/>\n&gt; &gt; --<br/>\n&gt; &gt; Esko Luontola<br/>\n&gt; &gt; www.orfjackal.net<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt; ------------------------------------<br/>\n&gt; &gt;<br/>\n&gt; &gt; Yahoo! Groups Links<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt;  <br/>\n&gt;<br/>\n<br/>\n<br/>\n<br/>\n-- <br/>\nBill Venners<br/>\nArtima, Inc.<br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.artima.com\">http://www.artima.com</a><br/>\n<br/>\n<br/>\n[Non-text portions of this message have been removed] </span></blockquote></div>", 
    "prevInTime": 22934, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1284392173", 
    "canDelete": false, 
    "nextInTopic": 22936, 
    "prevInTopic": 22934, 
    "headers": {
        "inReplyToHeader": "PEFBTkxrVGluNEFYazhCR2NiWEdmbTY4S1FGekxxYlZ6ayttMjJDcmNVZ1J0MUBtYWlsLmdtYWlsLmNvbT4=", 
        "messageIdInHeader": "PEFBTkxrVGltMTFPUk82OGlyRmhIclZDQnZxSDh2SzlCUUcyNndpVXhXZDlaZEBtYWlsLmdtYWlsLmNvbT4=", 
        "referencesHeader": "PDRDOEJGREU3LjMwMTA2MDNAZ21haWwuY29tPgk8QUFOTGtUaW40QVhrOEJHY2JYR2ZtNjhLUUZ6THFiVnprK20yMkNyY1VnUnQxQG1haWwuZ21haWwuY29tPg=="
    }
}