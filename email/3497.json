{
    "numMessagesInTopic": 3, 
    "nextInTime": 3498, 
    "senderId": "U0B_psncJq5vJo3IQWPY9iQg9V2SCezDX4OVXNapJTGxXaJQLxykeAvxjlWMpLFAkqCekshyOWurvOGp1_4389JwEdqx8DGj", 
    "systemMessage": false, 
    "subject": "trouble with JUnit and XML", 
    "from": "&quot;nthali&quot; &lt;nilesh.thali@...&gt;", 
    "authorName": "nthali", 
    "msgSnippet": "We are not able to run any JUnit tests for any of our classes that use XML. We get a java.lang.IncompatibleClassChangeError . Using a main() method within", 
    "msgId": 3497, 
    "profile": "nthali", 
    "topicId": 3497, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 90391555, 
    "messageBody": "<div id=\"ygrps-yiv-1701891750\">We are not able to run any JUnit tests for any of our classes that<br/>\nuse XML. We get a &quot;java.lang.IncompatibleClassChangeError&quot;. Using<br/>\na main() method within that class seems to run the methods being<br/>\ntested just fine.<br/>\nHas anyone else encountered anything similar ? <br/>\nI am adding some test source code and xml file for anyone that<br/>\nmight want to run this. <br/>\nAny help would be greatly appreciated.<br/>\nThanks,<br/>\nNilesh<br/>\n<br/>\n------------------- MyXMLClass.java ---------------------------<br/>\nimport org.xml.sax.InputSource;<br/>\nimport org.w3c.dom.Node;<br/>\nimport org.w3c.dom.NodeList;<br/>\nimport org.w3c.dom.Element;<br/>\nimport org.w3c.dom.NamedNodeMap;<br/>\n<br/>\nimport java.io.File;<br/>\nimport java.util.Hashtable;<br/>\n<br/>\nimport com.sun.xml.parser.Resolver;<br/>\nimport com.sun.xml.tree.XmlDocument;<br/>\n<br/>\npublic class MyXMLClass {<br/>\n    public static void main(String[] args) {<br/>\n        String psFileName = &quot;test.xml&quot;;<br/>\n        if (args.length &gt; 0)<br/>\n            psFileName = args[0];<br/>\n<br/>\n        MyXMLClass xml = new MyXMLClass(psFileName);<br/>\n<br/>\n        System.out.println(&quot;Error msg for id=1: &quot; + <br/>\n                           xml.getErrorMessage(1));<br/>\n    }<br/>\n<br/>\n    private Hashtable ht = new Hashtable();<br/>\n<br/>\n    public MyXMLClass(String psFileName) {<br/>\n        XmlDocument doc = null;<br/>\n<br/>\n        try {<br/>\n        File lsXmlFile = new File(psFileName);<br/>\n        System.out.println(&quot;Reading: &quot; + lsXmlFile.getAbsolutePath());<br/>\n        InputSource is = Resolver.createInputSource(lsXmlFile);<br/>\n        // create a DOM Document<br/>\n        doc = XmlDocument.createXmlDocument(is, true);<br/>\n        normalizeDocument(doc.getDocumentElement());<br/>\n        } catch (Exception e) {<br/>\n            e.printStackTrace();<br/>\n        }<br/>\n<br/>\n        Element root = doc.getDocumentElement();<br/>\n        NodeList errNodes = root.getChildNodes();<br/>\n        for (int i=0; i&lt;errNodes.getLength(); i++) {<br/>\n            Node errNode = errNodes.item(i);<br/>\n            NamedNodeMap attrs = errNode.getAttributes();<br/>\n            Node errIdNode = attrs.getNamedItem(&quot;id&quot;);<br/>\n            Node errMsgNode = attrs.getNamedItem(&quot;msg&quot;);<br/>\n            ht.put(new Integer(errIdNode.getNodeValue()), <br/>\n                   errMsgNode.getNodeValue());<br/>\n        }<br/>\n    }<br/>\n<br/>\n    public String getErrorMessage(int piErrId) {<br/>\n        return ht.get(new Integer(piErrId)).toString();<br/>\n    }<br/>\n<br/>\n    public static void normalizeDocument(Node n)<br/>\n    {<br/>\n      if (!n.hasChildNodes())<br/>\n        return;<br/>\n<br/>\n      NodeList nl = n.getChildNodes();<br/>\n      for (int i = 0; i &lt; nl.getLength(); i++)<br/>\n      {<br/>\n        Node cn = nl.item(i);<br/>\n        if (cn.getNodeType() == Node.TEXT_NODE && <br/>\n            isBlank(cn.getNodeValue()))<br/>\n        {<br/>\n          n.removeChild(cn);<br/>\n          i--;<br/>\n        }<br/>\n        else<br/>\n          normalizeDocument(cn);<br/>\n      }<br/>\n    }<br/>\n<br/>\n    public static boolean isBlank(String buf) {<br/>\n      if (buf == null)<br/>\n        return(false);<br/>\n<br/>\n      int len = buf.length();<br/>\n      for (int i=0; i &lt; len; i++)<br/>\n      {<br/>\n        char c = buf.charAt(i);<br/>\n        if (!Character.isWhitespace(c))<br/>\n          return(false);<br/>\n      }<br/>\n      return(true);<br/>\n    }<br/>\n}<br/>\n---------------------------------------------------------------<br/>\n<br/>\n------------------------- MyXMLClassTest.java -----------------<br/>\nimport junit.framework.TestCase;<br/>\n<br/>\npublic class MyXMLClassTest extends TestCase {<br/>\n<br/>\n    public MyXMLClassTest(String name) {<br/>\n        super(name);<br/>\n    }<br/>\n<br/>\n    protected void setUp() {<br/>\n        xmlTest = new MyXMLClass(&quot;test.xml&quot;);<br/>\n    }<br/>\n<br/>\n    public void testGetErrorMessage() {<br/>\n      assertEquals(&quot;Connection failed, Please try again&quot;, <br/>\n                   xmlTest.getErrorMessage(1));<br/>\n    }<br/>\n<br/>\n    private MyXMLClass xmlTest;<br/>\n}<br/>\n---------------------------------------------------------------<br/>\n<br/>\n----------------------- test.xml -------------------------------<br/>\n&lt;?xml version=&quot;1.0&quot; ?&gt;<br/>\n&lt;!DOCTYPE ERRORS SYSTEM &quot;test.dtd&quot;&gt;<br/>\n<br/>\n&lt;ERRORS&gt;<br/>\n  &lt;ERROR id=&quot;1&quot; msg=&quot;Connection failed, Please try again&quot;/&gt;<br/>\n  &lt;ERROR id=&quot;2&quot; msg=&quot;Server Name not found&quot;/&gt;<br/>\n&lt;/ERRORS&gt;<br/>\n----------------------------------------------------------------<br/>\n<br/>\n----------------------- test.dtd -------------------------------<br/>\n&lt;!ELEMENT ERRORS (ERROR)+&gt;<br/>\n&lt;!ELEMENT ERROR EMPTY&gt;<br/>\n&lt;!ATTLIST ERROR id CDATA #REQUIRED msg CDATA #REQUIRED&gt;<br/>\n----------------------------------------------------------------</div>", 
    "prevInTime": 3496, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1007844111", 
    "canDelete": false, 
    "nextInTopic": 3498, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PDl1dHR1ZittY3U5QGVHcm91cHMuY29tPg=="
    }
}