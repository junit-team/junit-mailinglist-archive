{
    "numMessagesInTopic": 14, 
    "nextInTime": 21702, 
    "senderId": "iilnjRHZrr1cph2eSKP_cruSbCt8nBzNBZbkxwYcTrDk3baqXpJE-XpIv3AHCyKsEwacTgE6xV7dzIQOF-WL1fMl", 
    "systemMessage": false, 
    "subject": "Re: [junit] Re: Change generic signature of assert that", 
    "from": "David Saff &lt;david@...&gt;", 
    "authorName": "David Saff", 
    "msgSnippet": "With the most recent snapshot build of JUnit 4.7, you can basically use the JUnitMatchers.matches() method as type-checking duct tape, so this should compile: ", 
    "msgId": 21701, 
    "profile": "dsaff", 
    "topicId": 21666, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 341876227, 
    "messageBody": "<div id=\"ygrps-yiv-873098885\">With the most recent snapshot build of JUnit 4.7, you can basically<br/>\nuse the JUnitMatchers.matches() method as type-checking duct tape, so<br/>\nthis should compile:<br/>\n<br/>\nassertThat(result, matches(hasEntry(&quot;Key&quot;, Date.class)));<br/>\n<br/>\n  David Saff<br/>\n<br/>\n<blockquote><span title=\"qreply\"> On Sun, May 31, 2009 at 12:25 PM, yme0987654321 &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:yme0987654321@...\">yme0987654321@...</a>&gt; wrote:<br/>\n&gt; Me too, it does generally work fine. It works fine for classes without generic parameters (they just have to be of the same type). Where it broke down is when comparing classes with generic parameters. The workaround was:<br/>\n&gt;<br/>\n&gt; Map&lt;String, Class&lt;? extends Serializable&gt;&gt; result = null;<br/>\n&gt; Matcher matches = hasEntry(&quot;Key&quot;, java.util.Date.class);<br/>\n&gt; assertThat(result, matches);<br/>\n&gt;<br/>\n&gt; It makes a compiler warning that has to be suppressed, but it gets around the problem.<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>, David Saff &lt;david@...&gt; wrote:<br/>\n&gt;&gt;<br/>\n&gt;&gt; For the record,<br/>\n&gt;&gt;<br/>\n&gt;&gt; I use assertThat in JUnit a lot every day, and don&#39;t run into these<br/>\n&gt;&gt; corner cases all that often.  This probably means that I&#39;ve learned to<br/>\n&gt;&gt; keep away from problem areas, but also means that it&#39;s fairly possible<br/>\n&gt;&gt; to keep away from problem areas.<br/>\n&gt;&gt;<br/>\n&gt;&gt; Didn&#39;t want to leave the thread on the impression that everyone agrees<br/>\n&gt;&gt; that assertThat is totally broken in JUnit.<br/>\n&gt;&gt;<br/>\n&gt;&gt;    David Saff<br/>\n&gt;&gt;<br/>\n&gt;&gt; On Tue, May 26, 2009 at 10:47 AM, Pigneri, Rocco &lt;rpigneri@...&gt; wrote:<br/>\n&gt;&gt; &gt; Yme,<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt; NUnit has a nice implementation of these sort of matchers that works<br/>\n&gt;&gt; &gt; pretty seamlessly-which might imply that .NET handles these typing<br/>\n&gt;&gt; &gt; issues better than Java.  I can&#39;t remember running into any situations<br/>\n&gt;&gt; &gt; like what you are describing.  I have run into a few scenarios like<br/>\n&gt;&gt; &gt; yours involving lists, but, if I remember correctly, those errors had<br/>\n&gt;&gt; &gt; more to do with an interesting design choice that Microsoft had made<br/>\n&gt;&gt; &gt; rather than with anything to do in NUnit itself.  I&#39;m not familiar<br/>\n&gt;&gt; &gt; enough with the NUnit source code so I am not sure if any .NET magic was<br/>\n&gt;&gt; &gt; required to build NUnit or if it was a rather straightforward<br/>\n&gt;&gt; &gt; implementation.<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt; Rocco<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt; From: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a> [mailto:<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>] On Behalf Of<br/>\n&gt;&gt; &gt; yme0987654321<br/>\n&gt;&gt; &gt; Sent: Friday, May 22, 2009 3:36 PM<br/>\n&gt;&gt; &gt; To: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\n&gt;&gt; &gt; Subject: [junit] Re: Change generic signature of assert that<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt; I&#39;m curious if you know of a language that does do such things well. It<br/>\n&gt;&gt; &gt; seems like the popular ones are moving away from compiler-level type<br/>\n&gt;&gt; &gt; safety all together.<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt; --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a> &lt;mailto:junit%40yahoogroups.com&gt; , David<br/>\n&gt;&gt; &gt; Saff &lt;david@&gt; wrote:<br/>\n&gt;&gt; &gt;&gt;<br/>\n&gt;&gt; &gt;&gt; That much is true. I think that in the end, we&#39;ll probably be forced<br/>\n&gt;&gt; &gt;&gt; back to the untyped version. It was a good dream, but Java just<br/>\n&gt;&gt; &gt;&gt; really isn&#39;t functional enough to pretend to do functional things with<br/>\n&gt;&gt; &gt;&gt; it.<br/>\n&gt;&gt; &gt;&gt;<br/>\n&gt;&gt; &gt;&gt; David Saff<br/>\n&gt;&gt; &gt;&gt;<br/>\n&gt;&gt; &gt;&gt; On Fri, May 22, 2009 at 2:48 PM, yme0987654321 &lt;yme0987654321@&gt;<br/>\n&gt;&gt; &gt; wrote:<br/>\n&gt;&gt; &gt;&gt; &gt; I&#39;m also curious the motivation for using generics on the<br/>\n&gt;&gt; &gt; assertThat. It seems the only thing it gains is that the parameter to<br/>\n&gt;&gt; &gt; the matcher is the right type for the comparison, but the actual<br/>\n&gt;&gt; &gt; underlying matches method does not look at the generic, so if it wasn&#39;t<br/>\n&gt;&gt; &gt; the right type and generics were not used, the assert would just fail?<br/>\n&gt;&gt; &gt; I&#39;m I reading that right?<br/>\n&gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt; --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a> &lt;mailto:junit%40yahoogroups.com&gt; ,<br/>\n&gt;&gt; &gt; &quot;yme0987654321&quot; &lt;yme0987654321@&gt; wrote:<br/>\n&gt;&gt; &gt;&gt; &gt;&gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; hasEntry is part of the Hamcrest library. Here is the signature:<br/>\n&gt;&gt; &gt;&gt; &gt;&gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; public static &lt;K, V&gt; org.hamcrest.Matcher&lt;java.util.Map&lt;K, V&gt;&gt;<br/>\n&gt;&gt; &gt; hasEntry(K key, V value)<br/>\n&gt;&gt; &gt;&gt; &gt;&gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; I&#39;m curious if you know of a reason that<br/>\n&gt;&gt; &gt;&gt; &gt;&gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; public static &lt;T&gt; void assertThat(T actual, Matcher&lt;? extends T&gt;<br/>\n&gt;&gt; &gt; matcher)<br/>\n&gt;&gt; &gt;&gt; &gt;&gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; is wrong. Does it break something that you know of?<br/>\n&gt;&gt; &gt;&gt; &gt;&gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a> &lt;mailto:junit%40yahoogroups.com&gt; ,<br/>\n&gt;&gt; &gt; David Saff &lt;david@&gt; wrote:<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; On Fri, May 22, 2009 at 1:18 PM, yme0987654321 &lt;yme0987654321@&gt;<br/>\n&gt;&gt; &gt; wrote:<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; &gt; Consider the following case:<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; &gt; Map&lt;String, Class&lt;? extends Serializable&gt;&gt; result = null;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; &gt; assertThat(result, hasEntry(&quot;Key&quot;, java.util.Date.class));<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; &gt; This will not compile, but if the method signature of<br/>\n&gt;&gt; &gt; assertThat was changed to:<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; &gt; public static &lt;T&gt; void assertThat(T actual, Matcher&lt;? extends<br/>\n&gt;&gt; &gt; T&gt; matcher)<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; &gt; It would compile.<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; &gt; I would seem that it would be an appropriate change for such<br/>\n&gt;&gt; &gt; cases (unless there is something I don&#39;t understand about the deep<br/>\n&gt;&gt; &gt; implications of Generics).<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; Sigh.<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; Unfortunately, it was all too easy for the hamcrest team, a<br/>\n&gt;&gt; &gt; couple<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; months ago, to come up with a list of 6 or 7 assertThat<br/>\n&gt;&gt; &gt; statements<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; that all looked like they should obviously compile or not<br/>\n&gt;&gt; &gt; compile, but<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; no Java typing that would make them all work.  It does get deep,<br/>\n&gt;&gt; &gt; and<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; in some cases, compiler-dependent, if I remember correctly.<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; However, we did find that in some cases, the signature of the<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; _Matcher_ could be improved.  What&#39;s the signature of hasEntry?<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; This is also pushing me to keep on my &quot;Dotmesh&quot; project, which<br/>\n&gt;&gt; &gt; would allow this:<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; assertThat(result.entrySet()).contains(entry(&quot;Key&quot;, Date.class));<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; [if the &quot;entry&quot; factory convenience method were written]<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt; Thanks,<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt;    David Saff<br/>\n&gt;&gt; &gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;&gt;<br/>\n&gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt; ------------------------------------<br/>\n&gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt; Yahoo! Groups Links<br/>\n&gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt; &gt;<br/>\n&gt;&gt; &gt;&gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt; [Non-text portions of this message have been removed]<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt; ------------------------------------<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt; Yahoo! Groups Links<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt; &gt;<br/>\n&gt;&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; ------------------------------------<br/>\n&gt;<br/>\n&gt; Yahoo! Groups Links<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; </span></blockquote></div>", 
    "prevInTime": 21700, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1243876867", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 21698, 
    "headers": {
        "inReplyToHeader": "PGd2dWIyMitpMmRxQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PDRmN2RhNmI5MDkwNjAxMTAyMWw3MzdkNTdmbTg4NTNhN2NiNGEwNjZjODVAbWFpbC5nbWFpbC5jb20+", 
        "referencesHeader": "PDRmN2RhNmI5MDkwNTI2MTAzMHMzY2I5ZmMwYnA4ZjY2MGU1OGJkZmJlNDRmQG1haWwuZ21haWwuY29tPgkgPGd2dWIyMitpMmRxQGVHcm91cHMuY29tPg=="
    }
}