{
    "numMessagesInTopic": 7, 
    "nextInTime": 12149, 
    "senderId": "M-yT4UmiT8iRBIQ9EXO_aOuOsl8Ux6UNdyK42VjCtPlDiGZUs9xUK5h4PKGWSdYdcoeiPjunbILr8sOL64OohME8771TKKzhD_CVFAO8Uwz_9MZyGA", 
    "systemMessage": false, 
    "subject": "Re: [junit] Re: How to go about TDDing a doclet class?", 
    "from": "&quot;Jeff Nielsen&quot; &lt;jeff.nielsen@...&gt;", 
    "authorName": "Jeff Nielsen", 
    "msgSnippet": "I took Harald s challenge and sent him my solution privately.  I also had no prior experience implementing doclets, but I m going on 3+ years of experience", 
    "msgId": 12148, 
    "profile": "jeffreymads", 
    "topicId": 12076, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 65487161, 
    "messageBody": "<div id=\"ygrps-yiv-677753683\">I took Harald&#39;s challenge and sent him my solution privately.  I also had no<br/>\nprior experience implementing doclets, but I&#39;m going on 3+ years of<br/>\nexperience with TDD.<br/>\n<br/>\nOne comment that may be of general interest to the group, regarding J.B.&#39;s<br/>\nobservation:<br/>\n<br/>\n<blockquote><span title=\"ireply\">    &gt; &gt;Now fortunately, RootDoc is an interface, so we ought to be able to<br/>\n </span></blockquote>mock<br/>\n<blockquote><span title=\"ireply\">    &gt; &gt;it, or provide a simple implementation of it, to pass in to the method<br/>\n   &gt; &gt;start(), which I /assume/ you&#39;re trying to test-drive.<br/>\n<br/>\n </span></blockquote>This was also my assumption going in, and the way that I started.  But doing<br/>\neither a mock or stub of RootDoc did turn out to be more of a hassle than I<br/>\nbargained for.  This is because RootDoc returns a collection of ClassDoc<br/>\nobjects (also an interface), and ClassDoc returns collectons of FieldDoc,<br/>\nMethodDoc, etc.  Each of these XXXDoc interfaces extends ProgramElementDoc,<br/>\nDoc, and Type--more interfaces.  We&#39;re talking on the order of 45 * 4 = ~200<br/>\ntotal methods among the interfaces you need for a simple test.<br/>\n<br/>\nSo the stub approach gets unwieldy (it makes javax.sql.ResultSet or<br/>\nHttpServletRequest seem easy).  And the mock approach using dynamic proxies<br/>\njust feels funny.  By the time you tell RootDoc what ClassDocs to return,<br/>\nthen tell each of those ClassDocs which FieldDocs to spit out based on what<br/>\nparameters, you do feel like you&#39;re re-writing a lot of what you&#39;re trying<br/>\nto test--with a lot of guess work as to the precise behavior of the actual<br/>\ncom.sun.tools.javadoc.* implementations.<br/>\n<br/>\nInstead, I finally ended up digging through the javadoc source from Sun and<br/>\nfiguring out what incantations I needed to create a bona-fide<br/>\ncom.sun.tools.javadoc.RootDocImpl (also not as straightforward as you would<br/>\nthink).  Once I had the 20-line method<br/>\n<br/>\n  RootDocImpl createRootDoc(ListBuffer javaNames)<br/>\n<br/>\nthen TDD was straightforward.  I could create actual RootDoc objects in my<br/>\nsetUp methods, and write JUnit tests with them, feeling more confident<br/>\nknowing that my RootDocImpl was the same one that the javadoc executable<br/>\nwould use.  The resulting 15 or so tests I ended up with to implement<br/>\nHarald&#39;s problem all run in about a second, so I still had the short cycle<br/>\ntime that is essential for TDD.<br/>\n<br/>\nAnway, for me it was an interesting example of how using mocks/stubs can<br/>\nsometimes make unit testing more difficult rather than less.<br/>\n<br/>\n--<br/>\nJeff Nielsen<br/>\nDigital Focus<br/>\nwww.digitalfocus.com<br/>\n<br/>\n<br/>\n<br/>\nHarald Mueller wrote:<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; And I&#39;m not satisfied with the result and the TDD-ing we did ... But<br/>\n </span></blockquote>before<br/>\n<blockquote><span title=\"ireply\"> &gt; I share my questions and concerns, I&#39;d like to see how TDDing our<br/>\n </span></blockquote>assignment<br/>\n<blockquote><span title=\"ireply\"> &gt; would or should really work. For this,<br/>\n&gt;<br/>\n&gt; &gt;&gt;&gt;&gt;&gt; I invite you to also implement the tool we had to write. &lt;&lt;&lt;&lt;&lt;<br/>\n&gt;<br/>\n&gt; For this, I have put a sort of spec on my website at<br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.haraldmmueller.de/swe_tdd1.html.\">http://www.haraldmmueller.de/swe_tdd1.html.</a><br/>\n&gt;<br/>\n&gt; It took us 2 hours 16 minutes end-to-end (including the shaky acceptance<br/>\n&gt; test on the website), and we were as unknowing about doclets as one can<br/>\n </span></blockquote>be -<br/>\n<blockquote><span title=\"ireply\"> &gt; so you have every chance to do the same thing in an hour or so.<br/>\n&gt;<br/>\n&gt; Everyone sending me (or posting) a &quot;TDD solution&quot; (including unit tests)<br/>\n&gt; will get in return our code ... if you like to criticize others&#39; code,<br/>\n </span></blockquote>that<br/>\n<blockquote><span title=\"ireply\"> &gt; should really be an incentive ;-)<br/>\n&gt;<br/>\n&gt; When I have two working solutions, I&#39;ll post - if I may - our code (maybe<br/>\n </span></blockquote>on<br/>\n<blockquote><span title=\"ireply\"> &gt; the refactoring mailing list? don&#39;t know where it suites better) so that<br/>\n </span></blockquote>you<br/>\n<blockquote><span title=\"ireply\"> &gt; can tear it apart.<br/>\n&gt;<br/>\n&gt; Is this a deal ;-) ?<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; JB (Joe - now I know it!) Rainsberger found time to answer - I&#39;ll only<br/>\n&gt; comment on one part:<br/>\n&gt;<br/>\n&gt; &gt;Now fortunately, RootDoc is an interface, so we ought to be able to mock<br/>\n&gt; &gt;it, or provide a simple implementation of it, to pass in to the method<br/>\n&gt; &gt;start(), which I /assume/ you&#39;re trying to test-drive.<br/>\n&gt;<br/>\n&gt; &quot;Yes, but ...&quot; (my children&#39;s answer to almost everything ...): If you<br/>\n </span></blockquote>look<br/>\n<blockquote><span title=\"ireply\"> &gt; at the documentation of RootDoc and related interfaces - i.e., the javadoc<br/>\n&gt; API -, it&#39;s not too small. Should I really mock this? I cannot see that<br/>\n </span></blockquote>I&#39;ll<br/>\n<blockquote><span title=\"ireply\"> &gt; then create a software that will run with the real javadoc API - I will<br/>\n&gt; misinterpret the Javadoc and implement mocks that do what I think they<br/>\n&gt; should do, not what the real thing does.<br/>\n&gt; So, I need learning tests for RootDoc etc. anyway, so why not write the<br/>\n&gt; doclet so that *is* the learning test object?<br/>\n&gt; But when I find time, I&#39;ll try also the mock approach - otherwise, I&#39;ll<br/>\n&gt; never lose my prejudice about it; and post the result without any feeling<br/>\n </span></blockquote>of<br/>\n<blockquote><span title=\"qreply\"> &gt; guilt.<br/>\n&gt;<br/>\n&gt; Ok - now I&#39;m waiting for contributions ...<br/>\n&gt;<br/>\n&gt; Regards<br/>\n&gt; Harald M. Mueller </span></blockquote></div>", 
    "prevInTime": 12147, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1097816505", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 12097, 
    "headers": {
        "messageIdInHeader": "PDAxODAwMWM0YjI3NCQxMjc3ODYzMCQ0YjA3MDAwYUBsYXB0b3AxMDA+", 
        "referencesHeader": "PDU2NjcuMTA5NjkwNTQzNUB3d3c1OC5nbXgubmV0Pg=="
    }
}