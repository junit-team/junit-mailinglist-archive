{
    "numMessagesInTopic": 16, 
    "nextInTime": 11554, 
    "senderId": "QAG_lbMLbTcRMKArBiAsti4P27QiRODVVM_1oYZdSJviXk-0aj6ec1IZG9doEhcgvzXBAwASpC7xQwcmUFbDcZWw-17LHXxV", 
    "systemMessage": false, 
    "subject": "Re: Mock objects...", 
    "from": "&quot;cypherfox&quot; &lt;cypherfox@...&gt;", 
    "authorName": "cypherfox", 
    "msgSnippet": "Greetings, ... Yeah, it was annoying to do that much work for nominally test classes. ... That s...impressive.  That s some very, very deep magic, and I like ", 
    "msgId": 11553, 
    "profile": "cypherfox", 
    "topicId": 11542, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 174888704, 
    "messageBody": "<div id=\"ygrps-yiv-1451855477\">Greetings,<br/>\n<br/>\n--- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>, &quot;J. B. Rainsberger&quot; &lt;jbrains@r...&gt;<br/>\nwrote:<br/>\n<blockquote><span title=\"ireply\"> &gt; cypherfox wrote:<br/>\n&gt; &gt; Sure, the most recent example of this to me, was this class:<br/>\n&gt; &gt;   <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.vixen.com/code/JournalHash.java\">http://www.vixen.com/code/JournalHash.java</a><br/>\n&gt; &gt; implementing<br/>\n&gt; &gt;   <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.vixen.com/code/JournalDataStore.java\">http://www.vixen.com/code/JournalDataStore.java</a><br/>\n&gt; <br/>\n&gt; Aha! It&#39;s a common mistake: you&#39;ve created an in-memory<br/>\n&gt; implementation of JournalDataStore, when you didn&#39;t really<br/>\n&gt; need one. I can understand your pain. Been there.<br/>\n<br/>\n </span></blockquote>Yeah, it was annoying to do that much work for nominally test classes.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; Solution? jMock. www.jmock.org<br/>\n<br/>\n </span></blockquote>That&#39;s...impressive.  That&#39;s some very, very deep magic, and I like<br/>\nit.  I think understanding that framework is going to be my weekend<br/>\nproject.  It is such a pity that it&#39;s not possible with C++, but since<br/>\nI&#39;m doing Java these days...  That&#39;s a very nice tool.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; First, it looks like you just want a &quot;fake&quot; and not a full-blown<br/>\n&gt; mock -- that is, a stand-in JournalDataStore that returns<br/>\n&gt; hardcoded data on demand.<br/>\n&gt; <br/>\n&gt; You can use a dynamic mock to implement a fake data store. You<br/>\n&gt; simply &quot;record&quot; the desired output for each desired input, then play<br/>\n&gt; it back.  Since Journal and JournalEntry appear both to be simple<br/>\n&gt; value objects, it should be easy.<br/>\n<br/>\n </span></blockquote>They are.  No logic to them, except a serialize-to-xml output. <br/>\nJournal has information about the &#39;journal&#39;, and &#39;JournalEntry&#39;<br/>\nhas information about the individual messages.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; When you want to test logic that uses a JournalDataStore, simply<br/>\n&gt; record the behavior you want to /simulate/ during the &quot;Arrange&quot;<br/>\n&gt; portion, then play it back during the &quot;Act&quot; portion. In the &quot;Assert&quot;<br/>\n&gt; portion, ask the  fake to verify() itself, and if the fake was used<br/>\n&gt; incorrectly, it will fail the test.<br/>\n<br/>\n </span></blockquote>That&#39;s very neat, I have to admit.  I can see pretty quickly how the<br/>\njMock classes can be used for that.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; If you give us a test for an object that talks to JournalHash, then<br/>\n&gt; we can convert it into a test using the fake. You can then decide<br/>\n&gt; whether JournalHash is worth keeping for some other use....<br/>\n<br/>\n </span></blockquote>I had to parse that carefully...  A test for an object that *talks* to<br/>\nJournalHash.  Unfortunately, in this case I can&#39;t easily.  I&#39;d have to<br/>\ndo a good bit of sanitizing.<br/>\n<br/>\nStill, I can see approximately how I&#39;d test it...  Basically set up<br/>\nexpectations and results for all the methods that are likely to<br/>\nbe called, tell the CUT to use the provided data store (an<br/>\nimplementation detail that is not exposed right now), run the<br/>\nactual test call, assert that the result is right from the actual<br/>\ntest, and verify() the dynamically created mock.<br/>\n<br/>\nVery, very neat stuff.   You say you have a chapter on using jMock?<br/>\nTheir examples are a little sparse, although the hints left are<br/>\nimpressive nonetheless.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; &gt; One of the things that isn&#39;t even in there, is the concept of<br/>\n&gt; &gt; &#39;get most recent &#39;n&#39; entries&#39;, because that would require me<br/>\n&gt; &gt; to walk backwards through the TreeMap, or add a *third*<br/>\n&gt; &gt; representation of the same data, as a linked list or something.<br/>\n&gt; <br/>\n&gt; Here you&#39;re implementing getMostRecentNEntries() in terms of the <br/>\n&gt; existing JournalDataStore methods?<br/>\n<br/>\n </span></blockquote>Well, no, because JournalDataStore doesn&#39;t export anything<br/>\nthat would allow you to look from the end backwards, basically.<br/>\nThat was one of my problems, I&#39;d have to add a third tracking<br/>\ndata structure to track order-entered, so that it could retrieve<br/>\nthe most recent &#39;n&#39;.  Whereas the JDBC version of this was<br/>\nbrutally simple, just modify the query.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; That&#39;s not too hard, although it <br/>\n&gt; might surprise you that I would put getMostRecentNEntries() on a <br/>\n&gt; different interface from JournalDataStore!<br/>\n<br/>\n </span></blockquote>I am curious why, although it might be a different discussion.  Is<br/>\nit just so that you can pass a mock object into it?<br/>\n<br/>\n[...deletia: cool mock psuedocode...]<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; Now note that this is pseudocode, and I&#39;m only a green belt in<br/>\n&gt; jMock (I used EasyMock before, and am still learning jMock), but<br/>\n&gt; this is the idea. Ignoring my choice of design for the<br/>\n&gt; GetMostRecentNEntriesQuery class, does this smaller amount<br/>\n&gt; of mock code look easier to maintain?<br/>\n<br/>\n </span></blockquote>It&#39;s easier to maintain mainly in that changes to the interface are<br/>\ndone at two places, again, in the test (the mock setup, and the<br/>\nactual call), and the actual code.  I&#39;m relatively positive that in<br/>\nthe end the number of mock setups would be bigger than the<br/>\nJournalHash class, but...and it&#39;s an important but...I wouldn&#39;t<br/>\nbe debugging logic that exists purely for testing purposes.<br/>\nThat&#39;s a bigger win, because it lets me focus on the two things<br/>\nthat matter: new code, and simple tests.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; Well, you definitely got some value from it, then. That&#39;s better<br/>\n&gt; than nothing. Still, you would have been able to focus on the<br/>\n&gt; interactions, rather than implementing the book-keeping,<br/>\n&gt; if you&#39;d known about dynamic mocks. Ah, well... it&#39;s never<br/>\n&gt; too late.<br/>\n<br/>\n </span></blockquote>I did get value, in a couple of ways, but I would have gotten the same<br/>\nvalue with the dynamic mocks, I think.  Mainly that as soon as the<br/>\nJDBC code started to be written, target that class instead of the<br/>\nmock, and immediately the JournalDB class is being tested with<br/>\nbasically debugged, complete tests.<br/>\n<br/>\njMock is *definitely* my weekend study project.<br/>\n<br/>\n--  Morgan Schweers</div>", 
    "prevInTime": 11552, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1090020705", 
    "canDelete": false, 
    "nextInTopic": 11554, 
    "prevInTopic": 11552, 
    "headers": {
        "inReplyToHeader": "PDQwRjg0OTc0LjYwMzA1MDhAcm9nZXJzLmNvbT4=", 
        "messageIdInHeader": "PGNkOW9oMStwbmd1QGVHcm91cHMuY29tPg=="
    }
}