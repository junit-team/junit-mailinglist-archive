{
    "numMessagesInTopic": 12, 
    "nextInTime": 22167, 
    "senderId": "mlo2Ja1oX7hEuQxiTQnJSZNzDCZn0OdtsvyS39gpb4T3vXsoQ8nyfy_78q8NogC5IZjEng5gkq1z95asef0kMwizSiSWYOs4wgUwbh-r5GBiSeWARsPn8BDukw", 
    "systemMessage": false, 
    "subject": "RE: [junit] Re: running a single test case in a separate JVM or ClassLoader", 
    "from": "&quot;Forsberg, Mike&quot; &lt;mike.forsberg@...&gt;", 
    "authorName": "Forsberg, Mike", 
    "msgSnippet": "I for one 100% agree that reading system properties during a static initializer leads to untestable-like code.  I think there are a few articles out there that", 
    "msgId": 22166, 
    "profile": "mike.forsberg_gf", 
    "topicId": 22156, 
    "spamInfo": {
        "reason": "6", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 392980748, 
    "messageBody": "<div id=\"ygrps-yiv-126427417\">I for one 100% agree that reading system properties during a static initializer leads to untestable-like code.  I think there are a few articles out there that frown against it.  No one likes dealing with the class loader if they don&#39;t have to.<br/>\n<br/>\nHowever, using system properties in something like object construction is a good idea.  (In my opinion.)  In fact I like it soo much I&#39;m going to blog about it.  But my first rough draft has the template you need.  (It is currently the second code snippet.)  The idea is to save the system properties in a before method and restore in an after method.  Then set the property you want to change before constructing the object.  In your case it would be before loading the class.<br/>\n<br/>\nI&#39;m leaving the class loading issues as an exercise for the reader.  (Cause I don&#39;t want to touch that.)<br/>\n<br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"http://bigmikef.blogspot.com/2009/12/using-system-properties-in-test.html\">http://bigmikef.blogspot.com/2009/12/using-system-properties-in-test.html</a><br/>\n<br/>\nP.S. This page will be filled out when I get home from work.<br/>\n<br/>\nFrom: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a> [mailto:<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>] On Behalf Of yme0987654321<br/>\nSent: Friday, December 11, 2009 7:51 AM<br/>\nTo: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\nSubject: [junit] Re: running a single test case in a separate JVM or ClassLoader<br/>\n<br/>\n<br/>\n<br/>\nI&#39;m not really suggesting you change the overall design of the public API, I&#39;m just suggesting you have a way of injecting a different properties object, via say a package-private method or constructor, rather than the public API, which would use that same method to inject the System properties at class initialization.<br/>\n<br/>\nRegarding the Suite option, you only need as many Suites as you have variations on the System property.<br/>\n<br/>\nIf none of this makes sense, you are indeed down to a custom class loader, but on my Java map custom class loaders are in the &quot;there be dragons&quot; area, so I can&#39;t really give you any good advice there.<br/>\n<br/>\n<blockquote><span title=\"qreply\"> --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>&lt;mailto:junit%40yahoogroups.com&gt;, Bill Shannon &lt;Bill.Shannon@...&gt; wrote:<br/>\n&gt;<br/>\n&gt; I can&#39;t change the design of the class under test, its behavior is defined<br/>\n&gt; by a standard.<br/>\n&gt;<br/>\n&gt; As for different suites, are you suggesting that I separate the tests<br/>\n&gt; into different groups, and then run each group of tests as a separate<br/>\n&gt; run from maven, each in its own JVM? The number of classes I&#39;d like<br/>\n&gt; to test this way is quite large. I think having lots of different test<br/>\n&gt; suites would quickly become unmanageable.<br/>\n&gt;<br/>\n&gt; If I need to build this capability myself, would building my own custom<br/>\n&gt; Runner be the right approach? If so, is there some documentation on how<br/>\n&gt; to write a custom Runner? Or do I just need to read the code?<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; yme0987654321 wrote on 12/10/2009 08:23 PM:<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt; The way I would handle this is to inject the relevant properties via a<br/>\n&gt; &gt; properties object, and then in production pass System.getProperties(),<br/>\n&gt; &gt; that way the tests are not coupled to the nasty global which is the<br/>\n&gt; &gt; System property.<br/>\n&gt; &gt;<br/>\n&gt; &gt; If that isn&#39;t an option for some reason, perhaps you can organize your<br/>\n&gt; &gt; different tests into suites, and set the system property in a<br/>\n&gt; &gt; @BeforeClass method on the suite?<br/>\n&gt; &gt;<br/>\n&gt; &gt; Yishai<br/>\n&gt; &gt;<br/>\n&gt; &gt; --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>&lt;mailto:junit%40yahoogroups.com&gt; &lt;mailto:junit%40yahoogroups.com&gt;, Bill<br/>\n&gt; &gt; Shannon &lt;Bill.Shannon@&gt; wrote:<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt; I&#39;ve read the FAQ and the javadocs and done much web searching but<br/>\n&gt; &gt; can&#39;t find<br/>\n&gt; &gt; &gt; an answer to this. Sorry if this is stupid question.<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt; I need to write a test case that tests a class whose behavior depends on<br/>\n&gt; &gt; &gt; a System property. The class reads the System property at class<br/>\n&gt; &gt; initialization<br/>\n&gt; &gt; &gt; time. I&#39;d like to have multiple test cases, each of which sets a<br/>\n&gt; &gt; different<br/>\n&gt; &gt; &gt; value for the System property, so each of the tests needs to be run in a<br/>\n&gt; &gt; &gt; separate JVM or possibly a separate ClassLoader.<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt; Is there a simple way to (e.g.) annotate my test case to cause JUnit to<br/>\n&gt; &gt; &gt; handle this for me?<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt; I&#39;m invoking JUnit as part of a maven build. Note that I don&#39;t want to<br/>\n&gt; &gt; &gt; run *all* of my JUnit tests in a single separate JVM, I want to run<br/>\n&gt; &gt; &gt; certain test cases each in their own separate JVM (or ClassLoader).<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt; If I have to start a new JVM or create a new ClassLoader myself, what&#39;s<br/>\n&gt; &gt; &gt; the best way to initialize the CLASSPATH and find the class to be tested<br/>\n&gt; &gt; &gt; from within a JUnit test case running under maven?<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt; Thanks.<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt;<br/>\n<br/>\n<br/>\n<br/>\n[Non-text portions of this message have been removed] </span></blockquote></div>", 
    "prevInTime": 22165, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1260544218", 
    "canDelete": false, 
    "nextInTopic": 22170, 
    "prevInTopic": 22163, 
    "headers": {
        "inReplyToHeader": "PGhmdGlvMisyOXBnQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PDRBN0M3MTFGMDAyRTkyNDM5NjcxRkYwQzI1Q0Q5RDM1MUI2MzQ4N0JAVkFVU0VYTUJYUDEuZ2ZvdW5kcmllcy5jb20+", 
        "referencesHeader": "PDRCMjFENTgzLjYwNTA5MDNAc3VuLmNvbT4gPGhmdGlvMisyOXBnQGVHcm91cHMuY29tPg=="
    }
}