{
    "numMessagesInTopic": 27, 
    "nextInTime": 17855, 
    "senderId": "1fMbGb47aFOgcZceC22GxcCtUOqsq9d_s15sCIaihDJ6qYosXhQarZjf4qDq9vpgmKXTGENh0D9pnL2MpXKRYCMnBCmPaodNCjVW0U7t4bVeu0evLKCeyZ7VnQ", 
    "systemMessage": false, 
    "subject": "Re: [junit] JUnit Testing Code That Has System.exit(n);", 
    "from": "Andrew McDonagh &lt;yahoogroups@...&gt;", 
    "authorName": "Andrew McDonagh", 
    "msgSnippet": "Hi Bob, I ll comment on the / ...developer had implemented System.exit(n) throughout the application whenever there was a trapped exception... /later, but for", 
    "msgId": 17854, 
    "rawEmail": "Return-Path: &lt;yahoogroups@...&gt;\r\nX-Sender: yahoogroups@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 93916 invoked from network); 7 Sep 2006 22:36:14 -0000\r\nReceived: from unknown (66.218.67.36)\n  by m22.grp.scd.yahoo.com with QMQP; 7 Sep 2006 22:36:14 -0000\r\nReceived: from unknown (HELO outmail.freedom2surf.net) (194.106.33.237)\n  by mta10.grp.scd.yahoo.com with SMTP; 7 Sep 2006 22:36:13 -0000\r\nReceived: from [192.168.1.100] (i-83-67-4-97.freedom2surf.net [83.67.4.97])\n\tby outmail.freedom2surf.net (Postfix) with ESMTP id C851C52E78\n\tfor &lt;junit@yahoogroups.com&gt;; Thu,  7 Sep 2006 23:33:49 +0100 (BST)\r\nMessage-ID: &lt;45009E44.80004@...&gt;\r\nDate: Thu, 07 Sep 2006 23:33:40 +0100\r\nUser-Agent: Thunderbird 1.5.0.5 (Windows/20060719)\r\nMIME-Version: 1.0\r\nTo: junit@yahoogroups.com\r\nReferences: &lt;edq2s9+odek@...&gt;\r\nIn-Reply-To: &lt;edq2s9+odek@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 7bit\r\nX-eGroups-Msg-Info: 1:0:0:0\r\nFrom: Andrew McDonagh &lt;yahoogroups@...&gt;\r\nSubject: Re: [junit] JUnit Testing Code That Has System.exit(n);\r\nX-Yahoo-Group-Post: member; u=234174584; y=lM_4_1JQIWoxQ1fp8zx2KArbwqvH9bqz2vvVTOr7b0xhl1QP6hdxuA\r\nX-Yahoo-Profile: andy_ipaccess\r\n\r\n\n\nHi Bob,\n\nI&#39;ll comment on the /&#39;...developer had implemented System.exit(n) \nthroughout the application whenever there was a trapped exception...&#39; \n/later, but for now here&#39;s how to write your tests...\n\n\nGiven this kind of class......\n\n\n\npublic class SomethingThatCallsExit {\n\n    public int add(int num1, int num2) {\n         if( num1 &lt; 0) {\n           System.exit(2);\n        }\n\n       return num1 + num2;\n    }\n\n}\n\n\nWhen trying to test it we need to provide a substitute  (delegate) for \nit to call System.exit(); on, instead of doing it itself, so that we \ndont call System.exit during our test runs.\n\n\nLets create the Interface that our delegate will need to implement....\n\npublic interface SystemExiter {\n  void exit(int reason);\n}\n\n\nNow lets create a Fake implementation of the interface for use within \nour tests.\n\npublic class FakeSystemExiter implements SystemExiter {\n\n   public boolean   wasExitCalled;\n   public int exitReason = -999;  // number not used by our app so other \ntests know if it was set\n\n   public void exit(int reason) {\n      wasExitCalled = true;\n      exitReason = reason;\n   }\n}\n\n\nNow lets create the real implementation....\n\n\npublic class RealSystemExiter implements SystemExiter {\n\n   public void exit(int reason) {\n      System.exit(reason);\n   }\n}\n\n\nSo now we have the necessary interface and classes to test, we have a \nchoice on how to use them.\n\nFirst. we could simply pass the delegate (the real and the fake) to the \nclass....\n\nSo we need to change our class by adding a new constructor parameter and \nchanging how it calls exit.\n\npublic class SomethingThatCallsExit {\n\n   private SystemExiter systemExiter;\n\n   public SomethingThatCallsExit( SystemExiter exiter) {\n       systemExiter = exiter;\n   }\n\n   public int add(int num1, int num2) {\n       if( num1 &lt; 0) {\n          //System.exit(2);\n         exiter.exit(2);\n      }\n      return num1 + num2;\n   }\n\n}\n\nNow we can test it like so...\n\npublic class SomethingThatCallsExitTests extends Testcase {\n\n  public void testTryingToAddNegativeNumberStopsApp () {\n      FakeSystemExiter exiter = new FakeSystemExiter();\n      SomethingThatCallsExit calc = new SomethingThatCallsExit ( exiter  );\n\n      calc.add( -1 , 1);\n\n     assertTrue(&quot;Exit not called!&quot;, exiter.wasExitCalled );    \n  }\n}\n\nThis does mean that the application code that creates and uses the class \nunder test (not shown here) would need to be modified to pass the \nconstructor parameter.\n\nThis is a nice and clean way of setting the delegate though.\n\n\nThe second approach is useful if we can&#39;t (don&#39;t want to) change the \ncode that creates and uses our class under test. This means our class \nunder test has to create the real exiter itself and during testing we \nneed to use a hook into this creation, so we can over ride it and \nprovide our fake.\n\nFirst lets rewrite the class so it creates the exiter....\n\npublic class SomethingThatCallsExit {\n\n   public int add(int num1, int num2) {\n       if( num1 &lt; 0) {\n          //System.exit(2);\n          SystemExiter systemExiter = createExiter();\n         exiter.exit(2);\n      }\n      return num1 + num2;\n   }\n\n  // real implementation\n   protected SystemExiter createExiter() {\n      return new RealSystemExiter();\n   }\n\n}\n\n\nNow lets write the test to over ride the &#39;createExiter()&#39; method to \nreturn our fake.\n\npublic class SomethingThatCallsExitTests extends Testcase {\n\n    public class TestableSomethingThatCallsExit extends  \nSomethingThatCallsExit{\n     \n         protected SystemExiter createExiter() {\n             return systemExiter;\n         }\n\n    }\n\n  \n\n  public void testTryingToAddNegativeNumberStopsApp () {\n      systemExiter = new FakeSystemExiter();\n      TestableSomethingThatCallsExit calc = new \nTestableSomethingThatCallsExit ();\n\n      calc.add( -1 , 1);\n\n     assertTrue(&quot;Exit not called!&quot;, exiter.wasExitCalled );    \n  }\n}\n\n\n\nSo there you go....two ways of injecting a fake exiter into the class \nunder test, so that we can test it without the real System.exit() being \ncalled.\n\nHTH\n\nAndrew\n\n\n\nBob Russell wrote:\n&gt;\n&gt;\n&gt; I&#39;m involved on a project as the QA. To improve my development\n&gt; skills and my JUnit skills, I am writing some JUnit tests. Today, I\n&gt; found that the developer had implemented System.exit(n) throughout\n&gt; the application whenever there was a trapped exception.\n&gt;\n&gt; Now, the requirements call for the application to return some exit\n&gt; code telling any downstream processes whether this application was\n&gt; 100% successful with no warnings (rc=0), 100% successful with\n&gt; warnings (rc=4), not successful at all (rc=8). However, the only\n&gt; java mechanism for reporting return codes is System.exit(n), based on\n&gt; my use of Google.\n&gt;\n&gt; My JUnit dilemma then, is that System.exit(n) gives the required\n&gt; application behavior but doesn&#39;t seem to be good for running JUnit\n&gt; tests from a test suite since System.exit(n) ends the JVM.\n&gt;\n&gt; Does anyone have any insights they can share? Since this is my first\n&gt; post to this forum, I&#39;m happy to Google some more if you&#39;ll only give\n&gt; me some keyword hint(s) beyond what I&#39;ve already tried: &quot;java exit\n&gt; code&quot;.\n&gt;\n&gt; Thanks!\n&gt;\n&gt; \n&gt; ------------------------------------------------------------------------\n&gt;\n&gt; No virus found in this incoming message.\n&gt; Checked by AVG Free Edition.\n&gt; Version: 7.1.405 / Virus Database: 268.12.2/441 - Release Date: 07/09/2006\n&gt;   \n\n\n", 
    "profile": "andy_ipaccess", 
    "topicId": 17851, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 234174584, 
    "prevInTime": 17853, 
    "contentTrasformed": false, 
    "postDate": "1157668420", 
    "canDelete": false, 
    "nextInTopic": 17855, 
    "prevInTopic": 17852, 
    "headers": {
        "inReplyToHeader": "PGVkcTJzOStvZGVrQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PDQ1MDA5RTQ0LjgwMDA0QGFuZHJld21jZG9uYWdoLmYycy5jb20+", 
        "referencesHeader": "PGVkcTJzOStvZGVrQGVHcm91cHMuY29tPg=="
    }
}