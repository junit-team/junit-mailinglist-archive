{
    "numMessagesInTopic": 15, 
    "nextInTime": 2462, 
    "senderId": "D0ppIEUcfnccHGSoiz4Fih-mSG2InkrbX1izXH4VdKAQt9WnUOL5P2b6zD9HPgpUgwyDOCLHYI7U4pbl7woWZUqfKY0MqkaezvBaKmcZVQdWJA", 
    "systemMessage": false, 
    "subject": "RE: Mocking classes (was RE: [junit] About mock object :!)", 
    "from": "&quot;Diego Medici&quot; &lt;diego.medici@...&gt;", 
    "authorName": "Diego Medici", 
    "msgSnippet": "We are implementing unit testing on our projects, and the use of mock objects is a great step to isolate the CUT. After several attempts we have find 2", 
    "msgId": 2461, 
    "topicId": 2404, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 0, 
    "messageBody": "<div id=\"ygrps-yiv-854824564\">We are implementing unit testing on our projects, and the use of mock<br/>\nobjects is a great step to isolate the CUT.<br/>\n<br/>\nAfter several attempts we have find 2 solutions that permits the use of mock<br/>\nobjects, that derives from these assumptions:<br/>\n<br/>\n1. Good class design: when design classes, you design only the interfaces of<br/>\nthese classes, and when you code these classes, implements the interfaces.<br/>\nIn this way, you can define a mock object for this class<br/>\n<br/>\n2. Never instantiate directly a class into a method.<br/>\n<br/>\nWith these tricks, you have the classes that known only the interface of the<br/>\nother classes that they use. You can change the implementation of every<br/>\nclass, without have to change the other classes.<br/>\n<br/>\nWhen you have the classes coded in this way, the use of mock object is easy.<br/>\n<br/>\n1st Solutions<br/>\nIf into a method you need to instantiate an object of another class, pass<br/>\nthe interface as parameter. In this example Class2 uses Class1.<br/>\n<br/>\n<br/>\npublic class Class1 implements Class1Iface<br/>\n{<br/>\n\tpublic void method1()<br/>\n\t{<br/>\n\t\t...<br/>\n\t}<br/>\n\t...<br/>\n}<br/>\n<br/>\n<br/>\npublic class Class2 implements Class2Iface<br/>\n{<br/>\n\tpublic void method2(Class1Iface c1)<br/>\n\t{<br/>\n\t\t...<br/>\n\t\tc1.method2();<br/>\n\t\t...<br/>\n\t}<br/>\n<br/>\n}<br/>\n<br/>\n<br/>\nIn this way, the method2 doesn&#39;t know the implementation of method1, but<br/>\nonly its interface.<br/>\nDuring the testing, you can define a mock object of Class1 and pass to<br/>\nmethod2 an instance of the mock object.<br/>\n<br/>\npublic class Class1Mock implements Class1Iface<br/>\n{<br/>\n\tpublic void method1()<br/>\n\t{<br/>\n\t\t//Behaviour defined by the mock implementation<br/>\n\t}<br/>\n\t...<br/>\n}<br/>\n<br/>\nAnd the test method:<br/>\n<br/>\n...<br/>\npublic void testMethod2()<br/>\n{<br/>\n\tClass1Iface c1 = new Class1Mock();<br/>\n\tClass2 c2 = new Class2();<br/>\n\tassert(c2.method2(c1));<br/>\n\t...<br/>\n}<br/>\n...<br/>\n<br/>\n2nd Solution:<br/>\nUse the AbstractFactory pattern to instantiate classes.<br/>\nThis solution doesn&#39;t force to pass the interface as parameter. You need to<br/>\nimplement a new class, called Factory, that instantiates the right class for<br/>\nthe test (mock) or the real class.<br/>\n<br/>\nThe Class1 and Class1Mock are the same.<br/>\n<br/>\n//Very simple Factory!!!<br/>\n//The Factory class should contain other features...<br/>\npublic abstract class Class1Factory<br/>\n{<br/>\n\tpublic static boolean TEST = false;<br/>\n\tpublic Class1Iface makeClass1()<br/>\n\t{<br/>\n\t\t...<br/>\n\t\tif(TEST) return new Class1Mock();<br/>\n\t\telse return new Class1();<br/>\n\t}<br/>\n\t...<br/>\n<br/>\n\t//if there are more constructor then define additionals makeClass1(params)<br/>\nmethods<br/>\n}<br/>\n<br/>\n<br/>\npublic class Class2 implements Class2Iface<br/>\n{<br/>\n\tpublic void method2()<br/>\n\t{<br/>\n\t\tClass1Iface c1 = Class1Factory.makeClass1();<br/>\n\t\tc1.method2();<br/>\n\t}<br/>\n\t...<br/>\n}<br/>\n<br/>\n<br/>\nAnd an example of the test method should be<br/>\n<br/>\n...<br/>\npublic void testMethod2()<br/>\n{<br/>\n\tClass1Factory.TEST = true;<br/>\n\tClass2 c2 = new Class2();<br/>\n\tassert(c2.method2(c1));<br/>\n\t...<br/>\n}<br/>\n<br/>\n<br/>\nAny comments, suggestions, critics will be appreciated!<br/>\n<br/>\nDiego<br/>\n<br/>\n**********************************************<br/>\nDiego Medici<br/>\nProject Manager<br/>\nDialogos 3 S.r.l.<br/>\nMilan, Italy<br/>\nTel: +39 0270005949<br/>\nFax: +39 0270049053<br/>\nMob: +39 3484009314<br/>\ne-mail: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:diego.medici@...\">diego.medici@...</a> - <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.dialogos3.com\">http://www.dialogos3.com</a><br/>\n********************************************<br/>\n<br/>\n<br/>\n-----Original Message-----<br/>\nFrom:<br/>\nsentto-2423328-2461-998518654-diego.medici=<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:dialogos3.com@...\">dialogos3.com@...</a><br/>\n.com<br/>\n[mailto:sentto-2423328-2461-998518654-diego.medici=dialogos3.com@returns<br/>\n.onelist.com]On Behalf Of Steve Freeman<br/>\nSent: mercoledi 22 agosto 2001 23.18<br/>\nTo: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\nSubject: Re: Mocking classes (was RE: [junit] About mock object :!)<br/>\n<br/>\n<br/>\nFrom: &quot;Shane Duan&quot; &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:sduan@...\">sduan@...</a>&gt;<br/>\n<blockquote><span title=\"ireply\"> &gt; So if I am going to spend a lot of time anyway, I&#39;d rather refactor the<br/>\n </span></blockquote>code to make the testing easy, and improve the design on the way.  I think<br/>\nthis fits into &#39;simplest possible&#39; principle also.<br/>\n<br/>\nThat sounds good to me. Often the trick is just to provide a level of<br/>\nindirection for getting hold of objects. For example, quite often we have<br/>\nmultiple constructors -- one with parameters to allow you pass in mock<br/>\ninstances, and another one that calls it that provides default<br/>\nimplementations:<br/>\n<br/>\n<br/>\nclass Thing {<br/>\n  public Thing(Param1 aParam) {<br/>\n     self(aParam, new RealObject());<br/>\n  }<br/>\n  public Thing(Param1 aParam, Realnterface aReal) {<br/>\n     param = aParam;<br/>\n     real = aReal;<br/>\n  }<br/>\n  [...]<br/>\n}<br/>\n<br/>\nThe other one we use a lot is lazy construction. Create an instance of the<br/>\nreal object if you haven&#39;t already preloaded a mock one.<br/>\n<br/>\nSteve<br/>\n<br/>\n<br/>\n<br/>\n<br/>\nTo unsubscribe from this group, send an email to:<br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit-unsubscribe@yahoogroups.com\">junit-unsubscribe@yahoogroups.com</a><br/>\n<br/>\n<br/>\nYour use of Yahoo! Groups is subject to <a rel=\"nofollow\" target=\"_blank\" href=\"http://docs.yahoo.com/info/terms/\">http://docs.yahoo.com/info/terms/</a></div>", 
    "prevInTime": 2460, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "998554754", 
    "canDelete": false, 
    "nextInTopic": 2463, 
    "prevInTopic": 2457, 
    "headers": {
        "inReplyToHeader": "PDAxMGYwMWMxMmI1OCQyM2Y4YWEyMCQwMTAwMDA1YUBnYXRld2F5Pg==", 
        "messageIdInHeader": "PE5EQkJLRlBLUEtBUEpMQUhMUE9ES0VOSURLQUEuZGllZ28ubWVkaWNpQGRpYWxvZ29zMy5jb20+"
    }
}