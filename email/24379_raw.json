{
    "numMessagesInTopic": 1, 
    "nextInTime": 24380, 
    "senderId": "lniUPkIqnPdtp-KUIcjf06xS-dut4_vUqsrEKty9nVcCgIwQWFr8DqUhe6qAxi7GPA6MX49eKI-6dgxi_JvLImtNCd0kGPnQ9Wcy2Q", 
    "systemMessage": false, 
    "subject": "Out of Mem when using @DataPoints with Iterator type, request lazy fetch", 
    "from": "&quot;willmcqueen&quot; &lt;willmcqueen@...&gt;", 
    "authorName": "willmcqueen", 
    "msgSnippet": "Hi, ... ...but just one problem -- the JUnit Iterable @DataPoints doesn t seem to get the data lazily... it looks like it slurps everything into memory before", 
    "msgId": 24379, 
    "rawEmail": "Return-Path: &lt;willmcqueen@...&gt;\r\nReceived: (qmail 28597 invoked by uid 7800); 2 May 2013 05:18:33 -0000\r\nX-Sender: willmcqueen@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 97489 invoked by uid 102); 2 May 2013 04:23:56 -0000\r\nX-Received: from unknown (HELO mta2.grp.bf1.yahoo.com) (10.193.84.150)\n  by m3.grp.bf1.yahoo.com with SMTP; 2 May 2013 04:23:56 -0000\r\nX-Received: (qmail 4499 invoked from network); 2 May 2013 04:23:56 -0000\r\nX-Received: from unknown (HELO ng8-ip2.bullet.mail.bf1.yahoo.com) (98.139.165.58)\n  by mta2.grp.bf1.yahoo.com with SMTP; 2 May 2013 04:23:56 -0000\r\nX-Received: from [98.139.164.120] by ng8.bullet.mail.bf1.yahoo.com with NNFMP; 02 May 2013 04:23:56 -0000\r\nX-Received: from [10.193.94.41] by tg1.bullet.mail.bf1.yahoo.com with NNFMP; 02 May 2013 04:23:56 -0000\r\nDate: Thu, 02 May 2013 04:23:55 -0000\r\nTo: junit@yahoogroups.com\r\nMessage-ID: &lt;klspor+f39h@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: &quot;willmcqueen&quot; &lt;willmcqueen@...&gt;\r\nSubject: Out of Mem when using @DataPoints with Iterator type, request lazy fetch\r\nX-Yahoo-Group-Post: member; u=125879749; y=kux5ufSyx0QP-AzyXcAWvyDTBZC120_NtzAQqnMe8JxIvd_1pGU\r\nX-Yahoo-Profile: willmcqueen\r\nX-eGroups-Approved-By: dsaff &lt;david@...&gt; via email; 2 May 2013 05:18:33 -0000\r\n\r\nHi,\n\nI see that in the current master branch of JUnit, the JUnit 4.12 relea=\r\nse notes say:\n\n&gt; &quot;Pull request #658: Iterables can now be used as datapoint=\r\ns\n&gt; Previously when building sets of datapoints for Theory parameters\n&gt; the=\r\n only valid multi-valued @DataPoints types were arrays. This has\n&gt; now been=\r\n extended to also take parameters from iterable @DataPoints\n&gt; methods and f=\r\nields.&quot;\n\nFantastic. To me this means that we can now have something similar=\r\n to TestNG&#39;s DataProvider that returns an &#39;Iterator&lt;Object[]&gt;&#39; (http://test=\r\nng.org/doc/documentation-main.html):\n\n&gt; An Iterator&lt;Object[]&gt;. The only dif=\r\nference with Object[][] is that an Iterator\n&gt; lets you create your test dat=\r\na lazily. TestNG will invoke the iterator and then\n&gt; the test method with t=\r\nhe parameters returned by this iterator one by one.\n&gt; This is particularly =\r\nuseful if you have a lot of parameter sets to pass to the\n&gt; method and you =\r\ndon&#39;t want to create all of them upfront.\n\n...but just one problem -- the J=\r\nUnit Iterable @DataPoints doesn&#39;t seem to get the data lazily... it looks l=\r\nike it slurps everything into memory before passing it to the Theory test. =\r\nI&#39;d like to request that we please change the implementation of this method=\r\n so that the data is ingested lazily (one element at a time, or maybe in ba=\r\ntches) to avoid OOME. As a quick test, what I&#39;d consider to be a desirable =\r\nimplementation would be one that passes a test that uses this infinite @Dat=\r\naPoints:\n\nimport com.google.common.collect.Iterables\n  @DataPoints\n  public=\r\n static Iterable&lt;String&gt; infiniteDataStream() {\n      return Iterables.cycl=\r\ne(&quot;one&quot;, &quot;two&quot;);  //continuously alternate between 2 values\n  }\n\n[Ref: http=\r\n://docs.guava-libraries.googlecode.com/git-history/v14.0.1/javadoc/com/goog=\r\nle/common/collect/Iterables.html#cycle(T...)]\n\nAlternatively, here&#39;s a fini=\r\nte test that still results in OOME:\n\nimport com.google.common.collect.Itera=\r\nbles\nimport java.util.Arrays;\nimport java.util.Collections;\n  public static=\r\n Iterable&lt;String&gt; finiteDataStream() {\n    //return 200 million copies of &quot;=\r\naaa&quot; and &quot;bbb&quot;\n    return Iterables.concat(Collections.nCopies(200000000, A=\r\nrrays.asList(&quot;aaa&quot;, &quot;bbb&quot;)));\n  }\n\nHere&#39;s the OOME:\n\njava.lang.OutOfMemoryE=\r\nrror: Java heap space\n\tat java.lang.AbstractStringBuilder.&lt;init&gt;(AbstractSt=\r\nringBuilder.java:45)\n\tat java.lang.StringBuilder.&lt;init&gt;(StringBuilder.java:=\r\n68)\n\tat org.junit.experimental.theories.internal.AllMembersSupplier.addIter=\r\nableValues(AllMembersSupplier.java:147)\n\tat org.junit.experimental.theories=\r\n.internal.AllMembersSupplier.addDataPointsValues(AllMembersSupplier.java:12=\r\n8)\n\tat org.junit.experimental.theories.internal.AllMembersSupplier.addMulti=\r\nPointMethods(AllMembersSupplier.java:83)\n\tat org.junit.experimental.theorie=\r\ns.internal.AllMembersSupplier.getValueSources(AllMembersSupplier.java:71)\n\t=\r\nat org.junit.experimental.theories.internal.Assignments.potentialsForNextUn=\r\nassigned(Assignments.java:78)\n\tat org.junit.experimental.theories.Theories$=\r\nTheoryAnchor.runWithIncompleteAssignment(Theories.java:162)\n\tat org.junit.e=\r\nxperimental.theories.Theories$TheoryAnchor.runWithAssignment(Theories.java:=\r\n153)\n\tat org.junit.experimental.theories.Theories$TheoryAnchor.evaluate(The=\r\nories.java:138)\n\tat org.junit.runners.ParentRunner.runLeaf(ParentRunner.jav=\r\na:271)\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4Cla=\r\nssRunner.java:72)\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(Blo=\r\nckJUnit4ClassRunner.java:51)\n\tat org.junit.runners.ParentRunner$3.run(Paren=\r\ntRunner.java:238)\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunne=\r\nr.java:63)\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java=\r\n:236)\n\tat org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)\n\t=\r\nat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)\n\tat org=\r\n.junit.runners.ParentRunner.run(ParentRunner.java:309)\n\tat org.junit.runner=\r\n.JUnitCore.run(JUnitCore.java:160)\n\tat com.intellij.junit4.JUnit4IdeaTestRu=\r\nnner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:77)\n\tat com.intellij.rt.=\r\nexecution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:195)\n=\r\n\tat com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:63)=\r\n\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.re=\r\nflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat=\r\n com.intellij.rt.execution.application.AppMain.main(AppMain.java:120)\n\n\nTha=\r\nnk you for considering this request.\n\nCheers,\nWill\n\n\n", 
    "profile": "willmcqueen", 
    "topicId": 24379, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 125879749, 
    "prevInTime": 24378, 
    "contentTrasformed": false, 
    "postDate": "1367468635", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PGtsc3BvcitmMzloQGVHcm91cHMuY29tPg=="
    }
}