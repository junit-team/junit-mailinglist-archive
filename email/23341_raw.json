{
    "numMessagesInTopic": 4, 
    "nextInTime": 23342, 
    "senderId": "85HRklmPjoafNFSKj9VHg0j77mqpe9xLzeU88XU0I8eHnNlb4mcbR0Bh64nZX3MRJCBEk5Xo7VPUsgFCW2O6BH0AbKDAW9qW_V4M3cSbnZ6udw", 
    "systemMessage": false, 
    "subject": "Re: [junit] Unit Testing with Spring", 
    "from": "Joakim Ohlrogge &lt;joakim.ohlrogge@...&gt;", 
    "authorName": "Joakim Ohlrogge", 
    "msgSnippet": "Yes it s ironic that testing spring stuff is so painful given that testability is one of the selling points (but it seems that applies to the parts, not the", 
    "msgId": 23341, 
    "rawEmail": "Return-Path: &lt;joakim.ohlrogge@...&gt;\r\nX-Sender: joakim.ohlrogge@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 24346 invoked from network); 18 Mar 2011 16:11:49 -0000\r\nX-Received: from unknown (98.137.34.44)\n  by m7.grp.sp2.yahoo.com with QMQP; 18 Mar 2011 16:11:49 -0000\r\nX-Received: from unknown (HELO mail-ww0-f42.google.com) (74.125.82.42)\n  by mta1.grp.sp2.yahoo.com with SMTP; 18 Mar 2011 16:11:48 -0000\r\nX-Received: by wwk4 with SMTP id 4so1465468wwk.3\n        for &lt;junit@yahoogroups.com&gt;; Fri, 18 Mar 2011 09:11:47 -0700 (PDT)\r\nX-Received: by 10.216.67.143 with SMTP id j15mr1333674wed.60.1300464707319; Fri,\n 18 Mar 2011 09:11:47 -0700 (PDT)\r\nMIME-Version: 1.0\r\nX-Received: by 10.216.5.70 with HTTP; Fri, 18 Mar 2011 09:11:27 -0700 (PDT)\r\nIn-Reply-To: &lt;AANLkTikcJ7o5dO0NaL2v8sQG--axOU8NPDV8+2uYoExU@...&gt;\r\nReferences: &lt;AANLkTikcJ7o5dO0NaL2v8sQG--axOU8NPDV8+2uYoExU@...&gt;\r\nDate: Fri, 18 Mar 2011 17:11:27 +0100\r\nX-Google-Sender-Auth: nK2YcZqmHu-5h_8bZIzK0vWWxv8\r\nMessage-ID: &lt;AANLkTimqoFrLg3iQbo0Q0ahmz2PvVW5pkBcEqPPc175j@...&gt;\r\nTo: junit@yahoogroups.com\r\nX-eGroups-Msg-Info: 2:4:8:0:2\r\nX-eGroups-From: Joakim Ohlrogge &lt;joakim.ohlrogge@...&gt;\r\nFrom: Joakim Ohlrogge &lt;joakim.ohlrogge@...&gt;\r\nReply-To: joakim.ohlrogge@...\r\nSubject: Re: [junit] Unit Testing with Spring\r\nX-Yahoo-Group-Post: member; u=261856052; y=WuROiBFEIG68a0fWk67Hq2n4AwK3potssfZGVX2JCFWY_jOX\r\nX-Yahoo-Profile: j0hlrogge\r\nContent-Type: text/plain\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nYes it&#39;s ironic that testing spring stuff is so painful given that\ntestabil=\r\nity is one of the selling points (but it seems that applies to the\nparts, n=\r\not the wireing of the parts). The biggest issues I have had are:\n\n1) Contex=\r\nts are slow to load\n2) Programatically replacing stuff in an already loaded=\r\n conext is not\nstraight forward\n3) Having different xml-setups for testing =\r\nand production soon becomes a\nnightmare.\n\nWhen it comes to 1 I have come to=\r\n break the rule of test isolation. I\nbasically load the context beforeClass=\r\n or even as a *gasp* singleton to only\nbe hit once by the load time. This m=\r\nakes it crucial to be careful about\nmutable state and side effects in the t=\r\nests for obvious reasons. It is a bit\nlike juggling with knives but reloadi=\r\nng the context for each test is simply\nnot practical.\n\nThe funny part is th=\r\nat spring sort of encourages mutability by prefering\nsetters over construct=\r\nors.\n\nTo some extent you can have a &quot;global&quot; parent context and programatic=\r\nally\ncreate child contexts on top of that but I have forgotten how but it&#39;s=\r\n a\nproblem that is solvable within a day or so.\n\nIf you keep the parts immu=\r\ntable and involve an in memory DB running tests in\ntransactions really help=\r\n.\n\nWhen it comes to 2 it is difficult, not impossible but if you go with th=\r\ne\nglobal context approach it quickly becomes nasty. Again for obvious\nreaso=\r\nns...\n\nWhen it comes to 3 it sort of forces you to solve 2 and deal with th=\r\ne\nconsequences in combination with 1.\n\nThis is one of the reasons why peopl=\r\ne have started considering dependency\ninjection to be evil. Guice however i=\r\ns a completely different story. Modules\nare lightning fast to load and whil=\r\ne guice solves the same problem as spring\nit does it in a completely differ=\r\nent way. Guice is more about defining the\nrules of wiring rather than the a=\r\nctual wiring and it makes a world of\ndifference.\n\nI understand you&#39;re stuck=\r\n with spring now and that guice is not really an\noption for you. I just men=\r\ntion that so that you see that the experience with\ndependency injection fra=\r\nmeworks doesn&#39;t have to be very similar at all to\nthe spring experience we =\r\nyou will later advice people to avoid DIP\nframeworks entirely when you real=\r\nly mean avoid Spring :)\n\nIn contrast to spring guice is actually very helpf=\r\nul when unittesting and it\nbecomes much easier to add and remove dependenci=\r\nes. In spring the philosophy\nis more to be explicit about stuff and that XM=\r\nL stuff... well, I rest my\ncase.\n\nLong story short: loading times of contex=\r\nts is the biggest issue IMO. My\nworkaround for them is to break test isolat=\r\nion and load once, not many. To\ndeal with that I try to eliminate or at lea=\r\nst isolate side effects as much\nas possible. I can imagine that in an exist=\r\ning system that is not really the\nstate of things...\n\nSpring has a lot of g=\r\nood stuff in it too like JDBCTemplates etc, I still use\nthose but I wire ma=\r\nnually, or if motivated with guice.\n\nI don&#39;t think, but hope, this helps so=\r\nme :)\n\n-----------------------------------------------------\nJoakim Ohlrogg=\r\ne\nAgical AB\nV=E4sterl=E5nggatan 79, 2 tr\n111 29 Stockholm, SWEDEN\n\nMobile: =\r\n+46-708-754004\nBlog: johlrogge.wordpress.com\nE-mail: joakim.ohlrogge@agical=\r\n.se\n\n\nOn Fri, Mar 18, 2011 at 4:25 PM, Mark Levison &lt;mark@...&gt; wro=\r\nte:\n\n&gt;\n&gt;\n&gt; I&#39;m working with a client who&#39;re using Spring extensively. When =\r\nI look at\n&gt; their Unit Test code I realize that I&#39;m looking at a heap\n&gt; of =\r\nintegration tests and not real Unit Tests. In part it seems to come from\n&gt; =\r\nthe autowiring of Spring. In addition I&#39;ve been told that creating new\n&gt; co=\r\nntexts on the fly in Spring can (in their case) really slow the running\n&gt; o=\r\nf\n&gt; the unit tests.\n&gt;\n&gt; I realize that we can bypass Spring completely but =\r\nthe point was made that\n&gt; in that case we&#39;re testing without the Spring Sec=\r\nurity Context and other\n&gt; rules, which means we&#39;re not really testing how t=\r\nhe code behaves in real\n&gt; life.\n&gt;\n&gt; I&#39;m wondering if any one has good writi=\r\nng on Unit Testing with Spring so I\n&gt; can get my head wrapped around what i=\r\nt looks when its done well?\n&gt;\n&gt; Cheers\n&gt; Mark Levison\n&gt;\n&gt; [image: Mark] &lt;ht=\r\ntp://www.flickr.com/photos/36331075@N00/3833840021/&gt;*Mark\n&gt; Levison* | Agil=\r\ne Pain Relief Consulting &lt;http://agilepainrelief.com/&gt; |\n&gt; Certified Scrum =\r\nTrainer\n&gt; Agile Editor @ InfoQ &lt;http://www.infoq.com/about.jsp&gt; |\n&gt; Blog&lt;ht=\r\ntp://www.notesfromatooluser.com/&gt;|\n&gt; Twitter &lt;http://twitter.com/mlevison&gt; =\r\n| Office: (613) 862-2538\n&gt; Recent Entries: Story Slicing How Small is Small=\r\n\n&gt; Enough&lt;\n&gt; http://agilepainrelief.com/notesfromatooluser/2010/09/story-sl=\r\nicing-how-small-is-enough.html\n&gt; &gt;,\n&gt; Why use an Agile\n&gt; Coach&lt;\n&gt; http://ww=\r\nw.notesfromatooluser.com/2009/11/why-use-an-agile-coach.html&gt;\n&gt;\n&gt; [Non-text=\r\n portions of this message have been removed]\n&gt;\n&gt;  \n&gt;\n\n\n[Non-text portions o=\r\nf this message have been removed]\n\n\n", 
    "profile": "j0hlrogge", 
    "topicId": 23340, 
    "spamInfo": {
        "reason": "4", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 261856052, 
    "prevInTime": 23340, 
    "contentTrasformed": false, 
    "postDate": "1300464687", 
    "canDelete": false, 
    "nextInTopic": 23342, 
    "prevInTopic": 23340, 
    "headers": {
        "inReplyToHeader": "PEFBTkxrVGlrY0o3bzVkTzBOYUwydjhzUUctLWF4T1U4TlBEVjgrMnVZb0V4VUBtYWlsLmdtYWlsLmNvbT4=", 
        "messageIdInHeader": "PEFBTkxrVGltcW9GckxnM2lRYm8wUTBhaG16MlB2Vlc1cGtCY0VxUFBjMTc1akBtYWlsLmdtYWlsLmNvbT4=", 
        "referencesHeader": "PEFBTkxrVGlrY0o3bzVkTzBOYUwydjhzUUctLWF4T1U4TlBEVjgrMnVZb0V4VUBtYWlsLmdtYWlsLmNvbT4="
    }
}