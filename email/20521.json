{
    "numMessagesInTopic": 21, 
    "nextInTime": 20522, 
    "senderId": "pUvvCgwDDPkRvHGxqE2fn71HeU7uNVIZJqfNQamwDJ6MfDPa5TvLIJGxtABZEBlXwe1i_sdyY77lIoSpQs5hzSRL06EimcuUXfRieHsF", 
    "systemMessage": true, 
    "subject": "Re: What is expected behavior on Assert.assertEquals on Number object?", 
    "from": "&quot;Roger Glover&quot; &lt;glover_roger@...&gt;", 
    "authorName": "Roger Glover", 
    "msgSnippet": "Sorry about how hosed my last message looked. I used the new Rich Text Editor (Beta) , which apparently did not play nicely with whatever the moderator was", 
    "msgId": 20521, 
    "profile": "glover_roger", 
    "topicId": 20513, 
    "spamInfo": {
        "reason": "6", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 151020962, 
    "messageBody": "<div id=\"ygrps-yiv-1616835817\">Sorry about how hosed my last message looked. I used the new &quot;Rich<br/>\nText Editor (Beta)&quot;, which apparently did not play nicely with<br/>\nwhatever the moderator was using to review messages and push them<br/>\nthrough to the group. Here it is again, hopefully in a better format.<br/>\n<br/>\n<blockquote><span title=\"qreply\"> --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>, &quot;J. B. Rainsberger&quot; &lt;jbrains762@&gt; wrote:<br/>\n&gt; On Jun 3, 2008, at 22:41 , Nattapong Sirilappanich wrote:<br/>\n&gt; &gt; Hi,<br/>\n&gt; &gt;<br/>\n&gt; &gt; When i try to make an assertion on Number object, e.g.<br/>\n&gt; &gt; Double the result always assertion successful. Even i try<br/>\n&gt; &gt; to compare by<br/>\n&gt; &gt;<br/>\n&gt; &gt; org.junit.Assert.assertEquals(123456789.345,123456789.34)<br/>\n&gt; &gt;<br/>\n&gt; &gt; it still success. (I&#39;m expecting failure)<br/>\n<br/>\nThis is not a good way to compare floating point numbers. You should<br/>\nactually use:<br/>\n<br/>\nAssert.assertEquals(expected, actual, delta)<br/>\n<br/>\nwhere &quot;expected&quot; and &quot;actual&quot; are as in the form you did use, but<br/>\nthere is a third &quot;delta&quot; argument (also a double). This argument<br/>\nprovides a tolerance value by which to judge &quot;equality&quot;. Basically the<br/>\nassertion fails if:<br/>\n<br/>\nMath.abs(expected - actual) &gt; delta<br/>\n<br/>\nThus, working from your failing example and adding the &quot;delta&quot; argument:<br/>\n<br/>\nAssert.assertEquals(123456789.345, 123456789.34, 0.5);    // PASS<br/>\nAssert.assertEquals(123456789.345, 123456789.34, 0.0005); // FAIL<br/>\n<br/>\nBy the way, this usage really makes the name of the method a misnomer.<br/>\nIt should really be called &quot;assertClose()&quot; (as in &quot;close, but no<br/>\ncigar&quot;, not as in &quot;close the door; it&#39;s cold&quot;). But that should be<br/>\nokay if you are using double the way it is meant to be used, because,<br/>\nas the old saying goes, &quot;close&quot; only counts in horseshoes, hand<br/>\ngrenades, and limited precision floating point operations.<br/>\n<br/>\nIn other words, the idea is that after even a few operations (or even<br/>\nafter no operations in some cases) it is unreasonable to expect<br/>\nfloating point quantities to be exactly equal to their unlimited<br/>\nprecision real number counterparts (even when an exact match exists).<br/>\nSo you aim for &quot;close&quot; instead. &quot;How close can you get&quot; is itself a<br/>\nblack art that combines roughly equal portions of operation counting,<br/>\nnumber magnitude tracking, operation order tracking, and wild-ass<br/>\nguessing.<br/>\n<br/>\nNow back to the problem at hand. Just for grins I compiled Nattapong&#39;s<br/>\noriginal assert under a J2SE 1.4 compiler and it gave a syntax error,<br/>\nsaying that essentially that the third double argument was missing. It<br/>\nappears that this is one of those rare-but-not-rare-enough cases when<br/>\nautoboxing is actually working against you.<br/>\n<br/>\nAnd now J.B.&#39;s response...<br/>\n&gt; Weird. assertEquals() appears only to compare the whole parts.<br/>\n&gt; <br/>\n&gt; public class DoubleTest {<br/>\n&gt;    @Test<br/>\n&gt;    public void unequalDoubleValueObjectsShouldBeUnequal() {<br/>\n&gt;      Assert.assertFalse(new Double(3).equals(new Double(4)));<br/>\n&gt;      Assert.assertFalse(new Double(3.1d).equals(new Double(3.2d)));<br/>\n&gt;      Assert.assertFalse(new Double(123456789.345d).equals(<br/>\n&gt;        new Double(123456789.34d)));<br/>\n<br/>\nSo far so good...<br/>\n<br/>\n&gt;      Assert.assertEquals(new Double(123456789.345d),<br/>\n&gt;        new Double(123456789.34d));<br/>\n<br/>\nWhen compiled under J2SE 1.4 the above &quot;assertEquals()&quot; fails. So,<br/>\nonce again, I suspect autoboxing is the culprit. In this case I<br/>\nsuspect the Doubles are being &quot;unboxed&quot; into longs, since there is a<br/>\ntwo-long &quot;assertEquals()&quot; method but not a two-double &quot;assertEquals()&quot;<br/>\nmethod.<br/>\n<br/>\n&gt;      Assert.assertEquals(new Double(3.1d), new Double(3.2d));<br/>\n<br/>\nSame as with the above.<br/>\n<br/>\n&gt;      Assert.assertEquals(new Double(3), new Double(4));<br/>\n<br/>\nSame as with the above, but if I am right this one fails (as J.B.<br/>\nnoted) because the integral parts are different, so you get different<br/>\nlongs.<br/>\n<br/>\n&gt;    }<br/>\n&gt; }<br/>\n&gt; <br/>\n&gt; Only the last assertion fails.<br/>\n<br/>\nThis behavior makes me wonder anew about in Nattapong&#39;s original case.<br/>\nMy best guess is that the primitive doubles are being boxed into<br/>\nobject Doubles which are, in turn, being unboxed into primitive longs<br/>\n(to match the two-long overload). Strange but perhaps true. If that is<br/>\nnot what is happening, something *even stranger* is going on. Either<br/>\nway, I don&#39;t particularly like it.<br/>\n<br/>\nBut, truth to tell you really should be using the three-double<br/>\noverload of the &quot;assertEquals()&quot; method. Then you would not be having<br/>\nthis problem.<br/>\n<br/>\n-- Roger Glover<br/>\n   Object Partners, Inc. </span></blockquote></div>", 
    "prevInTime": 20520, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1212720032", 
    "canDelete": false, 
    "nextInTopic": 20522, 
    "prevInTopic": 20520, 
    "headers": {
        "inReplyToHeader": "PGcyOWM0bCttZ2ZvQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PGcyYTgzMCs5aTJtQGVHcm91cHMuY29tPg=="
    }
}