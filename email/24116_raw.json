{
    "numMessagesInTopic": 27, 
    "nextInTime": 24117, 
    "senderId": "mH4ucNmyEhQzuUVKCfdAlh61k1_fYrkK0rIv6uy9-7LM0KTpTgZ5AoYt1c4xf-vOETr0-TK1pMko6TuN4rf09e6bnJ2sq3eLz51gSKSAGjphVk8SpelIEnA", 
    "systemMessage": true, 
    "subject": "Re: [junit] assertArrayEquals on arrays of objects", 
    "from": "Stephen Connolly &lt;stephen.alan.connolly@...&gt;", 
    "authorName": "Stephen Connolly", 
    "msgSnippet": "... Wel let s not mention the case I found where in a conference call scheduling application, the DateTimeHelper class got abused by another developer in", 
    "msgId": 24116, 
    "rawEmail": "Return-Path: &lt;stephen.alan.connolly@...&gt;\r\nReceived: (qmail 9222 invoked from network); 19 Nov 2012 13:05:44 -0000\r\nReceived: from unknown (98.137.35.161)\n  by m1.grp.sp2.yahoo.com with QMQP; 19 Nov 2012 13:05:44 -0000\r\nReceived: from unknown (HELO ng1-vm5.bullet.mail.gq1.yahoo.com) (98.136.219.5)\n  by mta5.grp.sp2.yahoo.com with SMTP; 19 Nov 2012 13:05:43 -0000\r\nDKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoogroups.com; s=echo; t=1353330343; bh=fax5kqFA4jOBXRfiKeZep05P1ZtLyNewBNUK/NlE5Zo=; h=Received:Received:X-Sender:X-Apparently-To:X-Received:X-Received:X-Received:X-Received:MIME-Version:X-Received:X-Received:In-Reply-To:References:Date:Message-ID:To:X-Originating-IP:X-eGroups-Msg-Info:From:Subject:X-Yahoo-Group-Post:X-Yahoo-Profile:Content-Type:Content-Transfer-Encoding:X-YGroups-SubInfo:Sender:X-Yahoo-Newman-Property:X-eGroups-Approved-By:X-eGroups-Auth; b=pj8449euHXdt9tiMNdsydy9lg2AZLY7JiVOEPaPxTCSXW3roVji3+hFLpi12WLmzGuxLFZdvsFTD5GsD9EDHuM4qdLeK0ummQrutNs/jZi+zhSjGfOHhHDi4dhPZfUTQxMNpARvNPSd/I8uM8N7ulhrSFsVtbul1tT+7XFeaoJ8=\r\nReceived: from [98.137.0.89] by ng1.bullet.mail.gq1.yahoo.com with NNFMP; 19 Nov 2012 13:05:43 -0000\r\nReceived: from [98.137.34.119] by tg9.bullet.mail.gq1.yahoo.com with NNFMP; 19 Nov 2012 13:05:43 -0000\r\nX-Sender: stephen.alan.connolly@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 54487 invoked from network); 19 Nov 2012 11:51:10 -0000\r\nX-Received: from unknown (98.137.34.44)\n  by m5.grp.sp2.yahoo.com with QMQP; 19 Nov 2012 11:51:10 -0000\r\nX-Received: from unknown (HELO mail-we0-f174.google.com) (74.125.82.174)\n  by mta1.grp.sp2.yahoo.com with SMTP; 19 Nov 2012 11:51:09 -0000\r\nX-Received: by mail-we0-f174.google.com with SMTP id d7so487233wer.19\n        for &lt;junit@yahoogroups.com&gt;; Mon, 19 Nov 2012 03:51:08 -0800 (PST)\r\nMIME-Version: 1.0\r\nX-Received: by 10.216.200.198 with SMTP id z48mr4419497wen.7.1353325868608; Mon,\n 19 Nov 2012 03:51:08 -0800 (PST)\r\nX-Received: by 10.217.5.195 with HTTP; Mon, 19 Nov 2012 03:51:08 -0800 (PST)\r\nIn-Reply-To: &lt;CAOBkoFULbk0DMQiid5V-UUyAJF3ORHiChMet9_siAadb8zY0Bg@...&gt;\r\nReferences: &lt;k88p63+p6jc@...&gt;\n\t&lt;DA6E9228-6EDC-44AE-92A0-35B06F81104C@...&gt;\n\t&lt;20121117153056.53bc6f70@habanero&gt;\n\t&lt;24D3CBB2-4D7C-4EED-B45B-9DC5106DA473@...&gt;\n\t&lt;20121117162005.7760a9d4@habanero&gt;\n\t&lt;CA+nPnMzsWg2zg8avA86PAwgoRzHJpkKkEFoKYiH5j6T5bCCu=A@...&gt;\n\t&lt;CAOphgJAjeM_u5XABQ8Zc481Q1cH-w-jKDBze06f5HTj_Lr2Y3g@...&gt;\n\t&lt;CA+nPnMwgGQ8WGHnOQU9_mDbOQEHWEZAg9Z2W1vez4q_Jjs+E_g@...&gt;\n\t&lt;CAOBkoFULbk0DMQiid5V-UUyAJF3ORHiChMet9_siAadb8zY0Bg@...&gt;\r\nDate: Mon, 19 Nov 2012 11:51:08 +0000\r\nMessage-ID: &lt;CA+nPnMwhkbnhiH_6FZofo8XW89OxXYU8c8X2K3cd+WP8SRsFKg@...&gt;\r\nTo: &quot;junit@yahoogroups.com&quot; &lt;junit@yahoogroups.com&gt;\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: Stephen Connolly &lt;stephen.alan.connolly@...&gt;\r\nSubject: Re: [junit] assertArrayEquals on arrays of objects\r\nX-Yahoo-Group-Post: member; u=458231986; y=j1XrkT7DWcKGQmqNAVdI-XlHj4w4G21BGSXU3OB6RH0UATa7YdWppR-BHHOh0Q\r\nX-Yahoo-Profile: stephenalanconnolly\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Yahoo-Newman-Property: groups-system\r\nX-eGroups-Approved-By: spchappell &lt;simonpeterchappell@...&gt; via web; 19 Nov 2012 13:05:41 -0000\r\n\r\nOn 19 November 2012 07:47, Matthew Farwell &lt;matthew@...&gt; wrote:\n\n=\r\n&gt; I partially disagree with this statement. Yes, adding more code adds more=\r\n\n&gt; scope for introducing bugs, but if you&#39;re adding code that allows your c=\r\node\n&gt; to be tested, then that is a good thing. When I&#39;m dealing with dates =\r\nand\n&gt; times in code, then it&#39;s a very common idiom to see a DateTimeHelper =\r\nwhich\n&gt; an be injected so that you can test code which depends on the curre=\r\nnt date\n&gt; and time. Without this, it&#39;s very hard to test this sort of code.=\r\n\n&gt;\n&gt; So adding code can make my code more reliable. Within reason, of cours=\r\ne.\n&gt;\n&gt;\nWel let&#39;s not mention the case I found where in a conference call\nsc=\r\nheduling application, the DateTimeHelper class got abused by another\ndevelo=\r\nper in production code to &quot;work around&quot; some DST issue causing all\nsorts of=\r\n bugs.... which only happened on the last day of October and only\nif it was=\r\n a Thursday!\n\nThank goodness we had Jenkins running nightly tests, and nobo=\r\ndy had\ncommitted *any* changes to that branch that week... or we would neve=\r\nr have\nfound the bug.\n\nAdding code to &quot;make testing easier&quot; can have uninte=\r\nnded consequences when\nothers come along maintaining your code and start to=\r\n abuse your API\ncontract!\n\n[Yes it was somebody doing something they should=\r\nn&#39;t have... and yes I\nsuspect they would have used reflection to achieve th=\r\ne same bug if the\nhelper was not there... but that would have been a bigger=\r\n more glaring code\nsmell]\n\n\n&gt; I would say that if your equals/hashCode aren=\r\n&#39;t necessary except for tests,\n&gt; then don&#39;t put them in. You can always ove=\r\nrride/mock them in your tests if\n&gt; you really really need them. However, I =\r\nwould feel that having equals and\n&gt; hashCode *only* in the tests is probabl=\r\ny a code smell. I can&#39;t think of an\n&gt; example where this would be necessary=\r\n. Most of the time, I suspect you can\n&gt; do a sort with an explicit comparat=\r\nor if you want to compare two\n&gt; collections.\n&gt;\n\nThe real issue is that Comp=\r\narator, Object.equals, Object.hashCode all have\nan implicit contract define=\r\nd by the JRE, and you need to ensure that they\nare correctly implemented *w=\r\nith respect to that contract*. The comparisons\nthat you need to make in uni=\r\nt tests *need not necessarily be the same* as\nthe required contract that yo=\r\nur classes are required to follow for their\ncorrect behaviour in production=\r\n.\n\nAs long as when you are writing your\n\nassertThat(x, is(y))\n\nor\n\nassertEq=\r\nuals(y, x);\n\nyou stop and think: &quot;Is it really the equality as specified by=\r\n the x&#39;s\n.equals() method that I want to check&quot; then you are fine.\n\nBecause=\r\n often enough, you may not require that test.\n\n\n&gt;\n&gt; Matthew Farwell.\n&gt;\n&gt; 20=\r\n12/11/18 Stephen Connolly &lt;stephen.alan.connolly@...&gt;\n&gt;\n&gt; &gt; **\n&gt; &gt;\n&gt; =\r\n&gt; Every line of code you write introduces another place for you to write a\n=\r\n&gt; &gt; bug. So adding test hooks to your production code, whatever form those\n=\r\n&gt; &gt; hooks take, is adding more scope for bugs.\n&gt; &gt;\n&gt; &gt; Production code shou=\r\nld be just what is required and no more, ie no dead\n&gt; &gt; code please.\n&gt; &gt;\n&gt; =\r\n&gt; That is the ideal we should strive for, just as 100% coverage is the\n&gt; id=\r\neal\n&gt; &gt; we should strive for.\n&gt; &gt;\n&gt; &gt; Now in practice, for my code, I usual=\r\nly implement equals and hash code...\n&gt; &gt; But I do so *following the correct=\r\n contract for equals and hashcode*\n&gt; &gt;\n&gt; &gt; One of the elements of that cont=\r\nract is that hashCode of two equal\n&gt; objects\n&gt; &gt; should be identical, and t=\r\nhat it should be based on the objects final\n&gt; &gt; fields.\n&gt; &gt;\n&gt; &gt; often enoug=\r\nh to warrant mentioning (though not every day), unless your\n&gt; &gt; objects are=\r\n immutable (I like immutable objects too btw which is why this\n&gt; &gt; doesn&#39;t =\r\nhappen every day for me) you will find that the necessities of\n&gt; the\n&gt; &gt; eq=\r\nuals and hashCode contracts with respect to collections etc, results in\n&gt; &gt;=\r\n equals methods that only compare on a subset of the objects fields, in\n&gt; &gt;=\r\n which case you need, in your tests, to compare on the non-final fields\n&gt; t=\r\noo.\n&gt; &gt;\n&gt; &gt; On other occasions I have found it necessary to leave the equal=\r\ns and\n&gt; &gt; hashCode methods unimplemented because I need specific behaviour =\r\nwithin\n&gt; &gt; collections. In such cases I typically have test cases to verify=\r\n that\n&gt; &gt; equals is inherited from Object so that future maintainers do not=\r\n\n&gt; &gt; accidentally add an implementation.\n&gt; &gt;\n&gt; &gt; Normally, I use a wrapper =\r\nclass for adding such objects to collections so\n&gt; &gt; that it is safe to use =\r\nequals... But that can put an excessive GC load,\n&gt; and\n&gt; &gt; as a result you =\r\nmay be forced to go without the wrapper... In a sense it\n&gt; &gt; is a pity that=\r\n the collections classes do not allow for plugable hashCode\n&gt; &gt; and equalit=\r\ny strategies,\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt; You might never have to test for equality=\r\n of your objects in production\n&gt; &gt; but\n&gt; &gt; &gt; need it for testing.\n&gt; &gt;\n&gt; &gt; O=\r\nr you might have need for the Object.equals behaviour\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt; A=\r\nnd more generally, there is really nothing wrong with implementing\n&gt; &gt; &gt; ha=\r\nshCode()/equals() for your objects that match their purpose.\n&gt; &gt;\n&gt; &gt; The po=\r\nint is that such purpose may not match the needs of testing.\n&gt; &gt;\n&gt; &gt; I agre=\r\ne that 95% if the time adding equals and hashCode is perfectly\n&gt; fine.\n&gt; &gt; =\r\nAnd since we often use IDE tooling or Guava&#39;s helpers (or equivalent\n&gt; &gt; he=\r\nlpers) to implement these methods it is very low risk. My point is that\n&gt; &gt;=\r\n there are times when it is less clear, and a subset of those where it is\n&gt;=\r\n &gt; the wrong thing to do.\n&gt; &gt;\n&gt; &gt; You should always know *why* you are addi=\r\nng code to production. Adding\n&gt; code\n&gt; &gt; *just because your tests need it* =\r\nis a bad code smell... It indicates\n&gt; that\n&gt; &gt; either you don&#39;t understand =\r\na production requirement of your code (which\n&gt; &gt; may mean that the equals m=\r\nethod is needed anyway) or you have a bad\n&gt; design\n&gt; &gt; of your production c=\r\node in the first place.\n&gt; &gt;\n&gt; &gt; Another final point is that relying on equa=\r\nls comparing equality as\n&gt; opposed\n&gt; &gt; to identity within your tests can hi=\r\nnder refactoring as it may make it\n&gt; &gt; harder to split the class given that=\r\n you then have to take care that the\n&gt; &gt; equals methods are split correctly=\r\n... Using duck comparison based on eg\n&gt; &gt; Guava&#39;s helpers is very little wo=\r\nrk and allows for correct testing.\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; &gt; --\n&gt; &gt; &gt; C=E9dric\n&gt; &gt; &gt;\n&gt; =\r\n&gt; &gt;\n&gt; &gt; &gt; [Non-text portions of this message have been removed]\n&gt; &gt; &gt;\n&gt; &gt; &gt;=\r\n\n&gt; &gt; &gt;\n&gt; &gt; &gt; ------------------------------------\n&gt; &gt; &gt;\n&gt; &gt; &gt; Yahoo! Groups=\r\n Links\n&gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt;\n&gt; &gt; [Non-text portions of this messa=\r\nge have been removed]\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt;\n&gt;\n&gt; [Non-text portions of this message =\r\nhave been removed]\n&gt;\n&gt;\n&gt;\n&gt; ------------------------------------\n&gt;\n&gt; Yahoo! =\r\nGroups Links\n&gt;\n&gt;\n&gt;\n&gt;\n\n\n[Non-text portions of this message have been removed=\r\n]\n\n\n", 
    "profile": "stephenalanconnolly", 
    "topicId": 24091, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 458231986, 
    "prevInTime": 24115, 
    "contentTrasformed": false, 
    "postDate": "1353325868", 
    "canDelete": false, 
    "nextInTopic": 24118, 
    "prevInTopic": 24115, 
    "headers": {
        "inReplyToHeader": "PENBT0Jrb0ZVTGJrMERNUWlpZDVWLVVVeUFKRjNPUkhpQ2hNZXQ5X3NpQWFkYjh6WTBCZ0BtYWlsLmdtYWlsLmNvbT4=", 
        "messageIdInHeader": "PENBK25Qbk13aGtibmhpSF82RlpvZm84WFc4OU94WFlVOGM4WDJLM2NkK1dQOFNSc0ZLZ0BtYWlsLmdtYWlsLmNvbT4=", 
        "referencesHeader": "PGs4OHA2MytwNmpjQGVHcm91cHMuY29tPgk8REE2RTkyMjgtNkVEQy00NEFFLTkyQTAtMzVCMDZGODExMDRDQGdtYWlsLmNvbT4JPDIwMTIxMTE3MTUzMDU2LjUzYmM2ZjcwQGhhYmFuZXJvPgk8MjREM0NCQjItNEQ3Qy00RUVELUI0NUItOURDNTEwNkRBNDczQGdtYWlsLmNvbT4JPDIwMTIxMTE3MTYyMDA1Ljc3NjBhOWQ0QGhhYmFuZXJvPgk8Q0ErblBuTXpzV2cyemc4YXZBODZQQXdnb1J6SEpwa0trRUZvS1lpSDVqNlQ1YkNDdT1BQG1haWwuZ21haWwuY29tPgk8Q0FPcGhnSkFqZU1fdTVYQUJROFpjNDgxUTFjSC13LWpLREJ6ZTA2ZjVIVGpfTHIyWTNnQG1haWwuZ21haWwuY29tPgk8Q0ErblBuTXdnR1E4V0dIbk9RVTlfbURiT1FFSFdFWkFnOVoyVzF2ZXo0cV9KanMrRV9nQG1haWwuZ21haWwuY29tPgk8Q0FPQmtvRlVMYmswRE1RaWlkNVYtVVV5QUpGM09SSGlDaE1ldDlfc2lBYWRiOHpZMEJnQG1haWwuZ21haWwuY29tPg=="
    }
}