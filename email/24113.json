{
    "numMessagesInTopic": 27, 
    "nextInTime": 24114, 
    "senderId": "al72j7fR-unKx8HFBW5zZkjQzfa6KsHMQ_yX62ROe9HuZsk8_aoRpjhvByBoQ5_Sz6HgH4vm8oGH3K-JGMyUJk_GxFPRisH6ZTKZ_He5", 
    "systemMessage": false, 
    "subject": "Re: [junit] assertArrayEquals on arrays of objects", 
    "from": "Matthew Farwell &lt;matthew@...&gt;", 
    "authorName": "Matthew Farwell", 
    "msgSnippet": "I partially disagree with this statement. Yes, adding more code adds more scope for introducing bugs, but if you re adding code that allows your code to be", 
    "msgId": 24113, 
    "profile": "mjfarwell", 
    "topicId": 24091, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 499556184, 
    "messageBody": "<div id=\"ygrps-yiv-1668591665\">I partially disagree with this statement. Yes, adding more code adds more<br/>\nscope for introducing bugs, but if you&#39;re adding code that allows your code<br/>\nto be tested, then that is a good thing. When I&#39;m dealing with dates and<br/>\ntimes in code, then it&#39;s a very common idiom to see a DateTimeHelper which<br/>\nan be injected so that you can test code which depends on the current date<br/>\nand time. Without this, it&#39;s very hard to test this sort of code.<br/>\n<br/>\nSo adding code can make my code more reliable. Within reason, of course.<br/>\n<br/>\nI would say that if your equals/hashCode aren&#39;t necessary except for tests,<br/>\nthen don&#39;t put them in. You can always override/mock them in your tests if<br/>\nyou really really need them. However, I would feel that having equals and<br/>\nhashCode *only* in the tests is probably a code smell. I can&#39;t think of an<br/>\nexample where this would be necessary. Most of the time, I suspect you can<br/>\ndo a sort with an explicit comparator if you want to compare two<br/>\ncollections.<br/>\n<br/>\nMatthew Farwell.<br/>\n<br/>\n2012/11/18 Stephen Connolly &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:stephen.alan.connolly@...\">stephen.alan.connolly@...</a>&gt;<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; **<br/>\n&gt;<br/>\n&gt; Every line of code you write introduces another place for you to write a<br/>\n&gt; bug. So adding test hooks to your production code, whatever form those<br/>\n&gt; hooks take, is adding more scope for bugs.<br/>\n&gt;<br/>\n&gt; Production code should be just what is required and no more, ie no dead<br/>\n&gt; code please.<br/>\n&gt;<br/>\n&gt; That is the ideal we should strive for, just as 100% coverage is the ideal<br/>\n&gt; we should strive for.<br/>\n&gt;<br/>\n&gt; Now in practice, for my code, I usually implement equals and hash code...<br/>\n&gt; But I do so *following the correct contract for equals and hashcode*<br/>\n&gt;<br/>\n&gt; One of the elements of that contract is that hashCode of two equal objects<br/>\n&gt; should be identical, and that it should be based on the objects final<br/>\n&gt; fields.<br/>\n&gt;<br/>\n&gt; often enough to warrant mentioning (though not every day), unless your<br/>\n&gt; objects are immutable (I like immutable objects too btw which is why this<br/>\n&gt; doesn&#39;t happen every day for me) you will find that the necessities of the<br/>\n&gt; equals and hashCode contracts with respect to collections etc, results in<br/>\n&gt; equals methods that only compare on a subset of the objects fields, in<br/>\n&gt; which case you need, in your tests, to compare on the non-final fields too.<br/>\n&gt;<br/>\n&gt; On other occasions I have found it necessary to leave the equals and<br/>\n&gt; hashCode methods unimplemented because I need specific behaviour within<br/>\n&gt; collections. In such cases I typically have test cases to verify that<br/>\n&gt; equals is inherited from Object so that future maintainers do not<br/>\n&gt; accidentally add an implementation.<br/>\n&gt;<br/>\n&gt; Normally, I use a wrapper class for adding such objects to collections so<br/>\n&gt; that it is safe to use equals... But that can put an excessive GC load, and<br/>\n&gt; as a result you may be forced to go without the wrapper... In a sense it<br/>\n&gt; is a pity that the collections classes do not allow for plugable hashCode<br/>\n&gt; and equality strategies,<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt; You might never have to test for equality of your objects in production<br/>\n&gt; but<br/>\n&gt; &gt; need it for testing.<br/>\n&gt;<br/>\n&gt; Or you might have need for the Object.equals behaviour<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt; And more generally, there is really nothing wrong with implementing<br/>\n&gt; &gt; hashCode()/equals() for your objects that match their purpose.<br/>\n&gt;<br/>\n&gt; The point is that such purpose may not match the needs of testing.<br/>\n&gt;<br/>\n&gt; I agree that 95% if the time adding equals and hashCode is perfectly fine.<br/>\n&gt; And since we often use IDE tooling or Guava&#39;s helpers (or equivalent<br/>\n&gt; helpers) to implement these methods it is very low risk. My point is that<br/>\n&gt; there are times when it is less clear, and a subset of those where it is<br/>\n&gt; the wrong thing to do.<br/>\n&gt;<br/>\n&gt; You should always know *why* you are adding code to production. Adding code<br/>\n&gt; *just because your tests need it* is a bad code smell... It indicates that<br/>\n&gt; either you don&#39;t understand a production requirement of your code (which<br/>\n&gt; may mean that the equals method is needed anyway) or you have a bad design<br/>\n&gt; of your production code in the first place.<br/>\n&gt;<br/>\n&gt; Another final point is that relying on equals comparing equality as opposed<br/>\n&gt; to identity within your tests can hinder refactoring as it may make it<br/>\n&gt; harder to split the class given that you then have to take care that the<br/>\n&gt; equals methods are split correctly... Using duck comparison based on eg<br/>\n&gt; Guava&#39;s helpers is very little work and allows for correct testing.<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; &gt; --<br/>\n&gt; &gt; Cï¿½dric<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt; [Non-text portions of this message have been removed]<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt; ------------------------------------<br/>\n&gt; &gt;<br/>\n&gt; &gt; Yahoo! Groups Links<br/>\n&gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt;<br/>\n&gt; [Non-text portions of this message have been removed]<br/>\n&gt;<br/>\n&gt;  <br/>\n&gt;<br/>\n<br/>\n<br/>\n </span></blockquote>[Non-text portions of this message have been removed]</div>", 
    "prevInTime": 24112, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1353311250", 
    "canDelete": false, 
    "nextInTopic": 24114, 
    "prevInTopic": 24112, 
    "headers": {
        "inReplyToHeader": "PENBK25Qbk13Z0dROFdHSG5PUVU5X21EYk9RRUhXRVpBZzlaMlcxdmV6NHFfSmpzK0VfZ0BtYWlsLmdtYWlsLmNvbT4=", 
        "messageIdInHeader": "PENBT0Jrb0ZVTGJrMERNUWlpZDVWLVVVeUFKRjNPUkhpQ2hNZXQ5X3NpQWFkYjh6WTBCZ0BtYWlsLmdtYWlsLmNvbT4=", 
        "referencesHeader": "PGs4OHA2MytwNmpjQGVHcm91cHMuY29tPiA8REE2RTkyMjgtNkVEQy00NEFFLTkyQTAtMzVCMDZGODExMDRDQGdtYWlsLmNvbT4gPDIwMTIxMTE3MTUzMDU2LjUzYmM2ZjcwQGhhYmFuZXJvPiA8MjREM0NCQjItNEQ3Qy00RUVELUI0NUItOURDNTEwNkRBNDczQGdtYWlsLmNvbT4gPDIwMTIxMTE3MTYyMDA1Ljc3NjBhOWQ0QGhhYmFuZXJvPiA8Q0ErblBuTXpzV2cyemc4YXZBODZQQXdnb1J6SEpwa0trRUZvS1lpSDVqNlQ1YkNDdT1BQG1haWwuZ21haWwuY29tPiA8Q0FPcGhnSkFqZU1fdTVYQUJROFpjNDgxUTFjSC13LWpLREJ6ZTA2ZjVIVGpfTHIyWTNnQG1haWwuZ21haWwuY29tPiA8Q0ErblBuTXdnR1E4V0dIbk9RVTlfbURiT1FFSFdFWkFnOVoyVzF2ZXo0cV9KanMrRV9nQG1haWwuZ21haWwuY29tPg=="
    }
}