{
    "numMessagesInTopic": 11, 
    "nextInTime": 9281, 
    "senderId": "tei2fMGxUplX2V-V8JCJbOlZ_vu4uvlSFnJbhxEnMirmCnwYr2G1lXz-blCSVpnjBuHxvyAhiRz_SxJwf4lRHIUWOVZLAJXMO6Ew", 
    "systemMessage": false, 
    "subject": "Re: [junit] Re: Domain specific question", 
    "from": "Curt Sampson &lt;yahoo_sucks@...&gt;", 
    "authorName": "Curt Sampson", 
    "msgSnippet": "... I m essentially going to say the same thing as J. B. Rainsberger, but I m going to say it slightly differently, so perhaps this will be helpful. Don t do", 
    "msgId": 9280, 
    "rawEmail": "Return-Path: &lt;yahoo_sucks@...&gt;\r\nX-Sender: yahoo_sucks@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 86567 invoked from network); 5 Sep 2003 13:49:19 -0000\r\nReceived: from unknown (66.218.66.167)\n  by m10.grp.scd.yahoo.com with QMQP; 5 Sep 2003 13:49:19 -0000\r\nReceived: from unknown (HELO platonic.cynic.net) (204.80.150.245)\n  by mta6.grp.scd.yahoo.com with SMTP; 5 Sep 2003 13:49:19 -0000\r\nReceived: from angelic.cynic.net (angelic-platonic.cvpn.cynic.net [198.73.220.226])\n\tby platonic.cynic.net (Postfix) with ESMTP id 3127EBFFB\n\tfor &lt;junit@yahoogroups.com&gt;; Fri,  5 Sep 2003 13:49:09 +0000 (UTC)\r\nReceived: from localhost (localhost [127.0.0.1])\n\tby angelic.cynic.net (Postfix) with ESMTP id CDC5D8736\n\tfor &lt;junit@yahoogroups.com&gt;; Fri,  5 Sep 2003 22:49:07 +0900 (JST)\r\nDate: Fri, 5 Sep 2003 22:49:07 +0900 (JST)\r\nX-X-Sender: cjs@...\r\nTo: junit@yahoogroups.com\r\nSubject: Re: [junit] Re: Domain specific question\r\nIn-Reply-To: &lt;bj8cj4$b53$1@...&gt;\r\nMessage-ID: &lt;Pine.NEB.4.51.0309052225360.3505@...&gt;\r\nReferences: &lt;bj803e$n19$1@...&gt; &lt;3F57AEF3.9060206@...&gt;\n &lt;bj8cj4$b53$1@...&gt;\r\nMIME-Version: 1.0\r\nContent-Type: TEXT/PLAIN; charset=US-ASCII\r\nFrom: Curt Sampson &lt;yahoo_sucks@...&gt;\r\nX-Yahoo-Group-Post: member; u=110189933\r\nX-Yahoo-Profile: cjstokyo\r\n\r\nOn Thu, 4 Sep 2003, Venkatesh Prasad Ranganath wrote:\n\n&gt; No, the question is when you have many phases that setup the data\n&gt; on which an analysis works, how do you unit test the analysis\n&gt; efficiently?\n\nI&#39;m essentially going to say the same thing as J. B. Rainsberger, but\nI&#39;m going to say it slightly differently, so perhaps this will be\nhelpful.\n\nDon&#39;t do the phases that set up the data. Instead, create chunks of\n&quot;already-set-up&quot; data, and test against those. This is, basically, layer\ndecoupling.\n\nFor example, I unit test a lot of servlets that make database calls.\nThey&#39;ll invoke a method in the Repository that will perform some sort of\ndatabase action and return a result: say, &quot;get me an object representing\nthe user logged in at such-and-such an IP address.&quot;\n\nMaking this User object &quot;for real&quot; involves a lot of work, including\naccessing two different databases. However, when unit testing, my\nservlet, unbeknownst to it, is not using the Repository that digs around\nin various databases and performs processing and whanot, but is using a\ndifferent Repository (with the same interface, of course) that simply\nreturns a fixed, mock object based on the IP address.\n\nSo when testing, I know that the repository will return an\n&quot;unregistered&quot; user when asked who is logged in on 10.0.0.1, and a\n&quot;registered&quot; user when asked who is logged in on 10.0.0.2. I put those\nparameters into a servlet that is making decisions based on whether the\nuser is &quot;registered&quot; or &quot;unregistered,&quot; and check that that the servlet\nis doing the correct thing in each case.\n\nThis allows me to do the bare minimum of setup to get this working.\nThere&#39;s no database access at all. The Repository that&#39;s being invoked\nfor this is nowhere near fully functional, many of the methods just\nthrow an &quot;I am not implemented&quot; exception. The User object that&#39;s\nreturned is not even fully functional; a lot of its methods also return\nan &quot;I am not implemented&quot; exception. The mock objects that I&#39;m using do\njust barely enough to let me test, and that&#39;s it.\n\nThis is the real power of object oriented programming: the ability\neasily to substitute one object for another.\n\nNote that this does require changes to your non-test code to work. In my\nsystem, originally I could just call a static method to do the database\nwork. I now have an object (the Repository) with a couple of different\nsubclasses (the one that actually does the database stuff, and the test\nversion), and a mechanism for setting up a servlet or group of servlets\nwith the correct Repository depending on whether they&#39;re being tested or\nare in production. This is a lot of extra code which contributes nothing\nto my program in a production environment.\n\n&gt; It may take a long time to setup the data, hence, the\n&gt; code-test-refactor cycle will prove rather costly.\n\nRight. Here&#39;s an example of reduction of data-setup time. It takes a lot\nof steps to decide whether or not a user is really registered. But for\ntesting:\n\n    class TestRepository\n\timplements Repository\n    {\n\tUser getUserOnIPAddress(IPAddress address)\n\t{\n\t    if (IPAddress.valueOf(&quot;10.0.0.1&quot;).equals(address)) {\n\t\treturn new TestUser() {\n\t\t\tboolean isRegistered() {\n\t\t\t    return false;\n\t\t\t}\n\t\t    };\n\t    } else if (IPAddress.valueOf(&quot;10.0.0.2&quot;).equals(address)) {\n\t\treturn new TestUser() {\n\t\t\tboolean isRegistered() {\n\t\t\t    return false;\n\t\t\t}\n\t\t    };\n\t    }\n\t    return null;\n\t}\n    }\n\ncjs\n-- \nCurt Sampson  &lt;cjs@...&gt;   +81 90 7737 2974   http://www.NetBSD.org\n    Don&#39;t you know, in this new Dark Age, we&#39;re all light.  --XTC\n\n", 
    "profile": "cjstokyo", 
    "topicId": 9274, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 110189933, 
    "prevInTime": 9279, 
    "contentTrasformed": false, 
    "postDate": "1062769747", 
    "canDelete": false, 
    "nextInTopic": 9281, 
    "prevInTopic": 9279, 
    "headers": {
        "inReplyToHeader": "PGJqOGNqNCRiNTMkMUBzZWEuZ21hbmUub3JnPg==", 
        "messageIdInHeader": "PFBpbmUuTkVCLjQuNTEuMDMwOTA1MjIyNTM2MC4zNTA1QGFuZ2VsaWMtdnRmdy5jdnBuLmN5bmljLm5ldD4=", 
        "referencesHeader": "PGJqODAzZSRuMTkkMUBzZWEuZ21hbmUub3JnPiA8M0Y1N0FFRjMuOTA2MDIwNkByb2dlcnMuY29tPiA8Ymo4Y2o0JGI1MyQxQHNlYS5nbWFuZS5vcmc+"
    }
}