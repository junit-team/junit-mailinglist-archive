{
    "numMessagesInTopic": 9, 
    "nextInTime": 24491, 
    "senderId": "qxLKT6Mo1poEIxNMbD7pqh2nf4QwXUwPsfxZYUuTJkv7JOIzU2SqgjAp2VO7JfQuxlkycTFhqYGpnFBMpuJc", 
    "systemMessage": false, 
    "subject": "Asserts using Comparable.compareTo() instead of equals() (for BigDecimal and others)", 
    "from": "&lt;SwingGuy1024@...&gt;", 
    "authorName": "", 
    "msgSnippet": "Comrades, Comparing two BigDecimals for the same value shouldn t be done with the equals() method, since two instances that have the same value but a different", 
    "msgId": 24490, 
    "topicId": 24490, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 168476580, 
    "messageBody": "<div id=\"ygrps-yiv-514850569\">Comrades,<div><br></div><div>&nbsp; Comparing two BigDecimals for the same value shouldn&#39;t be done with the equals() method, since two instances that have the same value but a different scale won&#39;t be &quot;equal.&quot; But there aren&#39;t any methods in Assert.class to do this. This means I need to write this:</div><div><br></div><div>Assert.assertTrue(expected.compareTo(actual) == 0);</div><div><br></div><div>when I would rather write this:</div><div><br></div><div>Assert.assertCompare(expected, actual)</div><div><br></div><div>The second one has the added advantage that it can throw a ComparisonFailure, so I can see the two values in the test results.</div><div><br></div><div>I would like to suggest the following four methods be added to Assert.class:</div><div><br></div><div>&lt;T extends Comparable&lt;T&gt;&nbsp;<span style=\"word-spacing:normal;\">void</span><span style=\"word-spacing:normal;\">&nbsp;</span><span style=\"word-spacing:normal;\">assertCompare(T, T);</span></div><div>&lt;T extends Comparable&lt;T&gt;&nbsp;<span style=\"word-spacing:normal;\">void</span><span style=\"word-spacing:normal;\">&nbsp;</span><span style=\"word-spacing:normal;\">assertCompare(String, T, T)</span></div><div>&lt;T&gt; void assertCompare(T, T, Comparator&lt;T&gt;)<br></div><div>&lt;T&gt; void assertCompare(String, T, T, Comparator&lt;T&gt;)</div><div><br></div><div>I have some code that implements these methods. I have this working in a production environment. I use it on BigDecimal values, but it works with any values that implement Comparable, or anything for which you can write a Comparator.&nbsp;</div><div><br></div><div>Here is my proposed code:</div><div><br></div><div><div><div>&nbsp; &nbsp; /**</div><div>&nbsp; &nbsp; &nbsp;* Compare two Comparable objects using Comparable.compareTo() instead&nbsp;</div><div>&nbsp; &nbsp; &nbsp;* of equals(). This is most useful for classes for which Comparable is&nbsp;</div><div>&nbsp; &nbsp; &nbsp;* inconsistent with equals(), such as BigDecimal.</div><div>&nbsp; &nbsp; &nbsp;*</div><div>&nbsp; &nbsp; &nbsp;* @param expected</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;expected value</div><div>&nbsp; &nbsp; &nbsp;* @param actual</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;actual value</div><div>&nbsp; &nbsp; &nbsp;* @param &lt;T&gt;</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Any object that implements Comparable</div><div>&nbsp; &nbsp; &nbsp;* @see java.lang.Comparable</div><div>&nbsp; &nbsp; &nbsp;*/</div><div>&nbsp; &nbsp; public static &lt;T extends Comparable&lt;T&gt;&gt; void assertCompare(final T expected, final T actual) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; assertCompare(null, expected, actual);</div><div>&nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; /**</div><div>&nbsp; &nbsp; &nbsp;* Compare two Comparable objects using Comparable.compareTo() instead&nbsp;</div><div>&nbsp; &nbsp; &nbsp;* of equals(). This is primarily for classes for which Comparable is&nbsp;</div><div>&nbsp; &nbsp; &nbsp;* inconsistent with equals(), such as BigDecimal.</div><div>&nbsp; &nbsp; &nbsp;*</div><div>&nbsp; &nbsp; &nbsp;* @param message</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the identifying message for the {@link AssertionError} (&lt;code&gt;null&lt;/code&gt;</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;okay)</div><div>&nbsp; &nbsp; &nbsp;* @param expected</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;expected value</div><div>&nbsp; &nbsp; &nbsp;* @param actual</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;actual value</div><div>&nbsp; &nbsp; &nbsp;* @param &lt;T&gt;</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Any object that implements Comparable</div><div>&nbsp; &nbsp; &nbsp;* @see java.lang.Comparable</div><div>&nbsp; &nbsp; &nbsp;*/</div><div>&nbsp; &nbsp; public static &lt;T extends Comparable&lt;T&gt;&gt; void assertCompare(final String message, final T expected, final T actual) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; if (expected == null &amp;&amp; actual == null) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // okay</div><div>&nbsp; &nbsp; &nbsp; &nbsp; } else if (expected != null &amp;&amp; actual != null &amp;&amp; expected.compareTo(actual) == 0) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // We tested both for null here, because the compareTo method might</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // not handle a null parameter cleanly. (BigDecimal, for example,</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // throws a NullPointerException.) For these cases, it&#39;s</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // preferable to throw a ComparisonFailure exception.</div><div>&nbsp; &nbsp; &nbsp; &nbsp; } else {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; failCompare(message, expected, actual);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; private static void failCompare(final String message, final Object expected, final Object actual) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; String cleanMessage = message == null ? &quot;&quot; : message;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; String expectedString = expected == null? null : expected.toString();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; String actualString = actual == null? null : actual.toString();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; throw new ComparisonFailure(cleanMessage, expectedString, actualString);</div><div>&nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; /**</div><div>&nbsp; &nbsp; &nbsp;* Compare two objects using Comparator.compare() instead of equals().&nbsp;</div><div>&nbsp; &nbsp; &nbsp;* This is primarily for classes with a natural order that is&nbsp;</div><div>&nbsp; &nbsp; &nbsp;* inconsistent with equals(), such as BigDecimal.</div><div>&nbsp; &nbsp; &nbsp;*</div><div>&nbsp; &nbsp; &nbsp;* @param message</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the identifying message for the {@link AssertionError} (&lt;code&gt;null&lt;/code&gt;</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;okay)</div><div>&nbsp; &nbsp; &nbsp;* @param expected</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;expected value</div><div>&nbsp; &nbsp; &nbsp;* @param actual</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;actual value</div><div>&nbsp; &nbsp; &nbsp;* @param comparator</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The comparator used to compare the values</div><div>&nbsp; &nbsp; &nbsp;* @param &lt;T&gt;</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The type of the object</div><div>&nbsp; &nbsp; &nbsp;* @see java.util.Comparator</div><div>&nbsp; &nbsp; &nbsp;*/</div><div>&nbsp; &nbsp; public static &lt;T&gt; void assertCompare(final T expected, final T actual, final Comparator&lt;T&gt; comparator) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; assertCompare(null, expected, actual, comparator);</div><div>&nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; /**</div><div>&nbsp; &nbsp; &nbsp;* Compare two objects using Comparator.compare() instead of equals().&nbsp;</div><div>&nbsp; &nbsp; &nbsp;* This is primarily for classes with a natural order that is&nbsp;</div><div>&nbsp; &nbsp; &nbsp;* inconsistent with equals(), such as BigDecimal.</div><div>&nbsp; &nbsp; &nbsp;*</div><div>&nbsp; &nbsp; &nbsp;* @param message</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;the identifying message for the {@link AssertionError} (&lt;code&gt;null&lt;/code&gt;</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;okay)</div><div>&nbsp; &nbsp; &nbsp;* @param expected</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;expected value</div><div>&nbsp; &nbsp; &nbsp;* @param actual</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;actual value</div><div>&nbsp; &nbsp; &nbsp;* @param comparator</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The comparator used to compare the values</div><div>&nbsp; &nbsp; &nbsp;* @param &lt;T&gt;</div><div>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The type of the object</div><div>&nbsp; &nbsp; &nbsp;* @see java.lang.Comparator</div><div>&nbsp; &nbsp; &nbsp;*/</div><div>&nbsp; &nbsp; public static &lt;T&gt; void assertCompare(final String message, final T expected, final T actual, final Comparator&lt;T&gt; comparator) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; if (comparator == null) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new IllegalArgumentException(&quot;Null Comparator in test&quot;);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; if (expected == null &amp;&amp; actual == null) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // okay</div><div>&nbsp; &nbsp; &nbsp; &nbsp; } else if (expected != null &amp;&amp; actual != null &amp;&amp; comparator.compare(actual, expected) == 0) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // We tested both for null here, because the compare() method might</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // not handle a null parameter cleanly. For these cases, it&#39;s</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // preferable to throw a ComparisonFailure exception.</div><div>&nbsp; &nbsp; &nbsp; &nbsp; } else {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; failCompare(message, expected, actual);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; }</div><div><br></div></div></div></div>", 
    "prevInTime": 24489, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1394669978", 
    "canDelete": false, 
    "nextInTopic": 24491, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PGxmcXRpcStkcGg1aGJAWWFob29Hcm91cHMuY29tPg=="
    }
}