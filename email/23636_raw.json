{
    "numMessagesInTopic": 13, 
    "nextInTime": 23637, 
    "senderId": "XP1vgvT1oJw2XjoVmbei-QY9d4-chMpc6ZR8Pnhf6RyFnFCmJyi5I0KAbXrQdt0Pyvnmh53ykFPtWcZC7NTjf4mTqitPJv6rUHMt9YazY5rrCp5i0Q90XoU", 
    "systemMessage": false, 
    "subject": "Feature request: @Assumes", 
    "from": "Stephen Connolly &lt;stephen.alan.connolly@...&gt;", 
    "authorName": "Stephen Connolly", 
    "msgSnippet": "Note: I have also posted this to junit-devel@lists.sourceforge.net but I think that wider input could be beneficial Consider the case where you are testing a", 
    "msgId": 23636, 
    "rawEmail": "Return-Path: &lt;stephen.alan.connolly@...&gt;\r\nReceived: (qmail 8731 invoked by uid 7800); 14 Sep 2011 13:50:22 -0000\r\nX-Sender: stephen.alan.connolly@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 26602 invoked from network); 14 Sep 2011 10:09:25 -0000\r\nX-Received: from unknown (98.137.34.46)\n  by m13.grp.sp2.yahoo.com with QMQP; 14 Sep 2011 10:09:25 -0000\r\nX-Received: from unknown (HELO mail-ww0-f49.google.com) (74.125.82.49)\n  by mta3.grp.sp2.yahoo.com with SMTP; 14 Sep 2011 10:09:24 -0000\r\nX-Received: by wwp14 with SMTP id 14so1611577wwp.6\n        for &lt;junit@yahoogroups.com&gt;; Wed, 14 Sep 2011 03:09:24 -0700 (PDT)\r\nMIME-Version: 1.0\r\nX-Received: by 10.227.57.66 with SMTP id b2mr195222wbh.64.1315994535496; Wed, 14\n Sep 2011 03:02:15 -0700 (PDT)\r\nX-Received: by 10.227.152.73 with HTTP; Wed, 14 Sep 2011 03:02:15 -0700 (PDT)\r\nIn-Reply-To: &lt;CA+nPnMwbfNvxbhqjWVyXW7UDt2VM5TzwWzwAiRJaHkKrnHzmxQ@...&gt;\r\nReferences: &lt;CA+nPnMwbfNvxbhqjWVyXW7UDt2VM5TzwWzwAiRJaHkKrnHzmxQ@...&gt;\r\nDate: Wed, 14 Sep 2011 11:02:15 +0100\r\nMessage-ID: &lt;CA+nPnMyQPw_hmB5PZjY5tO7LdhSvXJkb7Nn9JFZreB1Vy5P8ow@...&gt;\r\nTo: junit@yahoogroups.com\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Transfer-Encoding: quoted-printable\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: Stephen Connolly &lt;stephen.alan.connolly@...&gt;\r\nSubject: Feature request: @Assumes\r\nX-Yahoo-Group-Post: member; u=458231986; y=K1C5T3xfmXBlfhQC0MmWs53JnBcWTZo4b--2_r1_QBraXaksEUNWB2CZilrULg\r\nX-Yahoo-Profile: stephenalanconnolly\r\nX-eGroups-Approved-By: dsaff &lt;david@...&gt; via email; 14 Sep 2011 13:50:22 -0000\r\n\r\nNote: I have also posted this to junit-devel@... but\nI th=\r\nink that wider input could be beneficial\n\nConsider the case where you are t=\r\nesting a List class...\n\nwe have\n\npublic class ListTest {\n\n=A0@Test\n=A0publi=\r\nc void newListIsEmpty() {\n=A0 =A0assertThat(new List().isEmpty(), is(true);=\r\n\n=A0}\n\n=A0@Test\n=A0public void newListHasSizeZero() {\n=A0 =A0assertThat(new=\r\n List().size(), is(0));\n=A0}\n\n=A0@Test\n=A0public void addPutsAnElementIntoA=\r\nnEmptyList() {\n=A0 =A0List l =3D new List();\n=A0 =A0l.add(new Object());\n=\r\n=A0 =A0assertThat(l.isEmpty(), is(false));\n=A0}\n\n=A0@Test\n=A0public void ad=\r\ndIncreasesSizeOfPopulatedListByOne() {\n=A0 =A0List l =3D new List();\n=A0 =\r\n=A0l.add(new Object());\n=A0 =A0int s =3D l.size();\n=A0 =A0l.add(new Object(=\r\n));\n=A0 =A0assertThat(l.size(), is(s + 1));\n=A0}\n\n}\n\nWe now want to add som=\r\ne tests of the delete functionality... but the\nreality is that until/unless=\r\n some of the preceding tests are passing,\nthe tests for delete are meaningl=\r\ness. We could have a perfectly\nfunctional List.delete() method but until su=\r\nch time as the above tests\nare passing, there is no way to tell that the me=\r\nthod does not work.\n\nNow I could code my tests like such\n\n=A0@Test\n=A0publi=\r\nc void deleteIsANoOpOnEmptyList() {\n=A0 =A0List l =3D new List();\n=A0 =A0as=\r\nsumeThat(l.isEmpty(), is(true));\n=A0 =A0l.delete(new Object());\n=A0}\n\nBut a=\r\nll that I am doing is repeating code from the preceding tests,\nhaving chang=\r\ned all those tests&#39; assertThat(...)s into assumeThat(...)s\n\nThat does not s=\r\neem agile to me, copy & paste & search & replace... ban\ncode smell there\n\nI=\r\n would much rather be able to annotate the tests with an @Assumes\nannotatio=\r\nn that indicates that the test assumes that the specified\ntests are passing=\r\n, e.g.\n\n=A0@Test\n=A0@Assumes(&quot;newListIsEmpty&quot;)\n=A0public void deleteIsANoOp=\r\nOnEmptyList() {\n=A0 =A0List l =3D new List();\n=A0 =A0l.delete(new Object())=\r\n;\n=A0}\n\n=A0@Test\n=A0@Assumes({&quot;newListIsEmpty&quot;,&quot;addPutsAnElementIntoAnEmpty=\r\nList&quot;)\n=A0public void deleteRemovesAnElement() {\n=A0 =A0List l =3D new List=\r\n();\n=A0 =A0Object o =3D new Object();\n=A0 =A0l.add(o);\n=A0 =A0l.delete(o);\n=\r\n=A0 =A0assertThat(l.isEmpty(), is(true));\n=A0}\n\nIn fact in my initial examp=\r\nle of tests, there are some additional\nassumptions that I didn&#39;t make expli=\r\ncit\n\n\n=A0@Test\n=A0@Assumes(&quot;newListIsEmpty&quot;)\n=A0public void addPutsAnElemen=\r\ntIntoAnEmptyList() {\n=A0 =A0...\n=A0}\n\nand\n\n=A0@Test\n=A0@Assumes({&quot;newListIs=\r\nEmpty&quot;,&quot;addPutsAnElementIntoAnEmptyList&quot;)\n=A0public void addIncreasesSizeOf=\r\nPopulatedListByOne() {\n=A0 =A0...\n=A0}\n\nNow you could get some of this func=\r\ntionality via a TestRule...\n\nYou could watch tests to see if they pass, and=\r\n skip tests annotated\nwith the annotation if assumed functionality is faili=\r\nng, but that\nwould result in sporadic failures of, e.g. deleteRemovesAnElem=\r\nent\nbecause of the failing newListIsEmpty being executed _after_\ndeleteRemo=\r\nvesAnElement rather than before.\n\nThe simple point is that the test result =\r\nof deleteRemovesAnElement is\nmeaningless until its assumptions are true, an=\r\nd while I could code the\nassumptions with assumeThat(..)s C&P&S&R is even w=\r\norse than C&P.\n\nAnother alternative to @Assumes would be to invoke the assu=\r\nmed\nmethod(s) at the start of the test, e.g.\n\n=A0@Test\n=A0public void delet=\r\neRemovesAnElement() {\n=A0 =A0newListIsEmpty(); // verify assumed functional=\r\nity\n=A0 =A0addPutsAnElementIntoAnEmptyList(); =A0// verify assumed function=\r\nality\n=A0 =A0...\n=A0}\n\nThat gets rid of the C&P&S&R, but there are two issu=\r\nes with that:\n\n=A01. We have to manually invoke any setup/tearDown methods,=\r\n including\nall those of the rules that the test class has... very messy\n\n=\r\n=A02. The test fails when the assumed test fails. In actuality we can\nsay n=\r\nothing at all about whether deleteRemovesAnElement if a\nnewListIsEmpty is n=\r\not passing... yes we could code the test\ndifferently, but that is just movi=\r\nng our assumptions somewhere else.\n\nI am sure that there are others out the=\r\nre who feel there is a point 3...\n\n=A03. We already ran those tests why was=\r\nte time running them again?\n\nWell the answer to 3 is that these are UNIT te=\r\nsts which should be very\nfast, so what is the harm...\n\nSo, in my view, best=\r\n practice unit testing needs the ability to mark\ntests as assuming that oth=\r\ner tests are passing, so that those tests\ncan be skipped when the assumptio=\r\nns are known to be failing or\nskipped. [This is a deliberately loaded crite=\r\nria... if the\norg.junit.runner.Request does not include the assumed test, t=\r\nhen that\ntest is neither known failing or known skipped, so we can run the =\r\ntest\nand output a warning that the failure may be because of assumed\nfuncti=\r\nonality... the use case of executing one and only one test\nrepeatedly until=\r\n you get that test passing]\n\nThe annotation would have implications on test=\r\n sorting, as any assumed\ntests would have to always happen before the assum=\r\ning tests (as long\nas the assumed tests are in the org.junit.runner.Request=\r\n)\n\nAlso might have to be two annotations, e.g.\n\n@Assumes(methodNames)\n@Assu=\r\nmesClasses(classes)\n\nthough in my view the @AssumesClasses is less critical=\r\n, as these are\nUNIT tests and each test class should be independent to a la=\r\nrge\nextent. However I am willing to consider that some people may have\nmany=\r\n test classes for one class under test, one test class containing\nall the t=\r\nests of the constructors, another testing the Add methods,\netc. in which ca=\r\nse an @AssumesClasses annotation makes sense.\n\nWhere tests contain a circul=\r\nar dependency, fail/error both tests\n\nOk, let the critique begin!\n\n-Stephen=\r\n\n\nP.S.\n\nI pinged Kent with an earlier version of this idea... but I think t=\r\nhat\nhe missed the point about eliminating C&P&S&R that this feature would\np=\r\nrovide because I didn&#39;t frame the idea correctly...\n\n---------- Forwarded m=\r\nessage ----------\nFrom: &quot;Kent Beck&quot;\nDate: 13 Sep 2011 17:11\nSubject: Re: JU=\r\nnit and test dependencies\nTo: &quot;Stephen Connolly&quot;\n\nStephen,\n\nThank you for a=\r\nrticulating your idea so clearly. The short answer is that\nno, we don&#39;t pla=\r\nn to support dependencies. If I have tests that are slow\nenough that I care=\r\n about dependencies, my most productive option is\ngenerally to work on the =\r\ndesign of the software until the tests are fast\nenough that I no longer car=\r\ne. That said, my voice is only one of many. The\nlonger answer is that I enc=\r\nourage you to post your idea on the JUnit mailing\nlist for community discus=\r\nsion.\n\nRegards,\n\nKent\n\nOn Sep 13, 2011, at 8:32 AM, Stephen Connolly wrote:=\r\n\n\n&gt; Kent,\n&gt;\n&gt; Are there any plans for JUnit to support some test dependenci=\r\nes, such as:\n&gt;\n&gt; public class OnlyRunTestsThatMakeSenseTest {\n&gt;\n&gt; =A0@Test\n=\r\n&gt; =A0public void basicFunctionalityWorks() {\n&gt; =A0 =A0...\n&gt; =A0}\n&gt;\n&gt; =A0@Te=\r\nst\n&gt; =A0@AssumesPasses(&quot;basicFunctionalityWorks&quot;)\n&gt; =A0public void advanced=\r\nFunctionalityWorks() {\n&gt; =A0 =A0...\n&gt; =A0}\n&gt;\n&gt; =A0@Test\n&gt; =A0@AssumesPasses=\r\n(&quot;basicFunctionalityWorks&quot;)\n&gt; =A0public void basicFunctionalityWorksWithBev=\r\nel() {\n&gt; =A0 =A0...\n&gt; =A0}\n&gt;\n&gt; =A0@Test\n&gt;\n=A0@AssumesPasses({&quot;basicFunction=\r\nalityWorksWithBevel&quot;,&quot;advancedFunctionalityWorks&quot;})\n&gt; =A0public void advanc=\r\nedFunctionalityWorksWithBevel() {\n&gt; =A0 =A0...\n&gt; =A0}\n&gt;\n&gt; }\n&gt;\n&gt; In the abov=\r\ne example, no matter what sorting is applied,\n&gt; basicFunctionalityWorks wil=\r\nl always be run first, and the other three\n&gt; tests will only be run if basi=\r\ncFunctionalityWorks passed.\n&gt;\n&gt; I see the above being completely in the spi=\r\nrit of unit testing, the\n&gt; point with the above is that the @Before and @Af=\r\nter&#39;s will be run\n&gt; around each method, you are just saying that there is n=\r\no point even\n&gt; trying to test the advanced functionality when the basic fun=\r\nctionality\n&gt; is broken, skip those tests which we know cannot pass. That al=\r\nlows the\n&gt; person writing advancedFunctionalityWorks to power through the s=\r\netup\n&gt; that depends on the basic functionality and not have to litter their=\r\n\n&gt; advanced test with asserts that are redundant because of the basic\n&gt; fun=\r\nctionality. Those people who are relying on side-effects should\n&gt; really, f=\r\nor unit tests at least, be invoking the method who&#39;s\n&gt; side-effects they de=\r\npend on directly within their test method, rather\n&gt; than relying on acciden=\r\ntal ordering.\n&gt;\n&gt; Having said that, a second feature that I think would be =\r\ngood is\n&gt; something like a @RunAfter and/or @RunBefore which would ensure t=\r\nhat\n&gt; the test method is run in sequence even if the before or after tests\n=\r\n&gt; fail/are skipped. with @RunAfter and @RunBefore I still think the\n&gt; @Befo=\r\nre and @After methods should be invoked in-between, this would be\n&gt; moving =\r\ntowards more of a general purpose testing framework as opposed\n&gt; to being u=\r\nnit-testing focused, but JUnit is just too good ;-)\n&gt;\n&gt; Thoughts?\n&gt;\n&gt; -Step=\r\nhen\n\n", 
    "profile": "stephenalanconnolly", 
    "topicId": 23636, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 458231986, 
    "prevInTime": 23635, 
    "contentTrasformed": false, 
    "postDate": "1315994535", 
    "canDelete": false, 
    "nextInTopic": 23638, 
    "prevInTopic": 0, 
    "headers": {
        "inReplyToHeader": "PENBK25Qbk13YmZOdnhiaHFqV1Z5WFc3VUR0MlZNNVR6d1d6d0FpUkphSGtLcm5Iem14UUBtYWlsLmdtYWlsLmNvbT4=", 
        "messageIdInHeader": "PENBK25Qbk15UVB3X2htQjVQWmpZNXRPN0xkaFN2WEprYjdObjlKRlpyZUIxVnk1UDhvd0BtYWlsLmdtYWlsLmNvbT4=", 
        "referencesHeader": "PENBK25Qbk13YmZOdnhiaHFqV1Z5WFc3VUR0MlZNNVR6d1d6d0FpUkphSGtLcm5Iem14UUBtYWlsLmdtYWlsLmNvbT4="
    }
}