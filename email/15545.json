{
    "numMessagesInTopic": 21, 
    "nextInTime": 15546, 
    "senderId": "5cUj0XBx6wQPzd2mfgH-KJ1C9IzDWLtrVUf2ydeyeTIqZR7QSw0oNeCv_Fb4N1cmC7L0zQ0CWprBgb6PKmG5huUy2-4a7CH8", 
    "systemMessage": false, 
    "subject": "RE: [junit] Expected exception pitfall and pattern", 
    "from": "&quot;Kent Beck&quot; &lt;kentb@...&gt;", 
    "authorName": "Kent Beck", 
    "msgSnippet": "Jon, I can see the potential problem, but I ve never experienced it so I m not inclined to add anything to the framework to deal with it. The two workarounds I", 
    "msgId": 15545, 
    "profile": "kentlbeck", 
    "topicId": 15536, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 173198504, 
    "messageBody": "<div id=\"ygrps-yiv-1658651395\">Jon,<br/>\n<br/>\nI can see the potential problem, but I&#39;ve never experienced it so I&#39;m not<br/>\ninclined to add anything to the framework to deal with it. The two<br/>\nworkarounds I can see are to write the try/catch yourself or (in the case<br/>\nbelow) to move the Account creation to a @Before method. The following test<br/>\nwon&#39;t have the problem you note:<br/>\n<br/>\nAccount account;<br/>\n<br/>\n@Before public void createAccount() {<br/>\n  account= new Account(10);<br/>\n}<br/>\n<br/>\n@Test(expected= IllegalArgumentException.class) public void<br/>\nillegalWithdrawl() {<br/>\n  account.withdrawCash(-1);<br/>\n} <br/>\n<br/>\nSincerely yours,<br/>\n<br/>\nKent Beck<br/>\nThree Rivers Institute<br/>\n<br/>\n<blockquote><span title=\"qreply\"> &gt; -----Original Message-----<br/>\n&gt; From: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a> [mailto:<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>] On <br/>\n&gt; Behalf Of Jon Skeet<br/>\n&gt; Sent: Monday, November 28, 2005 1:12 AM<br/>\n&gt; To: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\n&gt; Subject: [junit] Expected exception pitfall and pattern<br/>\n&gt; <br/>\n&gt; There is a problem with the @Test(expected=...) pattern which I&#39;m sure<br/>\n&gt; has been noted elsewhere. Namely, it covers up problems if <br/>\n&gt; the expected<br/>\n&gt; exception is thrown at an unexpected point. The desired behaviour is<br/>\n&gt; really a try/catch around one particular line of code. For instance:<br/>\n&gt; <br/>\n&gt; @Test(expected=IllegalArgumentException.class)<br/>\n&gt; public void test()<br/>\n&gt; {<br/>\n&gt;     Account f = new Account(10);<br/>\n&gt;     f.withdrawCash(20);<br/>\n&gt; }<br/>\n&gt; <br/>\n&gt; is equivalent to:<br/>\n&gt; <br/>\n&gt; try<br/>\n&gt; {<br/>\n&gt;     Account f = new Account(10);<br/>\n&gt;     f.withdrawCash(20);<br/>\n&gt;     fail(&quot;Expected exception&quot;);<br/>\n&gt; }<br/>\n&gt; catch (IllegalArgumentException e)<br/>\n&gt; {<br/>\n&gt; }<br/>\n&gt; <br/>\n&gt; instead of the desired:<br/>\n&gt; <br/>\n&gt; Account f = new Account(10);<br/>\n&gt; try<br/>\n&gt; {<br/>\n&gt;     f.withdrawCash(20);<br/>\n&gt;     fail(&quot;Expected exception&quot;);    <br/>\n&gt; }<br/>\n&gt; catch (IllegalArgumentException e)<br/>\n&gt; {<br/>\n&gt; }<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; Now, there is a way around this (other than writing the code<br/>\n&gt; &quot;long-hand&quot;) - by keeping a flag which is checked during <br/>\n&gt; tear-down, and<br/>\n&gt; only set immediately before the last line of the code:<br/>\n&gt; <br/>\n&gt; @Test(expected=IllegalArgumentException.class)<br/>\n&gt; public void test()<br/>\n&gt; {<br/>\n&gt;     exceptionFlag.clear();<br/>\n&gt;     Account f = new Account(10);<br/>\n&gt;     execeptionFlag.set();<br/>\n&gt;     f.withdrawCash(20);<br/>\n&gt; }<br/>\n&gt; <br/>\n&gt; If this were only used when the test had an expected <br/>\n&gt; exception, it could<br/>\n&gt; be cleared on set-up.<br/>\n&gt; <br/>\n&gt; I *suspect* there&#39;s no point in making this part of the framework<br/>\n&gt; itself, but I just wondered whether anyone else had been <br/>\n&gt; thinking about<br/>\n&gt; it. It&#39;s never *actually* bitten me (as far as I&#39;m aware) when using<br/>\n&gt; NUnit, but it&#39;s always been a slight source of concern.<br/>\n&gt;  <br/>\n&gt; Jon Skeet<br/>\n&gt; Senior Software Engineer<br/>\n&gt; CLEARSWIFT<br/>\n&gt; The MIMEsweeper Company<br/>\n&gt; <br/>\n&gt; DDI:               +44 (0) 1189  038  109<br/>\n&gt; Mobile:           +44 (0) 7970 158 865<br/>\n&gt; Switchboard:   +44 (0) 1189  038  903 <br/>\n&gt; Fax:               +44 (0) 1189  039  000      <br/>\n&gt; Web: www.clearswift.com <br/>\n&gt; <br/>\n&gt; Clearswift monitors, controls and protects all its messaging <br/>\n&gt; traffic in compliance with its corporate email policy using <br/>\n&gt; Clearswift products.<br/>\n&gt; Find out more about Clearswift, its solutions and services at <br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.clearswift.com\">http://www.clearswift.com</a><br/>\n&gt; <br/>\n&gt; This communication is confidential and may contain privileged <br/>\n&gt; information intended solely for the named addressee(s). It <br/>\n&gt; may not be used or disclosed except for the purpose for which <br/>\n&gt; it has been sent. If you are not the intended recipient, you <br/>\n&gt; must not copy, distribute or take any action in reliance on <br/>\n&gt; it. Unless expressly stated, opinions in this message are <br/>\n&gt; those of the individual sender and not of Clearswift. If you <br/>\n&gt; have received this communication in error, please notify <br/>\n&gt; Clearswift by emailing <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:support@...\">support@...</a> quoting the <br/>\n&gt; sender and delete the message and any attached documents. <br/>\n&gt; Clearswift accepts no liability or responsibility for any <br/>\n&gt; onward transmission or use of emails and attachments having <br/>\n&gt; left the Clearswift domain.<br/>\n&gt; <br/>\n&gt; This footnote confirms that this email message has been swept <br/>\n&gt; by MIMEsweeper for Content Security threats, including <br/>\n&gt; computer viruses.<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; <br/>\n&gt; <br/>\n&gt; ------------------------ Yahoo! Groups Sponsor <br/>\n&gt; --------------------~--&gt; <br/>\n&gt; Get fast access to your favorite Yahoo! Groups. Make Yahoo! <br/>\n&gt; your home page<br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"http://us.click.yahoo.com/dpRU5A/wUILAA/yQLSAA/5cFolB/TM\">http://us.click.yahoo.com/dpRU5A/wUILAA/yQLSAA/5cFolB/TM</a><br/>\n&gt; --------------------------------------------------------------<br/>\n&gt; ------~-&gt; <br/>\n&gt; <br/>\n&gt;  <br/>\n&gt; Yahoo! Groups Links<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; <br/>\n&gt;  <br/>\n&gt; <br/>\n&gt; <br/>\n&gt; <br/>\n&gt; </span></blockquote></div>", 
    "prevInTime": 15544, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1133212491", 
    "canDelete": false, 
    "nextInTopic": 15549, 
    "prevInTopic": 15540, 
    "headers": {
        "inReplyToHeader": "PDZFQUE4QUQ4MkQ3RUJGNDc4Q0NFMjYyRkEzMkM2QzY0MDFCNTZBMUFAR0VNSU5JLkVVUk9QRS5DTEVBUlNXSUZULkNPTT4=", 
        "messageIdInHeader": "PEUxRWdxS3QtMDAwNncyLTVaQHNtdHBhdXRoMDIubWFpbC5hdGwuZWFydGhsaW5rLm5ldD4="
    }
}