{
    "numMessagesInTopic": 39, 
    "nextInTime": 20548, 
    "senderId": "rVre7DbRdPx9GKiF2ok8Kbli32D3mjTXOhAd8thm_Y8AHuNnHmWCWIqZi-JTiNkAd2QW87C_ha2Zxtq8Ja3Mo-KttKxqJDSUZVLX028", 
    "systemMessage": true, 
    "subject": "Re: A case for adding logging of assertions to junit", 
    "from": "&quot;Phil Surette&quot; &lt;philsurette@...&gt;", 
    "authorName": "Phil Surette", 
    "msgSnippet": "I agree that adding this logging will not make junit into a more elegant framework. Logging is never elegant and adding logging for assertions will make the", 
    "msgId": 20547, 
    "profile": "PhilSurette", 
    "topicId": 20531, 
    "spamInfo": {
        "reason": "6", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 100046987, 
    "messageBody": "<div id=\"ygrps-yiv-1687153937\">I agree that adding this logging will not make junit into<br/>\na more elegant framework. Logging is never elegant and adding<br/>\nlogging for assertions will make the Assert class uglier<br/>\nfor sure.<br/>\n<br/>\nI also would not want to oversell the benefits of having logging.<br/>\nIt is useful in some cases and gives another, runtime, view<br/>\nof the test case that is sometimes helpful in understanding<br/>\na test case or a test failure. <br/>\n<br/>\nGiven the size of the audience for junit it&#39;s tempting to<br/>\nthink that even a marginal improvement will be significant<br/>\nwhen multiplied over the number of users. But I&#39;m sure<br/>\nyou&#39;re fending off suggestions of this ilk all the time<br/>\n(I think I saw assertEquals for arrays in junit 4 - thanks!).<br/>\n<br/>\nWhat are the architectural hurdles that you see with the<br/>\nking of logging we&#39;re talking about? I&#39;d like to see if<br/>\nthey could be addressed, and at what cost, to see if the<br/>\ncost would outweigh the benefits of having this extra<br/>\nreporting capability. <br/>\n<br/>\n<br/>\n<blockquote><span title=\"qreply\"> --- In junit@yahoogroups.com, &quot;Kent Beck&quot; &lt;kentb@...&gt; wrote:<br/>\n&gt;<br/>\n&gt; Dear Phil,<br/>\n&gt;  <br/>\n&gt; Thank you for the clear case for logging assertions. This feature<br/>\nhas been<br/>\n&gt; &quot;on the list&quot; for at least eight of the ten years JUnit has been in<br/>\n&gt; existence. The problem is that I have never found a way to add it<br/>\nwithout<br/>\n&gt; breaking the architecture. For me, the additional ugliness has always<br/>\n&gt; outweighed the additional utility. I&#39;m open to suggestions, though.<br/>\n&gt;  <br/>\n&gt; Regards,<br/>\n&gt;  <br/>\n&gt; Kent Beck<br/>\n&gt; Three Rivers Institute<br/>\n&gt; <br/>\n&gt;   _____  <br/>\n&gt; <br/>\n&gt; From: junit@yahoogroups.com [mailto:junit@yahoogroups.com] On Behalf<br/>\nOf Phil<br/>\n&gt; Surette<br/>\n&gt; Sent: Monday, June 09, 2008 4:24 AM<br/>\n&gt; To: junit@yahoogroups.com<br/>\n&gt; Subject: [junit] A case for adding logging of assertions to junit<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; <br/>\n&gt; I&#39;d like to make a case for adding logging of assertions into junit.<br/>\n&gt; I&#39;ve been using junit for many years, and something that I&#39;ve found<br/>\n&gt; both for myself and for people who I&#39;ve mentored in XP practices is<br/>\n&gt; that it is often helpful to get warm fuzzy feedback that your tests<br/>\n&gt; are running and asserting what you think they are asserting. <br/>\n&gt; <br/>\n&gt; I notice that I&#39;m not alone in this; I see there are several threads<br/>\n&gt; where people were looking for this feature<br/>\n&gt; (http://tech. &lt;http://tech.groups.yahoo.com/group/junit/message/17845&gt;<br/>\n&gt; groups.yahoo.com/group/junit/message/17845 &quot;how to log<br/>\n&gt; junit tests&quot;, http://tech.<br/>\n&gt; &lt;http://tech.groups.yahoo.com/group/junit/message/18762&gt;<br/>\n&gt; groups.yahoo.com/group/junit/message/18762<br/>\n&gt; &quot;junit 4 & logging&quot;,<br/>\n&gt; http://tech. &lt;http://tech.groups.yahoo.com/group/junit/message/12000&gt;<br/>\n&gt; groups.yahoo.com/group/junit/message/12000 &quot;Log4J Logging<br/>\n&gt; in JUnit&quot;)<br/>\n&gt; <br/>\n&gt; Consider the following concocted unit test. It is not the purpose of<br/>\n&gt; this test case to demonstrate good test case design ;)<br/>\n&gt; <br/>\n&gt; 1 public class MyTest extends junit.framework.TestCase{<br/>\n&gt; 2 List&lt;Map&gt;; mapList;<br/>\n&gt; 3 <br/>\n&gt; 4 protected void setUp() throws Exception {<br/>\n&gt; 5 //create some silly data<br/>\n&gt; 6 Map map1 = new HashMap();<br/>\n&gt; 7 map1.put(&quot;id&quot;, &quot;vladimir&quot;);<br/>\n&gt; 8 Map map2 = new HashMap();<br/>\n&gt; 9 map2.put(&quot;id&quot;, &quot;estragon&quot;);<br/>\n&gt; 10 Map map3 = new HashMap();<br/>\n&gt; 11 //might have to wait for a while for this one :)<br/>\n&gt; 12 map3.put(&quot;id&quot;, &quot;godot&quot;);<br/>\n&gt; 13 mapList = new ArrayList();<br/>\n&gt; 14 mapList.add(map1);<br/>\n&gt; 15 mapList.add(map2);<br/>\n&gt; 16 mapList.add(map3);<br/>\n&gt; 17 }<br/>\n&gt; 18 <br/>\n&gt; 19 public void testMapIds(){<br/>\n&gt; 20 assertTrue(&quot;mapList has content&quot;, mapList.size() &gt; 0);<br/>\n&gt; 21 for (Map map: mapList){<br/>\n&gt; 22 assertNotNull(&quot;map has id field&quot;, map.get(&quot;id&quot;));<br/>\n&gt; 23 }<br/>\n&gt; 24 }<br/>\n&gt; 25 <br/>\n&gt; 26 public void testIdFormat(){<br/>\n&gt; 27 //at some point this will test that all ids are<br/>\n&gt; lowercase...<br/>\n&gt; 28 }<br/>\n&gt; 29 <br/>\n&gt; 30 public void testIdLengths(){<br/>\n&gt; 31 assertTrue(&quot;mapList has content&quot;, mapList.size() &gt; 0);<br/>\n&gt; 32 for (Map map: mapList){<br/>\n&gt; 33 String id = (String)map.get(&quot;id&quot;);<br/>\n&gt; 34 assertTrue(&quot;id &quot;+id+&quot; at least 8 characters long&quot;,<br/>\n&gt; id.length() &gt;=8);<br/>\n&gt; 35 }<br/>\n&gt; 36 }<br/>\n&gt; 37 }<br/>\n&gt; <br/>\n&gt; What I would like to be able to do is to turn on some kind of<br/>\n&gt; assertion logging that would allow me to see output such as the<br/>\nfollowing:<br/>\n&gt; (Note that this output was generated using my own tweaked<br/>\n&gt; version of junit that uses log4j logging categories for<br/>\n&gt; enabling/disabling both assertion logging and test summary logging):<br/>\n&gt; <br/>\n&gt; INFO junit.echo.run.start - __BEGIN MyClassTest.testMapIds__<br/>\n&gt; DEBUG junit.echo.assertTrue - (passed) mapList has content <br/>\n&gt; DEBUG junit.echo.assertNotNull - (passed) map has id field vladimir<br/>\n&gt; DEBUG junit.echo.assertNotNull - (passed) map has id field estragon<br/>\n&gt; DEBUG junit.echo.assertNotNull - (passed) map has id field godot<br/>\n&gt; INFO junit.echo.run.summary - __SUMMARY MyClassTest.testMapIds__ (4<br/>\n&gt; asserts)<br/>\n&gt; INFO junit.echo.run.start - __BEGIN MyClassTest.testIdFormat__<br/>\n&gt; WARN junit.echo.run.summary - __SUMMARY MyClassTest.testIdFormat__ &lt;a<br/>\n&gt; id=&quot;bogus&quot;&gt;&lt;/a&gt;(???no asserts???)<br/>\n&gt; INFO junit.echo.run.start - __BEGIN MyClassTest.testIdLengths__<br/>\n&gt; DEBUG junit.echo.assertTrue - (passed) mapList has content<br/>\n&gt; DEBUG junit.echo.assertTrue - (passed) id vladimir at least 8<br/>\n&gt; characters long<br/>\n&gt; DEBUG junit.echo.assertTrue - (passed) id estragon at least 8<br/>\n&gt; characters long<br/>\n&gt; DEBUG junit.echo.assertTrue - (FAILED) id godot at least 8<br/>\ncharacters long<br/>\n&gt; WARN junit.echo.run.summary - __SUMMARY MyClassTest.testIdLengths__<br/>\n&gt; (4 asserts) ASSERTION FAILED id godot at least 8 characters long<br/>\n&gt; <br/>\n&gt; Being able to see output like this has a number of benefits such as<br/>\n&gt; <br/>\n&gt; 1) eliminating redundant logging statements - Many logging statements<br/>\n&gt; in a JUnit test case simply output information that you&#39;ve already<br/>\n&gt; told JUnit about in your assertions. Developers often put these in as<br/>\n&gt; a &#39;sanity check&#39; to verify that the test is doing what they expected.<br/>\n&gt; For example: because on lines such as line 22 I can see the toString<br/>\n&gt; of the object that is not null, I get a warm fuzzy feeling that the<br/>\n&gt; test is sane when I look at the logged results. I&#39;ve noticed that when<br/>\n&gt; developers write their tests they often add log statements or<br/>\n&gt; System.outs to provide them this warm fuzzy feeling (often deleting<br/>\n&gt; the same logging when the test is complete - and putting them back in<br/>\n&gt; when debugging test failures)<br/>\n&gt; <br/>\n&gt; 2) improving assertion messages - it&#39;s often the case that the<br/>\n&gt; first time you see the message for an assertion will be when the<br/>\n&gt; assertion fails, which may not happen until you run a regression test<br/>\n&gt; many moons after you coded the test. Unless you see the message<br/>\n&gt; displayed when you are developing the test, you won&#39;t realize that the<br/>\n&gt; message - if you provided one - is not be very helpful. Better<br/>\n&gt; assertion messages also help to communicate to a developer what the<br/>\n&gt; point of the assertion is both when it fails and when reading the test.<br/>\n&gt; <br/>\n&gt; 3) see finer-grain test results. Every assertion is a mini-test on its<br/>\n&gt; own, but JUnit these mini-tests are invisible until they fail. <br/>\n&gt; Of course, most of the time that&#39;s the behaviour you want. But<br/>\n&gt; when you&#39;re developing a test or debugging a test failure, it&#39;s<br/>\n&gt; great to see what these smaller tests are doing.<br/>\n&gt; <br/>\n&gt; 4) by making logging easy, it can help to avoid the<br/>\n&gt; using-system-outs-instead-of-asserts syndrome, where new junit test<br/>\n&gt; writers will write &quot;test cases&quot; that actually just write a bunch of<br/>\n&gt; stuff to the console that the test writer then eyeballs for expected<br/>\n&gt; results<br/>\n&gt; <br/>\n&gt; Notice that in the output above, there are also &#39;summary&#39; lines which<br/>\n&gt; show how many assertions were made in a particular test. These are<br/>\n&gt; somewhat tangential to the main thread of this post, but it&#39;s nice to<br/>\n&gt; be able to know how many assertions occur in a test case if only to<br/>\n&gt; identify when a test case is written that never actually makes an<br/>\n&gt; assertion - which is often a bad smell in a test case. It&#39;s also nice<br/>\n&gt; when there is a test failure during a build run to see in a log the<br/>\n&gt; start of the test case and the assertions that passed before the<br/>\n&gt; failure occurred.<br/>\n&gt; <br/>\n&gt; There are some problems with logging assertions that I have encountered:<br/>\n&gt; <br/>\n&gt; 1) if iterating over a collection and asserting each element, your log<br/>\n&gt; can be overwhelmed. Maybe it would be useful to have some way of<br/>\n&gt; hinting that a particular assertion should not create notifications;<br/>\n&gt; maybe not.<br/>\n&gt; <br/>\n&gt; 2) the implementation I wrote creates a dependency on log4j (perhaps<br/>\n&gt; this could be avoided by using a notification mechanism and shipping a<br/>\n&gt; separate component that listens for logging notifications and logs them)<br/>\n&gt; <br/>\n&gt; BTW, From my own experience in instrumenting junit 3.8.1 <br/>\n&gt; (some time ago) I found that it is not a trivial thing to modify <br/>\n&gt; junit to do this kind of logging. For instance, in my<br/>\n&gt; own implementation I managed to confuse junit so it no longer reports<br/>\n&gt; junit failures differently than errors. It is a<br/>\n&gt; significant effort to do this badly, and much more effort to do it<br/>\n&gt; well ;).<br/>\n&gt; <br/>\n&gt; Is there any appetite out there for adding assertion logging (or<br/>\n&gt; assertion notification) into the junit 4 framework? I would be<br/>\n&gt; happy to do the work if I thought it would be accepted into the<br/>\n&gt; main junit distribution. Or maybe this capability already exists<br/>\n&gt; in some way in junit 4 that I am not aware of?<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; <br/>\n&gt;  <br/>\n&gt; <br/>\n&gt; <br/>\n&gt; [Non-text portions of this message have been removed]<br/>\n&gt; </span></blockquote></div>", 
    "prevInTime": 20546, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1213068326", 
    "canDelete": false, 
    "nextInTopic": 20548, 
    "prevInTopic": 20546, 
    "headers": {
        "inReplyToHeader": "PDAwYmQwMWM4Y2E4NCQyZDg1OGNjMCQ0MDAwYThjMEBrZW50c3BhdmlsaW9uPg==", 
        "messageIdInHeader": "PGcya3M3NitrZDFiQGVHcm91cHMuY29tPg=="
    }
}