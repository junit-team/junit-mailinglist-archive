{
    "numMessagesInTopic": 1, 
    "nextInTime": 4668, 
    "senderId": "Ky2vlSuaYtQmD5bwjuRLWNFVK2Jd38bqr6jYsBpSRj5OmRqYilxjPWyNM6oCUETHJ0HPX83ZyHTSB6a6KT1Kzz6wgk4o1r3G", 
    "systemMessage": false, 
    "subject": "It&#39;s still JUnit&#39;s classloader", 
    "from": "Steven Morgan &lt;xerafin@...&gt;", 
    "authorName": "Steven Morgan", 
    "msgSnippet": "This makes sense if you remember how ObjectInputStream gets its classloader.  When readObject() is called, the classloader used to resolve the class being", 
    "msgId": 4667, 
    "profile": "xerafin", 
    "topicId": 4667, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 56874360, 
    "messageBody": "<div id=\"ygrps-yiv-1925700586\">This makes sense if you remember how ObjectInputStream gets its classloader.  When<br/>\nreadObject() is called, the classloader used to resolve the class being loaded is<br/>\nthe  classloader associated with the class that called readObject().  In this case,<br/>\nthat class would be your test class which was indeed loaded by the JUnit<br/>\nclassloader.  That means your readObj object was also loaded by the JUnit<br/>\nclassloader, and that is the problem you are encountering.  When you use your class&#39;<br/>\nmain() method, then the class&#39; classloader is the same classloader calling<br/>\nreadObject(), so your classloaders then match.<br/>\n<br/>\nI do not have a good answer for you, unfortunately, because I see nothing in<br/>\nXMLDecoder that corresponds to the resolveClass() method of ObjectInputStream. <br/>\nAnyone else care to comment?<br/>\n<br/>\n-Steve  :)<br/>\n<br/>\n<br/>\nSaid &quot;bteichmann&quot; &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:bteichmann@...\">bteichmann@...</a>&gt;:<br/>\n<blockquote><span title=\"ireply\"> &gt; (it does not occure, if i run it with eclipes junit runner or if i <br/>\n&gt; run the source from its main() without junit.)<br/>\n&gt; <br/>\n&gt; the code lookes like this:<br/>\n&gt; +++++++++<br/>\n&gt;   dec =<br/>\n&gt;       new java.beans.XMLDecoder( <br/>\n&gt;         new BufferedInputStream(new FileInputStream(file)));<br/>\n&gt; \t  if (dec == null) throw new UserAgentException(&quot;cound not <br/>\n&gt; instanciate XMLdecoder with filename: &quot;+filename);<br/>\n&gt;     Object readObj = dec.readObject();<br/>\n&gt; <br/>\n&gt;     // the next 7 lines are for debugging purposes    <br/>\n&gt;     Class oc = readObj.getClass();<br/>\n&gt;     ClassLoader cl1 = oc.getClassLoader();<br/>\n&gt;     userAgent = new UserAgentImpl();<br/>\n&gt;     ClassLoader cl2 = userAgent.getClass().getClassLoader();<br/>\n&gt;     System.out.println(cl1.toString() + &quot;   &quot;+ cl2.toString() <br/>\n&gt;        + &quot;&#92;n&quot; + userAgent.getClass().getName()<br/>\n&gt;        + &quot;&#92;n&quot; + readObj.getClass().getName());<br/>\n&gt;     // this line does not work althought the readObj.class is <br/>\n&gt;     // the same as for userAgent<br/>\n&gt;     // the line throws a ClassCastException <br/>\n&gt;     userAgent = (UserAgentImpl) readObj;<br/>\n&gt;        <br/>\n&gt; +++++++<br/>\n&gt; the output looks like this:<br/>\n&gt; *****<br/>\n&gt; sun.misc.Launcher$AppClassLoader@2f6684   <br/>\n&gt; junit.runner.TestCaseClassLoader@efe475<br/>\n&gt; de.xx.useragent.UserAgentImpl<br/>\n&gt; de.xx.useragent.UserAgentImpl<br/>\n&gt; *******<br/>\n&gt; and altthought the class of readObj and userAgent are the same i got <br/>\n&gt; a ClassCastException on the last line &quot;userAgent = (UserAgentImpl) <br/>\n&gt; readObj;&quot;<br/>\n&gt; <br/>\n&gt; only if i run the test from a main() class in the TestCase i got <br/>\n&gt; different classloaders. if i run the TestCase from Eclipses buildin <br/>\n&gt; junit support the output looks like this no ClassCastException is <br/>\n&gt; thrown:<br/>\n&gt; ******<br/>\n&gt; sun.misc.Launcher$AppClassLoader@2f6684   <br/>\n&gt; sun.misc.Launcher$AppClassLoader@2f6684<br/>\n&gt; de.multivisual.textlib.useragent.UserAgentImpl<br/>\n&gt; de.multivisual.textlib.useragent.UserAgentImpl<br/>\n&gt; *******<br/>\n&gt; <br/>\n&gt; Any Ideas to fix this problem ?<br/>\n<br/>\n<br/>\n<br/>\n </span></blockquote>=====<br/>\n(@) (@)  Steven Morgan<br/>\n   |     <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:xerafin@...\">xerafin@...</a><br/>\n  ---    <a rel=\"nofollow\" target=\"_blank\" href=\"http://profiles.yahoo.com/xerafin\">http://profiles.yahoo.com/xerafin</a><br/>\n<br/>\n__________________________________________________<br/>\nDo You Yahoo!?<br/>\nYahoo! Tax Center - online filing with TurboTax<br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"http://taxes.yahoo.com/\">http://taxes.yahoo.com/</a></div>", 
    "prevInTime": 4666, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1018612631", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 0, 
    "headers": {
        "inReplyToHeader": "PDEwMTg1NTg3NTEuMTA4My4zMTg3OC5tMTJAeWFob29ncm91cHMuY29tPg==", 
        "messageIdInHeader": "PDIwMDIwNDEyMTE1NzExLjU4NDEyLnFtYWlsQHdlYjExNTA3Lm1haWwueWFob28uY29tPg=="
    }
}