{
    "topicId": 23785, 
    "postDate": "1325707993", 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "from": "Dawid Weiss &lt;dawid.weiss@...&gt;", 
    "canDelete": false, 
    "replyTo": "LIST", 
    "senderId": "ty_i-XeXRR8LnBC4mekjo_kFKaF_ABRg3_jxiuFKfuzfLSZdyg9TIZpsch1YvHRkptpKNcMfMNZZtfK5Wjgqz1_8UrrMrNrkQEk", 
    "nextInTime": 23791, 
    "userId": 223548916, 
    "prevInTime": 23789, 
    "prevInTopic": 23789, 
    "headers": {
        "inReplyToHeader": "PGplMHNzdSs5ODRlQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PENBTTIxUnQ4VHJqU1VzT1pVND0zbWRWdkdBOUxla01ENT05YzJ3aG9BMHNZVTd2TG1MQUBtYWlsLmdtYWlsLmNvbT4=", 
        "referencesHeader": "PENBT0Jrb0ZXVXl2M2ZnVURCRUc4X0crYVh1NlFXdW4za0I3M3pvMHdwOEFWTldoOXBIUUBtYWlsLmdtYWlsLmNvbT4gPGplMHNzdSs5ODRlQGVHcm91cHMuY29tPg=="
    }, 
    "authorName": "Dawid Weiss", 
    "numMessagesInTopic": 12, 
    "msgSnippet": "Hi Kristian, We had a similar issue. I was debating for a longer while if it makes sense to run parallel tests within the same VM. In many situations this", 
    "contentTrasformed": false, 
    "msgId": 23790, 
    "nextInTopic": 23791, 
    "systemMessage": false, 
    "rawEmail": "Return-Path: &lt;dawid.weiss@...&gt;\r\nReceived: (qmail 86617 invoked by uid 7800); 4 Jan 2012 20:15:48 -0000\r\nX-Sender: dawid.weiss@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 47761 invoked from network); 4 Jan 2012 20:13:34 -0000\r\nX-Received: from unknown (98.137.35.162)\n  by m7.grp.sp2.yahoo.com with QMQP; 4 Jan 2012 20:13:34 -0000\r\nX-Received: from unknown (HELO mail-iy0-f182.google.com) (209.85.210.182)\n  by mta6.grp.sp2.yahoo.com with SMTP; 4 Jan 2012 20:13:34 -0000\r\nX-Received: by iadj38 with SMTP id j38so41608991iad.13\n        for &lt;junit@yahoogroups.com&gt;; Wed, 04 Jan 2012 12:13:34 -0800 (PST)\r\nX-Received: by 10.50.188.132 with SMTP id ga4mr81801399igc.4.1325708014157; Wed,\n 04 Jan 2012 12:13:34 -0800 (PST)\r\nMIME-Version: 1.0\r\nX-Received: by 10.42.131.1 with HTTP; Wed, 4 Jan 2012 12:13:13 -0800 (PST)\r\nIn-Reply-To: &lt;je0ssu+984e@...&gt;\r\nReferences: &lt;CAOBkoFWUyv3fgUDBEG8_G+aXu6QWun3kB73zo0wp8AVNWh9pHQ@...&gt;\n &lt;je0ssu+984e@...&gt;\r\nDate: Wed, 4 Jan 2012 21:13:13 +0100\r\nMessage-ID: &lt;CAM21Rt8TrjSUsOZU4=3mdVvGA9LekMD5=9c2whoA0sYU7vLmLA@...&gt;\r\nTo: junit@yahoogroups.com\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: Dawid Weiss &lt;dawid.weiss@...&gt;\r\nSubject: Re: [junit] Re: Runner for maven\r\nX-Yahoo-Group-Post: member; u=223548916; y=T5gHztxfcXfFjsp1RKMy38k6DdCROWH4MhIAZjGmdSWlIYpaXPs\r\nContent-Type: text/plain; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\nX-eGroups-Approved-By: mark_l_salter &lt;marksalter@...&gt; via email; 4 Jan 2012 20:15:48 -0000\r\n\r\nHi Kristian,\n\nWe had a similar issue. I was debating for a longer while if =\r\nit makes sense\nto run parallel tests within the same VM. In many situations=\r\n this speeds\nthings a lot and has a nice memory conserving footprint but yo=\r\nu cannot\nguarantee tests won&#39;t interact with each other (in the simplest ca=\r\nse via\nmutating system properties). Finally the decision was to do it like =\r\nApache\nLucene did it -- split tests into parallel slave VMs with repeatable=\r\n suite\nexecution order and sequential test execution within a single VM. Th=\r\nis is\nimplemented in an ANT task called junit4 here.\n\nhttps://github.com/ca=\r\nrrotsearch/randomizedtesting/tree/master/ant-junit4\n\nJUnit tests inside wil=\r\nl give you a hint how to use it, the code is still\nvery fresh so documentat=\r\nion is scarce.\n\nNow... this was a digression. Back to your question (becaus=\r\ne we did go that\nroute as well, only backed up), one possible solution to i=\r\nsolating\nsysout/syserrs of parallel tests in a single VM is:\n\n1) isolate ea=\r\nch suite (for @BeforeClass/ @AfterClass hooks) into a separate\nthread which=\r\n you have under control. This can be either a custom @Runner or\na Computer,=\r\n many ways to achieve it.\n\n2) write a PrintStream implementation that redir=\r\nects to a thread-local\nbuffer. This gist implements a similar idea to demux=\r\n multiple thread\nstreams so that each one&#39;s output appears on a single line=\r\n; you&#39;ll get the\nidea I&#39;m sure.\n\nhttps://gist.github.com/1561833\n\n3) once y=\r\nou have the above the rest is easy: replace default\nSystem.out/System.err (=\r\nI assume no security manager is present or it allows\nsuch replacement), cle=\r\nar the buffer before suite, run your suite, flush the\nbuffer. The buffer&#39;s =\r\ncontent will be your thread&#39;s output even though\nsystem.* are singletons.\n\n=\r\nLike I said though -- I would consider using multiple jvms for running\npara=\r\nllel tests instead.\n\nDawid\n\nOn Wed, Jan 4, 2012 at 7:51 AM, &lt;kristian@rosen=\r\nvold.com&gt; wrote:\n\n&gt; **\n&gt;\n&gt;\n&gt; Sorry, I was doing just what I sometimes disli=\r\nke of our own users ;)\n&gt;\n&gt; The real problem I want to solve is associating =\r\nconsole output from a\n&gt; running thread to a given test-case (for parallel r=\r\nuns). We have this\n&gt; fairly well covered already and we manage to capture e=\r\nverything that\n&gt; happens within a given test-case for that test-case.\n&gt;\n&gt; T=\r\nhe real problem is that the RunListener API does not demarcate\n&gt; test-class=\r\nes properly, so I am unable to distinguish console output\n&gt; happening in @A=\r\nfterClass of one test with @BeforeClass on the test-class on\n&gt; the same thr=\r\nead.\n&gt;\n&gt; This problem has been in the corner of my eye for quite some time =\r\nand I&#39;ve\n&gt; been trying to find a decent angle to solve it from. I promise n=\r\not to do\n&gt; anything that is frowned upon, which is why I asked ;)\n&gt;\n&gt; Krist=\r\nian\n&gt;\n&gt;\n&gt; --- In junit@yahoogroups.com, Matthew Farwell &lt;matthew@...&gt; wrote=\r\n:\n&gt; &gt;\n&gt; &gt; Kristian,\n&gt; &gt;\n&gt; &gt; In reading your original mail, I was also confu=\r\nsed as to what you wanted\n&gt; to\n&gt; &gt; achieve. Could you expand a little pleas=\r\ne?\n&gt; &gt;\n&gt; &gt; Thanks.\n&gt; &gt;\n&gt; &gt; Matthew Farwell.\n&gt; &gt;\n&gt; &gt; Le 3 janvier 2012 22:45=\r\n, hkaipe &lt;hkaipe@...&gt; a =C3=A9crit :\n&gt;\n&gt; &gt;\n&gt; &gt; &gt; **\n&gt; &gt; &gt;\n&gt; &gt; &gt; Hi Kristian=\r\n\n&gt; &gt; &gt;\n&gt; &gt; &gt; Do you really want a transition from RunListener?\n&gt; &gt; &gt;\n&gt; &gt; &gt; =\r\nTo an outside observer - a JUnit Runner &quot;describes&quot; its test-executions\n&gt; &gt;=\r\n &gt; and reports their outcome to the RunNotifier, which forward the info to\n=\r\n&gt; &gt; &gt; RunListener, which is the interface that 3rd-party test-running\n&gt; &gt; &gt;=\r\n applications (e.g. IDEs, Maven-Surefire etc) are expected to use.\n&gt; &gt; &gt;\n&gt; =\r\n&gt; &gt; I have seen IDE-project test-extensions try to go beyond\n&gt; &gt; &gt; RunListe=\r\nner/RunNotifier and start to joggle with Runner internals (e.g.\n&gt; &gt; &gt; test-=\r\ninstance creation/setup, method-executions etc) and the result is\n&gt; &gt; &gt; som=\r\nething I don&#39;t like much. It works for simple cases but with\n&gt; customized\n&gt;=\r\n &gt; &gt; Runner-classes and new JUnit-features (e.g. the introduction of\n&gt; &gt; &gt; =\r\nJUnit-Rules) the result is usually bad and it discourages the IDE users\n&gt; &gt;=\r\n &gt; (i.e. the developers) from taking full advantage of JUnit!\n&gt; &gt; &gt;\n&gt; &gt; &gt; H=\r\nowever, Maven (versions 2.0-2.2) and its Surefire-plugin has handled\n&gt; the\n=\r\n&gt; &gt; &gt; JUnit-integration wonderfully, as far as I know, so your post worries=\r\n\n&gt; me a\n&gt; &gt; &gt; little. What is it that you want to accomplish by moving away=\r\n from the\n&gt; &gt; &gt; successful(!) &quot;Junitcore+RunListener based approach&quot;?\n&gt; &gt; &gt;=\r\n\n&gt; &gt; &gt; Henrik\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt; --- In junit@yahoogroups.com, kristian@ wro=\r\nte:\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; Hi,\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; I maintain the junit provider for m=\r\naven-surefire, and I&#39;m looking\n&gt; into\n&gt; &gt; &gt; transitioning from a Junitcore+=\r\nRunListener based approach to an\n&gt; approach\n&gt; &gt; &gt; based on something like B=\r\nlockJUnit4ClassRunner.\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; Unfortunately I cannot subclass the =\r\nBlockJUnit4ClassRunner since the\n&gt; &gt; &gt; client code itself may need to do th=\r\nat, so I&#39;d somehow need to put &quot;my&quot;\n&gt; &gt; &gt; &gt; Runner in front of the client-s=\r\nupplied one, maybe something proxy\n&gt; like.\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; Anyone have any =\r\ntips on this, maybe some existing code that does\n&gt; this ?\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt; &gt; K=\r\nristian\n&gt; &gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; [Non-text portions of this me=\r\nssage have been removed]\n&gt; &gt;\n&gt;\n&gt;  \n&gt;\n\n\n[Non-text portions of this message h=\r\nave been removed]\n\n\n", 
    "subject": "Re: [junit] Re: Runner for maven"
}