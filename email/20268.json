{
    "numMessagesInTopic": 8, 
    "nextInTime": 20269, 
    "senderId": "yWWf487y7TdFIvPhhm7At2Qn4NQFxnIki-oYMGs_de3bb4oA3kNJFL3d50xSVTlZqyc2NiRmbdw6R3EpKn-ql-dAncqHosqT", 
    "systemMessage": false, 
    "subject": "Re: [junit] How do you test your Java EE 5 applications?", 
    "from": "&quot;Nat Pryce&quot; &lt;nat.pryce@...&gt;", 
    "authorName": "Nat Pryce", 
    "msgSnippet": "... That s what I do. ... I d not do that. However, I m using message-driven, so it might be different for remote object interfaces. The reason I d not have my", 
    "msgId": 20268, 
    "profile": "nat_pryce", 
    "topicId": 20253, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 216973656, 
    "messageBody": "<div id=\"ygrps-yiv-137466626\">On 30/01/2008, Kent Larsson &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:kent.larsson@...\">kent.larsson@...</a>&gt; wrote:<br/>\n<blockquote><span title=\"ireply\"> &gt;  I haven&#39;t found a lot of (not a single one in fact) tutorials<br/>\n&gt;  explaining how to do this kind of out of container testing of EJB 3.0<br/>\n&gt;  stuff (and the book only mentioned it briefly). Perhaps it&#39;s self<br/>\n&gt;  explainatory to everyone except me, but I am more leaning on it still<br/>\n&gt;  being a fairly new technology. In either case I do need to discuss this<br/>\n&gt;  a bit more before I&#39;m able to use the method.<br/>\n&gt;<br/>\n&gt;  This is how I understand it so far. I broke it up into many smaller<br/>\n&gt;  paragraphs so that it would be easier to comment. If I have understood<br/>\n&gt;  something/most wrong I would appreciate if someone could correct me:<br/>\n&gt;<br/>\n&gt;  //--- How I think it works - Start<br/>\n&gt;<br/>\n&gt;  You separate your logic from your session bean so that your session<br/>\n&gt;  bean will become a mere forwarder of requests and replies as well as a<br/>\n&gt;  handler of EJB 3.0 components creation.<br/>\n<br/>\n </span></blockquote>That&#39;s what I do.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt;  Your logic POJO class will implement the same interface(s) as its<br/>\n&gt;  session bean.<br/>\n<br/>\n </span></blockquote>I&#39;d not do that. However, I&#39;m using message-driven, so it might be<br/>\ndifferent for remote object interfaces.<br/>\n<br/>\nThe reason I&#39;d not have my objects implement the remote interface is<br/>\nthat the remote interface declares exceptions that report errors to<br/>\nthe client.  They are no good for reporting errors to the implementor<br/>\nof the service with enough information to let the implementor interact<br/>\nwith the transaction manager appropriately.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt;  Your logic POJO class may require other session beans, or more<br/>\n&gt;  accurately put, it may require other classes which implements the same<br/>\n&gt;  interface(s) as said session beans.<br/>\n<br/>\n </span></blockquote>The Java classes that I create inside the EJB object don&#39;t directly<br/>\ncall other EJB APIs.  I pass them references to interfaces that I have<br/>\ndesigned and that make sense in terms of my domain model, but which<br/>\nare implemented as wrappers around EJB APIs.<br/>\n<br/>\nE.g. I wouldn&#39;t pass in an EntityManager.  I would pass in a<br/>\nimplementation of SalesLedger that used an EntityManager to implement<br/>\nthe abstraction using JPA.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt;  During normal operation the needed real session beans will be injected<br/>\n&gt;  into the session bean which requires them. The session beans will then<br/>\n&gt;  be passed to the logic POJO class through its constructor.<br/>\n<br/>\n </span></blockquote>As above, I&#39;d wrap any types that rely on the JavaEE APIs with<br/>\ninterfaces that are closer to my domain, or allow me to throw<br/>\nexceptions internally that let me interact with the transaction<br/>\nmanager cleanly.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt;  During unit testing you&#39;re unable to create the needed real session<br/>\n&gt;  beans. Instead you will create the logic POJO class versions of the<br/>\n&gt;  needed session beans. These will then be passed to the logic POJO class<br/>\n&gt;  through its constructor.<br/>\n<br/>\n </span></blockquote>In unit testing I use mock implementations of the domain abstractions<br/>\nthat I pass to the internal objects.<br/>\n<br/>\nI also have end-to-end and integration tests that exercise the glue<br/>\ncode between the app container and my own code and the classes that<br/>\nimplement domain abstractions by wrapping JavaEE services.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt;  And I also have some questions:<br/>\n&gt;<br/>\n&gt;  1. What should I do with the EntityManager? Should one out-of-container<br/>\n&gt;  EntityManager be created before each of my unit tests (and destroyed<br/>\n&gt;  when it&#39;s done)? Have you got any tips on how one is created which<br/>\n&gt;  ideally works as the in container one? What about transactions, what<br/>\n&gt;  should be one?<br/>\n<br/>\n </span></blockquote>In unit tests I don&#39;t use an entity manager.  I use jMock to mock out<br/>\nthe domain abstractions that are implemented with JPA in the real<br/>\nsystem.<br/>\n<br/>\nIn integration tests I create an entity manager by instantiating the<br/>\nclasses of the JPA implementation (e.g. Hibernate or Toplink) in JUnit<br/>\ntests.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt;  2. We have cases where the communication is &quot; servlet &lt;-&gt;<br/>\n&gt;  businessSessionBean &lt;-&gt; pojoIntegration &quot; where the pojoIntegration<br/>\n&gt;  handles entity beans and database queries and the businessSessionBean<br/>\n&gt;  merely acts as a forwarder of requests and responses. In these cases.<br/>\n&gt;  Should we test the methods of businessSessionBean?<br/>\n<br/>\n </span></blockquote>I would test them in integration or end-to-end tests.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt;  3. Do you know any good material which discusess testnig Java EE 5<br/>\n&gt;  applications this way?<br/>\n<br/>\n </span></blockquote>No.  It&#39;s something we worked out as we developed JavaEE applications.<br/>\n<br/>\nI hope that&#39;s some help.<br/>\n<br/>\nCheers,<br/>\n    --Nat</div>", 
    "prevInTime": 20267, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1201689084", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 20267, 
    "headers": {
        "inReplyToHeader": "PHM3YTA1MDZjLjA2M0BzbXRwZ3cudHBiLnNlPg==", 
        "messageIdInHeader": "PDE3ZmE1M2QwODAxMzAwMjMxdjFlNjFjOWQxc2JlM2Q1OWM3MTZhMmI3ZGNAbWFpbC5nbWFpbC5jb20+", 
        "referencesHeader": "PHM3YTA1MDZjLjA2M0BzbXRwZ3cudHBiLnNlPg=="
    }
}