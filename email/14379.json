{
    "numMessagesInTopic": 6, 
    "nextInTime": 14380, 
    "senderId": "v7qkOXVKVx5KN6q1WpQfbYkAGHL2BSzEjbziHd92X-_HLuFoeC5ToDcP_yspCf8Jz-b4z0vLmBo9FHaumTgjHMo4-_f7d3VJics", 
    "systemMessage": false, 
    "subject": "Testing a log rotation method", 
    "from": "Asif Sattar &lt;sattar_asif@...&gt;", 
    "authorName": "Asif Sattar", 
    "msgSnippet": "Hi everyone I m trying to get my unit test that tests log rotation functionality to work and it doesn t seem to do it properly...the log rotation method itself", 
    "msgId": 14379, 
    "profile": "sattar_asif", 
    "topicId": 14377, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 46895256, 
    "messageBody": "<div id=\"ygrps-yiv-1532853592\">Hi everyone<br/>\n<br/>\nI&#39;m trying to get my unit test that tests log rotation<br/>\nfunctionality to work and it doesn&#39;t seem to do it<br/>\nproperly...the log rotation method itself is pretty<br/>\nstraightforward, it keeps logs from the past 7 days and<br/>\ndeletes the rest after checking the directory:<br/>\n<br/>\n    private static void logRotation() {<br/>\n<br/>\n        // Populate logFilesInLogDirectory with files in<br/>\nlogFileDirectory<br/>\n        File logFilesInDirectory = new<br/>\nFile(logFileDirectory);<br/>\n        String[] logFilesArray =<br/>\nlogFilesInDirectory.list();<br/>\n        List logFilesInLogDirectory =<br/>\nArrays.asList(logFilesArray);<br/>\n<br/>\n        // Remove files that are not smart card log files<br/>\nfrom file list<br/>\n        for (int i = 0; i &lt; logFilesInLogDirectory.size();<br/>\ni++) {<br/>\n            if (!((String)<br/>\nlogFilesInLogDirectory.get(i)).startsWith(logFilePrefix)) {<br/>\n                logFilesInLogDirectory.remove(i);<br/>\n            }<br/>\n        }<br/>\n<br/>\n        // Delete oldest files if there are more than<br/>\nnoOfPreviousLogFiles files<br/>\n        if (logFilesInLogDirectory.size() &gt;<br/>\nnoOfPreviousLogFiles) {<br/>\n            Collections.sort(logFilesInLogDirectory);<br/>\n            for (int i = (noOfPreviousLogFiles - 1); i &lt;<br/>\nlogFilesInLogDirectory.size(); i++) {<br/>\n                new File((String)<br/>\nlogFilesInLogDirectory.remove(i)).delete();<br/>\n            }<br/>\n        }<br/>\n    }<br/>\n<br/>\nBut for some reason my log rotation tester can&#39;t get back<br/>\nthe right number of files.<br/>\n<br/>\npublic void testLogRotation() throws<br/>\nIllegalArgumentException, IllegalAccessException,<br/>\nSmartCardPropertiesException, IOException {<br/>\n        <br/>\n        int noOfLogFiles = 0;<br/>\n        String logFileDirectory = null;<br/>\n        <br/>\n        noOfLogFiles =<br/>\nsmartCardLoggerConfig.getNoOfPreviousLogFiles();<br/>\n        logFileDirectory = &quot;c:&#92;&#92;loggerTest&quot;;<br/>\n        <br/>\n        File logFilesInDirectory = new<br/>\nFile(logFileDirectory);<br/>\n        //logFilesInDirectory.createNewFile();<br/>\n        <br/>\n        // Populate logFilesInLogDirectory with files in<br/>\nlogFileDirectory<br/>\n        logFilesInDirectory = new File(logFileDirectory);<br/>\n        String[] logFilesArray =<br/>\nlogFilesInDirectory.list();<br/>\n        System.out.println(&quot;Number of files in &quot; +<br/>\nlogFileDirectory + &quot; is &quot; + logFilesArray.length);<br/>\n        <br/>\n        // Remove all files<br/>\n        for (int i = 0; i &lt; logFilesArray.length; i++) {<br/>\n            System.out.println(&quot;Deleting file  &quot; +<br/>\nlogFilesArray[i]);<br/>\n            System.out.println(&quot;Files in directory &quot; +<br/>\nArrays.asList(logFilesArray));<br/>\n            new File(logFilesArray[i]).delete();<br/>\n        }<br/>\n        <br/>\n        logFilesArray = logFilesInDirectory.list();<br/>\n <br/>\n        assertEquals(0, logFilesArray.length);<br/>\n<br/>\n        <br/>\n        int d = new Random().nextInt(1000) - 500;<br/>\n        <br/>\n        for (int i = 0; i &lt; 10; i++) {<br/>\n            testDate = new Date((new Date().getTime() +<br/>\n(d*100*60*60*24)));<br/>\n            logFileDateField.set(null, testDate);<br/>\n            smartCardLogger.log(SmartCardLogger.SEVERE,<br/>\ngetClass(), &quot;testLogRotation()&quot;, &quot;Testing log rotation&quot;);<br/>\n            d -= new Random().nextInt(20);<br/>\n            System.out.println(&quot;Creation log file for date<br/>\n&quot; + testDate);<br/>\n        }<br/>\n        <br/>\n        logFilesArray = logFilesInDirectory.list();<br/>\n        <br/>\n        assertEquals(noOfLogFiles, logFilesArray.length);<br/>\n        <br/>\n        // Remove all files<br/>\n// for (int i = 0; i &lt; logFilesArray.length; i++) {<br/>\n// new File(logFilesArray[i]).delete();<br/>\n// }<br/>\n<br/>\n<br/>\nAny suggestions, solutions would be MOST appreciated<br/>\n<br/>\n<br/>\nRegards<br/>\n<br/>\nAsif<br/>\n<br/>\n<br/>\n\t\t<br/>\n____________________________________________________<br/>\nStart your day with Yahoo! - make it your home page <br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.yahoo.com/r/hs\">http://www.yahoo.com/r/hs</a></div>", 
    "prevInTime": 14378, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1124388962", 
    "canDelete": false, 
    "nextInTopic": 14381, 
    "prevInTopic": 14378, 
    "headers": {
        "inReplyToHeader": "PDQzMDRDNTQ5LjUwMzAwMDdAZmFzdC1tYWlsLm9yZz4=", 
        "messageIdInHeader": "PDIwMDUwODE4MTgxNjAyLjc3OTQ2LnFtYWlsQHdlYjMwMDAyLm1haWwubXVkLnlhaG9vLmNvbT4="
    }
}