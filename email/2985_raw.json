{
    "numMessagesInTopic": 7, 
    "nextInTime": 2986, 
    "senderId": "BDV4qX_R-y8_Kqr85nliuys_5Od0wVAGsoaPecmo3kBM6YDShLG1IgYy9maQ8jmxfi7YYpqH6TexeUiLK__e4tRf5gjYv5iHdLmwz7p1", 
    "systemMessage": false, 
    "subject": "RE: [junit] Re: swingui & jdk1.4", 
    "from": "&quot;David Hooker&quot; &lt;dhooker@...&gt;", 
    "authorName": "David Hooker", 
    "msgSnippet": "Excellent!  Exactly what I wanted to know, thanks! ... From: Scott Stirling [mailto:sstirling@macromedia.com] Sent: Wednesday, October 17, 2001 1:00 PM To:", 
    "msgId": 2985, 
    "rawEmail": "Return-Path: &lt;dhooker@...&gt;\r\nX-Sender: dhooker@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (EGP: mail-8_0_0_1); 17 Oct 2001 18:04:34 -0000\r\nReceived: (qmail 72107 invoked from network); 17 Oct 2001 18:04:34 -0000\r\nReceived: from unknown (10.1.10.26)\n  by l10.egroups.com with QMQP; 17 Oct 2001 18:04:34 -0000\r\nReceived: from unknown (HELO imta01a2.registeredsite.com) (64.225.255.10)\n  by mta1 with SMTP; 17 Oct 2001 18:04:33 -0000\r\nReceived: from DHOOKER ([64.123.189.56]) by imta01a2.registeredsite.com\n          with ESMTP\n          id &lt;20011017180432.FMTN8009.imta01a2.registeredsite.com@DHOOKER&gt;\n          for &lt;junit@yahoogroups.com&gt;; Wed, 17 Oct 2001 14:04:32 -0400\r\nTo: &lt;junit@yahoogroups.com&gt;\r\nSubject: RE: [junit] Re: swingui & jdk1.4\r\nDate: Wed, 17 Oct 2001 13:04:15 -0500\r\nMessage-ID: &lt;000201c15736$22783bc0$6b01a8c0@DHOOKER&gt;\r\nMIME-Version: 1.0\r\nContent-Type: text/plain;\n\tcharset=&quot;US-ASCII&quot;\r\nContent-Transfer-Encoding: 7bit\r\nX-Priority: 3 (Normal)\r\nX-MSMail-Priority: Normal\r\nX-Mailer: Microsoft Outlook, Build 10.0.2627\r\nIn-Reply-To: &lt;4F47DCFADC8DD5118D2B00508B952D960C3989@...&gt;\r\nImportance: Normal\r\nX-MimeOLE: Produced By Microsoft MimeOLE V5.50.4807.1700\r\nFrom: &quot;David Hooker&quot; &lt;dhooker@...&gt;\r\nX-Yahoo-Profile: dudehook\r\n\r\nExcellent!  Exactly what I wanted to know, thanks!\n\n-----Original Message-----\nFrom: Scott Stirling [mailto:sstirling@...] \nSent: Wednesday, October 17, 2001 1:00 PM\nTo: &#39;junit@yahoogroups.com&#39;\nSubject: RE: [junit] Re: swingui & jdk1.4\n\n\nHere&#39;s a definitive answer (watch what you ask for ;-&gt; ), from my post\nto\nthis group on 7/10/01.  If Jim wants to put in the FAQ, please do.  It&#39;s\ndefinitely in the top 5 FAQs on this list.\n****************************\n\nThe JUnit TestCaseClassLoader (the reloadable one) has a fundamental\nproblem\nthat results in frequent LinkageErrors under the following conditions:\n\n1. You use the JUnit Swing UI.\n\n2.  You use JAXP in your test cases or any classes referenced in your\ntest\ncases, or even any &quot;instanceof&quot; expressions that reference JAXP classes.\n(By JAXP I mean the whole set of javax.* classes plus the org.w3c.dom.*\nand\norg.xml.sax.* classes)\n\nI can go into this in depth, but the bottom line problems are that JUnit\nloads classes from the same place as the JVM&#39;s system loader; the\nclasspath.\nThis necessitates the use of an exclusion list to filter out certain\nclass\nnames that either must be loaded by the system loader, or you would like\nto\nhave loaded by the system loader.  The JUnit loader does not always\ndelegate\nto the system loader when it should, particularly in the case of JAXP,\nwhich\nis a weird mix of classes whose names begin with the filtered &quot;javax.*&quot;\nand\nthe unfiltered &quot;org.w3c.*&quot; and org.xml.*&quot;.\n\nJAXP is a special case because it is based on a set of javax.* classes.\nAll\njavax.* classes are excluded from the JUnit loader by default (in the\ndefault excluded.properties file) in junit.jar.  But JAXP, as shipped\nfrom\nSun, comes with a bunch of other classes in org.w3c.* and org.xml.*.\nThe\ninteresting thing is a direct dependency between javax.* classes and\nsome\nother classes not in the usual exclusion list of com.sun.*, javax.*,\netc.\n\nSo what can happen, and frequently does when using the JUnit Swing UI\nwith\ntest cases or other classes, such as Log4J, that use JAXP, is that the\nJUnit\nclass loader (properly) delegates javax.xml.* classes it &quot;sees&quot; to the\nsystem loader.  But then the system loader loads up a bunch of\norg.w3c.dom\nand/or org.xml.sax classes as the result of initializing and loading\nthat\nJAXP class.  Later, if the JUnit loader comes across some org.w3c/xml\nclass\nthat it&#39;s never seen before, it tries to load it because the classname\ndoesn&#39;t match one of the patterns in the exclude list.  \n\nBut it&#39;s already been loaded through the &quot;backdoor&quot; as the result of\nsome\nother class loaded by the system loader (remember, the JVM keeps classes\nin\ntheir own namespace by identifying them by their fully qualified name\nplus\nthe instance of their _defining_ (not initiating) loader, AND, the JVM\nwill\nattempt to assign all unloaded classes referenced by a defined class to\nthat\ndefining class&#39;s loader).  The JVM&#39;s classresolver routine keeps track\nof\nall these class loading events and &quot;sees&quot; that the JUnit loader is\nattempting to define a class that has already been defined by the system\nloader.  That&#39;s wrong because according to the rules of loader\nconstraints,\nJUnit should delegate this load to the system loader.\n\nYou can hack around this (I did) by catching the LinkageError in\nTestCaseClassLoader&#39;s loadClass() method and then making a recovery call\nto\nfindSystemClass() -- thereby delegating to the system loader after the\nfact\n(which is OK).  This hack only works some of the time, though, because\nnow\nyou can have the reverse problem where the JUnit loader loads a host of\norg.*.* classes, and then the system loader violates the loader\ncontraints\nat some point when it tries to do exactly what I described above with\nJAXP\nbecause it doesn&#39;t ever delegate to its child (the JUnit loader).\nInevitably, if your test cases use many JAXP and related XML classes,\none or\nthe other ClassLoader will end violating the constraints whatever you\ndo.\n\nSo the solution in the existing JUnit is to definitely add org.w3c.dom.*\nand\norg.xml.sax.* to your excluded.properties if you&#39;re using any JAXP\nstuff.\n\nWhat can we learn from this?  Well, one thing is that it&#39;s a good idea\nto\nhave your custom class loaders load classes from repositories other than\nthe\nsystem classpath.  Note that the JVM&#39;s built-in classloaders work that\nway\n(one for the jre/ext dirs, another for the java.class.path).\n\nAnyway, the excluded.properties fix is just a matter of time before it\nbecomes standard in JUnit, since JAXP will be a standard part of the 1.4\nJDK.  It&#39;ll be just like having org.omg.* excluded.\n\nScott Stirling\n\n-----Original Message-----\nFrom: David V. Olivier [mailto:dolivier@...]\nSent: Wednesday, October 17, 2001 1:56 PM\nTo: junit@yahoogroups.com\nSubject: Re: [junit] Re: swingui & jdk1.4\n\n\nThis is similar to a question I had a week ago and I was told many other\n\nsubscribers had had the same type of question.  Perhaps this is a\ncandidate \nfor the new FAQ.\n\nDavid Olivier\n\nAt 05:43 PM 10/17/2001 +0000, you wrote:\n&gt;I&#39;m having similar issues when test code that uses dom4j (which uses\n&gt;JAXP to instantiate an XML parser, like Xerces).  When I run under\n&gt;junit, it can&#39;t find some org.xml classes.  When I run standalone I\n&gt;have no problems.\n&gt;\n&gt;If anyone knows why, I&#39;d love to find out.\n&gt;\n&gt;--- In junit@y..., Anthony  Pereira &lt;apereira@3...&gt; wrote:\n&gt; &gt; Hi,\n&gt; &gt;\n&gt; &gt; I&#39;m not sure whether this is the place to submit what I&#39;m just\n&gt;going to\n&gt; &gt; write about, if not please do point me in the right direction,\n&gt;cheers.\n&gt; &gt;\n&gt; &gt; I came across a rather bizzare scenario, today using the\n&gt; &gt; junit.swingui.TestRunner in a java 1.4beta2 environment. In some of\n&gt;my code,\n&gt; &gt; I reference classes in org.w3c.dom and org.apache.crimson. Now, as\n&gt;soon as\n&gt; &gt; junit came across classes from these packages, it threw class not\n&gt;found\n&gt; &gt; exceptions. Please note that this doesn&#39;t happen in the the textui\n&gt;nor my\n&gt; &gt; own testing classes, since they are both in the classpath.\n&gt; &gt;\n&gt; &gt; org.w3c.dom specifically is in the rt.jar\n&gt; &gt; org.apache.crimson is a separate jar, which is on my classpath\n&gt; &gt;\n&gt; &gt; After a bit of digging around in the source code, specifically in\n&gt;the\n&gt; &gt; TestCaseClassLoader, I found out about the\n&gt;junit&#92;runner&#92;exclude.properties\n&gt; &gt; file. When I added these package names to that file, things seemed\n&gt;ok, and\n&gt; &gt; those exceptions didn&#39;t take place.\n&gt; &gt;\n&gt; &gt; What confused me was why it didn&#39;t find the classes, even though\n&gt;they was on\n&gt; &gt; my classpath, especially the org.w3c ones which are in the rt.jar\n&gt;(with\n&gt; &gt; 1.4). Furthermore, this was only a problem when using the swingui,\n&gt;with the\n&gt; &gt; textui, it was fine.\n&gt; &gt;\n&gt; &gt; I&#39;ve got it working now that I put those details in the\n&gt;exclude.properties\n&gt; &gt; file. Is this perhaps a issue with using 1.4?\n&gt; &gt;\n&gt; &gt; Any comments or explainations?\n&gt; &gt; Thanks\n&gt; &gt; Anthony\n&gt;\n&gt;\n&gt;To unsubscribe from this group, send an email to:\n&gt;junit-unsubscribe@yahoogroups.com\n&gt;\n&gt;\n&gt;Your use of Yahoo! Groups is subject to\nhttp://docs.yahoo.com/info/terms/\n\n\n\nTo unsubscribe from this group, send an email to:\njunit-unsubscribe@yahoogroups.com\n \n\nYour use of Yahoo! Groups is subject to\nhttp://docs.yahoo.com/info/terms/ \n\n\n\nTo unsubscribe from this group, send an email to:\njunit-unsubscribe@yahoogroups.com\n \n\nYour use of Yahoo! Groups is subject to\nhttp://docs.yahoo.com/info/terms/ \n\n\n\n\n", 
    "profile": "dudehook", 
    "topicId": 2764, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 0, 
    "prevInTime": 2984, 
    "contentTrasformed": false, 
    "postDate": "1003341855", 
    "canDelete": false, 
    "nextInTopic": 2986, 
    "prevInTopic": 2984, 
    "headers": {
        "inReplyToHeader": "PDRGNDdEQ0ZBREM4REQ1MTE4RDJCMDA1MDhCOTUyRDk2MEMzOTg5QHNhbHNhLmFsbGFpcmUuY29tPg==", 
        "messageIdInHeader": "PDAwMDIwMWMxNTczNiQyMjc4M2JjMCQ2YjAxYThjMEBESE9PS0VSPg=="
    }
}