{
    "numMessagesInTopic": 3, 
    "nextInTime": 13971, 
    "senderId": "El0lUSNzw6rmlV7-g2mEJHTTET06SXE-Y5fnMXsEUv-0k6_W1NQ8bVlwfQAgWwK2PW7oAzQ0R1HjROkoP_dym7lu2ss", 
    "systemMessage": true, 
    "subject": "Advice on TDD&#39;ing a POJO that uses a web service", 
    "from": "&quot;etl_dan&quot; &lt;etl_dan@...&gt;", 
    "authorName": "etl_dan", 
    "msgSnippet": "Hi! I m working on a few projects that will obtain data from a web service using JAX-RPC.  To get my feet wet, I m building a project that will get the weather", 
    "msgId": 13970, 
    "rawEmail": "Return-Path: &lt;etl_dan@...&gt;\r\nReceived: (qmail 37001 invoked from network); 20 Jun 2005 17:03:37 -0000\r\nReceived: from unknown (66.218.66.172)\n  by m25.grp.scd.yahoo.com with QMQP; 20 Jun 2005 17:03:37 -0000\r\nReceived: from unknown (HELO n8.bulk.dcn.yahoo.com) (216.155.201.61)\n  by mta4.grp.scd.yahoo.com with SMTP; 20 Jun 2005 17:03:37 -0000\r\nComment: DomainKeys? See http://antispam.yahoo.com/domainkeys\r\nReceived: from [216.155.201.65] by n8.bulk.dcn.yahoo.com with NNFMP; 20 Jun 2005 17:03:36 -0000\r\nReceived: from [66.218.66.58] by mailer2.bulk.dcn.yahoo.com with NNFMP; 20 Jun 2005 17:03:36 -0000\r\nReceived: from [66.218.66.82] by mailer7.bulk.scd.yahoo.com with NNFMP; 20 Jun 2005 17:03:36 -0000\r\nX-Sender: etl_dan@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 81214 invoked from network); 19 Jun 2005 02:46:02 -0000\r\nReceived: from unknown (66.218.66.172)\n  by m23.grp.scd.yahoo.com with QMQP; 19 Jun 2005 02:46:02 -0000\r\nReceived: from unknown (HELO n20a.bulk.scd.yahoo.com) (66.94.237.49)\n  by mta4.grp.scd.yahoo.com with SMTP; 19 Jun 2005 02:46:02 -0000\r\nComment: DomainKeys? See http://antispam.yahoo.com/domainkeys\r\nReceived: from [66.218.69.6] by n20.bulk.scd.yahoo.com with NNFMP; 19 Jun 2005 02:46:02 -0000\r\nReceived: from [66.218.66.79] by mailer6.bulk.scd.yahoo.com with NNFMP; 19 Jun 2005 02:46:02 -0000\r\nDate: Sun, 19 Jun 2005 02:46:01 -0000\r\nTo: junit@yahoogroups.com\r\nMessage-ID: &lt;d92m99+jfog@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Length: 3607\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-system\r\nX-eGroups-Msg-Info: 1:12:0\r\nFrom: &quot;etl_dan&quot; &lt;etl_dan@...&gt;\r\nSubject: Advice on TDD&#39;ing a POJO that uses a web service\r\nX-Yahoo-Group-Post: member; u=86431363; y=G6qemytzibxLF6ssX-EWrQxJmpYGtyebsQuEIT38Dm8_-w\r\nX-Yahoo-Profile: etl_dan\r\nX-eGroups-Approved-By: nails762 &lt;jbrains@...&gt; via web; 20 Jun 2005 17:03:34 -0000\r\n\r\nHi!\n\nI&#39;m working on a few projects that will obtain data from a web service\nusing JAX-RPC.  To get my feet wet, I&#39;m building a project that will\nget the weather forecast from the NDFDXML web service at weather.gov\nand used Axis to generate a client stub.  (http://weather.gov/xml/)\n\nI am doing OK so far, but I wondered if someone would mind checking to\nsee if I&#39;m going too far or in the wrong direction?\n\n\nMy first approach is to have a service POJO that handles all\ncommunication with the web service via the generated stub classes and\nparses response data into more digestible data objects.\n\nGoing the test-first route, I started writing tests for this POJO\nservice, called NOAAWeatherService.  My first gut was to write a happy\npath test to see that the class correctly passes the right arguments.\n To do this, I realized that if my web services consumer object\nactually obtained the stub directly, it would be hard for my tests to\nsubstitute in mocks.  I created a method setProxy() which allows tests\nand a dependency injection container like Spring to wire it up.  (Here\nI pass an object that implements PortType interface generated by Axis&#39;\nWSDL2Java tool)\n\nMy next wince came when I wondered what my mock web service stub\nimplementation could return - the NDFDXML web service at weather.gov\nreturns their specially prepared XML as a response.  My fake object\nwould need to return well-formatted XML data that could be correctly\nprocesse!  So, I decided that this class would have too many\nresponsibilities on its own -- communicating with the web service, and\nparsing the XML results.  So I created a setParser() method which I\ncould fake for these tests and supply a real parser for production.\n\n\nAm I testing at too high a level here, or is this the right way to go?\n  Based on this test, it seems like I&#39;m not testing a whole lot -\nsince the object under test will probably just delegate to other\nobjects.\n\nThanks for the advice!\n\n-Dan\n--\n\n\n    public void testGetCurrentConditions_HappyPath() {\n        NOAAWeatherService service = new NOAAWeatherService();\n        \n        final String webServiceResponse = &quot;Test string&quot;;\n        final double latitude = 30.5d;\n        final double longitude = -70.0d;\n\n        // Set a fake proxy to verify the right arguments are passed\n        service.setProxy(new NdfdXMLStub() {\n            // NDFDgen is a weather.gov method to get forecast data\n            public String NDFDgen(BigDecimal latitude, BigDecimal\nlongitude, String product, Calendar startTime, Calendar endTime,\nWeatherParametersType weatherParameters) throws RemoteException {\n                assertEquals(latitude, latitude.doubleValue(), 0.01);\n                assertEquals(longitude, longitude.doubleValue(),\n0.01);\n                ...  // Check ?all? the web service parameters? \n                return webServiceResponse;\n            }\n        });\n        \n        // Secondly, create a fake response parser so\n        // our tests don&#39;t have to create valid XML...\n        // we&#39;re just testing that our code is interacting\n        // with the web service correctly...\n \n        final WeatherData expected = new WeatherData();\n        service.setNdfdXMLResponseParser(new NdfdXMLResponseParser() {\n            public WeatherData[] parseNdfdGen(String xml) {\n                assertEquals(webServiceResponse, xml);\n                WeatherData[] response = new WeatherData[1];\n                response[0] = expected;\n                return response;\n            }\n        });\n        \n        \n        assertEquals(expected, service.getCurrentConditions(latitude,\nlongitude));\n    }\n\n\n\n\n\n\n", 
    "profile": "etl_dan", 
    "topicId": 13970, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 86431363, 
    "prevInTime": 13969, 
    "contentTrasformed": false, 
    "postDate": "1119149161", 
    "canDelete": false, 
    "nextInTopic": 13981, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PGQ5Mm05OStqZm9nQGVHcm91cHMuY29tPg=="
    }
}