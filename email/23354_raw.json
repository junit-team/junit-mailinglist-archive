{
    "numMessagesInTopic": 10, 
    "nextInTime": 23355, 
    "senderId": "4oVrru45Xox_KkwltuGPRCvY-3OR-Mghq5zbCqezYBjpdpDofGfhvTJla2Jyfl7LYmxagnVFoWUaV__YyaS8ACc9L2ENLT473cW8xz1enQgc3w", 
    "systemMessage": false, 
    "subject": "Re: [junit] Sometimes my tests fail, sometimes not - why?!", 
    "from": "Joakim Ohlrogge &lt;joakim.ohlrogge@...&gt;", 
    "authorName": "Joakim Ohlrogge", 
    "msgSnippet": "I have had several issues when working with a the filesystem from unit tests. In theory you cannot expect the tests to be run sequencially as in test A has", 
    "msgId": 23354, 
    "rawEmail": "Return-Path: &lt;joakim.ohlrogge@...&gt;\r\nX-Sender: joakim.ohlrogge@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 67080 invoked from network); 30 Mar 2011 06:56:52 -0000\r\nX-Received: from unknown (66.196.94.106)\n  by m13.grp.re1.yahoo.com with QMQP; 30 Mar 2011 06:56:52 -0000\r\nX-Received: from unknown (HELO mail-pw0-f48.google.com) (209.85.160.48)\n  by mta2.grp.re1.yahoo.com with SMTP; 30 Mar 2011 06:56:52 -0000\r\nX-Received: by pwi14 with SMTP id 14so205482pwi.7\n        for &lt;junit@yahoogroups.com&gt;; Tue, 29 Mar 2011 23:56:52 -0700 (PDT)\r\nX-Received: by 10.142.122.8 with SMTP id u8mr613880wfc.283.1301468212086; Tue,\n 29 Mar 2011 23:56:52 -0700 (PDT)\r\nMIME-Version: 1.0\r\nX-Received: by 10.142.51.14 with HTTP; Tue, 29 Mar 2011 23:56:32 -0700 (PDT)\r\nIn-Reply-To: &lt;4D924D9E.9060303@...&gt;\r\nReferences: &lt;4D924D9E.9060303@...&gt;\r\nDate: Wed, 30 Mar 2011 08:56:32 +0200\r\nX-Google-Sender-Auth: 9wmKC17-LPSy1rZw8AwSYgGI3BA\r\nMessage-ID: &lt;AANLkTinwfKN6xEpTc82-dPfLFjxduu8zV2tA31N3Cyuv@...&gt;\r\nTo: junit@yahoogroups.com\r\nX-eGroups-From: Joakim Ohlrogge &lt;joakim.ohlrogge@...&gt;\r\nFrom: Joakim Ohlrogge &lt;joakim.ohlrogge@...&gt;\r\nReply-To: joakim.ohlrogge@...\r\nSubject: Re: [junit] Sometimes my tests fail, sometimes not - why?!\r\nX-Yahoo-Group-Post: member; u=261856052; y=0UCsvvBbjUNGaTakZmq318d3PIk0vNY9s28pY4Y-3ZGqr-C_\r\nX-Yahoo-Profile: j0hlrogge\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nI have had several issues when working with a the filesystem from unit\ntest=\r\ns. In theory you cannot expect the tests to be run sequencially as in\ntest =\r\nA has always run before test B (someone may request to run just one of\nthem=\r\n by rightclicking on the test in eclipse for instance) so that is a bad\nass=\r\numption. I don&#39;t think that is your problem in this case though. I don&#39;t\nkn=\r\now about all the magic that goes on with the filesystem behind the scenes\nb=\r\nut especially on windows I have seen issues when files are occationaly not\n=\r\ndeleted properly. I don&#39;t remember how I solved it but I would look for\nthi=\r\nngs like wether the files are properly closed and flushed before you try\nto=\r\n delete them (could be a race condition where the the write stream is\nalmos=\r\nt always GC:ed and closed in that process but sometimes not) that would\nloc=\r\nk the file for deletion occationall (when the the output stream has not\nyet=\r\n been GC:ed). Make sure everything is explicitly closed.\nIt has happened th=\r\nat I think everything looks fine but I have problems\nanyway. That is when I=\r\n start imagining that there the issue is related to\npounding on the filesys=\r\ntem too fast...  I don&#39;t think that has ever been the\ncase though but one g=\r\nets paranoid.\n\nIn general when I have to tests against the file system I te=\r\nnd to to the\nsetup a bit in reverse. I use an empty target directory and re=\r\ncusrively\ndelete every file in it both in my setUp (@Before) and my tearDow=\r\nn (@After).\nThis way, in case a run gets interupted midway and the director=\r\ny is left\ndirty it is cleaned prior to the next run.\n\nThis is not a JUnit i=\r\nssue in any case. In general avoid using the filesystem\nfrom your tests wil=\r\nl spare you lots of grief. Perhaps most of what you want\nto test could be d=\r\none in memory with\nByteArrayOutputStream/ByteArrayInputStream and only touc=\r\nh the filesystem in\nthat last case when you know everything works, you just=\r\n want to see that you\ncan replace ByteArrayInput/OutputStream with FileInpu=\r\ntOutputStream.\nA neat sideeffect by coding this way is that it&#39;s very simpl=\r\ne to change\nsources/targets (like reading from any URL instead of the files=\r\nystem) or\nfiltering (like GZipping everything that is written to the target=\r\n) which is\nnot as elegant to do if you pass around File objects. By all mea=\r\nns make your\nAPI able to take a filename/File instance but make usre that t=\r\nhe first thing\nyou do with it is creat a FileInputStream/FileOutputStream a=\r\nnd pass it on to\nthe next method (using try finally of course). By running =\r\nin memory you are\nalso better prepared to run tests in prallell etc.\n\nNo ro=\r\nck solid advice in here but hopefully something that helps some...\n--------=\r\n---------------------------------------------\nJoakim Ohlrogge\nAgical AB\nV=\r\n=E4sterl=E5nggatan 79, 2 tr\n111 29 Stockholm, SWEDEN\n\nMobile: +46-708-75400=\r\n4\nBlog: johlrogge.wordpress.com\nE-mail: joakim.ohlrogge@...\n\n\nOn Tue,=\r\n Mar 29, 2011 at 11:22 PM, Nils Wilhelm &lt;murphy@...&gt;wrote:\n\n&gt; =\r\nHi there,\n&gt;\n&gt; i have written a simple backup tool and 10 tests. They all ha=\r\nve the same\n&gt; structure:\n&gt; 1. Create some test files and directories in an =\r\ndirectory called &quot;source&quot;\n&gt; 2. Start the backup process (to backup the file=\r\ns/dirs in &quot;source&quot; to a\n&gt; directory called &quot;target&quot;)\n&gt; 3. Check whether all=\r\n files in &quot;source&quot; exist also in &quot;target&quot;\n&gt; 4. Remove all files from the &quot;s=\r\nource&quot; and &quot;target&quot; directory so that the\n&gt; directories are empty for the n=\r\next test.\n&gt;\n&gt; If i execute the whole test set ten times, i have 6-7 success=\r\nes and 3-4\n&gt; failures. The error messages say that files in the target dire=\r\nctory\n&gt; could not be created or deleted (in the last step of the tests, see=\r\n\n&gt; above) if there is a failure. One possibility i could think of is that\n&gt;=\r\n the tests are not run sequentially, so they could have influence at each\n&gt;=\r\n other. But as far as i know JUnit runs all tests in separate threads and\n&gt;=\r\n those sequentially. Is that correct? Does anybody have any suggestions?\n&gt;\n=\r\n&gt; I use eclipse helios, JUnit 4.8.1, Java 1.6 and AspectJ\n&gt;\n&gt; Best regards,=\r\n\n&gt;\n&gt; Nils\n&gt;\n&gt;\n&gt; ------------------------------------\n&gt;\n&gt; Yahoo! Groups Link=\r\ns\n&gt;\n&gt;\n&gt;\n&gt;\n\n\n[Non-text portions of this message have been removed]\n\n\n", 
    "profile": "j0hlrogge", 
    "topicId": 23353, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 261856052, 
    "prevInTime": 23353, 
    "contentTrasformed": false, 
    "postDate": "1301468192", 
    "canDelete": false, 
    "nextInTopic": 23355, 
    "prevInTopic": 23353, 
    "headers": {
        "inReplyToHeader": "PDREOTI0RDlFLjkwNjAzMDNAcGxhbmV0LW9mLWFydC5kZT4=", 
        "messageIdInHeader": "PEFBTkxrVGlud2ZLTjZ4RXBUYzgyLWRQZkxGanhkdXU4elYydEEzMU4zQ3l1dkBtYWlsLmdtYWlsLmNvbT4=", 
        "referencesHeader": "PDREOTI0RDlFLjkwNjAzMDNAcGxhbmV0LW9mLWFydC5kZT4="
    }
}