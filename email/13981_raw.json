{
    "numMessagesInTopic": 3, 
    "nextInTime": 13982, 
    "senderId": "Cx7wQTe-l_L-G57BqniupQUgDWVuAitNypKpqnAYqTpDysqIsqFFkrHfx_Q70hB1-UkvYYd1xKKIvx4XQIdac1RJjKc", 
    "systemMessage": false, 
    "subject": "Re: Advice on TDD&#39;ing a POJO that uses a web service", 
    "from": "&quot;etl_dan&quot; &lt;etl_dan@...&gt;", 
    "authorName": "etl_dan", 
    "msgSnippet": "Sorry, I didn t notice that the code I had lost its format; I ll try once more. I m exposing a method on an interface like this: public WeatherData[]", 
    "msgId": 13981, 
    "rawEmail": "Return-Path: &lt;etl_dan@...&gt;\r\nX-Sender: etl_dan@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 88825 invoked from network); 21 Jun 2005 02:21:41 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m26.grp.scd.yahoo.com with QMQP; 21 Jun 2005 02:21:41 -0000\r\nReceived: from unknown (HELO n8.bulk.dcn.yahoo.com) (216.155.201.61)\n  by mta1.grp.scd.yahoo.com with SMTP; 21 Jun 2005 02:21:41 -0000\r\nComment: DomainKeys? See http://antispam.yahoo.com/domainkeys\r\nReceived: from [216.155.201.64] by n8.bulk.dcn.yahoo.com with NNFMP; 21 Jun 2005 02:21:33 -0000\r\nReceived: from [66.218.69.6] by mailer1.bulk.dcn.yahoo.com with NNFMP; 21 Jun 2005 02:21:33 -0000\r\nReceived: from [66.218.66.76] by mailer6.bulk.scd.yahoo.com with NNFMP; 21 Jun 2005 02:21:33 -0000\r\nDate: Tue, 21 Jun 2005 02:21:33 -0000\r\nTo: junit@yahoogroups.com\r\nMessage-ID: &lt;d97tjd+1tu3@...&gt;\r\nIn-Reply-To: &lt;d92m99+jfog@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Length: 5114\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Msg-Info: 1:12:0\r\nFrom: &quot;etl_dan&quot; &lt;etl_dan@...&gt;\r\nSubject: Re: Advice on TDD&#39;ing a POJO that uses a web service\r\nX-Yahoo-Group-Post: member; u=86431363; y=CwUxAU8OaqGQPzqxoUbvyIVEwEpcouNWHZ0B2qV1fektcQ\r\nX-Yahoo-Profile: etl_dan\r\n\r\nSorry, I didn&#39;t notice that the code I had lost its format; I&#39;ll try\nonce more.\n\nI&#39;m exposing a method on an interface like this:\n\n  public WeatherData[] getForecast(Date startDate, int numDays,\nBigDecimal latitude, BigDecimal longitude);\n\n\nThe trick is that obtaining the data involves two steps: 1)\nCommunicating with a web service, and 2) Parsing the returned XML into\nappropriate model objects.\n\nIf I try to directly test getForecast, then I determined that I need\nto supply a fake web service stub which I can use to verify arguments\nare being passed correctly, but I also need to pass a fake object that\nknows how to parse that XML stream.\n\n\nSo in my happy path test, I am testing that:\n1. the object invokes the right method and parameters on the web\nservice proxy stub\n2. the object returns the same items that the parser returns (the\nparser stub returns some plain fake objects, and the tests assert that\nthis fake array is the right size and contains the right elements)\n\n\nTest #1 feels OK, but Test #2 feels a little unneccessary, and it\nmakes my test longer.  Ultimately I need my parser to return some fake\ndata to prevent an exception (returning null would not test the right\nbehavior!)\n\nAm I going down the right path?\n\nAny advice appreciated!\n\nThanks,\nDan\n\n--- In junit@yahoogroups.com, &quot;etl_dan&quot; &lt;etl_dan@y...&gt; wrote:\n&gt; Hi!\n&gt; \n&gt; I&#39;m working on a few projects that will obtain data from a web service\n&gt; using JAX-RPC.  To get my feet wet, I&#39;m building a project that will\n&gt; get the weather forecast from the NDFDXML web service at weather.gov\n&gt; and used Axis to generate a client stub.  (http://weather.gov/xml/)\n&gt; \n&gt; I am doing OK so far, but I wondered if someone would mind checking to\n&gt; see if I&#39;m going too far or in the wrong direction?\n&gt; \n&gt; \n&gt; My first approach is to have a service POJO that handles all\n&gt; communication with the web service via the generated stub classes and\n&gt; parses response data into more digestible data objects.\n&gt; \n&gt; Going the test-first route, I started writing tests for this POJO\n&gt; service, called NOAAWeatherService.  My first gut was to write a happy\n&gt; path test to see that the class correctly passes the right arguments.\n&gt;  To do this, I realized that if my web services consumer object\n&gt; actually obtained the stub directly, it would be hard for my tests to\n&gt; substitute in mocks.  I created a method setProxy() which allows tests\n&gt; and a dependency injection container like Spring to wire it up.  (Here\n&gt; I pass an object that implements PortType interface generated by Axis&#39;\n&gt; WSDL2Java tool)\n&gt; \n&gt; My next wince came when I wondered what my mock web service stub\n&gt; implementation could return - the NDFDXML web service at weather.gov\n&gt; returns their specially prepared XML as a response.  My fake object\n&gt; would need to return well-formatted XML data that could be correctly\n&gt; processe!  So, I decided that this class would have too many\n&gt; responsibilities on its own -- communicating with the web service, and\n&gt; parsing the XML results.  So I created a setParser() method which I\n&gt; could fake for these tests and supply a real parser for production.\n&gt; \n&gt; \n&gt; Am I testing at too high a level here, or is this the right way to go?\n&gt;   Based on this test, it seems like I&#39;m not testing a whole lot -\n&gt; since the object under test will probably just delegate to other\n&gt; objects.\n&gt; \n&gt; Thanks for the advice!\n&gt; \n&gt; -Dan\n&gt; --\n&gt; \n&gt; \n&gt;     public void testGetCurrentConditions_HappyPath() {\n&gt;         NOAAWeatherService service = new NOAAWeatherService();\n&gt;         \n&gt;         final String webServiceResponse = &quot;Test string&quot;;\n&gt;         final double latitude = 30.5d;\n&gt;         final double longitude = -70.0d;\n&gt; \n&gt;         // Set a fake proxy to verify the right arguments are passed\n&gt;         service.setProxy(new NdfdXMLStub() {\n&gt;             // NDFDgen is a weather.gov method to get forecast data\n&gt;             public String NDFDgen(BigDecimal latitude, BigDecimal\n&gt; longitude, String product, Calendar startTime, Calendar endTime,\n&gt; WeatherParametersType weatherParameters) throws RemoteException {\n&gt;                 assertEquals(latitude, latitude.doubleValue(), 0.01);\n&gt;                 assertEquals(longitude, longitude.doubleValue(),\n&gt; 0.01);\n&gt;                 ...  // Check ?all? the web service parameters? \n&gt;                 return webServiceResponse;\n&gt;             }\n&gt;         });\n&gt;         \n&gt;         // Secondly, create a fake response parser so\n&gt;         // our tests don&#39;t have to create valid XML...\n&gt;         // we&#39;re just testing that our code is interacting\n&gt;         // with the web service correctly...\n&gt;  \n&gt;         final WeatherData expected = new WeatherData();\n&gt;         service.setNdfdXMLResponseParser(new NdfdXMLResponseParser() {\n&gt;             public WeatherData[] parseNdfdGen(String xml) {\n&gt;                 assertEquals(webServiceResponse, xml);\n&gt;                 WeatherData[] response = new WeatherData[1];\n&gt;                 response[0] = expected;\n&gt;                 return response;\n&gt;             }\n&gt;         });\n&gt;         \n&gt;         \n&gt;         assertEquals(expected, service.getCurrentConditions(latitude,\n&gt; longitude));\n&gt;     }\n\n\n\n\n", 
    "profile": "etl_dan", 
    "topicId": 13970, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 86431363, 
    "prevInTime": 13980, 
    "contentTrasformed": false, 
    "postDate": "1119320493", 
    "canDelete": false, 
    "nextInTopic": 13989, 
    "prevInTopic": 13970, 
    "headers": {
        "inReplyToHeader": "PGQ5Mm05OStqZm9nQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PGQ5N3RqZCsxdHUzQGVHcm91cHMuY29tPg=="
    }
}