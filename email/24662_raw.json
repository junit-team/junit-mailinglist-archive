{
    "numMessagesInTopic": 10, 
    "nextInTime": 24663, 
    "senderId": "Z-qPLIgZXT_LyUHkTPa0CNMzC7EZUkd1keH7Sv_lUqhUaJVlC3RrzvIQIzpIg1LO3AvL_enupnAtfvELgvHlmqnG-bhxhb2QJaNAKuM7Duk", 
    "systemMessage": false, 
    "subject": "Re: [junit] Custom classloader", 
    "from": "Johannes Ernst &lt;johannes.ernst@...&gt;", 
    "authorName": "Johannes Ernst", 
    "msgSnippet": "... Short answer: The code I’m trying to test will be loaded by custom ClassLoaders, and I’d rather unit test it with a setup as close to the run-time", 
    "msgId": 24662, 
    "rawEmail": "Return-Path: &lt;johannes.ernst@...&gt;\r\nReceived: (qmail 31932 invoked by uid 7800); 19 May 2015 21:38:29 -0000\r\nX-Sender: johannes.ernst@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 20276 invoked by uid 102); 19 May 2015 21:36:16 -0000\r\nX-Received: from unknown (HELO mtaq1.grp.bf1.yahoo.com) (10.193.84.32)\n  by m1.grp.bf1.yahoo.com with SMTP; 19 May 2015 21:36:16 -0000\r\nX-Received: (qmail 10714 invoked from network); 19 May 2015 21:36:16 -0000\r\nX-Received: from unknown (HELO mail-pa0-f47.google.com) (98.138.100.119)\n  by mtaq1.grp.bf1.yahoo.com with SMTP; 19 May 2015 21:36:16 -0000\r\nX-Received: by pabts4 with SMTP id ts4so40519552pab.3\n        for &lt;junit@yahoogroups.com&gt;; Tue, 19 May 2015 14:36:15 -0700 (PDT)\r\nX-Received: by 10.68.179.67 with SMTP id de3mr57896228pbc.85.1432071375484;\n        Tue, 19 May 2015 14:36:15 -0700 (PDT)\r\nX-Original-Return-Path: &lt;johannes.ernst@...&gt;\r\nX-Received: from sharpwifi.aviatis.com (c-107-3-142-14.hsd1.ca.comcast.net. [107.3.142.14])\n        by mx.google.com with ESMTPSA id dp4sm13949280pbb.82.2015.05.19.14.36.13\n        for &lt;junit@yahoogroups.com&gt;\n        (version=TLSv1 cipher=ECDHE-RSA-RC4-SHA bits=128/128);\n        Tue, 19 May 2015 14:36:14 -0700 (PDT)\r\nX-Google-Original-From: Johannes Ernst &lt;Johannes.Ernst@...&gt;\r\nContent-Type: multipart/alternative; boundary=&quot;Apple-Mail=_860B94F3-A358-4CF5-824D-709579C0809B&quot;\r\nMessage-Id: &lt;1EE513BB-7F9D-4D9D-9312-BF244B1D16FD@...&gt;\r\nMime-Version: 1.0 (Mac OS X Mail 8.2 &#92;(2098&#92;))\r\nDate: Tue, 19 May 2015 14:36:12 -0700\r\nReferences: &lt;mj3eua+jgvvld@...&gt; &lt;CAMZecXm5oZmKHXsdd70wZOgKq8+0F5Eivy5CZQg1RyYUpUofQQ@...&gt; &lt;B54781E6-AFAD-469F-89B1-1B7489A27913@...&gt; &lt;CAM21Rt9XQyAXphovp=cEbKeYRgx1=ts0fWoMVO2e1G2_KCewqw@...&gt; &lt;CALS12-Pid3U-jZvr-6bJe8Z81RYvMaywNDvbd5OLVVPkmh=qdQ@...&gt;\r\nTo: junit@yahoogroups.com\r\nIn-Reply-To: &lt;CALS12-Pid3U-jZvr-6bJe8Z81RYvMaywNDvbd5OLVVPkmh=qdQ@...&gt;\r\nX-Mailer: Apple Mail (2.2098)\r\nSubject: Re: [junit] Custom classloader\r\nX-Yahoo-Group-Post: member; u=411618599; y=9u_V3E4su9zQv9qQvODFNYBd5LFWELkcsB8Q6x7JxRQLY_KJ\r\nX-Yahoo-Profile: r_objects\r\nX-Original-From: Johannes Ernst &lt;johannes.ernst@...&gt;\r\nX-eGroups-Approved-By: dsaff &lt;david@...&gt; via email; 19 May 2015 21:38:29 -0000\r\nFrom: Johannes Ernst &lt;johannes.ernst@...&gt;\r\n\r\n\r\n--Apple-Mail=_860B94F3-A358-4CF5-824D-709579C0809B\r\nContent-Transfer-Encoding: quoted-printable\r\nContent-Type: text/plain;\n\tcharset=utf-8\r\n\r\nSome people asked:\n\n&gt; Why do you need custom classloading?\n\nShort answer:\n\n=\r\nThe code I=E2=80=99m trying to test will be loaded by custom ClassLoaders, =\r\nand I=E2=80=99d rather unit test it with a setup as close to the run-time s=\r\netup as possible.\n\nLonger answer:\n\nI=E2=80=99ve created a =E2=80=9Cmodule f=\r\nramework=E2=80=9D (still looking for a good name; suggestions welcome) that=\r\n mirrors the maven project hierarchy at runtime. Assume your maven projects=\r\n look like this:\n\nMAIN\n    MODULE_A\n        MODULE_C\n            MODULE_D\n =\r\n       MODULE_E\n    MODULE_B\n        MODULE_C\n            MODULE_D\n        =\r\nMODULE_E\n\nto run my project, I say:\n\n&gt; java -jar mybootloader.jar -module M=\r\nAIN\n\ninstead of having to create a really long class path that includes all=\r\n the module jars. The module framework evaluates the pom file inside MAIN.j=\r\nar, and recursively looks for the jars of submodules in a well-known place =\r\n(e.g. ~/.m2, or /usr/lib/java), and creates a ClassLoader for each one of t=\r\nhem. (In the above example: 6 ClassLoaders) They delegate to each other in =\r\na structure that reflects the maven project hierarchy.\n\nThis has several ad=\r\nvantages:\n * isolation =E2=80=94 it=E2=80=99s much harder for code in one m=\r\nodule with its own ClassLoader to =E2=80=9Cbreak out=E2=80=9D. \n * I can dy=\r\nnamically add modules to a running program without much trouble, simply by =\r\nadding another delegate ClassLoader to MODULE_C=E2=80=99s ClassLoader, for =\r\nexample. This is useful for dynamic plug-ins such as =E2=80=9Coh, this webs=\r\nite I just came across references yet another media type=E2=80=9D)\n * And I=\r\n really hate distributing gigantic WARs and what have you that contain a to=\r\nn of code that wasn=E2=80=99t actually updated: this lets me update just th=\r\ne one JAR at the time that was updated. This is a problem I=E2=80=99d like =\r\nto solve nicely for UBOS http://ubos.net/ &lt;http://ubos.net/&gt; =E2=80=94 if i=\r\nt can be done for all languages, why not also for Java?\n\nBecause more thing=\r\ns can go wrong with so many ClassLoaders than with only one, I=E2=80=99d li=\r\nke to have the same structure during junit testing.\n\nThe code for this curr=\r\nently resides at https://github.com/infogrid-org/infogrid-modules &lt;https://=\r\ngithub.com/infogrid-org/infogrid-modules&gt; but it will become a separate pro=\r\nject, once I figure out a name for it! It works from the command line, and =\r\nit works in Tomcat 8.\n\nDoes this make sense?\n\nCheers,\n\n\n\nJohannes.\n\n\r\n--Apple-Mail=_860B94F3-A358-4CF5-824D-709579C0809B\r\nContent-Transfer-Encoding: quoted-printable\r\nContent-Type: text/html;\n\tcharset=utf-8\r\n\r\n&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=3D&quot;Content-Type&quot; content=3D&quot;text/html charset=\r\n=3Dutf-8&quot;&gt;&lt;/head&gt;&lt;body style=3D&quot;word-wrap: break-word; -webkit-nbsp-mode: s=\r\npace; -webkit-line-break: after-white-space;&quot; class=3D&quot;&quot;&gt;&lt;div&gt;Some people a=\r\nsked:&lt;/div&gt;&lt;div&gt;&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;blockquote type=3D&quot;cite&quot; class=\r\n=3D&quot;&quot;&gt;&lt;div class=3D&quot;&quot;&gt;&lt;div id=3D&quot;ygrp-mlmsg&quot; style=3D&quot;font-size: 13px; font=\r\n-family: Arial, helvetica, clean, sans-serif; font-style: normal; font-vari=\r\nant: normal; font-weight: normal; letter-spacing: normal; line-height: norm=\r\nal; orphans: auto; text-align: start; text-indent: 0px; text-transform: non=\r\ne; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-strok=\r\ne-width: 0px; background-color: rgb(255, 255, 255); position: relative;&quot; cl=\r\nass=3D&quot;&quot;&gt;&lt;div id=3D&quot;ygrp-msg&quot; style=3D&quot;line-height: 1.22em; z-index: 1;&quot; cl=\r\nass=3D&quot;&quot;&gt;&lt;div id=3D&quot;ygrp-text&quot; style=3D&quot;line-height: 1.22em; font-family: G=\r\neorgia;&quot; class=3D&quot;&quot;&gt;&lt;div dir=3D&quot;ltr&quot; style=3D&quot;line-height: 1.22em;&quot; class=\r\n=3D&quot;&quot;&gt;&lt;div style=3D&quot;line-height: 1.22em;&quot; class=3D&quot;&quot;&gt;Why do you need custom=\r\n classloading?&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;br class=3D=\r\n&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;Short answer:&lt;/div&gt;&lt;div&gt;&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;The code I=\r\n=E2=80=99m trying to test will be loaded by custom ClassLoaders, and I=E2=\r\n=80=99d rather unit test it with a setup as close to the run-time setup as =\r\npossible.&lt;/div&gt;&lt;div&gt;&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;div&gt;Longer answer:&lt;/div&gt;&lt;div&gt;&lt;br =\r\nclass=3D&quot;&quot;&gt;&lt;/div&gt;I=E2=80=99ve created a =E2=80=9Cmodule framework=E2=80=9D =\r\n(still looking for a good name; suggestions welcome) that mirrors the maven=\r\n project hierarchy at runtime. Assume your maven projects look like this:&lt;d=\r\niv class=3D&quot;&quot;&gt;&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;MAIN&lt;/div&gt;&lt;div class=3D&quot;=\r\n&quot;&gt;&nbsp; &nbsp; MODULE_A&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&nbsp; &nbsp; &nbsp; &nbsp; M=\r\nODULE_C&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MODU=\r\nLE_D&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&nbsp; &nbsp; &nbsp; &nbsp; MODULE_E&lt;/div&gt;&lt;div cl=\r\nass=3D&quot;&quot;&gt;&nbsp; &nbsp; MODULE_B&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&nbsp; &nbsp; &nbsp; &=\r\nnbsp; MODULE_C&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&lt;div class=3D&quot;&quot;&gt;&nbsp; &nbsp; &nbsp; &n=\r\nbsp; &nbsp; &nbsp; MODULE_D&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&nbsp; &nbsp; &nbsp; &nbsp=\r\n; MODULE_E&lt;/div&gt;&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;=\r\nto run my project, I say:&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;div cl=\r\nass=3D&quot;&quot;&gt;&gt; java -jar mybootloader.jar -module MAIN&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;=\r\n&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;instead of having to create a really l=\r\nong class path that includes all the module jars. The module framework eval=\r\nuates the pom file inside MAIN.jar, and recursively looks for the jars of s=\r\nubmodules in a well-known place (e.g. ~/.m2, or /usr/lib/java), and creates=\r\n a ClassLoader for each one of them. (In the above example: 6 ClassLoaders)=\r\n They delegate to each other in a structure that reflects the maven project=\r\n hierarchy.&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;This =\r\nhas several advantages:&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&nbsp;* isolation =E2=80=94 it=\r\n=E2=80=99s much harder for code in one module with its own ClassLoader to =\r\n=E2=80=9Cbreak out=E2=80=9D.&nbsp;&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&nbsp;* I can dynam=\r\nically add modules to a running program without much trouble, simply by add=\r\ning another delegate ClassLoader to MODULE_C=E2=80=99s ClassLoader, for exa=\r\nmple. This is useful for dynamic plug-ins such as =E2=80=9Coh, this website=\r\n I just came across references yet another media type=E2=80=9D)&lt;/div&gt;&lt;div c=\r\nlass=3D&quot;&quot;&gt;&nbsp;* And I really hate distributing gigantic WARs and what hav=\r\ne you that contain a ton of code that wasn=E2=80=99t actually updated: this=\r\n lets me update just the one JAR at the time that was updated. This is a pr=\r\noblem I=E2=80=99d like to solve nicely for UBOS &lt;a href=3D&quot;http://ubos.net/=\r\n&quot; class=3D&quot;&quot;&gt;http://ubos.net/&lt;/a&gt;&nbsp;=E2=80=94 if it can be done for all =\r\nlanguages, why not also for Java?&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&lt;br class=3D&quot;&quot;&gt;&lt;/div=\r\n&gt;&lt;div class=3D&quot;&quot;&gt;Because more things can go wrong with so many ClassLoaders=\r\n than with only one, I=E2=80=99d like to have the same structure during jun=\r\nit testing.&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;The c=\r\node for this currently resides at&nbsp;&lt;a href=3D&quot;https://github.com/infogr=\r\nid-org/infogrid-modules&quot; class=3D&quot;&quot;&gt;https://github.com/infogrid-org/infogri=\r\nd-modules&lt;/a&gt;&nbsp;but it will become a separate project, once I figure out=\r\n a name for it! It works from the command line, and it works in Tomcat 8.&lt;/=\r\ndiv&gt;&lt;div class=3D&quot;&quot;&gt;&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&lt;div class=3D&quot;&quot;&gt;Do=\r\nes this make sense?&lt;/div&gt;&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;div cl=\r\nass=3D&quot;&quot;&gt;Cheers,&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;=\r\n&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;J=\r\nohannes.&lt;/div&gt;&lt;div class=3D&quot;&quot;&gt;&lt;br class=3D&quot;&quot;&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;\r\n--Apple-Mail=_860B94F3-A358-4CF5-824D-709579C0809B--\r\n\n", 
    "profile": "r_objects", 
    "topicId": 24651, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 411618599, 
    "prevInTime": 24661, 
    "contentTrasformed": false, 
    "postDate": "1432071372", 
    "canDelete": false, 
    "nextInTopic": 24663, 
    "prevInTopic": 24661, 
    "headers": {
        "inReplyToHeader": "PENBTFMxMi1QaWQzVS1qWnZyLTZiSmU4WjgxUll2TWF5d05EdmJkNU9MVlZQa21oPXFkUUBtYWlsLmdtYWlsLmNvbT4=", 
        "messageIdInHeader": "PDFFRTUxM0JCLTdGOUQtNEQ5RC05MzEyLUJGMjQ0QjFEMTZGREBnbWFpbC5jb20+", 
        "referencesHeader": "PG1qM2V1YStqZ3Z2bGRAWWFob29Hcm91cHMuY29tPiA8Q0FNWmVjWG01b1ptS0hYc2RkNzB3Wk9nS3E4KzBGNUVpdnk1Q1pRZzFSeVlVcFVvZlFRQG1haWwuZ21haWwuY29tPiA8QjU0NzgxRTYtQUZBRC00NjlGLTg5QjEtMUI3NDg5QTI3OTEzQGdtYWlsLmNvbT4gPENBTTIxUnQ5WFF5QVhwaG92cD1jRWJLZVlSZ3gxPXRzMGZXb01WTzJlMUcyX0tDZXdxd0BtYWlsLmdtYWlsLmNvbT4gPENBTFMxMi1QaWQzVS1qWnZyLTZiSmU4WjgxUll2TWF5d05EdmJkNU9MVlZQa21oPXFkUUBtYWlsLmdtYWlsLmNvbT4="
    }
}