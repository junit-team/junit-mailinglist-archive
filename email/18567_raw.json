{
    "numMessagesInTopic": 12, 
    "nextInTime": 18568, 
    "senderId": "foo4Ng_m0Kq3CpDKg5cgiE3y8S6AseCHD7-zIo7k2zWJO6pU-J6llFydtGR26Cz-lmZsR8TVZWP0eMixsy3zOWY-oG2O7kRbGE_h4RlqR38xXGg", 
    "systemMessage": false, 
    "subject": "Re: Test a remote server", 
    "from": "&quot;Andrew McDonagh&quot; &lt;andrewmcdonagh@...&gt;", 
    "authorName": "Andrew McDonagh", 
    "msgSnippet": "... I am writting  a sample java file which will be doing the same (You can say its a prototype of it.) ... ().toString()); ... sInetAddress); ... JAVA files", 
    "msgId": 18567, 
    "rawEmail": "Return-Path: &lt;andrewmcdonagh@...&gt;\r\nX-Sender: andrewmcdonagh@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 5227 invoked from network); 21 Dec 2006 19:09:18 -0000\r\nReceived: from unknown (66.218.67.33)\n  by m28.grp.scd.yahoo.com with QMQP; 21 Dec 2006 19:09:18 -0000\r\nReceived: from unknown (HELO n18.bullet.sp1.yahoo.com) (69.147.64.215)\n  by mta7.grp.scd.yahoo.com with SMTP; 21 Dec 2006 19:09:18 -0000\r\nReceived: from [216.252.122.219] by n18.bullet.sp1.yahoo.com with NNFMP; 21 Dec 2006 19:08:37 -0000\r\nReceived: from [209.73.164.86] by t4.bullet.sp1.yahoo.com with NNFMP; 21 Dec 2006 19:08:37 -0000\r\nReceived: from [66.218.66.83] by t8.bullet.scd.yahoo.com with NNFMP; 21 Dec 2006 19:08:37 -0000\r\nDate: Thu, 21 Dec 2006 19:08:37 -0000\r\nTo: junit@yahoogroups.com\r\nMessage-ID: &lt;emem3l+9j9l@...&gt;\r\nIn-Reply-To: &lt;20061215142328.80090.qmail@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-compose\r\nX-eGroups-Msg-Info: 1:6:0:0\r\nFrom: &quot;Andrew McDonagh&quot; &lt;andrewmcdonagh@...&gt;\r\nSubject: Re: Test a remote server\r\nX-Yahoo-Group-Post: member; u=283773244; y=gKYuKy5gr-KUbPtF9uLrRsRrPkCzg2xZprAxOsV_Ihr5Kg03qjJlvg\r\nX-Yahoo-Profile: andy_ipaccess\r\n\r\n--- In junit@yahoogroups.com, avinash anand &lt;avinash_anand@...&gt; \nwrote:\n&gt;\n&gt;=\r\n Hi \n&gt;      Posting the real .java file would not  be possible for me but \n=\r\nI am writting  a sample java file which will be doing the same (You \ncan sa=\r\ny its a prototype of it.)\n&gt; \n&gt; class server{\n&gt; private DBConnection _dbconn=\r\nectoin;\n&gt; private server _serverinstance =3D null;\n&gt; private static VespAla=\r\nrmService _alarmService;\n&gt; private static VespUuid _serverUUID;\n&gt; private s=\r\nerver(){\n&gt; _alarmService =3D VespAlarmServiceImpl.getInstance();\n&gt; }\n&gt; publ=\r\nic static server getInstance(){\n&gt; if (null =3D=3D _servernstance){\n&gt; _serve=\r\nrinstance =3D new server(); \n&gt; }\n&gt; return _serverinstance;\n&gt; }\n&gt; public sta=\r\ntic void main(String[] args){ \n&gt; if (args.length &gt;=3D 1){\n&gt; try {\n&gt; //set t=\r\nhe initial environment\n&gt; AnotherServer.getInstance().setEnvironment();\n&gt; se=\r\nrver obj =3D server.getInstance();\n&gt; _serverUUID =3D new VespUuid(args[0]);=\r\n\n&gt; StringBuffer sb =3D new StringBuffer(_serverUUID.getInetAddress\n().toStr=\r\ning());\n&gt; sb.delete(0, 1);\n&gt; sb.append(&quot;:&quot;);\n&gt; sb.append(_serverUUID.getPor=\r\nt());\n&gt; String sInetAddress =3D sb.toString();\n&gt; System.setProperty(VespCon=\r\nfigParams.MTT_INSTANCE_HOST_PROPERTY, \nsInetAddress);\n&gt; if(args.length &gt;=3D=\r\n 2) { \n&gt; System.setProperty(VespConfigParams.ORB_UUID_PROPERTY, args[1]);\n&gt;=\r\n }\n&gt; void startserver ()\n&gt; {\n&gt; }\n&gt; void stopserver()\n&gt; {\n&gt; }\n&gt; void isserve=\r\nrready()\n&gt; {\n&gt; }\n&gt; void generatevespAlarm()\n&gt; {\n&gt; } \n&gt; }\n&gt; \n&gt; \n&gt; This is ho=\r\nw the main class looks. There are many other supporting \nJAVA files for thi=\r\ns main server. It uses a JNI layer to talk to the \nnative code. Which is im=\r\nplemented elesewhere.\n&gt; \n&gt; \n&gt; \n&gt; For it to run in the actul enviroment, it =\r\nuses a wrapper .exe \nwhich calls an xml file where all the server propertie=\r\ns are listed \nin the main method the location of .class files are specified=\r\n which \nare already compiled and put in the java&#92;lib folder in the form \nof=\r\n .jar. Here is the snippet of xml file where the exe tries to read \nit.\n&gt; \n=\r\n&gt; &lt;stringProperty property=3D&quot;jloader.server.main.class&quot; \ndisplayName=3D&quot;Ma=\r\nin class&quot; default=3D&quot;com/xyz/server/testing&quot; \nenabled=3D&quot;false&quot; advanced=3D=\r\n&quot;true&quot; /&gt;\n&gt; \n&gt; \n&gt; What I am trying is to write a JUnit test suite for this =\r\nJava \nbased server, which will be running in the form of an .exe. And my \nt=\r\nest cases will be running in eclipse.\n&gt; \n&gt; \n&gt; Hope the entire thing might m=\r\nake the picture a bit clear. \n&gt; \n&gt; Thanks\n&gt; Avinash\n&gt; \n&gt; \n&gt; ----- Original =\r\nMessage ----\n&gt; From: &quot;andrew.p.mcdonagh@...&quot; &lt;andrew.p.mcdonagh@...&gt;\n&gt; To: =\r\njunit@yahoogroups.com\n&gt; Sent: Friday, 15 December, 2006 7:25:14 PM\n&gt; Subjec=\r\nt: Re: [junit] Test a remote server\n&gt; \n&gt; Hi,\n&gt; \n&gt; Not sure why your Java ap=\r\np does not use Java&#39;s corba ability (a \ngood Java \n&gt; ORB being http://www.j=\r\nacorb. org/ ), instead of JNI...\n&gt; \n&gt; Anyway, onto your real question, how =\r\ndo I test the code that is \ndependant \n&gt; upon the other servers?\n&gt; \n&gt; As yo=\r\nu are asking on the JUnit list I take it you mean Unit test?\n&gt; Not System o=\r\nr Integration testing?\n&gt; \n&gt; If so, then you will find unit testing much sim=\r\npler and (imo) \nbetter, if \n&gt; none of your unit tests need to access any fi=\r\nle, network, database \nor UI. \n&gt; This means they run very fast. Once you fi=\r\ngure out how to do them, \nyou \n&gt; should be able to write lots of them , qui=\r\nckly too.\n&gt; \n&gt; We could just give you some simple examples, but I tend to f=\r\nind it \nbetter \n&gt; to show you how to unit test one of your classes that dep=\r\nend on \ncorba or \n&gt; some other system, by using one of your real classes. S=\r\no, please \npost \n&gt; (just one) class and we&#39;ll knock up a unit test for it.\n=\r\n&gt; \n&gt; Regards\n&gt; \n&gt; Andrew\n&gt; \n&gt; &quot;avinash anand&quot; &lt;avinash_anand@ yahoo.co. uk&gt;=\r\n \n&gt; Sent by: junit@yahoogroups. com\n&gt; 15-Dec-2006 09:04\n&gt; Please respond to=\r\n junit@yahoogroups. com\n&gt; \n&gt; To\n&gt; junit@yahoogroups. com\n&gt; cc\n&gt; \n&gt; Subject\n=\r\n&gt; [junit] Test a remote server\n&gt; \n&gt; Hi Group\n&gt; Greetings to all. These days=\r\n I am writting test suit for a CORBA \nCRM. Let \n&gt; me first introduce the sy=\r\nstem.\n&gt; \n&gt; There is a central ORB server and many other servers which talk =\r\nto \neach \n&gt; other through vesp. ORB being the central one. Entire code base=\r\n is \nin C++. \n&gt; I have to test a new server introduced in the system which =\r\nis \nwritten in \n&gt; Java. This new server talks to the rest through JNI. As a=\r\n matter \nof Fact \n&gt; none of the servers can run independently, they neccesi=\r\nrily have \nto log \n&gt; into the central kit and report to the the central ORB=\r\n server. \nAfter \n&gt; validation stuff the server starts working.\n&gt; \n&gt; Even th=\r\nis new Java based server uses an executable file to work \n&gt; (Jloader.exe wr=\r\nitten in c++)\n&gt; \n&gt; This .exe loads various .dll files in the system and in =\r\nits main \nmethod \n&gt; calls the compiled .class files. This is the way how sy=\r\nstem \nfunctions.\n&gt; \n&gt; My problem is that when I will write a JUnit test cas=\r\ne in IDE \n(eclipse) \n&gt; which would operate on the actual code which has 99%=\r\n dependency \nand cannot \n&gt; be tested isolated. Is there any way to test thi=\r\ns server code \nwhile it is \n&gt; working under the live system and the test su=\r\nite running in the \neclipse \n&gt; IDE.\n&gt; \n&gt; HELP !!!\n&gt; \n&gt; Thanks\n&gt; Avinash\n\n\nS=\r\norry for the delay - Yahoo doesn&#39;t seem to be accepting my emails \nat the m=\r\noment!\n\nHere&#39;s what I&#39;ve tried to post a few times.....\n\n\n\n\n\nHi, \n\nSo I&#39;m s=\r\ntill not sure if you mean you want to Unit test or System \ntest, using the =\r\nJUnit framework. \n\nI&#39;m going to show how I would   Unit Test    the code, u=\r\nsing \nJUnit..... \n\n\nThe code as it stands, makes unit testing difficult bec=\r\nause of the \nuse of Singletons, static methods and raw Corba or RMi objects=\r\n.  So \nI&#39;m going to refactor it somewhat to make it testable.  Making it \nt=\r\nestable usually makes the design more flexible, finer grained and \nloosely =\r\ncoupled - all good things. \n\nFirst step - move the property setting code in=\r\nto its own class - \nthen test it there instead of inside the main() method.=\r\n  This is \nbecause the main() method has calls to a singleton and creates C=\r\nORBA \nobjects, which I can&#39;t easily get around, as this code is inside the =\r\n\nstatic &#39;main()&#39; method.  If this code lived inside an instance \nmethod of =\r\nServer, then I could inject a mock object for these. \n\nSo, here&#39;s the main =\r\nmethod, with the MTT Host and UUID property \nsetting code moved into a new =\r\nclass. The new class&#39;s method also \nonly knows about normal Java classes (I=\r\nnetAddress) instead of being \ncoupled to the VestUUID class - this makes un=\r\nit testing really \neasy!!!! \n\n\n public static void main(String[] args) { \n =\r\n   if (args.length &gt;=3D 1) { \n      try { \n        // set the initial envir=\r\nonment \n        AnotherServer.getInstance().setEnvironment(); \n\n        Ser=\r\nver obj =3D Server.getInstance(); \n\n        _serverUUID =3D new VespUuid(ar=\r\ngs[0]); \n\n        InetAddress inetAddress =3D _serverUUID.getInetAddress();=\r\n \n        SystemPropertyConfigurator.setMttHostProperty(inetAddress, \nServe=\r\nr._serverUUID.getPort()); \n\n        if (args.length &gt;=3D 2) { \n          Sy=\r\nstemPropertyConfigurator.setOrbUuidProperty(args[1]); \n        } \n      } c=\r\natch (Exception e) { \n        // todo... \n        throw new RuntimeExceptio=\r\nn(e); \n      } \n    } \n  } \n\n\nHere&#39;s the new class......(as it currently st=\r\nands) \n\n\nimport java.net.InetAddress; \n\npublic class SystemPropertyConfigur=\r\nator { \n\n  static void setMttHostProperty(InetAddress inetAddress, String \n=\r\nport) { \n    StringBuffer sb =3D new StringBuffer(inetAddress.toString()); =\r\n\n    sb.delete(0, 1); \n    sb.append(&quot;:&quot;); \n    sb.append(port); \n  \n    St=\r\nring sInetAddress =3D sb.toString(); \n    System.setProperty(VespConfigPara=\r\nms.MTT_INSTANCE_HOST_PROPERTY, \nsInetAddress); \n  } \n\n\n\n  static void setOr=\r\nbUuidProperty(String uuid) { \n    System.setProperty(VespConfigParams.ORB_U=\r\nUID_PROPERTY, uuid); \n  } \n  \n} \n\n\n\n\nAnd now here&#39;s its unit test!!!!!!!!!!=\r\n! (these run and pass in my \neclipse) \n\n\nimport java.net.InetAddress; \nimpo=\r\nrt java.net.UnknownHostException; \n\nimport junit.framework.TestCase; \n\npubl=\r\nic class SystemPropertyConfiguratorTest extends TestCase { \n\n  public void =\r\ntestMttHostPropertySetWithoutFirstLetter() throws \nUnknownHostException { \n=\r\n    InetAddress address =3D InetAddress.getByName(&quot;localhost&quot;); \n\n    Syste=\r\nmPropertyConfigurator.setMttHostProperty(address, &quot;8080&quot;); \n\n    String act=\r\nualProperty =3D System.getProperty\n(VespConfigParams.MTT_INSTANCE_HOST_PROP=\r\nERTY); \n    \n    String expectedProperty =3D &quot;ocalhost/127.0.0.1:8080&quot;; \n  =\r\n  \n    assertNotNull(&quot;Property not found!&quot;, actualProperty); \n    assertEqu=\r\nals(&quot;Wrong property value!&quot;, expectedProperty, \nactualProperty); \n  } \n  \n =\r\n \n public void testOrbUuidPropertySet() { \n   SystemPropertyConfigurator.se=\r\ntOrbUuidProperty(&quot;a UUID!&quot;); \n    \n   String actualProperty =3D System.getP=\r\nroperty\n(VespConfigParams.ORB_UUID_PROPERTY); \n      \n   assertNotNull(&quot;Pro=\r\nperty not found!&quot;, actualProperty); \n   assertEquals(&quot;Wrong property value!=\r\n&quot;, &quot;a UUID!&quot;, actualProperty); \n } \n  \n} \n\n\n\n\nNow, as things stand, I may d=\r\necide to not unit test the &#39;main()&#39; \nmethod in Server class at all, as all =\r\nits doing is calling others to \ndo things, I might rely upon the normal Sys=\r\ntem and integeration \ntests to test it.  Or I may decide to refactor the Se=\r\nrver class as \nwell, to allow me to make the main() method more testable (w=\r\nhich \nwill involve similar techniques as I&#39;ve shown here).  The choice \ncom=\r\nes down as always to one of time vs payback.   \n\nHopefully this is enough t=\r\no get you started in thinking baout how to \nchange your design slightly, to=\r\n enable unit testing of the code, \nwithout having to have real corba, netwo=\r\nrks, files, dbs, etc around. \n\nFeel free to ask for more help... \n\nAndrew \n=\r\n\n\n\n\n\n\n", 
    "profile": "andy_ipaccess", 
    "topicId": 18546, 
    "spamInfo": {
        "reason": "6", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 283773244, 
    "prevInTime": 18566, 
    "contentTrasformed": false, 
    "postDate": "1166728117", 
    "canDelete": false, 
    "nextInTopic": 18571, 
    "prevInTopic": 18560, 
    "headers": {
        "inReplyToHeader": "PDIwMDYxMjE1MTQyMzI4LjgwMDkwLnFtYWlsQHdlYjI2NzEyLm1haWwudWtsLnlhaG9vLmNvbT4=", 
        "messageIdInHeader": "PGVtZW0zbCs5ajlsQGVHcm91cHMuY29tPg=="
    }
}