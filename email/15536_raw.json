{
    "numMessagesInTopic": 21, 
    "nextInTime": 15537, 
    "senderId": "ZN39XiRRxvBU07pOPXVQrHtYZ31GEl2G_e902EuGGI8se0HlEmcj8tSUAxRJwNBfy6fZa0mMpVzuv2Rqm5Lg9C09qyU_Bilj7fqLPRc", 
    "systemMessage": true, 
    "subject": "Expected exception pitfall and pattern", 
    "from": "&quot;Jon Skeet&quot; &lt;jon.skeet@...&gt;", 
    "authorName": "Jon Skeet", 
    "msgSnippet": "There is a problem with the @Test(expected=...) pattern which I m sure has been noted elsewhere. Namely, it covers up problems if the expected exception is", 
    "msgId": 15536, 
    "rawEmail": "Return-Path: &lt;Jon.Skeet@...&gt;\r\nReceived: (qmail 50800 invoked from network); 28 Nov 2005 17:50:21 -0000\r\nReceived: from unknown (66.218.66.172)\n  by m23.grp.scd.yahoo.com with QMQP; 28 Nov 2005 17:50:21 -0000\r\nReceived: from unknown (HELO n3a.bulk.scd.yahoo.com) (66.94.237.37)\n  by mta4.grp.scd.yahoo.com with SMTP; 28 Nov 2005 17:50:21 -0000\r\nComment: DomainKeys? See http://antispam.yahoo.com/domainkeys\r\nReceived: from [66.218.69.2] by n3.bullet.scd.yahoo.com with NNFMP; 28 Nov 2005 17:50:00 -0000\r\nReceived: from [66.218.66.76] by mailer2.bulk.scd.yahoo.com with NNFMP; 28 Nov 2005 17:50:00 -0000\r\nX-Sender: Jon.Skeet@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 50581 invoked from network); 28 Nov 2005 09:12:18 -0000\r\nReceived: from unknown (66.218.66.172)\n  by m29.grp.scd.yahoo.com with QMQP; 28 Nov 2005 09:12:18 -0000\r\nReceived: from unknown (HELO uk-app-2.clearswift.com) (213.146.158.166)\n  by mta4.grp.scd.yahoo.com with SMTP; 28 Nov 2005 09:12:18 -0000\r\nReceived: from uk-msw-a.clearswift.com ([10.44.30.43])\n\tby uk-app-2.clearswift.com (8.13.4/8.13.4) with ESMTP id jAS9CAK2008922\n\tfor &lt;junit@yahoogroups.com&gt;; Mon, 28 Nov 2005 09:12:10 GMT\r\nReceived: from GEMINI.EUROPE.CLEARSWIFT.COM (unverified) by \n    uk-msw-a.clearswift.com (Clearswift SMTPRS 5.2.2) with ESMTP id \n    &lt;T74e295cb6d0a2c1e2b5a8@...&gt; for \n    &lt;junit@yahoogroups.com&gt;; Mon, 28 Nov 2005 09:21:14 +0000\r\nReceived: from exchclusta.EUROPE.CLEARSWIFT.COM ([10.44.16.98]) by \n    GEMINI.EUROPE.CLEARSWIFT.COM with Microsoft SMTPSVC(5.0.2195.6713); \n    Mon, 28 Nov 2005 09:12:09 +0000\r\nX-MimeOLE: Produced By Microsoft Exchange V6.0.6603.0\r\ncontent-class: urn:content-classes:message\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;us-ascii&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nDate: Mon, 28 Nov 2005 09:12:09 -0000\r\nMessage-ID: &lt;6EAA8AD82D7EBF478CCE262FA32C6C6401B56A1A@...&gt;\r\nX-MS-Has-Attach: \r\nX-MS-TNEF-Correlator: \r\nThread-Topic: Expected exception pitfall and pattern\r\nThread-Index: AcXz+89fSk7EJssrQfCnDECvKPM3AA==\r\nTo: &lt;junit@yahoogroups.com&gt;\r\nX-OriginalArrivalTime: 28 Nov 2005 09:12:09.0890 (UTC) \n    FILETIME=[CFD1C820:01C5F3FB]\r\nX-eGroups-Msg-Info: 1:12:0:0\r\nFrom: &quot;Jon Skeet&quot; &lt;jon.skeet@...&gt;\r\nSubject: Expected exception pitfall and pattern\r\nX-Yahoo-Group-Post: member; u=246518675; y=BP18E68oT4DkJ9-FUZzd3SYtCW3T-gOt4DY7vGbHllJ8nDo\r\nX-Yahoo-Profile: jskeetuk\r\nX-Yahoo-Newman-Property: groups-system\r\nX-eGroups-Approved-By: vbossica &lt;vladimir@...&gt; via web; 28 Nov 2005 17:49:57 -0000\r\n\r\nThere is a problem with the @Test(expected=3D...) pattern which I&#39;m sure\nha=\r\ns been noted elsewhere. Namely, it covers up problems if the expected\nexcep=\r\ntion is thrown at an unexpected point. The desired behaviour is\nreally a tr=\r\ny/catch around one particular line of code. For instance:\n\n@Test(expected=\r\n=3DIllegalArgumentException.class)\npublic void test()\n{\n    Account f =3D n=\r\new Account(10);\n    f.withdrawCash(20);\n}\n\nis equivalent to:\n\ntry\n{\n    Acc=\r\nount f =3D new Account(10);\n    f.withdrawCash(20);\n    fail(&quot;Expected exce=\r\nption&quot;);\n}\ncatch (IllegalArgumentException e)\n{\n}\n\ninstead of the desired:\n=\r\n\nAccount f =3D new Account(10);\ntry\n{\n    f.withdrawCash(20);\n    fail(&quot;Exp=\r\nected exception&quot;);    \n}\ncatch (IllegalArgumentException e)\n{\n}\n\n\nNow, ther=\r\ne is a way around this (other than writing the code\n&quot;long-hand&quot;) - by keepi=\r\nng a flag which is checked during tear-down, and\nonly set immediately befor=\r\ne the last line of the code:\n\n@Test(expected=3DIllegalArgumentException.cla=\r\nss)\npublic void test()\n{\n    exceptionFlag.clear();\n    Account f =3D new A=\r\nccount(10);\n    execeptionFlag.set();\n    f.withdrawCash(20);\n}\n\nIf this we=\r\nre only used when the test had an expected exception, it could\nbe cleared o=\r\nn set-up.\n\nI *suspect* there&#39;s no point in making this part of the framewor=\r\nk\nitself, but I just wondered whether anyone else had been thinking about\ni=\r\nt. It&#39;s never *actually* bitten me (as far as I&#39;m aware) when using\nNUnit, =\r\nbut it&#39;s always been a slight source of concern.\n \nJon Skeet\nSenior Softwar=\r\ne Engineer\nCLEARSWIFT\nThe MIMEsweeper Company\n\nDDI:               +44 (0) 1=\r\n189  038  109\nMobile:           +44 (0) 7970 158 865\nSwitchboard:   +44 (0)=\r\n 1189  038  903 \nFax:               +44 (0) 1189  039  000      \nWeb: www.c=\r\nlearswift.com \n\nClearswift monitors, controls and protects all its messagin=\r\ng traffic in compliance with its corporate email policy using Clearswift pr=\r\noducts.\nFind out more about Clearswift, its solutions and services at http:=\r\n//www.clearswift.com\n\nThis communication is confidential and may contain pr=\r\nivileged information intended solely for the named addressee(s). It may not=\r\n be used or disclosed except for the purpose for which it has been sent. If=\r\n you are not the intended recipient, you must not copy, distribute or take =\r\nany action in reliance on it. Unless expressly stated, opinions in this mes=\r\nsage are those of the individual sender and not of Clearswift. If you have =\r\nreceived this communication in error, please notify Clearswift by emailing =\r\nsupport@... quoting the sender and delete the message and any at=\r\ntached documents. Clearswift accepts no liability or responsibility for any=\r\n onward transmission or use of emails and attachments having left the Clear=\r\nswift domain.\n\nThis footnote confirms that this email message has been swep=\r\nt by MIMEsweeper for Content Security threats, including computer viruses.\n=\r\n\n\n\n", 
    "profile": "jskeetuk", 
    "topicId": 15536, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 246518675, 
    "prevInTime": 15535, 
    "contentTrasformed": false, 
    "postDate": "1133169129", 
    "canDelete": false, 
    "nextInTopic": 15540, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PDZFQUE4QUQ4MkQ3RUJGNDc4Q0NFMjYyRkEzMkM2QzY0MDFCNTZBMUFAR0VNSU5JLkVVUk9QRS5DTEVBUlNXSUZULkNPTT4="
    }
}