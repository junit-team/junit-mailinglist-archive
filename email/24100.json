{
    "numMessagesInTopic": 27, 
    "nextInTime": 24101, 
    "senderId": "8dDXDVYVaHFGAmUhTqlOgiwbgqNQQbn2k-ERnD_FDWwwBI309OPHsjXWAOmpvndlFAJ9FfMBPlSYxlG_cImwbUIRRjxw53Pc44pVKz9fRtSU-thW66boCz4", 
    "systemMessage": false, 
    "subject": "Re: [junit] assertArrayEquals on arrays of objects", 
    "from": "Stephen Connolly &lt;stephen.alan.connolly@...&gt;", 
    "authorName": "Stephen Connolly", 
    "msgSnippet": "... Every line of code you write introduces another place for you to write a bug. So adding test hooks to your production code, whatever form those hooks take,", 
    "msgId": 24100, 
    "profile": "stephenalanconnolly", 
    "topicId": 24091, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 458231986, 
    "messageBody": "<div id=\"ygrps-yiv-1818162089\">On Sunday, 18 November 2012, Cédric Beust ♔ wrote:<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; On Sat, Nov 17, 2012 at 5:45 PM, Stephen Connolly &lt;<br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:stephen.alan.connolly@...\">stephen.alan.connolly@...</a> &lt;javascript:;&gt;&gt; wrote:<br/>\n&gt;<br/>\n&gt; &gt; Don&#39;t add equality or hashCode methods *because* you need them for<br/>\n&gt; testing<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; What&#39;s the justification for this restriction? It makes no sense to me.<br/>\n&gt;<br/>\n&gt;<br/>\n </span></blockquote>Every line of code you write introduces another place for you to write a<br/>\nbug. So adding test hooks to your production code, whatever form those<br/>\nhooks take, is adding more scope for bugs.<br/>\n<br/>\nProduction code should be just what is required and no more, ie no dead<br/>\ncode please.<br/>\n<br/>\nThat is the ideal we should strive for, just as 100% coverage is the ideal<br/>\nwe should strive for.<br/>\n<br/>\nNow in practice, for my code, I usually implement equals and hash code...<br/>\nBut I do so *following the correct contract for equals and hashcode*<br/>\n<br/>\nOne of the elements of that contract is that hashCode of two equal objects<br/>\nshould be identical, and that it should be based on the objects final<br/>\nfields.<br/>\n<br/>\noften enough to warrant mentioning (though not every day), unless your<br/>\nobjects are immutable (I like immutable objects too btw which is why this<br/>\ndoesn&#39;t happen every day for me) you will find that the necessities of the<br/>\nequals and hashCode contracts with respect to collections etc, results in<br/>\nequals methods that only compare on a subset of the objects fields, in<br/>\nwhich case you need, in your tests, to compare on the non-final fields too.<br/>\n<br/>\nOn other occasions I have found it necessary to leave the equals and<br/>\nhashCode methods unimplemented because I need specific behaviour within<br/>\ncollections. In such cases I typically have test cases to verify that<br/>\nequals is inherited from Object so that future maintainers do not<br/>\naccidentally add an implementation.<br/>\n<br/>\nNormally, I use a wrapper class for adding such objects to collections so<br/>\nthat it is safe to use equals... But that can put an excessive GC load, and<br/>\nas a result you may be forced to go without the  wrapper... In a sense it<br/>\nis a pity that the collections classes do not allow for plugable hashCode<br/>\nand equality strategies,<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt;<br/>\n&gt; You might never have to test for equality of your objects in production but<br/>\n&gt; need it for testing.<br/>\n<br/>\n<br/>\n </span></blockquote>Or you might have need for the Object.equals behaviour<br/>\n<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt;<br/>\n&gt; And more generally, there is really nothing wrong with implementing<br/>\n&gt; hashCode()/equals() for your objects that match their purpose.<br/>\n<br/>\n<br/>\n </span></blockquote>The point is that such purpose may not match the needs of testing.<br/>\n<br/>\nI agree that 95% if the time adding equals and hashCode is perfectly fine.<br/>\nAnd since we often use IDE tooling or Guava&#39;s helpers (or equivalent<br/>\nhelpers) to implement these methods it is very low risk. My point is that<br/>\nthere are times when it is less clear, and a subset of those where it is<br/>\nthe wrong thing to do.<br/>\n<br/>\nYou should always know *why* you are adding code to production. Adding code<br/>\n*just because your tests need it* is a bad code smell... It indicates that<br/>\neither you don&#39;t understand a production requirement of your code (which<br/>\nmay mean that the equals method is needed anyway) or you have a bad design<br/>\nof your production code in the first place.<br/>\n<br/>\nAnother final point is that relying on equals comparing equality as opposed<br/>\nto identity within your tests can hinder refactoring as it may make it<br/>\nharder to split the class given that you then have to take care that the<br/>\nequals methods are split correctly... Using duck comparison based on eg<br/>\nGuava&#39;s helpers is very little work and allows for correct testing.<br/>\n<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; --<br/>\n&gt; Cédric<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; [Non-text portions of this message have been removed]<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; ------------------------------------<br/>\n&gt;<br/>\n&gt; Yahoo! Groups Links<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n<br/>\n<br/>\n </span></blockquote>[Non-text portions of this message have been removed]</div>", 
    "prevInTime": 24099, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1353229385", 
    "canDelete": false, 
    "nextInTopic": 24101, 
    "prevInTopic": 24099, 
    "headers": {
        "inReplyToHeader": "PENBT3BoZ0pBamVNX3U1WEFCUThaYzQ4MVExY0gtdy1qS0RCemUwNmY1SFRqX0xyMlkzZ0BtYWlsLmdtYWlsLmNvbT4=", 
        "messageIdInHeader": "PENBK25Qbk13Z0dROFdHSG5PUVU5X21EYk9RRUhXRVpBZzlaMlcxdmV6NHFfSmpzK0VfZ0BtYWlsLmdtYWlsLmNvbT4=", 
        "referencesHeader": "PGs4OHA2MytwNmpjQGVHcm91cHMuY29tPgk8REE2RTkyMjgtNkVEQy00NEFFLTkyQTAtMzVCMDZGODExMDRDQGdtYWlsLmNvbT4JPDIwMTIxMTE3MTUzMDU2LjUzYmM2ZjcwQGhhYmFuZXJvPgk8MjREM0NCQjItNEQ3Qy00RUVELUI0NUItOURDNTEwNkRBNDczQGdtYWlsLmNvbT4JPDIwMTIxMTE3MTYyMDA1Ljc3NjBhOWQ0QGhhYmFuZXJvPgk8Q0ErblBuTXpzV2cyemc4YXZBODZQQXdnb1J6SEpwa0trRUZvS1lpSDVqNlQ1YkNDdT1BQG1haWwuZ21haWwuY29tPgk8Q0FPcGhnSkFqZU1fdTVYQUJROFpjNDgxUTFjSC13LWpLREJ6ZTA2ZjVIVGpfTHIyWTNnQG1haWwuZ21haWwuY29tPg=="
    }
}