{
    "topicId": 2537, 
    "postDate": "999510392", 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "from": "&quot;Bruce Vinchon&quot; &lt;bruce.vinchon@...&gt;", 
    "canDelete": false, 
    "replyTo": "LIST", 
    "senderId": "d4GZVlOvoA-ZVRsPS8JsxwIdy20s3mngfPLTjUJu9jZ_xv_XB9jsBdn2nR9HvTdvMic_ZZcjAk3zXqtAxwFbJZZowxG9QkcSUkgUCuJXsOEI", 
    "nextInTime": 2551, 
    "userId": 0, 
    "prevInTime": 2549, 
    "prevInTopic": 2539, 
    "headers": {
        "messageIdInHeader": "PE9GN0IyNkU5RTguQ0FDRTg3MzUtT05DMTI1NkFCQy4wMDMwOTRDM0BmcmFuY2UuaWJtLmNvbT4="
    }, 
    "authorName": "Bruce Vinchon", 
    "numMessagesInTopic": 4, 
    "msgSnippet": "hi all, As richard said, there could be several approach to test a database : 1) I just want to make some test and rollback (autoCommit(false) in setup() and", 
    "contentTrasformed": false, 
    "msgId": 2550, 
    "nextInTopic": 0, 
    "systemMessage": false, 
    "rawEmail": "Return-Path: &lt;bruce.vinchon@...&gt;\r\nX-Sender: bruce.vinchon@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (EGP: mail-7_3_2); 3 Sep 2001 12:10:15 -0000\r\nReceived: (qmail 37084 invoked from network); 3 Sep 2001 12:10:05 -0000\r\nReceived: from unknown (10.1.10.142)\n  by l7.egroups.com with QMQP; 3 Sep 2001 12:10:05 -0000\r\nReceived: from unknown (HELO d06lmsgate-2.uk.ibm.com) (195.212.29.2)\n  by mta3 with SMTP; 3 Sep 2001 12:10:02 -0000\r\nReceived: from d06relay01.portsmouth.uk.ibm.com (d06relay01.portsmouth.uk.ibm.com [9.166.84.147])\n\tby d06lmsgate-2.uk.ibm.com (1.0.0) with ESMTP id MAA77160\n\tfor &lt;junit@yahoogroups.com&gt;; Mon, 3 Sep 2001 12:52:18 +0100\r\nReceived: from d07ml028.france.ibm.com (d07ml028.france.ibm.com [9.101.24.222])\n\tby d06relay01.portsmouth.uk.ibm.com (8.11.1m3/NCO v4.97.1) with ESMTP id f839mVk292360\n\tfor &lt;junit@yahoogroups.com&gt;; Mon, 3 Sep 2001 10:48:31 +0100\r\nTo: junit@yahoogroups.com\r\nSubject: Re: [junit] database testing with JTA/JTS\r\nX-Mailer: Lotus Notes Release 5.0.3 (Intl) 21 March 2000\r\nMessage-ID: &lt;OF7B26E9E8.CACE8735-ONC1256ABC.003094C3@...&gt;\r\nDate: Mon, 3 Sep 2001 11:46:32 +0200\r\nX-MIMETrack: Serialize by Router on D07ML028/07/M/IBM(Release 5.0.6 |December 14, 2000) at\n 03/09/2001 11:46:35,\n\tSerialize complete at 03/09/2001 11:46:35\r\nMIME-Version: 1.0\r\nContent-Type: multipart/alternative; boundary=&quot;=_alternative 003640A8C1256ABC_=&quot;\r\nFrom: &quot;Bruce Vinchon&quot; &lt;bruce.vinchon@...&gt;\r\n\r\n\r\n--=_alternative 003640A8C1256ABC_=\r\nContent-Type: text/plain; charset=&quot;us-ascii&quot;\r\n\r\nhi all,\n\nAs richard said, there could be several approach to test a database :\n\n1) I just want to make some test and rollback (autoCommit(false) in \nsetup() and rollback() in tearDown()). It allows to insert, update, delete \nin my database during my tests and rollback all operations to let the \ndatabase clean. If you do a lot of tests (testSuite), you could just have \nindependant tests (as it should be). If you want to chain tests that uses \nthe same connection and to rollback all operations at the end, you \nprobably should developed a transaction object. Eric describes it. You can \ncontrol autoCommit and rollback and inhibit their standard behavior. a \ntestSuite can control commit and rollback through other methods in the \ntransaction class (globalCommit() and globalRollback() called in the body \nof your testSuite ?) as each test methods call inactive autoCommit(), \ncommit() and rollback() methods.\n\n2) you don&#39;t want to borrow about it and want to manage nested \ntransactions. well... JTS specification allows nested transaction (spec \n1.0 says : &quot;not required&quot; but you can find JTS compliant platforms that \nsupport it) :\n\n&quot;A JTS transaction manager must support flat transactions; support of \nnested transactions is optional. If a client begins a transaction, and \nwithin that transaction begins another transaction, the latter operation \nwill throw a NotSupportedException if the JTS implementation does not \nsupport nested transactions. Keep in mind that even if the JTS \nimplementation supports nested transactions, this transaction \nmanager-level support does not guarantee support for nested transactions \nin an application. For example, the EJB 1.1 specification does not support \nnested transactions.&quot;... [find on jGuru]\n\nbut EJB 2.0 supports it ! \n(http://www.wap-shareware.com/sjug/ejb/index.shtml - see point 6).\n\nso where is the problem ? you should find a database that supports it and \na transaction server that is JTS compliant. DB2 and SQL Server seems not \nto support nested transactions (perhaps directly ?). Oracle 8i does... \nwith a little trick : the save points.\n\n3) With save points, you could simulate nested transactions. Oracle 8i \nallows it in PL/SQL procedure that you could call through JDBC (not good \nfor simple tests !) (see \nhttp://www.inquiry.com/techtips/oracle_pro/10min/10min1100.asp). [Informix \nUniverse 9.4 supports the same thing : see \nhttp://www.inactsys.com/universe.htm]. \n\nWhere to find some transaction application server that allows it ? Some \nproducts like PowerTiers provides setSavePoints() methods (you can read \nhere for an explanation : \nhttp://www.persistence.com/powertier/devpit/documentation/programming/directt5.htm). \nBut you should use it with an appropriate database.\n\nConclusion : as it seems not quite easy to find a cool platform where \nnested transactions are automatically supported, the first solution seems \nthe best approach actually.\n\nAny comments or ideas ?\n\nregards,\n\nBruce Vinchon\n\n\nA while ago I had an email conversation with Bruce Vinchon regarding\ndatabase testing. I said I&#39;d mention something we discussed on this \nmailing\nlist so here goes (and apologies to Bruce if I&#39;ve misrepresented his \nthoughts).\n\nBruce mentioned using the &quot;auto commit off&quot; trick to make database testing\neasier.   I.e., you do something like turn auto commit off during setUp()\nand do an rollback/abort in tearDown(), so you can write to a test \ndatabase\nand not have to worry about cleaning it up. Something like that.\n\nI replied talking about the problems when you have methods which are\nthemselves transactions (i.e., methods which\nstart transactions, write to various tables, then commit).  How can you \nuse\nthe &quot;auto commit off&quot; trick in those situations?\n\nBruce suggested that you may be able to get something to work with nested\ntransactions, perhaps using a transaction service such as JTA/JTS.  Sounds\ngood to me, but I haven&#39;t had the opportunity to investigate this idea or\nthe Java Transaction APIs.\n\nCan anyone comment on this approach?\n\nRegards\nRichard\n\n\n\r\n--=_alternative 003640A8C1256ABC_=\r\nContent-Type: text/html; charset=&quot;us-ascii&quot;\r\n\r\n\n&lt;br&gt;&lt;font size=2 face=&quot;sans-serif&quot;&gt;hi all,&lt;/font&gt;\n&lt;br&gt;\n&lt;br&gt;&lt;font size=2 face=&quot;sans-serif&quot;&gt;As richard said, there could be several approach to test a database :&lt;/font&gt;\n&lt;br&gt;\n&lt;br&gt;&lt;font size=2 face=&quot;sans-serif&quot;&gt;1) I just want to make some test and rollback (autoCommit(false) in setup() and rollback() in tearDown()). It allows to insert, update, delete in my database during my tests and rollback all operations to let the database clean. If you do a lot of tests (testSuite), you could just have independant tests (as it should be). If you want to chain tests that uses the same connection and to rollback all operations at the end, you probably should developed a transaction object. Eric describes it. You can control autoCommit and rollback and inhibit their standard behavior. a testSuite can control commit and rollback through other methods in the transaction class (globalCommit() and globalRollback() called in the body of your testSuite ?) as each test methods call inactive autoCommit(), commit() and rollback() methods.&lt;/font&gt;\n&lt;br&gt;\n&lt;br&gt;&lt;font size=2 face=&quot;sans-serif&quot;&gt;2) you don&#39;t want to borrow about it and want to manage nested transactions. well... JTS specification allows nested transaction (spec 1.0 says : &quot;not required&quot; but you can find JTS compliant platforms that support it) :&lt;/font&gt;\n&lt;br&gt;\n&lt;table width=100%&gt;\n&lt;tr valign=top&gt;\n&lt;td width=100%&gt;&lt;font size=2 face=&quot;Verdana&quot;&gt;&quot;A JTS transaction manager must support flat transactions; support of nested transactions is optional. If a client begins a transaction, and within that transaction begins another transaction, the latter operation will throw a NotSupportedException if the JTS implementation does not support nested transactions. Keep in mind that even if the JTS implementation supports nested transactions, this transaction manager-level support does not guarantee support for nested transactions in an application. For example, the EJB 1.1 specification does not support nested transactions.&quot;... [find on jGuru]&lt;/font&gt;\n&lt;br&gt;\n&lt;br&gt;&lt;font size=2 face=&quot;Verdana&quot;&gt;but EJB 2.0 supports it ! (http://www.wap-shareware.com/sjug/ejb/index.shtml - see point 6).&lt;/font&gt;&lt;/table&gt;\n&lt;br&gt;\n&lt;br&gt;&lt;font size=2 face=&quot;sans-serif&quot;&gt;so where is the problem ? you should find a database that supports it and a transaction server that is JTS compliant. DB2 and SQL Server seems not to support nested transactions (perhaps directly ?). Oracle 8i does... with a little trick : the save points.&lt;/font&gt;\n&lt;br&gt;\n&lt;br&gt;&lt;font size=2 face=&quot;sans-serif&quot;&gt;3) With save points, you could simulate nested transactions. Oracle 8i allows it in PL/SQL procedure that you could call through JDBC (not good for simple tests !) (see http://www.inquiry.com/techtips/oracle_pro/10min/10min1100.asp). [Informix Universe 9.4 supports the same thing : see http://www.inactsys.com/universe.htm]. &lt;/font&gt;\n&lt;br&gt;\n&lt;br&gt;&lt;font size=2 face=&quot;sans-serif&quot;&gt;Where to find some transaction application server that allows it ? Some products like PowerTiers provides setSavePoints() methods (you can read here for an explanation : http://www.persistence.com/powertier/devpit/documentation/programming/directt5.htm). But you should use it with an appropriate database.&lt;/font&gt;\n&lt;br&gt;\n&lt;br&gt;&lt;font size=2 face=&quot;sans-serif&quot;&gt;Conclusion : as it seems not quite easy to find a cool platform where nested transactions are automatically supported, the first solution seems the best approach actually.&lt;/font&gt;\n&lt;br&gt;\n&lt;br&gt;&lt;font size=2 face=&quot;sans-serif&quot;&gt;Any comments or ideas ?&lt;/font&gt;\n&lt;br&gt;\n&lt;br&gt;&lt;font size=2 face=&quot;sans-serif&quot;&gt;regards,&lt;/font&gt;\n&lt;br&gt;\n&lt;br&gt;&lt;font size=2 face=&quot;sans-serif&quot;&gt;Bruce Vinchon&lt;br&gt;\n&lt;/font&gt;\n&lt;br&gt;\n&lt;br&gt;&lt;font size=2&gt;&lt;tt&gt;A while ago I had an email conversation with Bruce Vinchon regarding&lt;br&gt;\ndatabase testing. I said I&#39;d mention something we discussed on this mailing&lt;br&gt;\nlist so here goes (and apologies to Bruce if I&#39;ve misrepresented his thoughts).&lt;br&gt;\n&lt;/tt&gt;&lt;/font&gt;\n&lt;br&gt;&lt;font size=2&gt;&lt;tt&gt;Bruce mentioned using the &quot;auto commit off&quot; trick to make database testing&lt;br&gt;\neasier. &nbsp; I.e., you do something like turn auto commit off during setUp()&lt;br&gt;\nand do an rollback/abort in tearDown(), so you can write to a test database&lt;br&gt;\nand not have to worry about cleaning it up. Something like that.&lt;br&gt;\n&lt;/tt&gt;&lt;/font&gt;\n&lt;br&gt;&lt;font size=2&gt;&lt;tt&gt;I replied talking about the problems when you have methods which are&lt;br&gt;\nthemselves transactions (i.e., methods which&lt;br&gt;\nstart transactions, write to various tables, then commit). &nbsp;How can you use&lt;br&gt;\nthe &quot;auto commit off&quot; trick in those situations?&lt;br&gt;\n&lt;/tt&gt;&lt;/font&gt;\n&lt;br&gt;&lt;font size=2&gt;&lt;tt&gt;Bruce suggested that you may be able to get something to work with nested&lt;br&gt;\ntransactions, perhaps using a transaction service such as JTA/JTS. &nbsp;Sounds&lt;br&gt;\ngood to me, but I haven&#39;t had the opportunity to investigate this idea or&lt;br&gt;\nthe Java Transaction APIs.&lt;br&gt;\n&lt;/tt&gt;&lt;/font&gt;\n&lt;br&gt;&lt;font size=2&gt;&lt;tt&gt;Can anyone comment on this approach?&lt;br&gt;\n&lt;/tt&gt;&lt;/font&gt;\n&lt;br&gt;&lt;font size=2&gt;&lt;tt&gt;Regards&lt;br&gt;\nRichard&lt;br&gt;\n&lt;/tt&gt;&lt;/font&gt;\n&lt;br&gt;\n&lt;br&gt;\r\n--=_alternative 003640A8C1256ABC_=--\r\n\n", 
    "subject": "Re: [junit] database testing with JTA/JTS"
}