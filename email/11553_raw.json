{
    "numMessagesInTopic": 16, 
    "nextInTime": 11554, 
    "senderId": "1ek47CtLEIgpCFztswpwR1AJWyFABHcbid3LD5ekNOvGT1MztRKlpgF9v-DpVTD-iX40kL0hEk-ubgm9MyiNck5e93-hdjuY", 
    "systemMessage": false, 
    "subject": "Re: Mock objects...", 
    "from": "&quot;cypherfox&quot; &lt;cypherfox@...&gt;", 
    "authorName": "cypherfox", 
    "msgSnippet": "Greetings, ... Yeah, it was annoying to do that much work for nominally test classes. ... That s...impressive.  That s some very, very deep magic, and I like ", 
    "msgId": 11553, 
    "rawEmail": "Return-Path: &lt;cypherfox@...&gt;\r\nX-Sender: cypherfox@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 52566 invoked from network); 16 Jul 2004 23:31:50 -0000\r\nReceived: from unknown (66.218.66.167)\n  by m24.grp.scd.yahoo.com with QMQP; 16 Jul 2004 23:31:50 -0000\r\nReceived: from unknown (HELO n32.grp.scd.yahoo.com) (66.218.66.100)\n  by mta6.grp.scd.yahoo.com with SMTP; 16 Jul 2004 23:31:50 -0000\r\nReceived: from [66.218.67.187] by n32.grp.scd.yahoo.com with NNFMP; 16 Jul 2004 23:31:46 -0000\r\nDate: Fri, 16 Jul 2004 23:31:45 -0000\r\nTo: junit@yahoogroups.com\r\nMessage-ID: &lt;cd9oh1+pngu@...&gt;\r\nIn-Reply-To: &lt;40F84974.6030508@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Length: 5169\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-eGroups-Remote-IP: 66.218.66.100\r\nFrom: &quot;cypherfox&quot; &lt;cypherfox@...&gt;\r\nSubject: Re: Mock objects...\r\nX-Yahoo-Group-Post: member; u=174888704\r\nX-Yahoo-Profile: cypherfox\r\n\r\nGreetings,\n\n--- In junit@yahoogroups.com, &quot;J. B. Rainsberger&quot; &lt;jbrains@r...&gt;\nwrote:\n&gt; cypherfox wrote:\n&gt; &gt; Sure, the most recent example of this to me, was this class:\n&gt; &gt;   http://www.vixen.com/code/JournalHash.java\n&gt; &gt; implementing\n&gt; &gt;   http://www.vixen.com/code/JournalDataStore.java\n&gt; \n&gt; Aha! It&#39;s a common mistake: you&#39;ve created an in-memory\n&gt; implementation of JournalDataStore, when you didn&#39;t really\n&gt; need one. I can understand your pain. Been there.\n\nYeah, it was annoying to do that much work for nominally test classes.\n\n&gt; Solution? jMock. www.jmock.org\n\nThat&#39;s...impressive.  That&#39;s some very, very deep magic, and I like\nit.  I think understanding that framework is going to be my weekend\nproject.  It is such a pity that it&#39;s not possible with C++, but since\nI&#39;m doing Java these days...  That&#39;s a very nice tool.\n\n&gt; First, it looks like you just want a &quot;fake&quot; and not a full-blown\n&gt; mock -- that is, a stand-in JournalDataStore that returns\n&gt; hardcoded data on demand.\n&gt; \n&gt; You can use a dynamic mock to implement a fake data store. You\n&gt; simply &quot;record&quot; the desired output for each desired input, then play\n&gt; it back.  Since Journal and JournalEntry appear both to be simple\n&gt; value objects, it should be easy.\n\nThey are.  No logic to them, except a serialize-to-xml output. \nJournal has information about the &#39;journal&#39;, and &#39;JournalEntry&#39;\nhas information about the individual messages.\n\n&gt; When you want to test logic that uses a JournalDataStore, simply\n&gt; record the behavior you want to /simulate/ during the &quot;Arrange&quot;\n&gt; portion, then play it back during the &quot;Act&quot; portion. In the &quot;Assert&quot;\n&gt; portion, ask the  fake to verify() itself, and if the fake was used\n&gt; incorrectly, it will fail the test.\n\nThat&#39;s very neat, I have to admit.  I can see pretty quickly how the\njMock classes can be used for that.\n\n&gt; If you give us a test for an object that talks to JournalHash, then\n&gt; we can convert it into a test using the fake. You can then decide\n&gt; whether JournalHash is worth keeping for some other use....\n\nI had to parse that carefully...  A test for an object that *talks* to\nJournalHash.  Unfortunately, in this case I can&#39;t easily.  I&#39;d have to\ndo a good bit of sanitizing.\n\nStill, I can see approximately how I&#39;d test it...  Basically set up\nexpectations and results for all the methods that are likely to\nbe called, tell the CUT to use the provided data store (an\nimplementation detail that is not exposed right now), run the\nactual test call, assert that the result is right from the actual\ntest, and verify() the dynamically created mock.\n\nVery, very neat stuff.   You say you have a chapter on using jMock?\nTheir examples are a little sparse, although the hints left are\nimpressive nonetheless.\n\n&gt; &gt; One of the things that isn&#39;t even in there, is the concept of\n&gt; &gt; &#39;get most recent &#39;n&#39; entries&#39;, because that would require me\n&gt; &gt; to walk backwards through the TreeMap, or add a *third*\n&gt; &gt; representation of the same data, as a linked list or something.\n&gt; \n&gt; Here you&#39;re implementing getMostRecentNEntries() in terms of the \n&gt; existing JournalDataStore methods?\n\nWell, no, because JournalDataStore doesn&#39;t export anything\nthat would allow you to look from the end backwards, basically.\nThat was one of my problems, I&#39;d have to add a third tracking\ndata structure to track order-entered, so that it could retrieve\nthe most recent &#39;n&#39;.  Whereas the JDBC version of this was\nbrutally simple, just modify the query.\n\n&gt; That&#39;s not too hard, although it \n&gt; might surprise you that I would put getMostRecentNEntries() on a \n&gt; different interface from JournalDataStore!\n\nI am curious why, although it might be a different discussion.  Is\nit just so that you can pass a mock object into it?\n\n[...deletia: cool mock psuedocode...]\n\n&gt; Now note that this is pseudocode, and I&#39;m only a green belt in\n&gt; jMock (I used EasyMock before, and am still learning jMock), but\n&gt; this is the idea. Ignoring my choice of design for the\n&gt; GetMostRecentNEntriesQuery class, does this smaller amount\n&gt; of mock code look easier to maintain?\n\nIt&#39;s easier to maintain mainly in that changes to the interface are\ndone at two places, again, in the test (the mock setup, and the\nactual call), and the actual code.  I&#39;m relatively positive that in\nthe end the number of mock setups would be bigger than the\nJournalHash class, but...and it&#39;s an important but...I wouldn&#39;t\nbe debugging logic that exists purely for testing purposes.\nThat&#39;s a bigger win, because it lets me focus on the two things\nthat matter: new code, and simple tests.\n\n&gt; Well, you definitely got some value from it, then. That&#39;s better\n&gt; than nothing. Still, you would have been able to focus on the\n&gt; interactions, rather than implementing the book-keeping,\n&gt; if you&#39;d known about dynamic mocks. Ah, well... it&#39;s never\n&gt; too late.\n\nI did get value, in a couple of ways, but I would have gotten the same\nvalue with the dynamic mocks, I think.  Mainly that as soon as the\nJDBC code started to be written, target that class instead of the\nmock, and immediately the JournalDB class is being tested with\nbasically debugged, complete tests.\n\njMock is *definitely* my weekend study project.\n\n--  Morgan Schweers\n\n\n", 
    "profile": "cypherfox", 
    "topicId": 11542, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 174888704, 
    "prevInTime": 11552, 
    "contentTrasformed": false, 
    "postDate": "1090020705", 
    "canDelete": false, 
    "nextInTopic": 11554, 
    "prevInTopic": 11552, 
    "headers": {
        "inReplyToHeader": "PDQwRjg0OTc0LjYwMzA1MDhAcm9nZXJzLmNvbT4=", 
        "messageIdInHeader": "PGNkOW9oMStwbmd1QGVHcm91cHMuY29tPg=="
    }
}