{
    "numMessagesInTopic": 4, 
    "nextInTime": 11571, 
    "senderId": "P3T02XZ6PCgJkLIXDedOpvL7RgwedEfEhI2tPhdZQgBuc457NbVIdfS5LwpFE6HG0QMCWDKAIb5covGVtzJ2L1nD", 
    "systemMessage": false, 
    "subject": "Re: Is this approach to mock objects too complex?", 
    "from": "&quot;kk_oop&quot; &lt;kk_oop@...&gt;", 
    "authorName": "kk_oop", 
    "msgSnippet": "See response below... ... I discovered my problem.  The article shows in listing 4 that the collaborating object is being created inside one of the containing ", 
    "msgId": 11570, 
    "rawEmail": "Return-Path: &lt;kk_oop@...&gt;\r\nReceived: (qmail 82631 invoked from network); 18 Jul 2004 15:33:55 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m21.grp.scd.yahoo.com with QMQP; 18 Jul 2004 15:33:55 -0000\r\nReceived: from unknown (HELO n30.grp.scd.yahoo.com) (66.218.66.87)\n  by mta1.grp.scd.yahoo.com with SMTP; 18 Jul 2004 15:33:55 -0000\r\nX-eGroups-Return: kk_oop@...\r\nReceived: from [66.218.66.115] by n30.grp.scd.yahoo.com with NNFMP; 18 Jul 2004 15:33:52 -0000\r\nX-Sender: kk_oop@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 84815 invoked from network); 18 Jul 2004 04:20:12 -0000\r\nReceived: from unknown (66.218.66.172)\n  by m23.grp.scd.yahoo.com with QMQP; 18 Jul 2004 04:20:12 -0000\r\nReceived: from unknown (HELO n37.grp.scd.yahoo.com) (66.218.66.105)\n  by mta4.grp.scd.yahoo.com with SMTP; 18 Jul 2004 04:20:12 -0000\r\nReceived: from [66.218.67.168] by n37.grp.scd.yahoo.com with NNFMP; 18 Jul 2004 04:20:12 -0000\r\nDate: Sun, 18 Jul 2004 04:20:11 -0000\r\nTo: junit@yahoogroups.com\r\nMessage-ID: &lt;cdctpr+fql7@...&gt;\r\nIn-Reply-To: &lt;200407161117.19021.jason.rogers@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Length: 3587\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-eGroups-Remote-IP: 66.218.66.105\r\nFrom: &quot;kk_oop&quot; &lt;kk_oop@...&gt;\r\nSubject: Re: Is this approach to mock objects too complex?\r\nX-Yahoo-Group-Post: member; u=192309277\r\nX-Yahoo-Profile: kk_oop\r\nX-eGroups-Approved-By: nails762 &lt;jbrains@...&gt; via web; 18 Jul 2004 15:33:52 -0000\r\nX-eGroups-Remote-IP: 66.218.66.87\r\n\r\nSee response below...\n\n--- In junit@yahoogroups.com, Jason Rogers &lt;jacaetevha@f...&gt; wrote:\n&gt; On Friday 16 July 2004 03:59 am, kk_oop wrote:\n&gt; &gt;  Hi.  I was just reading an article about a novel way of implementing\n&gt; &gt;  mock objects using an anonymous inner class.   The article is at: \n&gt; &gt;\n&gt; &gt;  http://www-106.ibm.com/developerworks/library/j-mocktest.html\n&gt; \n&gt; &gt;  I find, though, that when I try to run the sample code in listings 5\n&gt; &gt;  and 6 through JUnit, I get a null pointer exception.\n&gt; \n&gt; Where?\n\nI discovered my problem.  The article shows in listing 4 that the\ncollaborating object is being created inside one of the containing\nclass&#39; methods (doWithdrawal).\n\n  private Status doWithdrawal(Account account, float amount) {\n    Transaction transaction = createTransaction();\n    transaction.setSourceAccount(account);\n    ...\n\nIn my code, I need to create the collaborating object in the\ncontaining class&#39; constructor.  So for some reason, when I call the\nfactory method from the constructor, I get a null pointer error.  This\nhappens whether I am in JUnit or just Java.  If I call the factory\nmethod from a non-constructor method (as in the article), I do not get\nthe error.  I suppose there is some unstable state in the constructor\nhierarchy when the factory method is called, but I&#39;m not sure.\n\nSo to work around this problem, here&#39;s what I&#39;m doing:\n\nI&#39;m putting two inner classes in my test case.  One overrides my\nfactory method and the other is my mock version of the contained class\nthat gets returned by the factory method.\n\nI&#39;m giving my override class a static attribute of the mock object\ntype and a static setter for the same type.\n\nIn my test method, I first instantiate the mock object and set its\nstates for my test.  Then I use the static setter to put this object\nin the override class.\n\nNow when the overriden factory method is called, the mock object\nreference contained in the static attribute will be used.\n\nThe code for the container inner class looks like this (this is an\ninner class in the test case class):\n\n    //static class overrides class being tested.\n    static public class InnerSubContainer extends Container \n    {\n        static private ContainedA s_mockContainedA;\n        static public void setMockContainedA(ContainedA\n                                               mockContainedA)\n        {\n            s_mockContainedA = mockContainedA;\n        }\n\n        //factory method for contained class\n        protected ContainedA createCA()\n        {\n            return s_mockContainedA;\n        }\n    } \n\nThe test case code looks like this:\n\n        ...\n        //set up mock contained object states for test.\n        //mock is an inner class in the test case.\n        mockContainedA = new MockContainedA();       \n        mockContainedA.setValue(1062);\n        \n        \n        //set mock contained object into class being tested\n        InnerSubContainer.setMockContainedA(mockContainedA);\n        \n        //create instance of class being tested and\n        //test the class for expected behavior\n        Container container = new InnerSubContainer();\n\n        Assert.assertEquals(&quot;Value not correct.&quot;,\n                             container.getValue(),1062);\n        ...\n\nI also use the setUp method to initially set the static attribute to\nnull, just to make sure I don&#39;t reuse state data from a prior test.\n\nThis approach enables me to have the factory method in the constructor\nof the class being tested.\n\nPerhaps there is a better way, but this does seem to work.  That being\nsaid, I welcome and encourage suggestions.\n\nThanks!\n\nKen\n\n\n\n\n", 
    "profile": "kk_oop", 
    "topicId": 11525, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 192309277, 
    "prevInTime": 11569, 
    "contentTrasformed": false, 
    "postDate": "1090124411", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 11530, 
    "headers": {
        "inReplyToHeader": "PDIwMDQwNzE2MTExNy4xOTAyMS5qYXNvbi5yb2dlcnNAcmlza21ldHJpY3MuY29tPg==", 
        "messageIdInHeader": "PGNkY3RwcitmcWw3QGVHcm91cHMuY29tPg=="
    }
}