{
    "numMessagesInTopic": 6, 
    "nextInTime": 16001, 
    "senderId": "Fx3P1AW7GTq1Q1v7CVVb-N33svy8wdaZuFIZ4-ixLn6MrALtr1pPjppQAM8A1DaQ_NzCM15sIpjXbv26lK7VSEbCkT8svRps", 
    "systemMessage": false, 
    "subject": "RE: [junit] Reliability of Timeout", 
    "from": "&quot;Kent Beck&quot; &lt;kentb@...&gt;", 
    "authorName": "Kent Beck", 
    "msgSnippet": "Ben, I know this might be difficult, but is it possible to provide a reliably failing test case that demonstrates the problems you are having? Timeouts that", 
    "msgId": 16000, 
    "profile": "kentlbeck", 
    "topicId": 15970, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 173198504, 
    "messageBody": "<div id=\"ygrps-yiv-1417416401\">Ben,<br/>\n<br/>\nI know this might be difficult, but is it possible to provide a reliably<br/>\nfailing test case that demonstrates the problems you are having? Timeouts<br/>\nthat are less than the maximum GC pause will always be unreliable. Might<br/>\nthat be the cause of the instability you see?<br/>\n<br/>\nKent Beck<br/>\nThree Rivers Institute<br/>\n<br/>\n<blockquote><span title=\"qreply\"> &gt; -----Original Message-----<br/>\n&gt; From: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a> [mailto:<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>] On <br/>\n&gt; Behalf Of Ben Maurer<br/>\n&gt; Sent: Sunday, February 05, 2006 6:06 PM<br/>\n&gt; To: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\n&gt; Subject: [junit] Reliability of Timeout<br/>\n&gt; <br/>\n&gt; Hey guys,<br/>\n&gt; <br/>\n&gt; On the junit4 I am using for the the testing server described in a<br/>\n&gt; previous email, I&#39;m noticing that the support for timeouts can be less<br/>\n&gt; than fully reliable. My server has an OS level protection system that<br/>\n&gt; kicks in a ulimit-like functionality in Windows to protect against<br/>\n&gt; failures in Java. However, the down-side of this failsafe is that it<br/>\n&gt; makes it impossible to recover junit information.<br/>\n&gt; <br/>\n&gt; I think this is due to the way junit aborts threads:<br/>\n&gt; <br/>\n&gt; boolean terminated = service.awaitTermination(timeout,<br/>\n&gt; \tTimeUnit.MILLISECONDS);<br/>\n&gt; \tif (!terminated)<br/>\n&gt; \t\tservice.shutdownNow();<br/>\n&gt; <br/>\n&gt; By tracing through the java code, it seems that the shutdownNow method<br/>\n&gt; ends up calling thread.interrupt. This *only* aborts the thread if it<br/>\n&gt; is caught in a sleep/wait/etc. In my case, the thread stays in some<br/>\n&gt; cpu intensive loop, causing other tests to timeout, or possibly<br/>\n&gt; causing a kick-in of the OS level protection.<br/>\n&gt; <br/>\n&gt; A few options that I can see:<br/>\n&gt; <br/>\n&gt; - Provide an option to call .stop on non-responsive threads. My<br/>\n&gt; understanding is that stop uses the same method that the GC does to<br/>\n&gt; suspend threads.<br/>\n&gt; <br/>\n&gt; - Set the priority of a run-away thread to be as low as possible to<br/>\n&gt; minimize damage.<br/>\n&gt; <br/>\n&gt; - In the Assert api, poll (every N calls) for a command to stop. If<br/>\n&gt; the program in question is slow (but not completely out of control),<br/>\n&gt; this may allow junit to safely stop.<br/>\n&gt; <br/>\n&gt; In any case, if the functionaliy of the timeout api can&#39;t be correct<br/>\n&gt; for most programs, I&#39;m not exactly sure what value it provides.<br/>\n&gt; <br/>\n&gt; -- Ben<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; <br/>\n&gt; <br/>\n&gt; <br/>\n&gt;  <br/>\n&gt; Yahoo! Groups Links<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; <br/>\n&gt;  <br/>\n&gt; <br/>\n&gt; </span></blockquote></div>", 
    "prevInTime": 15999, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1139283340", 
    "canDelete": false, 
    "nextInTopic": 16013, 
    "prevInTopic": 15970, 
    "headers": {
        "inReplyToHeader": "PGRzNmF2NStpcWs5QGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PEUxRjZKZHAtMDAwMXRMLVF4QHNtdHBhdXRoMDQubWFpbC5hdGwuZWFydGhsaW5rLm5ldD4="
    }
}