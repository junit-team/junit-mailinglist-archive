{
    "numMessagesInTopic": 9, 
    "nextInTime": 22792, 
    "senderId": "D_D9udQ7IWkvNlDeLItaMLJzDhrWrfjYBRezPtrr6zsGhcXg_0uBNrMFgwqQ9dwY4-ugKlCWRXo4yLhOfq7HX-L8_4G4OEAitqQ1kzHl4Fe_cLtfuhYW", 
    "systemMessage": true, 
    "subject": "Re: @BeforeClass method for DBUnit Dataset creation", 
    "from": "&quot;Bogdan&quot; &lt;bogdan.mocanu.notifications@...&gt;", 
    "authorName": "Bogdan", 
    "msgSnippet": "Just like PostConstruct, you also have the PreDestroy annotation. Annotating a method with this will allow you to execute code before the respective bean is", 
    "msgId": 22791, 
    "profile": "bogdanmocanu2011", 
    "topicId": 22776, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 414734247, 
    "messageBody": "<div id=\"ygrps-yiv-206545855\">Just like PostConstruct, you also have the PreDestroy annotation. Annotating a method with this will allow you to execute code before the respective bean is taken out of the context.<br/>\n<br/>\nMore generaly, you could implement (if you don&#39;t already have) a Spring bean that is responsible with setting up the test, and then cleaning up when the tests are finished. Having this bean as a Spring singleton ensures that the bean will be created only once, and the initialization + destruction methods will also be called only once.<br/>\n<br/>\nBogdan<br/>\n<br/>\n<blockquote><span title=\"qreply\"> --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>, &quot;hdave321321&quot; &lt;hdave321321@...&gt; wrote:<br/>\n&gt;<br/>\n&gt; I am totally good with hacks!  However, this one still leaves me with a problem.  I still need to delete the test data after all the tests have run!  The only way to do this is via @AfterClass which, again, forces all my DBUnit code to be static which doesn&#39;t work.<br/>\n&gt; <br/>\n&gt; In the meantime, I implemented another approach that has seemed to work.   I created a non-static DBUnitHelper class and used Spring to instantiate one of these and inject it into the root class of my test classes.  The DBUnitHelper class uses your approach to ensure the data is only loaded once regardless of how many times it is asked to load it.  Deleting the data from an @AfterClass static method was also simple.  So for now, I am happy.<br/>\n&gt; <br/>\n&gt; For the record, an alternative (and better) approach I learned about elsewhere is to do what unitils does and create a custom testexecutionlistener.<br/>\n&gt; <br/>\n&gt; Also for the record, if you annotate a method with @PostConstruct -- it&#39;s also a great way to load the data just once.  However, you are still left with the cleanup problem....<br/>\n&gt; <br/>\n&gt; Anyway hope all this helps somebody else!<br/>\n&gt; <br/>\n&gt; --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>, Mike Forsberg &lt;bigmike.f@&gt; wrote:<br/>\n&gt; &gt;<br/>\n&gt; &gt; The hack of a initalizationOccurred boolean is always an option.<br/>\n&gt; &gt; <br/>\n&gt; &gt; In other words... use a static field that is initially set to false.  Then<br/>\n&gt; &gt; when you come to your setup method, only do the update if the field is<br/>\n&gt; &gt; false.  Just remember to set the field to true once the update occurs.  This<br/>\n&gt; &gt; way, no matter which test runs first or even if a sub set of tests run, then<br/>\n&gt; &gt; the reset only occurs initially.<br/>\n&gt; &gt; <br/>\n&gt; &gt; There may be a better way to do this, but I like to fall back on this<br/>\n&gt; &gt; recipe.<br/>\n&gt; &gt; <br/>\n&gt; &gt; Big Mike<br/>\n&gt; &gt; <br/>\n&gt; &gt; On Thu, Jul 1, 2010 at 11:39 AM, hdave321321 &lt;hdave321321@&gt; wrote:<br/>\n&gt; &gt; <br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt; Thanks for the help. In my case, Spring Test does an automatic transaction<br/>\n&gt; &gt; &gt; rollback after every test method, so there are no dependencies between tests<br/>\n&gt; &gt; &gt; -- so thats not a problem. Because of the rollback, it is also the case that<br/>\n&gt; &gt; &gt; they order of the test runs also doesn&#39;t matter. The database is reset to a<br/>\n&gt; &gt; &gt; &quot;known&quot; state after each test method by the transactional rollback.<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt; I&#39;d just like to load the data once rather than 50 times. But the<br/>\n&gt; &gt; &gt; @BeforeClass requirement to be a static method makes it impossible to use.<br/>\n&gt; &gt; &gt; Is there any trigger that can run after a class is initialized by Spring and<br/>\n&gt; &gt; &gt; before any test method is executed?<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt; --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a> &lt;junit%40yahoogroups.com&gt;, Mike Forsberg<br/>\n&gt; &gt; &gt; &lt;bigmike.f@&gt; wrote:<br/>\n&gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt; I would advise against that unless you were following the following guide<br/>\n&gt; &gt; &gt; &gt; lines....<br/>\n&gt; &gt; &gt; &gt; - No test method (or called method) manipulates the data base.<br/>\n&gt; &gt; &gt; &gt; - The order of the test methods do not cause conflicts with each other<br/>\n&gt; &gt; &gt; with<br/>\n&gt; &gt; &gt; &gt; required data being there.<br/>\n&gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt; Some things I&#39;d try before doing the @BeforeClass<br/>\n&gt; &gt; &gt; &gt; - Only populate the data you need for a given set of tests. (Don&#39;t<br/>\n&gt; &gt; &gt; populate<br/>\n&gt; &gt; &gt; &gt; the _whole_ database.)<br/>\n&gt; &gt; &gt; &gt; - Which of the DBUnit population features are you using... I think there<br/>\n&gt; &gt; &gt; is<br/>\n&gt; &gt; &gt; &gt; one that will revert to a known state, without the delete and insert.<br/>\n&gt; &gt; &gt; This<br/>\n&gt; &gt; &gt; &gt; may save some time.<br/>\n&gt; &gt; &gt; &gt; - Try to use a non-commitable transaction for testing. After all, one<br/>\n&gt; &gt; &gt; &gt; shouldn&#39;t need to test the commit functionality. If that breaks more than<br/>\n&gt; &gt; &gt; &gt; just you will have problems.<br/>\n&gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt; Hope I helped,<br/>\n&gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt; Big Mike<br/>\n&gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt; On Wed, Jun 30, 2010 at 8:32 PM, hdave321321 &lt;hdave321321@&gt; wrote:<br/>\n&gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt; &gt; My DAO integration tests are taking a long time to run. I am using<br/>\n&gt; &gt; &gt; Spring<br/>\n&gt; &gt; &gt; &gt; &gt; Test which automatically does a transaction rollback after each test<br/>\n&gt; &gt; &gt; method.<br/>\n&gt; &gt; &gt; &gt; &gt; However, I am also using DBUnit to load the exact same dataset before<br/>\n&gt; &gt; &gt; each<br/>\n&gt; &gt; &gt; &gt; &gt; test method via the @BeforeTransaction annotation.<br/>\n&gt; &gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt; &gt; It has occured to me that I could save a lot of time if I load the<br/>\n&gt; &gt; &gt; DBUnit<br/>\n&gt; &gt; &gt; &gt; &gt; test data once per test class instead of once per test method.<br/>\n&gt; &gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt; &gt; I&#39;ve not used the @BeforeClass and @AfterClass methods before, but<br/>\n&gt; &gt; &gt; &gt; &gt; apparently they require the annotated method to be static and this is<br/>\n&gt; &gt; &gt; &gt; &gt; interfering with my normal use of Spring dependency injection that<br/>\n&gt; &gt; &gt; provides<br/>\n&gt; &gt; &gt; &gt; &gt; an application context, data source, and other things I need to load<br/>\n&gt; &gt; &gt; the<br/>\n&gt; &gt; &gt; &gt; &gt; correct data set.<br/>\n&gt; &gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt; &gt; Anyone experience this before? What&#39;s a good way to address this<br/>\n&gt; &gt; &gt; problem?<br/>\n&gt; &gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt; &gt; [Non-text portions of this message have been removed]<br/>\n&gt; &gt; &gt; &gt;<br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; &gt;  <br/>\n&gt; &gt; &gt;<br/>\n&gt; &gt; <br/>\n&gt; &gt; <br/>\n&gt; &gt; [Non-text portions of this message have been removed]<br/>\n&gt; &gt;<br/>\n&gt; </span></blockquote></div>", 
    "prevInTime": 22790, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1278271330", 
    "canDelete": false, 
    "nextInTopic": 22810, 
    "prevInTopic": 22784, 
    "headers": {
        "inReplyToHeader": "PGkwbDE5NitoODBkQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PGkwcW4xMiszY25sQGVHcm91cHMuY29tPg=="
    }
}