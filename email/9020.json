{
    "numMessagesInTopic": 24, 
    "nextInTime": 9021, 
    "senderId": "GAuI2PZXeeBkhurni0JLi0O1M_G_Wh03HpxF8QBOOOq-kkMW6sZZSvnYk7O_wsNQcm2S9TVfFYJxnCtuWE-mbu5cjFNivc0i", 
    "systemMessage": false, 
    "subject": "Re: How to test a main(String[] args) method?", 
    "from": "&quot;jxingtang&quot; &lt;jxingtang@...&gt;", 
    "authorName": "jxingtang", 
    "msgSnippet": "... method. ... founds ... test ... test ... production ... (see ... value;}      // ... on ... (used ... case! ... instead ... field ... false ... method, ...", 
    "msgId": 9020, 
    "profile": "jxingtang", 
    "topicId": 8737, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 126373237, 
    "messageBody": "<div id=\"ygrps-yiv-1934561299\">--- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>, &quot;David&quot; &lt;achepati67@y...&gt; wrote:<br/>\n<blockquote><span title=\"ireply\"> &gt; See below...<br/>\n&gt;   -----Mensaje original-----<br/>\n&gt;   De: jxingtang [mailto:jxingtang@y...]<br/>\n&gt;   Enviado el: viernes, 01 de agosto de 2003 0:33<br/>\n&gt;   Para: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\n&gt;   Asunto: [junit] Re: How to test a main(String[] args) method?<br/>\n&gt; <br/>\n&gt; <br/>\n&gt;   --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>, &quot;David&quot; &lt;achepati67@y...&gt; wrote:<br/>\n&gt;   &gt; &gt;Dear Members,<br/>\n&gt;   &gt; &gt;<br/>\n&gt;   &gt; &gt;I whould like to test a class with a main(String[] args) <br/>\n </span></blockquote>method.<br/>\n<blockquote><span title=\"ireply\"> &gt;   Depending<br/>\n&gt;   &gt; &gt;on the input argument it executes one thing or the other. The<br/>\n&gt;   problem is<br/>\n&gt;   &gt; &gt;that on my main(String[] args) method at the end or when it <br/>\n </span></blockquote>founds<br/>\n<blockquote><span title=\"ireply\"> &gt;   an<br/>\n&gt;   &gt; error,<br/>\n&gt;   &gt; &gt;the method System.exit() is invoked. So when I define jUnit <br/>\n </span></blockquote>test<br/>\n<blockquote><span title=\"ireply\"> &gt;   cases<br/>\n&gt;   &gt; &gt;(methods with prefix test), jUnits only runs the first test,<br/>\n&gt;   because<br/>\n&gt;   &gt; some&gt;System.exit() was invoked.<br/>\n&gt;   &gt; &gt;Is there any way to test such kind of situations?<br/>\n&gt;   &gt; &gt;Thanks in advance,<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; The solution propoused by Bern was:<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; java.lang.System is final and does not implement interfaces,so<br/>\n&gt;   there is no<br/>\n&gt;   &gt; chance to replace ist behaviour.You may want to replace calls to<br/>\n&gt;   &gt; System.exit() with calls againstan interface you define. Under <br/>\n </span></blockquote>test<br/>\n<blockquote><span title=\"ireply\"> &gt;   use an<br/>\n&gt;   &gt; implementation which allowsyourtest code to chech if the exit<br/>\n&gt;   method has<br/>\n&gt;   &gt; been called by main() but whichdoes not exit the VM. In <br/>\n </span></blockquote>production<br/>\n<blockquote><span title=\"ireply\"> &gt;   use an<br/>\n&gt;   &gt; implememtation which delegatesto System.exit().<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; As far as I know what you mean could be implemented like this: <br/>\n </span></blockquote>(see<br/>\n<blockquote><span title=\"ireply\"> &gt;   comments<br/>\n&gt;   &gt; below)<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; package com.my.example<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; public class Example {<br/>\n&gt;   &gt;       static Finish _finish = new Example.ProductionFinish();//<br/>\n&gt;   private package<br/>\n&gt;   &gt; (static because it is<br/>\n&gt;   &gt;<br/>\n&gt;               // going to be used on main.)<br/>\n&gt;   &gt;       static void setFinish(Finish value){_finish = <br/>\n </span></blockquote>value;}      //<br/>\n<blockquote><span title=\"ireply\"> &gt;   private package<br/>\n&gt;   &gt;<br/>\n&gt;   &gt;       static main (String[] args)<br/>\n&gt;   &gt;<br/>\n&gt;   &gt;             boolean goOn = true;       // because we don&#39;t exit <br/>\n </span></blockquote>on<br/>\n<blockquote><span title=\"ireply\"> &gt;   testing mode,<br/>\n&gt;   &gt;                                     // we need a way for<br/>\n&gt;   controling the execution flow.<br/>\n&gt;   &gt;             if (someCondition) {// first checking (exceptional<br/>\n&gt;   flow)<br/>\n&gt;   &gt;                   goOn = finish.do(-1);<br/>\n&gt;   &gt;             }<br/>\n&gt;   &gt;             // ... put other checking here<br/>\n&gt;   &gt;             if (goOn && otherCondition) {// main flow<br/>\n&gt;   &gt;                   finish.do(0);<br/>\n&gt;   &gt;             }<br/>\n&gt;   &gt;       }<br/>\n&gt;   &gt;<br/>\n&gt;   &gt;       /* Now we define the interface Finish and its default<br/>\n&gt;   implementation (as<br/>\n&gt;   &gt; inner classes<br/>\n&gt;   &gt;       with private-package visibility, because we have to define<br/>\n&gt;   ONLY for testing<br/>\n&gt;   &gt; purpose this<br/>\n&gt;   &gt;       interface!)*/<br/>\n&gt;   &gt;<br/>\n&gt;   &gt;       interface Finish {<br/>\n&gt;   &gt;             boolean do(int i);<br/>\n&gt;   &gt;       }<br/>\n&gt;   &gt;<br/>\n&gt;   &gt;       class ProductionFinish {// its default implementation <br/>\n </span></blockquote>(used<br/>\n<blockquote><span title=\"ireply\"> &gt;   on production<br/>\n&gt;   &gt; mode)<br/>\n&gt;   &gt;             ProductionFinish(){} // default constructor with<br/>\n&gt;   private-package<br/>\n&gt;   &gt; visibility<br/>\n&gt;   &gt;             boolean do(int i) {<br/>\n&gt;   &gt;                   System.exit(i);<br/>\n&gt;   &gt;             }<br/>\n&gt;   &gt;       }<br/>\n&gt;   &gt; }<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; Now on the testing class defined on the same package:<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; package com.my.example<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; public class ExampleTest extends TestCase{<br/>\n&gt;   &gt;       // ...<br/>\n&gt;   &gt;           protected void setUp (){Example.setFinish(new<br/>\n&gt;   &gt; ExampleTest.TestingFinish());}<br/>\n&gt;   &gt;       }<br/>\n&gt;   &gt;       class TestingFinish implements Example.Finish{<br/>\n&gt;   &gt;             TestingFinish (){} // default constructor with<br/>\n&gt;   private-package visibility<br/>\n&gt;   &gt;             boolean do(int i) { // We have to stop on every <br/>\n </span></blockquote>case!<br/>\n<blockquote><span title=\"ireply\"> &gt;   &gt;                   return false;<br/>\n&gt;   &gt;             }<br/>\n&gt;   &gt;       }<br/>\n&gt;   &gt; }<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; COMMENTS:<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; - About this suggestion and the corresponding implementation,<br/>\n&gt;   because we<br/>\n&gt;   &gt; need a default implementation ALWAYS (for production), then <br/>\n </span></blockquote>instead<br/>\n<blockquote><span title=\"ireply\"> &gt;   of using<br/>\n&gt;   &gt; an INTERFACE, it is BETTER to just define the class Finish as<br/>\n&gt;   ABSTRACT (the<br/>\n&gt;   &gt; do(int i) method should be abstract)<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; - You have to write A LOT for makeing a very simple task. I have<br/>\n&gt;   implemented<br/>\n&gt;   &gt; a simpler solution, just do the following steps:<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; a) Define on the class to test (Example), the static boolean <br/>\n </span></blockquote>field<br/>\n<blockquote><span title=\"ireply\"> &gt;   _TEST as<br/>\n&gt;   &gt; private-package. This field is initialized with default value: <br/>\n </span></blockquote>false<br/>\n<blockquote><span title=\"ireply\"> &gt;   &gt; (production)<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; b) Define a STATIC PRIVATE method finish, like this:<br/>\n&gt;   &gt;             private static boolean finish(int i) {<br/>\n&gt;   &gt;                   if(!_TEST) {<br/>\n&gt;   &gt;                         System.exit(i);<br/>\n&gt;   &gt;                   }<br/>\n&gt;   &gt;                   return false;<br/>\n&gt;   &gt;             }<br/>\n&gt;   &gt; c) On the testing class (ExampleTest), set on the setup() <br/>\n </span></blockquote>method,<br/>\n<blockquote><span title=\"ireply\"> &gt;   the field<br/>\n&gt;   &gt; _TEST to true.<br/>\n&gt;   &gt;<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; Now we have:<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; package com.my.example<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; public class Example {<br/>\n&gt;   &gt;       static boolean _TEST = false;<br/>\n&gt;   &gt;<br/>\n&gt;   &gt;       static main (String[] args)<br/>\n&gt;   &gt;<br/>\n&gt;   &gt;             boolean goOn = true;<br/>\n&gt;   &gt;             if (someCondition) {// fist checking<br/>\n&gt;   &gt;                   goOn = finish(-1);<br/>\n&gt;   &gt;             }<br/>\n&gt;   &gt;             // ... put other checking here<br/>\n&gt;   &gt;             if (goOn && otherCondition) {// the last condition<br/>\n&gt;   (end of the program)<br/>\n&gt;   &gt;                   finish(-1);<br/>\n&gt;   &gt;             }<br/>\n&gt;   &gt;       }<br/>\n&gt;   &gt;<br/>\n&gt;   &gt;       private static boolean finish (int i) {<br/>\n&gt;   &gt;             if (!_TEST) {<br/>\n&gt;   &gt;                   System.exit(i);<br/>\n&gt;   &gt;             }<br/>\n&gt;   &gt;             return false;<br/>\n&gt;   &gt;       }<br/>\n&gt;   &gt; }<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; package com.my.example<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; public class ExampleTest extends TestCase{<br/>\n&gt;   &gt;       // ...<br/>\n&gt;   &gt;           protected void setUp (){Example._TEST = true;}<br/>\n&gt;   &gt;       }<br/>\n&gt;   &gt; }<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; I think this solution is enough. Any suggestion?<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; Thanks in advance,<br/>\n&gt;   &gt;<br/>\n&gt;   &gt; David<br/>\n&gt; <br/>\n&gt; <br/>\n&gt;   Just wondering how the testMain() looks like? How do you cover for<br/>\n&gt;   all different arguments combination? Do you have to separate <br/>\n </span></blockquote>testMain<br/>\n<blockquote><span title=\"ireply\"> &gt;   () for each scenario? Thanks!<br/>\n&gt;   [David Leal] In general I have the following test methods:<br/>\n&gt;   testMain_help for testing when the user invokes the &quot;-h&quot;. &quot;-help&quot; <br/>\n </span></blockquote>on my<br/>\n<blockquote><span title=\"ireply\"> &gt; case.<br/>\n&gt;   testMain_exceptionalFlow for testing situation that produces <br/>\n </span></blockquote>errors and<br/>\n<blockquote><span title=\"ireply\"> &gt; the process is abruptly stoped.<br/>\n&gt;   testMain_mainFlow it is the main flow execution.<br/>\n&gt; <br/>\n&gt;   I coollects all possible outputs: error and standard output on <br/>\n </span></blockquote>files<br/>\n<blockquote><span title=\"ireply\"> &gt; (using the methods: System.setOut(), System.setErr()) and then <br/>\n </span></blockquote>compare the<br/>\n<blockquote><span title=\"ireply\"> &gt; files with the expected ones. That is may test.<br/>\n&gt; <br/>\n&gt;   That is my aproach, because on test mode the main() method <br/>\n </span></blockquote>doesn&#39;t finish<br/>\n<blockquote><span title=\"ireply\"> &gt; (Example._TEST= true), we can test more than one invocation to the <br/>\n </span></blockquote>method.<br/>\n<blockquote><span title=\"ireply\"> &gt; <br/>\n&gt;   Hope this help,<br/>\n&gt; <br/>\n&gt;   David<br/>\n<br/>\n </span></blockquote>By reading your answers to my question, I suddenly had a second <br/>\nthought to the approach to test main(...) method. Personally, I think <br/>\nthat the approach we have been discussed so far is little bit over <br/>\nengineering for Junit test. We are compelled to change the design to <br/>\nfaciliate unit testing. It may not be a good idea. So far, we just <br/>\nachieved test the exit code invoked by main. To test whether other <br/>\nmethods should be called, I am afraid that we may need introduce more <br/>\nmock object/interface. For instance, if main(...) calls fooA(), fooB<br/>\n()...fooX(), fooY() and fooZ(), then we may have to introduce <br/>\nfooA_4test(),fooB_4test()...fooZ_4test() to verify that <br/>\nfooA,fooB,,,fooZ are called by main(). Here we just want to test that <br/>\nthese foo methods are called but how they are exeucted is out of the <br/>\nscope of just testing main(...). This is what the task for <br/>\ntestMain_mainFlow should be. <br/>\n<br/>\nFor testMain_exceptionalFlow, could we try something to avoid <br/>\nchanging the code?<br/>\n<br/>\nString[] cmdStrArr = { &quot;myCmd exceptArg1,exceptArg2...&quot;,<br/>\n                       ....<br/>\n                      };<br/>\n<br/>\nfor( int i=0; i&lt;cmdStrArr.length; i++ )<br/>\n{<br/>\n    Process mainProcess = Runtime.getRuntime.exec( cmdStrArr[ i ] );<br/>\n<br/>\n    int exitVal = mainProcess.exitValue();<br/>\n <br/>\n    assertEqual( exitValue, ... );<br/>\n}<br/>\n<br/>\nThanks a lot for your input and correction!</div>", 
    "prevInTime": 9019, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1060028688", 
    "canDelete": false, 
    "nextInTopic": 9021, 
    "prevInTopic": 9016, 
    "headers": {
        "inReplyToHeader": "PE5GQkJMRkROTUpMTkxKQUpKS05BSUVOR0ZIQUEuYWNoZXBhdGk2N0B5YWhvby5lcz4=", 
        "messageIdInHeader": "PGJnbWZlZytodDEyQGVHcm91cHMuY29tPg=="
    }
}