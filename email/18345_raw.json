{
    "numMessagesInTopic": 4, 
    "nextInTime": 18346, 
    "senderId": "9Bz88bGVpzeS7U5GUgCejGNYie45gPiLSJ5X5M1KYMyZkgbFcANpY_WE8B3hlwvgMbgP3ZcAFKDeC42Tn_zI01n8_YYd-RmrpkOzmQNNw03_Nax2", 
    "systemMessage": false, 
    "subject": "Re: [junit] When code refuses to be mocked", 
    "from": "&quot;Joakim Ohlrogge&quot; &lt;joakim.ohlrogge@...&gt;", 
    "authorName": "Joakim Ohlrogge", 
    "msgSnippet": "Hi Wendy, Just a longshot: Does UniFile throw an exception when created using the default constructor? If that is the case you should be able to reproduce the ", 
    "msgId": 18345, 
    "rawEmail": "Return-Path: &lt;joakim.ohlrogge@...&gt;\r\nX-Sender: joakim.ohlrogge@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 29470 invoked from network); 13 Nov 2006 22:50:44 -0000\r\nReceived: from unknown (66.218.67.34)\n  by m27.grp.scd.yahoo.com with QMQP; 13 Nov 2006 22:50:44 -0000\r\nReceived: from unknown (HELO ug-out-1314.google.com) (66.249.92.172)\n  by mta8.grp.scd.yahoo.com with SMTP; 13 Nov 2006 22:50:44 -0000\r\nReceived: by ug-out-1314.google.com with SMTP id i24so971210ugd\n        for &lt;junit@yahoogroups.com&gt;; Mon, 13 Nov 2006 14:50:44 -0800 (PST)\r\nReceived: by 10.78.164.13 with SMTP id m13mr226719hue.1163458243685;\n        Mon, 13 Nov 2006 14:50:43 -0800 (PST)\r\nReceived: by 10.78.147.18 with HTTP; Mon, 13 Nov 2006 14:50:43 -0800 (PST)\r\nMessage-ID: &lt;b9ee5e410611131450x7e4d078avaa9d737ef275eaf1@...&gt;\r\nDate: Mon, 13 Nov 2006 23:50:43 +0100\r\nTo: junit@yahoogroups.com\r\nIn-Reply-To: &lt;adba96190611121321u22fd4542r6bc3cb98b3d4f187@...&gt;\r\nMIME-Version: 1.0\r\nReferences: &lt;adba96190611121321u22fd4542r6bc3cb98b3d4f187@...&gt;\r\nX-Google-Sender-Auth: 6b5f02fe236d76cf\r\nX-eGroups-Msg-Info: 1:0:0:0\r\nX-eGroups-From: &quot;Joakim Ohlrogge&quot; &lt;joakim.ohlrogge@...&gt;\r\nFrom: &quot;Joakim Ohlrogge&quot; &lt;joakim.ohlrogge@...&gt;\r\nReply-To: joakim.ohlrogge@...\r\nSubject: Re: [junit] When code refuses to be mocked\r\nX-Yahoo-Group-Post: member; u=261856052; y=Ox4mSrKuqMRcLwC_JuINqtzRqGchBaFZfKL_wgSmu7HGdR1h\r\nX-Yahoo-Profile: j0hlrogge\r\nContent-Type: text/plain; charset=US-ASCII\r\nContent-Transfer-Encoding: 7bit\r\n\r\nHi Wendy,\n\nJust a longshot: Does UniFile throw an exception when created using the\ndefault constructor? If that is the case you should be able to reproduce the\nexact same failure without easymock by creating an instance of UniFile (if\nthe default constructor is protected in UniFile you may have to subclass it\nto reproduce the problem).\n\nAre there any constructors in UniFile that take arguments? I suspect you\nshould make EasyMock use one of those. I don&#39;t know how to do that in\nEasyMock but rMock also uses cglib and in rMock it looks like this:\n\nmock(SomeClass.class, new Object[]{&quot;constructorAgrument1&quot;, 4711});\n\nThe above is the equivalent to:\n\nnew SomeClass(&quot;constructorArgument1&quot;, 4711);\n\nI bet you can do the same in EasyMock.\n\nSome background: EasyMock uses CGLIB (same as RMock) in order to be able to\nmock classes. While mocking concrete classes can sometimes be convenient it\nis seldom worth the trouble. One nasty thing is what I suspect that you are\nexpericening: since mocking a class works by /subclassing/ the actual class\n/dynamically/ you can have sideeffects from the constructor of the mocked\nclass.\n\nI generally try to wrap my 3rd party API:s behind interfaces I own (create a\nvery thin wrapper exposing only what I need and use) and leave the testing\nof the wrapper to integration-tests. Mocks are most effective when\ndiscovering interfaces IMO. (That is the inverse of how I started using\nmocks, I mock between classes I own and test the &quot;edges&quot; of my system\nstatebased). I find that using mocks this way helps me discovering\ninterfaces, guide my design and focus on one thng at the time. If I want to\nisolate myself from a database or some other resource I generally use stubs\nand not dynamic mocks.\n\nJust my 2 cents for what they are worth.\nHope this helps!\n/J\n\n\n\n\nOn 11/12/06, Wendy Smoak &lt;wsmoak@...&gt; wrote:\n&gt;\n&gt;   I&#39;m having trouble testing some code that sits on top of a 3rd party\n&gt; library.\n&gt;\n&gt; Think &quot;Spring JDBC&quot; only instead of JDBC, it&#39;s a proprietary API to an\n&gt; obscure database [1]. I&#39;m coming back to this project after several\n&gt; months, so if I&#39;m not making sense it&#39;s because I&#39;ve forgotten some\n&gt; details. Please point that out and I&#39;ll re-learn and clarify.\n&gt;\n&gt; Where I seem to have gotten stuck is that with EasyMock Class\n&gt; Extension, I tried this:\n&gt;\n&gt; // set up the mock UniFile\n&gt; ctrlUniFile = MockClassControl.createControl(UniFile.class, null, null);\n&gt; mockUniFile = (UniFile) ctrlUniSession.getMock();\n&gt;\n&gt; And I get:\n&gt;\n&gt; net.sf.cglib.core.CodeGenerationException:\n&gt; asjava.uniobjects.UniFileException--&gt;\n&gt; Cannot instantiate this object in this manner. Must use the UniSession\n&gt; object\n&gt;\n&gt; The UniSession object is analogous to a Connection. I&#39;m trying to\n&gt; avoid having to connect to the database to test the &#39;Spring UOJ&#39;\n&gt; framework code. All I need to know is that it called the read method\n&gt; on a UniFile, and got something back.\n&gt;\n&gt; The test class and stack trace are here:\n&gt; http://wiki.wsmoak.net/cgi-bin/wiki.pl?SpringUOJ/Test\n&gt;\n&gt; Any ideas, or do you see anything I&#39;m doing wrong?\n&gt;\n&gt; After this, it looks like I started to write concrete &#39;MockUniSession&#39;\n&gt; and &#39;MockUniFile&#39; classes. Before I continue down that path (or\n&gt; continue wandering aimlessly) I thought I&#39;d ask for help.\n&gt;\n&gt; [1] UniObjects for Java and IBM&#39;s UniData, respectively.\n&gt;\n&gt; Thanks,\n&gt; --\n&gt; Wendy\n&gt;\n&gt;  \n&gt;\n\n\n[Non-text portions of this message have been removed]\n\n\n", 
    "profile": "j0hlrogge", 
    "topicId": 18341, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 261856052, 
    "prevInTime": 18344, 
    "contentTrasformed": false, 
    "postDate": "1163458243", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 18344, 
    "headers": {
        "inReplyToHeader": "PGFkYmE5NjE5MDYxMTEyMTMyMXUyMmZkNDU0MnI2YmMzY2I5OGIzZDRmMTg3QG1haWwuZ21haWwuY29tPg==", 
        "messageIdInHeader": "PGI5ZWU1ZTQxMDYxMTEzMTQ1MHg3ZTRkMDc4YXZhYTlkNzM3ZWYyNzVlYWYxQG1haWwuZ21haWwuY29tPg==", 
        "referencesHeader": "PGFkYmE5NjE5MDYxMTEyMTMyMXUyMmZkNDU0MnI2YmMzY2I5OGIzZDRmMTg3QG1haWwuZ21haWwuY29tPg=="
    }
}