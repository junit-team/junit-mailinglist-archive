{
    "numMessagesInTopic": 2, 
    "nextInTime": 11918, 
    "senderId": "YLo0sDJJ_zWi4P5QYywRBHiht6YNS6eGRub3K8gj3r7Me2a6F7ee1WUGgNYE4ghDOJa01aDtTyl1sL_MMddG2KyPQzXpvQNR_ZsmIlyb", 
    "systemMessage": false, 
    "subject": "Re: [junit] garbage-collection of tests", 
    "from": "Neil Swingler &lt;neil@...&gt;", 
    "authorName": "Neil Swingler", 
    "msgSnippet": "You could introduce a decorator for the TestCase which could null it s reference to the real TestCase as soon as it has finished executing. See my example", 
    "msgId": 11917, 
    "profile": "neil_swingler", 
    "topicId": 11917, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 117993331, 
    "messageBody": "<div id=\"ygrps-yiv-1670428414\">You could introduce a decorator for the TestCase which could null it&#39;s reference to the real TestCase as soon as it has finished executing.<br/>\n<br/>\nSee my example (name.swingler.neil.classreloader.zip) in the files section which uses this technique to introduce a new classloader for each TestCase instance:<br/>\n<br/>\n- Neil<br/>\n<br/>\n<blockquote><span title=\"qreply\"> &gt; &lt;html&gt;&lt;body&gt;<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; &lt;tt&gt;<br/>\n&gt; I recently encountered a problem when running a lot (~500) of UI tests &lt;BR&gt;<br/>\n&gt; which probably wouldn&#39;t show up for non-UI tests until you get in the &lt;BR&gt;<br/>\n&gt; 100K of tests.&lt;BR&gt;<br/>\n&gt; &lt;BR&gt;<br/>\n&gt; After a TestCase instance is run, it is usually never garbage-collected &lt;BR&gt;<br/>\n&gt; or made available for GC until the runner itself is disposed on program &lt;BR&gt;<br/>\n&gt; exit (at least with the default runners, and probably with most custom &lt;BR&gt;<br/>\n&gt; runners as well).&nbsp; Not a big deal if you have just a few basic data &lt;BR&gt;<br/>\n&gt; fields or not too many tests, but if the runner has 1000s of tests and &lt;BR&gt;<br/>\n&gt; you don&#39;t have enough resources for all tests to be resident at once, &lt;BR&gt;<br/>\n&gt; you&#39;re in trouble.&lt;BR&gt;<br/>\n&gt; &lt;BR&gt;<br/>\n&gt; In my case, each UI test usually included assignment of several member &lt;BR&gt;<br/>\n&gt; fields in its setUp method.&nbsp;&nbsp; Unless these are explicitly nulled in the &lt;BR&gt;<br/>\n&gt; tearDown method, the references are kept around until the test runner &lt;BR&gt;<br/>\n&gt; terminates, since the TestCase instance itself is never GCd.&nbsp; This &lt;BR&gt;<br/>\n&gt; causes real problems when the fields are resource-intensive or the &lt;BR&gt;<br/>\n&gt; resources are limited (think Windows and UI resources).&lt;BR&gt;<br/>\n&gt; &lt;BR&gt;<br/>\n&gt; Yes, it&#39;s possible to explicitly blank certain fields when necessary, &lt;BR&gt;<br/>\n&gt; but that&#39;s only a hair removed from explicitly freeing memory, and a &lt;BR&gt;<br/>\n&gt; pain when there are some 500-odd tests that would need to be changed &lt;BR&gt;<br/>\n&gt; (no refactoring tool for *that* yet, I&#39;m afraid).&lt;BR&gt;<br/>\n&gt; &lt;BR&gt;<br/>\n&gt; There are several solutions:&lt;BR&gt;<br/>\n&gt; 1) explicitly null fields in tearDown (this smells, because that&#39;s what &lt;BR&gt;<br/>\n&gt; GC is for)&lt;BR&gt;<br/>\n&gt; 2) make a runner that doesn&#39;t keep references to test case instances &lt;BR&gt;<br/>\n&gt; after they&#39;re run&lt;BR&gt;<br/>\n&gt; 3) use reflection to auto-null all test case fields (hackishly neat, &lt;BR&gt;<br/>\n&gt; but still smells)&lt;BR&gt;<br/>\n&gt; &lt;BR&gt;<br/>\n&gt; Any other ideas, suggestions?&lt;BR&gt;<br/>\n&gt; &lt;BR&gt;<br/>\n&gt; &lt;/tt&gt;<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; &lt;br&gt;<br/>\n&gt; <br/>\n&gt; &lt;!-- |**|begin egp html banner|**| --&gt;<br/>\n&gt; <br/>\n&gt; &lt;table border=0 cellspacing=0 cellpadding=2&gt;<br/>\n&gt; &lt;tr bgcolor=#FFFFCC&gt;<br/>\n&gt; &lt;td align�nter&gt;&lt;font size=&quot;-1&quot; color=#003399&gt;&lt;b&gt;Yahoo! Groups Sponsor&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;<br/>\n&gt; &lt;/tr&gt;<br/>\n&gt; &lt;tr bgcolor=#FFFFFF&gt;<br/>\n&gt; &lt;td align�nter widthG0&gt;&lt;table border=0 cellpadding=0 cellspacing=0&gt; &lt;tr&gt; &lt;td align�nter&gt;&lt;font face=arial size=-2&gt;ADVERTISEMENT&lt;/font&gt;&lt;br&gt;&lt;a href=&quot;http://us.ard.yahoo.com/SIG\u001295g5gqq/M)5196.4901138.6071305.3001176/D=groups/S\u001705006905:HM/EXP\u001094739772/A!28215/R=0/SIG\u0010se96mf6/*http://companion.yahoo.com&quot; alt=&quot;&quot;&gt;&lt;img src=&quot;http://us.a1.yimg.com/us.yimg.com/a/ya/yahoo_companion/lrec_companion_043004.gif&quot; alt=&quot;click here&quot; width=&quot;300&quot; height=&quot;250&quot; border=&quot;0&quot;&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt; &lt;/td&gt;<br/>\n&gt; &lt;/tr&gt;<br/>\n&gt; &lt;tr&gt;&lt;td&gt;&lt;img alt=&quot;&quot; width=1 height=1 src=&quot;http://us.adserver.yahoo.com/l?M)5196.4901138.6071305.3001176/D=groups/S=:HM/A!28215/randq7150414&quot;&gt;&lt;/td&gt;&lt;/tr&gt;<br/>\n&gt; &lt;/table&gt;<br/>\n&gt; <br/>\n&gt; &lt;!-- |**|end egp html banner|**| --&gt;<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; <br/>\n&gt; &lt;!-- |**|begin egp html banner|**| --&gt;<br/>\n&gt; <br/>\n&gt; &lt;br&gt;<br/>\n&gt; &lt;tt&gt;&lt;hr width=&quot;500&quot;&gt;<br/>\n&gt; &lt;b&gt;Yahoo! Groups Links&lt;/b&gt;&lt;br&gt;<br/>\n&gt; &lt;ul&gt;<br/>\n&gt; &lt;li&gt;To visit your group on the web, go to:&lt;br&gt;&lt;a href=&quot;http://groups.yahoo.com/group/junit/&quot;&gt;http://groups.yahoo.com/group/junit/&lt;/a&gt;&lt;br&gt;&nbsp;<br/>\n&gt; &lt;li&gt;To unsubscribe from this group, send an email to:&lt;br&gt;&lt;a href=&quot;mailto:junit-unsubscribe@yahoogroups.com?subject=Unsubscribe&quot;&gt;junit-unsubscribe@yahoogroups.com&lt;/a&gt;&lt;br&gt;&nbsp;<br/>\n&gt; &lt;li&gt;Your use of Yahoo! Groups is subject to the &lt;a href=&quot;http://docs.yahoo.com/info/terms/&quot;&gt;Yahoo! Terms of Service&lt;/a&gt;.<br/>\n&gt; &lt;/ul&gt;<br/>\n&gt; &lt;/tt&gt;<br/>\n&gt; &lt;/br&gt;<br/>\n&gt; <br/>\n&gt; &lt;!-- |**|end egp html banner|**| --&gt;<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; &lt;/body&gt;&lt;/html&gt;<br/>\n&gt; <br/>\n&gt; </span></blockquote></div>", 
    "prevInTime": 11916, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1094662946", 
    "canDelete": false, 
    "nextInTopic": 11920, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PEUxQzU1cTUtMDAwNWRaLTAwQHNlcnYwMS5uZWlsLnN3aW5nbGVyLm5hbWU+"
    }
}