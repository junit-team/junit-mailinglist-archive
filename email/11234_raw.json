{
    "numMessagesInTopic": 8, 
    "nextInTime": 11235, 
    "senderId": "3S1jbj_BBjnSM0g1spURrW4V6WexDUiSDcbOx_tza_dbDPxK4CwIGdOrr8D81EybZwzGrYrGYN0yA-m66RVxzOW1qfkOzRBo_A", 
    "systemMessage": false, 
    "subject": "Re: JUnit tests and common resources", 
    "from": "&quot;youlian&quot; &lt;julian@...&gt;", 
    "authorName": "youlian", 
    "msgSnippet": "... depends ... develop ... correctly. ... is ... invokes ... say, ... a ... subclass ... something ... do ... that ... connection. ... representing ... test", 
    "msgId": 11234, 
    "rawEmail": "Return-Path: &lt;julian@...&gt;\r\nReceived: (qmail 43399 invoked from network); 20 Jun 2004 15:31:12 -0000\r\nReceived: from unknown (66.218.66.172)\n  by m23.grp.scd.yahoo.com with QMQP; 20 Jun 2004 15:31:12 -0000\r\nReceived: from unknown (HELO n4.grp.scd.yahoo.com) (66.218.66.88)\n  by mta4.grp.scd.yahoo.com with SMTP; 20 Jun 2004 15:31:12 -0000\r\nX-eGroups-Return: julian@...\r\nReceived: from [66.218.66.113] by n4.grp.scd.yahoo.com with NNFMP; 20 Jun 2004 15:31:11 -0000\r\nX-Sender: julian@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 54038 invoked from network); 20 Jun 2004 07:24:47 -0000\r\nReceived: from unknown (66.218.66.218)\n  by m3.grp.scd.yahoo.com with QMQP; 20 Jun 2004 07:24:47 -0000\r\nReceived: from unknown (HELO n20.grp.scd.yahoo.com) (66.218.66.76)\n  by mta3.grp.scd.yahoo.com with SMTP; 20 Jun 2004 07:24:47 -0000\r\nReceived: from [66.218.67.175] by n20.grp.scd.yahoo.com with NNFMP; 20 Jun 2004 07:24:42 -0000\r\nDate: Sun, 20 Jun 2004 07:24:41 -0000\r\nTo: junit@yahoogroups.com\r\nMessage-ID: &lt;cb3e3p+jvcu@...&gt;\r\nIn-Reply-To: &lt;40D4A31E.2010608@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Transfer-Encoding: quoted-printable\r\nContent-Length: 6887\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-eGroups-Remote-IP: 66.218.66.76\r\nFrom: &quot;youlian&quot; &lt;julian@...&gt;\r\nSubject: Re: JUnit tests and common resources\r\nX-Yahoo-Group-Post: member; u=147836653\r\nX-Yahoo-Profile: youlian\r\nX-eGroups-Approved-By: nails762 &lt;jbrains@...&gt; via web; 20 Jun 2004 15:31:11 -0000\r\nX-eGroups-Remote-IP: 66.218.66.88\r\n\r\n--- In junit@yahoogroups.com, &quot;J. B. Rainsberger&quot; &lt;jbrains@r...&gt; \nwrote:\n&gt; =\r\nyoulian wrote:\n&gt; \n&gt; &gt; Hi,\n&gt; &gt; \n&gt; &gt; I hope this has a simple answer...\n&gt; &gt; \n=\r\n&gt; &gt; My issue is when I write test cases that exercise code that \ndepends\n&gt; =\r\n&gt; on a common resource. There is couple of things, but the simplest\n&gt; &gt; cas=\r\ne is a serial port.\n&gt; &gt; \n&gt; &gt; Lets say that I have a class that implements a=\r\n protocol with a\n&gt; &gt; hardware device over serial port connection. I would l=\r\nike to \ndevelop\n&gt; &gt; a test to verify that the class implements the protocol=\r\n \ncorrectly.\n&gt; &gt; This means, that I will have to have the device connected =\r\nand\n&gt; &gt; operational when running the test, and that is o.k.\n&gt; &gt; \n&gt; &gt; I coul=\r\nd mock the serial connection - I understand this, but this \nis\n&gt; &gt; not my i=\r\nntention. I see little value in this for many reasons. I\n&gt; &gt; want to test t=\r\nhe real thing.\n&gt; &gt; \n&gt; &gt; So, I write a simple test suite and test case. The =\r\ntest case \ninvokes\n&gt; &gt; different methods - lets say total of three. To simp=\r\nlify, lets \nsay,\n&gt; &gt; that those methods each send different command to the =\r\ndevice. In\n&gt; &gt; order to do that each test method will open the comm port, w=\r\nrite \na\n&gt; &gt; string and close it.\n&gt; &gt; \n&gt; &gt; Sounds simple enough. However, wh=\r\nen using JUnit, all these tests\n&gt; &gt; execute in parallel and since the resou=\r\nrce is shared, all but one\n&gt; &gt; fail with SerialPortInUseException.\n&gt; &gt; \n&gt; \n=\r\n&gt; \n&gt; &gt; I have read the JUnit Cookbook and undesrstand the reason - JUnit\n&gt; =\r\n&gt; via reflection generates dynamically child classes. \n&gt; \n&gt; Not quite. Inst=\r\nead, it instantiates the test case class, invokes \n&gt; setUp(), a test method=\r\n, then tearDown(). There is no need to \nsubclass \n&gt; anonymously since JUnit=\r\n 2.0 first appeared.\n&gt; \n&gt;  &gt; For each test\n&gt; &gt; method setUp and tearDown is=\r\n invoked. The log would look \nsomething\n&gt; &gt; like this:\n&gt; &gt; \n&gt; &gt; setUp()\n&gt; &gt;=\r\n setUp()\n&gt; &gt; setUp()\n&gt; &gt; ...\n&gt; &gt; test1()\n&gt; &gt; test2()\n&gt; &gt; testx()\n&gt; &gt; ...\n&gt; =\r\n&gt; tearDown()\n&gt; &gt; tearDown()\n&gt; &gt; tearDown()\n&gt; \n&gt; No.\n&gt; \n&gt; setUp(), test1(), =\r\ntearDown();\n&gt; setUp(), test2(), tearDown();\n&gt; ...\n&gt; \n&gt; &gt; If I use setUp() o=\r\nr even testX() to open the connection, I always\n&gt; &gt; end up in conflict.\n&gt; \n=\r\n&gt; You want to open the connection /once/. The easiest thing you can \ndo \n&gt; =\r\n(for now) is create a Singleton that contains a global connection \nthat \n&gt; =\r\nonly allows itself to be opened once. Let your tests use that \nconnection.\n=\r\n&gt; \n&gt; Ultimately, what you&#39;d /like/ to do is Extract an Interface \nrepresent=\r\ning \n&gt; the API for your resource, then use a mock objects approach to \ntest=\r\n how \n&gt; well your code interacts with that API. The majority of your tests =\r\n\nwill \n&gt; be like this. Eventually, you will have a small number of tests \nt=\r\nhat \n&gt; actually verify that the /production/ implementation of your new \n&gt; =\r\ninterface uses the serial port API correctly. This does not make \nyour \n&gt; p=\r\nroblem go away, but it lessens the problem&#39;s impact, isolating it \nto a \n&gt; =\r\nsingle class (a well-known part of the code). This is the point of \nOOP.\n&gt; =\r\n\n&gt; &gt; My questions are:\n&gt; &gt; Is there a way to explicitly control the order o=\r\nf execution of \ntest\n&gt; &gt; methods within a test case, so to control the acce=\r\nss to commonly\n&gt; &gt; used resources and account for their state? (system port=\r\ns, JDBC\n&gt; &gt; connections, etc.)\n&gt; &gt; \n&gt; &gt; Is JUnit the tool for such a job?\n&gt;=\r\n \n&gt; No, it isn&#39;t. Still, whenenver I want to do something in my design \ntha=\r\nt \n&gt; JUnit makes difficult, it is /usually/ a sign that my design needs \n&gt; =\r\nimprovement.\n&gt; -- \n&gt; J. B. Rainsberger,\n&gt; Diaspar Software Services\n&gt; http:=\r\n//www.diasparsoftware.com :: +1 416 791-8603\n&gt; Let&#39;s write software that pe=\r\nople understand\n\nI will try to answer couple of replies in a single message=\r\n:\n\n1. I do have an interface defined and more. It is the low-level host \npr=\r\notocol I need to test. The difficulty is that the device on the \nother end =\r\nis often experimental and I cannot rely on perfect \noperation and documenta=\r\ntion. I could try to take the high road and \nexpect perfection from the man=\r\nufacturer, but that is not how things \nwork in my world :). What I am writi=\r\nng is a set of software drivers \ncontrolling devices from different manufac=\r\nturers. I am trying to \nprovide consistent interface to a class of hardware=\r\n modules, all \nwith a twist and all of them with vastly different protocols=\r\n. \nMocking the hardware will not help me much. It will be a waste of \ntime =\r\ntrying to duplicate (and some times guess) all aspects of the \nbehavior, wh=\r\nen I can simply plug it in. In effect I am testing more \nthe host protocol =\r\nand the device then the business logic on my end. \nAgain, I am developing a=\r\n driver, not the business logic that will \nuse that driver.\n\n2. Yes, after =\r\nsome thinking I have decided that I really need to \nopen the connection onl=\r\ny once. I did that by following the example \nof custom initialization for m=\r\ny suite taken directly from the JUnit \nCookbook. It worked fine. The setUp =\r\nand tearDown methods of the \nsuite are invoked only once. Then the setUp an=\r\nd tearDown methods for \nthe tests are called. Since the instance of my driv=\r\ner is in effect \ndefined in the suite, it is being initialized only once. I=\r\n am free \nto use the tests to define the detailed operations, etc. Test sui=\r\ntes \ncan be nested and that works fine for me in this case.\n\n3. It crossed =\r\nmy mind to put everything into one test method and \ncall the individual tes=\r\nt methods from there, but I do not like this \napproach. It invalidates in m=\r\ny opinion many of the benefits of \nJUnit. \n\n4. I also had the idea of creat=\r\ning a Singleton, or simply a static \nreference to the driver within the tes=\r\nt case. However, that would \nrequire creating yet another class just for th=\r\nat purpose. It can be \ndone of course, but feels a bit awkward. #2 proved t=\r\no be much more \nelegant solution. No static fields, no extra classes. \n\n&gt; N=\r\no, it isn&#39;t. Still, whenever I want to do something in my design \nthat \n&gt; J=\r\nUnit makes difficult, it is /usually/ a sign that my design needs \n&gt; Improv=\r\nement.\n\n5. I do not agree entirely with the above. My concern was related t=\r\no \nthe fact that I see no way to control the flow in JUnit and it has \nvery=\r\n little to do with the design of the system being tested =96 good \nor bad. =\r\nAs far as I understand test framework should perform well \neven if the code=\r\n it works with is bad (I hope this is not the case \nwith mine J). I still c=\r\nonsider this ability (flow control) \ncompletely missing in JUnit.  I think =\r\nit would be very useful if I \ncould have explicit control over what tests e=\r\nxecute when and even \nbranch the logic based on a condition. Perhaps jump f=\r\nrom one test to \nanother, etc. On the other hand I do not like the underlyi=\r\nng \nsuggestion that one should be dependent on the specific capabilities \no=\r\nf any one testing framework. In a way, to design for JUnit. Test \ntools com=\r\ne and go and the merits of the design should be judged not \nby how easy is =\r\nto use with JUnit, but how it performs.\n\nThe bottom line is that I found a =\r\nsolution that works. Thanks for \nall the good suggestions.\n\n\n\n\n\n\n", 
    "profile": "youlian", 
    "topicId": 11214, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 147836653, 
    "prevInTime": 11233, 
    "contentTrasformed": false, 
    "postDate": "1087716281", 
    "canDelete": false, 
    "nextInTopic": 11240, 
    "prevInTopic": 11232, 
    "headers": {
        "inReplyToHeader": "PDQwRDRBMzFFLjIwMTA2MDhAcm9nZXJzLmNvbT4=", 
        "messageIdInHeader": "PGNiM2UzcCtqdmN1QGVHcm91cHMuY29tPg=="
    }
}