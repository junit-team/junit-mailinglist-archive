{
    "numMessagesInTopic": 1, 
    "nextInTime": 12787, 
    "senderId": "Svh1n47vsj3-4p3BzvPcViPsLM2q_SNG3N1-ou4eeyPPDx2wVjiQe24cWm7KbnfYuav52ffHvTOef_hHJn91ZCda3MOIX0oOe4-FkQ", 
    "systemMessage": true, 
    "subject": "Interceptor usage in MockEJB", 
    "from": "&quot;Ian Priest&quot; &lt;ian_priest@...&gt;", 
    "authorName": "Ian Priest", 
    "msgSnippet": "", 
    "msgId": 12786, 
    "profile": "ianpriest2000", 
    "topicId": 12786, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 213216731, 
    "messageBody": "<div id=\"ygrps-yiv-1993530137\"><blockquote><span title=\"qreply\">&gt;Hi,<br/>\n&gt;<br/>\n&gt;I&#39;m trying to use an interceptor in MockEJB, but it doesn&#39;t seem to be <br/>\n&gt;intercepting.<br/>\n&gt;<br/>\n&gt;I have a bean class that has method...<br/>\n&gt;<br/>\n&gt;\tpublic String echoStringUpper(String input)<br/>\n&gt;\t{<br/>\n&gt;\t\tSimpleHelper helper = new SimpleHelper();<br/>\n&gt;\t\tString upper = helper.toUpper(input);<br/>\n&gt;\t\treturn upper;<br/>\n&gt;\t}<br/>\n&gt;<br/>\n&gt;and in SimpleHelper the toUpper method is...<br/>\n&gt;<br/>\n&gt;\tpublic String toUpper(String in) {<br/>\n&gt;\t\treturn in.toUpperCase();<br/>\n&gt;\t}<br/>\n&gt;<br/>\n&gt;I have set up a unit test with an interceptor as follows. (The setup method <br/>\n&gt;publishes the bean to mock jndi in the usual manner).<br/>\n&gt;<br/>\n&gt;\tpublic void testEchoStringUpper() throws Exception {<br/>\n&gt;<br/>\n&gt;\t\tAspectSystem aspectSystem = AspectSystemFactory.getAspectSystem();<br/>\n&gt;<br/>\n&gt;\t\tClassPointcut simpleHelperPointcut = new ClassPointcut(<br/>\n&gt;\t\t\t\tSimpleHelper.class,<br/>\n&gt;\t\t\t\tfalse);<br/>\n&gt;<br/>\n&gt;\t\tInvocationRecorder recorder = new InvocationRecorder();<br/>\n&gt;\t\taspectSystem.add(simpleHelperPointcut, recorder);<br/>\n&gt;<br/>\n&gt;\t\tObject homeObj = context.lookup(SimpleHome.JNDI_NAME);<br/>\n&gt;\t\tSimpleHome home = (SimpleHome) PortableRemoteObject.narrow(<br/>\n&gt;\t\t\t\thomeObj,<br/>\n&gt;\t\t\t\tSimpleHome.class<br/>\n&gt;\t\t);<br/>\n&gt;\t\tSimple bean = home.create();<br/>\n&gt;<br/>\n&gt;\t\tString retval = bean.echoStringUpper(&quot;Hello World&quot;);<br/>\n&gt;<br/>\n&gt;\t\tList methods = recorder.getMethodInvocationList();<br/>\n&gt;\t\tSystem.out.println(&quot;contexts...&quot;);<br/>\n&gt;\t\tfor (Iterator iter = methods.iterator(); iter.hasNext();)<br/>\n&gt;\t\t{<br/>\n&gt;\t\t\tInvocationContext element = (InvocationContext) iter.next();<br/>\n&gt;\t\t\tSystem.out.println(element);<br/>\n&gt;\t\t}<br/>\n<br/>\n&gt;\t\tInvocationContext toUpperInvocationCxt = recorder.findByTargetMethod(<br/>\n&gt;\t\t\t\t&quot;toUpper&quot;<br/>\n&gt;\t\t);<br/>\n&gt;\t\tassertNotNull(&quot;toUpper wasn&#39;t invoked&quot;, toUpperInvocationCxt);<br/>\n&gt;<br/>\n&gt;\t\tString input = (String) (toUpperInvocationCxt.getParamVals()[0]);<br/>\n&gt;\t\tassertEquals(&quot;Wrong value passed to toUpper()&quot;, &quot;Hello World&quot;, input);<br/>\n&gt;<br/>\n&gt;\t\tassertEquals(&quot;Returned string was incorrect&quot;, &quot;Hello World&quot;, retval);<br/>\n&gt;<br/>\n&gt;\t}<br/>\n&gt;<br/>\n&gt;The println bit shows that the recorder doesn&#39;t record any invocations, and <br/>\n&gt;the findByTargetMethod always returns null.<br/>\n&gt;<br/>\n&gt;I&#39;ve tried various combinations of ClassPointcut, ClassPatternPointcut and <br/>\n&gt;MethodPatternPointcut, but nothing seems to pick up the call to <br/>\n&gt;SimpleHelper.toUpper().<br/>\n&gt;<br/>\n&gt;Can anyone help, or explain why it can&#39;t be done?<br/>\n&gt;<br/>\n&gt;Cheers,<br/>\n&gt;Ian. </span></blockquote></div>", 
    "prevInTime": 12785, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1107278335", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PEJBWTEwMS1GMjNFRkMwQThBRkMyNDREQTRCOERBRkZGN0QwQHBoeC5nYmw+"
    }
}