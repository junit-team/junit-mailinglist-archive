{
    "numMessagesInTopic": 30, 
    "nextInTime": 24281, 
    "senderId": "HIt5SaQJ6pvy05x2SARDWBSFCgc7zTw3gc0SQMGZ14_jjAhiXUwtYoc7S1h3YmVnecB1LqVuedC1LOewu4R27H-oR3178Q-3", 
    "systemMessage": false, 
    "subject": "Re: [junit] Feedback requested: Impending changes to RunListener", 
    "from": "Kevin Cooney &lt;kcooney@...&gt;", 
    "authorName": "Kevin Cooney", 
    "msgSnippet": "Currently the RunListener code stores the listeners in a synchronized list, and has a large synchronized block where it calls all of the listeners: ", 
    "msgId": 24280, 
    "rawEmail": "Return-Path: &lt;kcooney@...&gt;\r\nReceived: (qmail 78562 invoked by uid 7800); 6 Feb 2013 23:42:23 -0000\r\nX-Sender: kcooney@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 50684 invoked from network); 6 Feb 2013 23:38:39 -0000\r\nX-Received: from unknown (10.193.84.151)\n  by m4.grp.bf1.yahoo.com with QMQP; 6 Feb 2013 23:38:39 -0000\r\nX-Received: from unknown (HELO mail-ia0-f182.google.com) (209.85.210.182)\n  by mta5.grp.bf1.yahoo.com with SMTP; 6 Feb 2013 23:38:39 -0000\r\nX-Received: by mail-ia0-f182.google.com with SMTP id w33so2328594iag.27\n        for &lt;junit@yahoogroups.com&gt;; Wed, 06 Feb 2013 15:38:38 -0800 (PST)\r\nX-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;\n        d=google.com; s=20120113;\n        h=x-received:mime-version:in-reply-to:references:from:date:message-id\n         :subject:to:content-type:x-gm-message-state;\n        bh=wvU1ZZNcUW647jJHcMZs0liXqZHWNRxmWwZwB9FSszA=;\n        b=ZiyST/YewnEZVcW7XQEvMSr3dj29xlLc01sprcR+kFL0zAFgbIsgOyyYNJsYumNW35\n         VlF6HFokWC6FHAjCD2D12tMfgq5skCZmuELoKig/eIGkCQ6m6WzEk2mT+7g5JrGxPspH\n         sfP3fZTQfldmjbfhcXnkRL83Dqy6dvqRh8ZFgnJJ8uf5qYmJQWdlcMzF/uxPPjkZSCmR\n         HpSbpJN40bI3YgBXb6tQvUmAR0lN21bgKwEe9gh7AARdq16/7irakyoDsnhA2XLIo8ie\n         TkgN7G/lwvBdkRlUjqVk2IrwxqOLdhUZMtpe2NiLoD+kv0ElUverOdJENIMid10PVDCs\n         T9Ng==\r\nX-Received: by 10.43.110.132 with SMTP id ek4mr32273160icc.32.1360193918642;\n Wed, 06 Feb 2013 15:38:38 -0800 (PST)\r\nMIME-Version: 1.0\r\nX-Received: by 10.43.12.195 with HTTP; Wed, 6 Feb 2013 15:38:07 -0800 (PST)\r\nIn-Reply-To: &lt;CAO_RykoJ1vQskNCkRyZbDiqSiUN__E8YaYzWssTEh7VGx1uupw@...&gt;\r\nReferences: &lt;CAA3E+eXqF6DNQc0r5Hekj1gE-PyBnvj4_TNbVgRUo+Eekxwhjw@...&gt;\n &lt;CAO_RykoJ1vQskNCkRyZbDiqSiUN__E8YaYzWssTEh7VGx1uupw@...&gt;\r\nDate: Wed, 6 Feb 2013 15:38:07 -0800\r\nMessage-ID: &lt;CAA3E+eW_Xqm61gPhzEN8PSp79aAjbAx1ZC3prZexc6vzGk8ukA@...&gt;\r\nTo: junit@yahoogroups.com\r\nX-Gm-Message-State: ALoCoQnmCVlLmJRt0IOK1CJitVP8cmpWXd15gr/Uf5dcldOG/QlcbJP7HWKffmNeEZ0G+IpPQY1KCjroRzdgmtTGO6/b4J8ZKHb6LHAqSr+Enx2a9C5zPa9tM5OGajW3vVFB3LtZyxQ75m+a2fZjCiAMgv7ozmJChJbK/M87SlCboO8zCitgcFVoIQW4CDAYeBznjwjam/rA\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: Kevin Cooney &lt;kcooney@...&gt;\r\nSubject: Re: [junit] Feedback requested: Impending changes to RunListener\r\nX-Yahoo-Group-Post: member; u=475263748; y=DBrHfvCVj5haCmZ4kpxXMM-bl4jGGq4VzI4QNhNi054badvQbwQOOCD4D_bRSh93PS3cHglg7_FjEEc\r\nX-Yahoo-Profile: kevincooney2000\r\nContent-Type: text/plain; charset=US-ASCII\r\nContent-Transfer-Encoding: 7bit\r\nX-eGroups-Approved-By: dsaff &lt;david@...&gt; via email; 6 Feb 2013 23:42:23 -0000\r\n\r\nCurrently the RunListener code stores the listeners in a synchronized list,\nand has a large synchronized block where it calls all of the listeners:\n\nhttps://github.com/junit-team/junit/blob/master/src/main/java/org/junit/runner/notification/RunNotifier.java#L54\n\n-- Kevin\n\nOn Wed, Feb 6, 2013 at 1:30 PM, Bill Venners &lt;bill@...&gt; wrote:\n\n&gt; Hi Kevin,\n&gt;\n&gt; Can you clarify what the performance issue was? Is the problem that you\n&gt; have events coming possibly in parallel via different threads, and you want\n&gt; to send them all to a user-specified RunListener? Because you don&#39;t know\n&gt; whether a RunListener is thread safe, currently you are serializing those\n&gt; events somehow that&#39;s slow?\n&gt;\n&gt; Bill\n&gt;\n&gt; On Wed, Feb 6, 2013 at 9:06 AM, Kevin Cooney &lt;kcooney@...&gt; wrote:\n&gt;\n&gt; &gt; **\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; Hello, everyone\n&gt; &gt;\n&gt; &gt; Short version: we are thinking of adding an optional dependency from\n&gt; JUnit\n&gt; &gt; to jcip-annotations and are soliciting feedback.\n&gt; &gt;\n&gt; &gt; A few people have noticed that when you use ParallelComputer, you got\n&gt; poor\n&gt; &gt; performance because calls to registered RunListeners are synchronized. We\n&gt; &gt; would like to fix this in the next release of JUnit.\n&gt; &gt;\n&gt; &gt; In order to prevent affecting existing users, we are proposing having an\n&gt; &gt; annotation that can be added to RunListener implementations that can\n&gt; safely\n&gt; &gt; be called concurrently from multiple threads. If a RunListener passed to\n&gt; a\n&gt; &gt; RunNotifier is not annotated with this annotation, JUnit will wrap it\n&gt; with\n&gt; &gt; a decorator that does synchronization.\n&gt; &gt;\n&gt; &gt; We would appreciate feedback on this new annotation.\n&gt; &gt;\n&gt; &gt; We have two options:\n&gt; &gt;\n&gt; &gt; a. Create our own annotation for this\n&gt; &gt; b. Use ThreadSafe (\n&gt; &gt;\n&gt; &gt;\n&gt; http://grepcode.com/file/repo1.maven.org/maven2/net.jcip/jcip-annotations/1.0/net/jcip/annotations/ThreadSafe.java\n&gt; &gt; )\n&gt; &gt;\n&gt; &gt; The advantages to option b are:\n&gt; &gt;\n&gt; &gt; 1. It&#39;s a well-known annotation\n&gt; &gt; 2. Users that use JUnit can add this annotation to their thread-safe\n&gt; &gt; RunListener implementations today and get the benefits &quot;for free&quot; later.\n&gt; &gt;\n&gt; &gt; Note we can do this without requiring that all users of JUnit have the\n&gt; &gt; jcip-annotations jar in their classpath as of JDK 1.5.0_06 (see\n&gt; &gt;\n&gt; &gt;\n&gt; http://stackoverflow.com/questions/3567413/why-doesnt-a-missing-annotation-cause-a-classnotfoundexception-at-runtime\n&gt; &gt; ).\n&gt; &gt; If jcip-annotations is not on the classpath then all RunListener\n&gt; &gt; implementations will be treated as not thread-safe.\n&gt; &gt;\n&gt; &gt; As a specific example, the Maven Surefire plugin would use this\n&gt; dependency\n&gt; &gt; and include jcip-annotations.\n&gt; &gt;\n&gt; &gt; Currently, JUnit only depends on one third-party library (Hamcrest). This\n&gt; &gt; has caused us some pain in the past when the Hamcrest code changed in\n&gt; ways\n&gt; &gt; that broke existing users of JUnit. We believe this will not be an issue\n&gt; &gt; with jcip-annotations because the JAR only contains annotations, not any\n&gt; &gt; code.\n&gt; &gt;\n&gt; &gt; One possible concern would be with other open source libraries that\n&gt; provide\n&gt; &gt; RunListener implementations (they would need to add jcip-annotations to\n&gt; &gt; their compile-time classpath if they have thread-safe annotations, and\n&gt; &gt; document this to their users).\n&gt; &gt;\n&gt; &gt; Thoughts?\n&gt; &gt;\n&gt; &gt; -- Kevin\n&gt; &gt;\n&gt; &gt; [Non-text portions of this message have been removed]\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt;\n&gt;\n&gt;\n&gt; --\n&gt; Bill Venners\n&gt; Artima, Inc.\n&gt; http://www.artima.com\n&gt;\n&gt;\n&gt; [Non-text portions of this message have been removed]\n&gt;\n&gt;\n&gt;\n&gt; ------------------------------------\n&gt;\n&gt; Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n&gt;\n\n\n[Non-text portions of this message have been removed]\n\n\n", 
    "profile": "kevincooney2000", 
    "topicId": 24274, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 475263748, 
    "prevInTime": 24279, 
    "contentTrasformed": false, 
    "postDate": "1360193887", 
    "canDelete": false, 
    "nextInTopic": 24282, 
    "prevInTopic": 24279, 
    "headers": {
        "inReplyToHeader": "PENBT19SeWtvSjF2UXNrTkNrUnlaYkRpcVNpVU5fX0U4WWFZeldzc1RFaDdWR3gxdXVwd0BtYWlsLmdtYWlsLmNvbT4=", 
        "messageIdInHeader": "PENBQTNFK2VXX1hxbTYxZ1BoekVOOFBTcDc5YUFqYkF4MVpDM3ByWmV4YzZ2ekdrOHVrQUBtYWlsLmdtYWlsLmNvbT4=", 
        "referencesHeader": "PENBQTNFK2VYcUY2RE5RYzByNUhla2oxZ0UtUHlCbnZqNF9UTmJWZ1JVbytFZWt4d2hqd0BtYWlsLmdtYWlsLmNvbT4gPENBT19SeWtvSjF2UXNrTkNrUnlaYkRpcVNpVU5fX0U4WWFZeldzc1RFaDdWR3gxdXVwd0BtYWlsLmdtYWlsLmNvbT4="
    }
}