{
    "numMessagesInTopic": 3, 
    "nextInTime": 15903, 
    "senderId": "DeE4dO-bCP4LpjikCpiJaM_bWF9VBmjpoKpOIF9Zrofezb3yDB-2YnEc_HDGA_g1Yb5uhzHcxNgKswOnuqlJedCq06Zf", 
    "systemMessage": true, 
    "subject": "junit 3.8 Test/TestResult interaction - reality check", 
    "from": "Ian Darwin &lt;ian@...&gt;", 
    "authorName": "Ian Darwin", 
    "msgSnippet": "I m trying to write a test runner for a new subframework that will read an arbitrary number of tests from a little language scripting file, and I m trying ", 
    "msgId": 15902, 
    "topicId": 15902, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 23529957, 
    "messageBody": "<div id=\"ygrps-yiv-509003708\">I&#39;m trying to write a test runner for a new &quot;subframework&quot; that will <br/>\nread an arbitrary<br/>\nnumber of tests from a &quot;little language&quot; scripting file, and I&#39;m trying <br/>\nto write this as a Test class<br/>\n(my framework will be released as open source when it is working).<br/>\n<br/>\nI started with the assumption that if the framework calls a Test&#39;s <br/>\ncountTestCases<br/>\nit will next call its run() method once and let it run all the tests, <br/>\nand that it expects the<br/>\ntest to call results.startTest(this) and endTest(this).  So this is a <br/>\ngloss of my test: is this<br/>\nat all the right approach?<br/>\n<br/>\n// DO NOT JUST COPY THIS CODE, IT DOES NOT WORK YET<br/>\npublic class MyTest implements Test {<br/>\n<br/>\n        private String name = &quot;TestRunner&quot;;<br/>\n        final static int MAX = 10;<br/>\n<br/>\n        public int countTestCases() {<br/>\n                return MAX;<br/>\n        }<br/>\n        public void run(TestResult result) {<br/>\n                System.out.printf(&quot;MyTest.run(%s)%n&quot;, this);<br/>\n                for (int i = 0; i &lt; MAX; i++) {<br/>\n                        if (result.shouldStop())<br/>\n                                return;<br/>\n                        // Do Nothing Slowly(tm), to simulate reading a <br/>\ntest from the file<br/>\n                        // and running it...<br/>\n                        try {    <br/>\n                                Thread.sleep(250);   // so I can see the <br/>\ngauge moving...<br/>\n                        } catch (InterruptedException e) {<br/>\n                        }<br/>\n                       <br/>\n                        result.startTest(this);<br/>\n<br/>\n                        if (i == 6) {<br/>\n                                System.out.println(&quot;ADDING FAILURE&quot;);<br/>\n                                result.addFailure(this,<br/>\n                                    new AssertionFailedError(&quot;boo hoo&quot;));<br/>\n                        } else {<br/>\n                                if (i == 9) {<br/>\n                                        result.addError(this,<br/>\n                                    new RuntimeException(&quot;wah&quot;));<br/>\n                                }<br/>\n                        }<br/>\n                        result.endTest(this);<br/>\n                }<br/>\n        }<br/>\n<br/>\n<br/>\nI looked around and couldn&#39;t find commentary describing if I am doing <br/>\nthis correctly, but<br/>\ntextui.TextRunner.doRun would appear to confirm that I am not violating <br/>\nany assumptions.<br/>\n<br/>\nWhen I run this under e.g., the Eclipse testrunner, the gauge moves, and <br/>\nturns red at the<br/>\nexpected time, but the Failure is replicated through all remaining <br/>\ninvocations of that Test.<br/>\nThe default testresult implementation adds smth like &quot;new <br/>\nTestFailure(test, exc)&quot; to a<br/>\nVector, so the non-uniqueness problem seems to be rooted deeper down.<br/>\n<br/>\nAs well, clicking on a failure itself results in a popup about test <br/>\nclass not found in project.<br/>\n<br/>\nMore detailed code is attached in case anyone has time to look. Or wants <br/>\nto play.<br/>\n<br/>\nThanks<br/>\nIan Darwin<br/>\n<br/>\n<br/>\n  ----------<br/>\n<br/>\npackage regress;<br/>\n<br/>\nimport junit.framework.Test;<br/>\nimport junit.framework.TestSuite;<br/>\n<br/>\npublic class AllTests {<br/>\n<br/>\n\tpublic static Test suite() {<br/>\n\t\tTestSuite suite = new TestSuite(&quot;Test for default package&quot;);<br/>\n\t\t//$JUnit-BEGIN$<br/>\n\t\tsuite.addTest(new MyTest(&quot;one&quot;));<br/>\n\t\tsuite.addTest(new MyTest(&quot;Two&quot;));<br/>\n\t\t//$JUnit-END$<br/>\n\t\treturn suite;<br/>\n\t}<br/>\n<br/>\n}<br/>\n<br/>\n<br/>\n  ----------<br/>\n<br/>\npackage regress;<br/>\n<br/>\nimport junit.framework.AssertionFailedError;<br/>\nimport junit.framework.Test;<br/>\nimport junit.framework.TestResult;<br/>\n<br/>\n/**<br/>\n * Skeleton for how pageunit will run multiple testcases from<br/>\n * within one Test class. Thanks for Jonathan Fuerth of sqlpower.ca<br/>\n * for the idea on how to set this up.<br/>\n * &lt;br/&gt;<br/>\n * In this version it sort of works, but:<br/>\n * &lt;br/&gt;Once a test has failed, subsequent tests report the same failure;<br/>\n * &lt;br/&gt;Clicking on the failures pops up a dialog about &quot;test class not<br/>\n * found in project...&quot;<br/>\n * @author Ian Darwin<br/>\n */<br/>\npublic class MyTest implements Test {<br/>\n\t<br/>\n\tprivate String name = &quot;TestRunner&quot;;<br/>\n\tfinal static int MAX = 10;<br/>\n\tpublic MyTest(String name) {<br/>\n\t\tthis.name=name;<br/>\n\t\tSystem.out.printf(&quot;MyTest.MyTest(%s)%n&quot;, name);<br/>\n\t}<br/>\n\tpublic MyTest() {<br/>\n\t\tthis(&quot;NoName&quot;);<br/>\n\t}<br/>\n\tpublic int countTestCases() {<br/>\n\t\treturn MAX;<br/>\n\t}<br/>\n\tint i = 0;<br/>\n\tpublic void run(TestResult result) {<br/>\n\t\tSystem.out.printf(&quot;MyTest.run(%s)%n&quot;, this);<br/>\n\t\tfor (; i &lt; MAX; i++) {<br/>\n\t\t\tif (result.shouldStop())<br/>\n\t\t\t\treturn;<br/>\n\t\t\tSystem.out.println(&quot;MyTest.run(), i = &quot; + i);<br/>\n\t\t\ttry {<br/>\n\t\t\t\tThread.sleep(250);<br/>\n\t\t\t} catch (InterruptedException e) {<br/>\n\t\t\t\t// canthappen<br/>\n\t\t\t}<br/>\n\t\t\tSystem.out.println(&quot;MyTest.run(): start test&quot;);<br/>\n\t\t\tresult.startTest(this);<br/>\n\t\t\t<br/>\n\t\t\tif (i == 6) {<br/>\n\t\t\t\tSystem.out.println(&quot;ADDING FAILURE&quot;);<br/>\n\t\t\t\tresult.addFailure(this, new AssertionFailedError(&quot;boo hoo&quot;));<br/>\n\t\t\t} else {<br/>\n\t\t\t\tif (i == 9) {<br/>\n\t\t\t\t\tresult.addError(this, new RuntimeException(&quot;wah&quot;));<br/>\n\t\t\t\t}<br/>\n\t\t\t}<br/>\n\t\t\tresult.endTest(this);<br/>\n\t\t}<br/>\n\t}<br/>\n\t<br/>\n\t@Override<br/>\n\tpublic String toString() {<br/>\n\t\treturn getName();<br/>\n\t}<br/>\n\tpublic String getName() {<br/>\n\t\treturn name + i;<br/>\n\t}<br/>\n}<br/>\n<br/>\n<br/>\n<br/>\n[Non-text portions of this message have been removed]</div>", 
    "prevInTime": 15901, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1138730623", 
    "canDelete": false, 
    "nextInTopic": 15906, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PDQzREZBNjdGLjUwODA1MDhAZGFyd2luc3lzLmNvbT4="
    }
}