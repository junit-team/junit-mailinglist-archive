{
    "numMessagesInTopic": 21, 
    "nextInTime": 20530, 
    "senderId": "QHAwMngDOwPfYK6h0fbuKLsujF92zJGNfc8IKCX7B_adL0ThUgQRVQ5942qulnLIOTaMVeBmuFCVDmFWVlfMkOGkYcpDEjdc", 
    "systemMessage": false, 
    "subject": "RE: [junit] Re: What is expected behavior on Assert.assertEquals on Number object?", 
    "from": "&quot;Kent Beck&quot; &lt;kentb@...&gt;", 
    "authorName": "Kent Beck", 
    "msgSnippet": "Nattapong, The situation is confusing. AssertEquals() started out just using equals(). Then people were surprised by this behavior for a variety of special", 
    "msgId": 20529, 
    "rawEmail": "Return-Path: &lt;kentb@...&gt;\r\nX-Sender: kentb@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 19179 invoked from network); 9 Jun 2008 16:46:55 -0000\r\nX-Received: from unknown (66.218.67.97)\n  by m36.grp.scd.yahoo.com with QMQP; 9 Jun 2008 16:46:55 -0000\r\nX-Received: from unknown (HELO elasmtp-curtail.atl.sa.earthlink.net) (209.86.89.64)\n  by mta18.grp.scd.yahoo.com with SMTP; 9 Jun 2008 16:46:54 -0000\r\nX-Received: from [65.100.6.133] (helo=kentspavilion)\n\tby elasmtp-curtail.atl.sa.earthlink.net with esmtpa (Exim 4.67)\n\t(envelope-from &lt;kentb@...&gt;)\n\tid 1K5kWC-0005LU-31\n\tfor junit@yahoogroups.com; Mon, 09 Jun 2008 12:46:54 -0400\r\nTo: &lt;junit@yahoogroups.com&gt;\r\nReferences: &lt;g29c4l+mgfo@...&gt; &lt;OFF0F85730.9CF821E9-ON47257460.00187669-47257460.00190AF7@...&gt;\r\nDate: Mon, 9 Jun 2008 09:46:31 -0700\r\nMessage-ID: &lt;007601c8ca50$5fe114c0$4000a8c0@kentspavilion&gt;\r\nMIME-Version: 1.0\r\nX-Mailer: Microsoft Office Outlook 11\r\nX-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198\r\nIn-Reply-To: &lt;OFF0F85730.9CF821E9-ON47257460.00187669-47257460.00190AF7@...&gt;\r\nthread-index: AcjHx/TTwXz6Ju8vQb2488mzASjJjgCgFCaw\r\nX-ELNK-Trace: 6d780abf06d998e474bf435c0eb9d4780182ff3a4749f0d948f2c63c8797870ed7172146da887e01350badd9bab72f9c350badd9bab72f9c350badd9bab72f9c\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: &quot;Kent Beck&quot; &lt;kentb@...&gt;\r\nSubject: RE: [junit] Re: What is expected behavior on Assert.assertEquals on Number object?\r\nX-Yahoo-Group-Post: member; u=173198504; y=DevII5B6HT_MNHfwpHrrdinhCQqDFtWjD4Huk1_tC-XYyDDU\r\nX-Yahoo-Profile: kentlbeck\r\nContent-Type: text/plain; charset=US-ASCII\r\nContent-Transfer-Encoding: 7bit\r\n\r\nNattapong,\n \nThe situation is confusing. AssertEquals() started out just using equals().\nThen people were surprised by this behavior for a variety of special cases,\nso we started making assertEquals() smarter. Then people were surprised by\nthis behavior for a variety of special cases (strange how that works\nout...), so we&#39;ve gone back to simpler behavior for assertEquals. Special\ncases were handled by special assertions, like assertArrayEquals(). In\nfuture, they will be handled using special Matchers and assertThat().\n \nRegards,\n \nKent Beck\nThree Rivers Institute\n\n  _____  \n\nFrom: junit@yahoogroups.com [mailto:junit@yahoogroups.com] On Behalf Of\nNattapong Sirilappanich\nSent: Thursday, June 05, 2008 9:35 PM\nTo: junit@yahoogroups.com\nCc: Suwit Srivilairith\nSubject: Re: [junit] Re: What is expected behavior on Assert.assertEquals on\nNumber object?\n\n\n\n\n\nActually, my point here is i&#39;m expecting\norg.junit.Assert.assertEquals(Object obj1, Object obj2) to call its\nobj1.equals(obj2) or something like this.\nHowever, the outcome surprise me.\nAssertion success but obj1.equals(obj2) return false.\n\nWhat&#39;s going on inside assertEquals() operation?\nIs this what it&#39;s suppose to be?\n\nBest regards,\nNattapong Sirilappanich\nEngineer, National Language Development - GCoC & TSC Thailand\nSoftware Group, IBM Thailand Co., Ltd.\nNational Phone: 02-273-4715, Fax: 02-619-2030\nInternational Phone: +66 2 273 4715, Fax: +66 2 619 2030\ne-mail: natta@.... &lt;mailto:natta%40th.ibm.com&gt; com\n\n&quot;Roger Glover&quot; \n&lt;glover_roger@yah \noo.com&gt; To \nSent by: junit@yahoogroups. &lt;mailto:junit%40yahoogroups.com&gt; com \njunit@yahoogroups cc \n.com \nSubject \n[junit] Re: What is expected \n06/06/2008 01:43 behavior on Assert.assertEquals on \nNumber object? \n\nPlease respond to \njunit@yahoogroups \n.com \n\n\n\n--- In junit@yahoogroups. &lt;mailto:junit%40yahoogroups.com&gt; com, &quot;J. B.\nRainsberger&quot; &lt;jbrains762@...&gt; \nwrote: \nOn Jun 3, 2008, at 22:41 , Nattapong Sirilappanich wrote: \nHi, \n\nWhen i try to make an assertion on Number object, e.g. Double the \nresult always assertion successful. Even i try to compare by \n\norg.junit.Assert.assertEquals(123456789.345,123456789.34) \n\nit still success. (I&#39;m expecting failure) \nThis is not a good way to compare floating point numbers. You should \nactually use: \n\nAssert.assertEquals(expected, actual, delta) \n\nwhere expected and actual are as in the form you did use, but there is a \nthird &quot;delta&quot; argument (also a double). This argument provides a \ntolerance value by which to judge &quot;equality&quot;. basically the assertion \nfails if: \n\nMath.abs(expected - actual) &gt; delta \n\nThus, working from your failing example: \n\nAssert.assertEquals(123456789.345, 123456789.34, 0.5); // PASS \nAssert.assertEquals(123456789.345, 123456789.34, 0.0005); // FAIL \n\nBy the way, this usage really makes the name of the method a misnomer. \nIt should really be called &quot;assertClose&quot; (as in &quot;close, but no cigar&quot;, \nnot &quot;close the door; it&#39;s cold&quot;). But that should be okay if you are \nusing double the way it is meant to be used, because, as the old saying \ngoes, close only counts in horseshoes, hand grenades, and limited \nprecision floating point operations. \n\nIn other words, the idea is that after even a few operations (or even \nafter none in some cases) it is unreasonable to expect floating point \nquantities to be exactly equal to their unlimited precision real number \ncounterparts (even when an exact match exists). So you aim for &quot;close&quot; \ninstead. &quot;How close can you get&quot; is itself a black art that combines \nroughly equal portions of operation counting, number magnitude tracking, \noperation order tracking, and wild-ass guessing. \n\nNow back to the problem at hand. Just for grins I compiled Nattapong&#39;s \noriginal assert under a J2SE 1.4 compiler and it gave a syntax error, \nsaying that essentially that the third double argument was missing. It \nappears that this is one of those rare-but-not-rare-enough cases when \nautoboxing is actually working against you. \n\nAnd now J.B.&#39;s response... \nWeird. assertEquals() appears only to compare the whole parts. \n\npublic class DoubleTest { \n@Test \npublic void unequalDoubleValueObjectsShouldBeUnequal() { \nAssert.assertFalse(new Double(3).equals(new Double(4))); \nAssert.assertFalse(new Double(3.1d).equals(new Double(3.2d))); \nAssert.assertFalse(new Double(123456789.345d).equals(new \nDouble(123456789.34d))); \nSo far so good... \nAssert.assertEquals(new Double(123456789.345d), new \nDouble(123456789.34d)); \nWhen compiled under J2SE 1.4 the above assertEquals() fails. So, once \nagain, I suspect autoboxing is the culprit. In this case I suspect the \nDoubles are being &quot;unboxed&quot; into longs, since there is a two-long \nassertEquals() but not a two-double assertEquals(). \nAssert.assertEquals(new Double(3.1d), new Double(3.2d)); \nSame with the above. \nAssert.assertEquals(new Double(3), new Double(4)); \nSame with the above, but if I am right this one fails (as J.B. noted) \nbecause the \nintegral parts are different, so you get different longs. \n} \n} \n\nOnly the last assertion fails. \nThis behavior makes me wonder if in Nattapong&#39;s original case the \nprimitive doubles are being boxed into object Doubles which are, in \nturn, being unboxed into primitive longs. If that is not what is \nhappening, something even stranger is going on. Either way, I don&#39;t like \nit. \n\n-- Roger Glover \nObject Partners, Inc. \n\n[Non-text portions of this message have been removed] \n\n\n\n\n\n[Non-text portions of this message have been removed]\n\n\n\n \n\n\n[Non-text portions of this message have been removed]\n\n\n", 
    "profile": "kentlbeck", 
    "topicId": 20513, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 173198504, 
    "prevInTime": 20528, 
    "contentTrasformed": false, 
    "postDate": "1213029991", 
    "canDelete": false, 
    "nextInTopic": 20530, 
    "prevInTopic": 20527, 
    "headers": {
        "inReplyToHeader": "PE9GRjBGODU3MzAuOUNGODIxRTktT040NzI1NzQ2MC4wMDE4NzY2OS00NzI1NzQ2MC4wMDE5MEFGN0B0aC5pYm0uY29tPg==", 
        "messageIdInHeader": "PDAwNzYwMWM4Y2E1MCQ1ZmUxMTRjMCQ0MDAwYThjMEBrZW50c3BhdmlsaW9uPg==", 
        "referencesHeader": "PGcyOWM0bCttZ2ZvQGVHcm91cHMuY29tPiA8T0ZGMEY4NTczMC45Q0Y4MjFFOS1PTjQ3MjU3NDYwLjAwMTg3NjY5LTQ3MjU3NDYwLjAwMTkwQUY3QHRoLmlibS5jb20+"
    }
}