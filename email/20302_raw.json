{
    "numMessagesInTopic": 2, 
    "nextInTime": 20303, 
    "senderId": "lVmKLhZsDjENV3l5F6Y1dy7LZTbmNqj7LrAvzcpDugk9swXmg_TgYoWu76xiGNXgSk-QsiYI6Zlo-ILI3lUv6vNzGRUiWD771yrgoGo", 
    "systemMessage": true, 
    "subject": "Re: Regarding &quot;Annotated descriptions&quot; of new improvements in version 4.4", 
    "from": "&quot;Francesco&quot; &lt;won_espylacopa@...&gt;", 
    "authorName": "Francesco", 
    "msgSnippet": "... Well, in the meanwhile I solved my needs picking directly the source code of the Ant JUnit task and patching :p So if my little patch solution can be", 
    "msgId": 20302, 
    "rawEmail": "Return-Path: &lt;won_espylacopa@...&gt;\r\nReceived: (qmail 36798 invoked from network); 8 Feb 2008 12:46:28 -0000\r\nReceived: from unknown (66.218.67.95)\n  by m42.grp.scd.yahoo.com with QMQP; 8 Feb 2008 12:46:28 -0000\r\nReceived: from unknown (HELO n53a.bullet.mail.sp1.yahoo.com) (66.163.168.147)\n  by mta16.grp.scd.yahoo.com with SMTP; 8 Feb 2008 12:46:28 -0000\r\nReceived: from [216.252.122.217] by n53.bullet.mail.sp1.yahoo.com with NNFMP; 08 Feb 2008 12:46:28 -0000\r\nReceived: from [66.218.69.4] by t2.bullet.sp1.yahoo.com with NNFMP; 08 Feb 2008 12:46:27 -0000\r\nReceived: from [66.218.66.86] by t4.bullet.scd.yahoo.com with NNFMP; 08 Feb 2008 12:46:27 -0000\r\nX-Sender: won_espylacopa@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 29795 invoked from network); 8 Feb 2008 07:18:42 -0000\r\nX-Received: from unknown (66.218.67.96)\n  by m55.grp.scd.yahoo.com with QMQP; 8 Feb 2008 07:18:42 -0000\r\nX-Received: from unknown (HELO n50d.bullet.mail.sp1.yahoo.com) (66.163.169.48)\n  by mta17.grp.scd.yahoo.com with SMTP; 8 Feb 2008 07:18:42 -0000\r\nX-Received: from [216.252.122.217] by n50.bullet.mail.sp1.yahoo.com with NNFMP; 08 Feb 2008 07:18:39 -0000\r\nX-Received: from [66.218.69.5] by t2.bullet.sp1.yahoo.com with NNFMP; 08 Feb 2008 07:18:39 -0000\r\nX-Received: from [66.218.66.79] by t5.bullet.scd.yahoo.com with NNFMP; 08 Feb 2008 07:18:39 -0000\r\nDate: Fri, 08 Feb 2008 07:18:38 -0000\r\nTo: junit@yahoogroups.com\r\nMessage-ID: &lt;fogvof+c3fq@...&gt;\r\nIn-Reply-To: &lt;fog30g+2efe@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-system\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: &quot;Francesco&quot; &lt;won_espylacopa@...&gt;\r\nSubject: Re: Regarding &quot;Annotated descriptions&quot; of new improvements in version 4.4\r\nX-Yahoo-Group-Post: member; u=108575068; y=4z3I5vnakU13wkezaMecnpMEH97EnsTDZQuwCvqgEXA9ZtdX0BNBYTI\r\nX-Yahoo-Profile: won_espylacopa\r\nX-eGroups-Approved-By: spchappell &lt;simonpeterchappell@...&gt; via web; 08 Feb 2008 12:46:27 -0000\r\n\r\n--- In junit@yahoogroups.com, &quot;Francesco&quot; &lt;won_espylacopa@...&gt; wrote:\n&gt;\n&gt; H=\r\nello Everyone,\n&gt; \n&gt; I am interested if the &quot;annotated description&quot; feature =\r\ncan get the\n&gt; javadoc method description and adding a textual description t=\r\no its\n&gt; relative generated report. Please can you point me on the right doc=\r\n or\n&gt; give me some sample of this new improvement usage?\n&gt; \n&gt; Thank You\n&gt;\n\n=\r\nWell, in the meanwhile I solved my needs picking directly the source\ncode o=\r\nf the Ant JUnit task and patching :p\n\nSo if my little patch solution can be=\r\n useful for other newbies like\nme, I put here my solution as simple sample.=\r\n Serious disclaimer: pick\nand use it but don&#39;t claim any nuclear disaster :=\r\n) \n\n\n*** As note for who can help me, I noticed that a nice thing which I\nc=\r\nould do, would be to pick directly the test info content directly\nfrom the =\r\nsource javadoc code method, but I am still searching the\nright way to do it=\r\n :), anyone could point me into the right direction?\nThanks :) ***\n\n\nHoweve=\r\nr, here It follows all steps to print out a title and a description:\n\n1) do=\r\nwnload last Ant sources and unpack it, then find XMLConstants,\nJUnitVersion=\r\nHelper, XMLJUnitResultFormatter classes and modify them as\nthe followings\n\n=\r\n=3D=3D=3Dorg.apache.tools.ant.taskdefs.optional.junit.XMLConstants=3D=3D=3D=\r\n\n+++&gt;\n\n[...]\n\n    /**\n     * title attribute for testcase element\n     * @a=\r\nuthor rigel alias zetatau \n     * TODO:\n     */\n    String ATTR_TITLE =3D &quot;=\r\ntitle&quot;;\n\n    /**\n     * desc attribute for testcase element\n     * @author =\r\nrigel alias zetatau \n     * TODO:\n     */\n    String ATTR_DESC =3D &quot;desc&quot;;\n=\r\n\n[...]\n\n&lt;+++ \n\n\n=3D=3D=3Dorg.apache.tools.ant.taskdefs.optional.junit.JUnit=\r\nVersionHelper=3D=3D=3D\n+++&gt;\n\n[...]\n\npublic static String getTestCaseTitle(T=\r\nest test, String\nannotationMatch, String annotationParameter) {\n    if (tes=\r\nt !=3D null) {\n    \tif (test.getClass().getName().equals(JUNIT_TESTFACADE))=\r\n\n\t\t\treturn\nhelperMethodInvoke(test,annotationMatch,annotationParameter,UNKN=\r\nOWN);\n    \telse\n\t\t\treturn &quot;&quot;;\n    }\n\treturn UNKNOWN;\n}\n\npublic static Strin=\r\ng getTestCaseDesc(Test test, String\nannotationMatch, String annotationParam=\r\neter) {\n    if (test !=3D null) {\n    \tif (test.getClass().getName().equals=\r\n(JUNIT_TESTFACADE))\n\t\t\treturn\nhelperMethodInvoke(test,annotationMatch,annot=\r\nationParameter,UNKNOWN);\n\t\telse\n\t\t\treturn &quot;&quot;;\n    }\n\treturn UNKNOWN;\n}\n\n\npr=\r\nivate static Iterator helperDescriptorCollection(Test facade) {\n\tfinal Stri=\r\nng \n\t\tjunitDescription=3D&quot;org.junit.runner.Description&quot;,\n\t\tmethodOnFacade=\r\n=3D&quot;getDescription&quot;,\n\t\tmethodOnItem=3D&quot;getAnnotations&quot;;\n\t\t\t\n\tArrayList empt=\r\ny =3D new ArrayList();\n\tif (!facade.getClass().getName().equals(JUNIT_TESTF=\r\nACADE))\n\t\treturn empty.iterator();\n\ttry {\n\t\nClass.forName(junitDescription,=\r\nfalse,ClassLoader.getSystemClassLoader());\n\t\t\t// otherwise throw an excepti=\r\non\n\t\tMethod m =3D facade.getClass().getMethod(methodOnFacade, new Class[0])=\r\n;\n\t\tObject itemInstance =3D m.invoke(facade, new Object[0]);\n\t\tif\n(itemInst=\r\nance!=3Dnull&&junitDescription.equals(itemInstance.getClass().getName())){\n=\r\n\t\t\tMethod m1 =3D itemInstance.getClass().getMethod(methodOnItem, new\nClass[=\r\n0]);\n\t\t\tObject rtObj =3D m1.invoke(itemInstance, new Object[0]);\n\t\t\tif (rtO=\r\nbj instanceof Collection)\n\t\t\t\treturn ((Collection)rtObj).iterator();\n\t\t\tret=\r\nurn empty.iterator();\n\t\t} else return empty.iterator();\n\t} catch (ClassNotF=\r\noundException e) {\n\t} catch (SecurityException e) {\n\t} catch (IllegalArgume=\r\nntException e) {\n\t} catch (NoSuchMethodException e) {\n\t} catch (IllegalAcce=\r\nssException e) {\n\t} catch (InvocationTargetException e) {\n\t}\n\treturn empty.=\r\niterator();\n}\n\nprivate static Object helperAnnotation(Test fa=C3=A7ade, Str=\r\ning\nannotationMatch) {\n\tfinal String methodOnAnnotation=3D&quot;annotationType&quot;;=\r\n\n\tObject item=3Dnull;\n\tIterator it =3D helperDescriptorCollection(fa=C3=A7a=\r\nde);\n\twhile (it.hasNext()) {\n\t\tObject a =3D (Object)it.next();\n\t\tString mat=\r\nch =3D &quot;&quot;;\n\t\ttry {\n\t\t\tMethod m =3D a.getClass().getMethod(methodOnAnnotatio=\r\nn, new Class[0]);\n\t\t\tClass out =3D (Class)m.invoke(a, new Object[0]);\n\t\t\tma=\r\ntch=3DString.valueOf(out.getName());\n\t\t} catch (SecurityException e) {\n\t\t} =\r\ncatch (NoSuchMethodException e) {\n\t\t} catch (IllegalArgumentException e) {\n=\r\n\t\t} catch (IllegalAccessException e) {\n\t\t} catch (InvocationTargetException=\r\n e) {\n\t\t}\n\t\tif (annotationMatch.equals(match)) {\n\t\t\titem=3Da;\n\t\t\tbreak;\n\t\t}=\r\n\n\t}\n\treturn item;\n}\n\nprivate static String helperMethodInvoke(Test instance=\r\n, String\nannotationMatch, String methodName, String defaultValue) {\n\ttry {\n=\r\n// ANNOTATIONS WORKS ONLY ABOVE JDK 1.5\n//\t\t\tIterator it =3D\n((junit.framew=\r\nork.JUnit4TestCaseFacade)instance).getDescription().getAnnotations().iterat=\r\nor();\n//\t\t\tjava.lang.annotation.Annotation item=3Dnull;\n//    \t\twhile (it.h=\r\nasNext()) {\n//    \t\t\tjava.lang.annotation.Annotation a =3D\n(java.lang.annot=\r\nation.Annotation)it.next();\n//    \t\t\tif (annotationMatch.equals(a.annotatio=\r\nnType().getName())) {\n//    \t\t\t\titem=3Da;\n//    \t\t\t\tbreak;\n//    \t\t\t}\n//   =\r\n \t\t}\n\t\tObject item =3D helperAnnotation(instance, annotationMatch);\n\t\t/* No=\r\n appropriate annotation was found so returns defaultValue */\n\t\tif (item=3D=\r\n=3Dnull)\n\t\t\treturn defaultValue;\n\t\t\n\t\tMethod m =3D item.getClass().getMetho=\r\nd(methodName, new Class[0]);\n\t\tObject oOut =3D m.invoke(item, new Object[0]=\r\n);\n\t\tif (oOut instanceof String) {\n\t\t\tString sOut =3D String.valueOf(oOut);=\r\n\n\t\t\tif (&quot;&quot;.equals(sOut)||sOut=3D=3Dnull)\n\t\t\t\treturn defaultValue;\n\t\t\telse\n\t=\r\n\t\t\treturn sOut;\n\t\t} else {\n\t\t\treturn defaultValue;\n\t\t}\n\t} catch (SecurityEx=\r\nception e) {\n\t} catch (IllegalArgumentException e) {\n\t} catch (NoSuchMethod=\r\nException e) {\n\t} catch (IllegalAccessException e) {\n\t} catch (InvocationTa=\r\nrgetException e) {\n\t}\n\treturn defaultValue;\n}\n\n\n[...]\n\n&lt;+++\n\n\n\n=3D=3D=3Dorg=\r\n.apache.tools.ant.taskdefs.optional.junit.XMLJUnitResultFormatter=3D=3D=3D\n=\r\n+++&gt;\npublic void endTest(Test test) {\n\n[...]\n\n/* \n * This adds additional i=\r\nnfo to the generated XML test case data,\nunfortunately I don&#39;t\n * know what=\r\n ant helper class can give me some params from XML build,\n */\nString sTitle=\r\n =3D\nJUnitVersionHelper.getTestCaseTitle(test,&quot;test.TestInfo&quot;,&quot;title&quot;);\nStr=\r\ning sDesc =3D\nJUnitVersionHelper.getTestCaseDesc(test,&quot;test.TestInfo&quot;,&quot;desc=\r\n&quot;);\ncurrentTest.setAttribute(ATTR_TITLE,UNKNOWN.equals(sTitle) ? &quot;&quot; : sTitl=\r\ne);\ncurrentTest.setAttribute(ATTR_DESC,UNKNOWN.equals(sDesc) ? &quot;&quot; : sDesc);=\r\n\n\n}\n\n[...]\n\n&lt;+++ \n\n\n2) Now build all Ant sources and replace in your defaul=\r\nt Ant library\nenvironment the old &quot;ant-junit.jar&quot; with the new one. \n\n\n3) N=\r\now you can create an annotation class like this, the name is\nimportant beca=\r\nuse in the previous class &quot;XMLJUnitResultFormatter&quot; is\nliterally wired as &quot;=\r\ntest.TestInfo&quot;, and if you found a way to retrieve\neasily params from build=\r\n.xml it could be easily parameterized:\n\n=3D=3D=3Dtest.TestInfo=3D=3D=3D\n\n=\r\n=3D=3D=3D&gt;\npackage test;\n\nimport java.lang.annotation.ElementType;\nimport j=\r\nava.lang.annotation.Retention;\nimport java.lang.annotation.RetentionPolicy;=\r\n\nimport java.lang.annotation.Target;\n\n/**\n *\n * @author rigel alias zetatau=\r\n\n *\n */\n@Retention(RetentionPolicy.RUNTIME)\n@Target({ElementType.METHOD})\np=\r\nublic @interface TestInfo {\n\t/**\n\t * Optionally specify test &lt;code&gt;title&lt;/c=\r\node&gt;\n\t */\n\tpublic String title() default &quot;Default test title&quot;;\n\n\t/**\n\t * Op=\r\ntionally specify test &lt;code&gt;description&lt;/code&gt;\n\t */\n\tpublic String desc() d=\r\nefault &quot;Default test description&quot;;\n\t\n\t/**\n\t * Optionally specify test &lt;code=\r\n&gt;error message descriptor&lt;/code&gt;\n\t */\n\tpublic String errorMessage() default=\r\n &quot;Default error message descriptor&quot;;\n\t  \n}\n&lt;=3D=3D=3D\n\n\n4) Last step is you=\r\nr class under test, add a TestInfo annotation and\nit&#39;s all done for the XML=\r\n testcase data generation (apart xml dtd\nanother step would be to patch the=\r\n junit-frames.xsl to show your new\nattributes):\n\n=3D=3D=3DSomeClassUnderTes=\r\nt=3D=3D=3D\n\n+++&gt;\n\n[...]\n\t/** \n\t * This test probes if a null argument cause=\r\ns a NPE\n\t * @... \n\t */\n\t@Test(expected=3DNullPointerException.c=\r\nlass)\n\t@TestInfo(title=3D&quot;Null argument&quot;,\n\t\t\t\tdesc=3D&quot;This test probes if a=\r\n null argument causes a NPE&quot;)\n\tpublic final void beginTest1() {\n\t\t[...]\n\t}\n=\r\n\n[...]\n\n&lt;+++\n\n\n\n-- \nFrancesco V.\n\n\n", 
    "profile": "won_espylacopa", 
    "topicId": 20301, 
    "spamInfo": {
        "reason": "6", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 108575068, 
    "prevInTime": 20301, 
    "contentTrasformed": false, 
    "postDate": "1202455118", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 20301, 
    "headers": {
        "inReplyToHeader": "PGZvZzMwZysyZWZlQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PGZvZ3ZvZitjM2ZxQGVHcm91cHMuY29tPg=="
    }
}