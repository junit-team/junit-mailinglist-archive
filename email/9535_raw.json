{
    "numMessagesInTopic": 40, 
    "nextInTime": 9536, 
    "senderId": "FSZz6TEubkFLpU14OKKf-BLg6bD18XDKVVKtQbINRIQsVByzY7tNUHuqCBjO803md1ONG3-0bir_NnnXr_V4g2At2L244YrI9Pbuy_tbF2k", 
    "systemMessage": false, 
    "subject": "Re: [junit] Re: Recursive TestRunner -- one implementation", 
    "from": "&quot;Neil Swingler&quot; &lt;neil@...&gt;", 
    "authorName": "Neil Swingler", 
    "msgSnippet": "... From: Jeff Grigg  ... Jeff, did you see my submission in the files section, using javassist to insert imposter mock classes using", 
    "msgId": 9535, 
    "rawEmail": "Return-Path: &lt;neil@...&gt;\r\nX-Sender: neil@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 89520 invoked from network); 28 Sep 2003 21:49:51 -0000\r\nReceived: from unknown (66.218.66.218)\n  by m15.grp.scd.yahoo.com with QMQP; 28 Sep 2003 21:49:51 -0000\r\nReceived: from unknown (HELO neil.swingler.name) (80.218.74.33)\n  by mta3.grp.scd.yahoo.com with SMTP; 28 Sep 2003 21:49:50 -0000\r\nReceived: from Spooler by neil.swingler.name (Mercury/32 v3.31) ID MO000020;\n    28 Sep 03 23:49:50 +0200\r\nReceived: from spooler by neil.swingler.name (Mercury/32 v3.31); 28 Sep 03 23:49:39 +0200\r\nReceived: from notebook (192.168.2.101) by neil.swingler.name (Mercury/32 v3.31) ID MG00001F;\n   28 Sep 03 23:49:31 +0200\r\nMessage-ID: &lt;002b01c3860a$621564b0$6502a8c0@notebook&gt;\r\nTo: &lt;junit@yahoogroups.com&gt;\r\nReferences: &lt;bl5cfk+pc9c@...&gt;\r\nSubject: Re: [junit] Re: Recursive TestRunner -- one implementation\r\nDate: Sun, 28 Sep 2003 23:49:24 +0200\r\nMIME-Version: 1.0\r\nContent-Type: text/plain;\n\tcharset=&quot;iso-8859-1&quot;\r\nContent-Transfer-Encoding: 7bit\r\nX-Priority: 3\r\nX-MSMail-Priority: Normal\r\nX-Mailer: Microsoft Outlook Express 6.00.2800.1158\r\nX-MimeOLE: Produced By Microsoft MimeOLE V6.00.2800.1165\r\nFrom: &quot;Neil Swingler&quot; &lt;neil@...&gt;\r\nX-Yahoo-Group-Post: member; u=117993331\r\nX-Yahoo-Profile: neil_swingler\r\n\r\n\n----- Original Message ----- \nFrom: &quot;Jeff Grigg&quot; &lt;jeffgrigg@...&gt;\n&gt; I&#39;m using jAdvise/javassist to instrument classes at run time, a \n&gt; kind of Aspect-Oriented Programming (AOP).  I do this to implement \n&gt; Mock Objects for classes in an uncooperative third party library -- \n&gt; made by people who seem to believe that unsubclassable concrete \n&gt; classes are a good idea, and that interfaces are an unnecessary \n&gt; complexity.  Using AOP I can change some aspects of the \n&gt; implementation of the 3rd party library while running in the test \n&gt; environment.\n&gt; \n&gt; *BUT* for any of this to work, the classes under test must be loaded \n&gt; with a custom class loader.  This is the rub:  Standard JUnit test \n&gt; runners load the TestCase classes using the standard Java class \n&gt; loader.  So when I load the application classes using the \n&gt; jAdvise/javassist class loader, the tests can only communicate with \n&gt; the application objects using Reflection, because classes and \n&gt; interfaces are incompatible when loaded with different class \n&gt; loaders.  Writing all test logic using Reflection would be really \n&gt; unpleasant.  So I need to load the TestCase classes with the \n&gt; jAdvise/javassist class loader.\n&gt; \n&gt; Hmmm...\n&gt; \n&gt; Here&#39;s what I do:\n&gt; Each test method that needs to run under jAdvise/javassist checks to \n&gt; see if it was loaded by a JUnit runner or jAdvise.  If it was loaded \n&gt; by a JUnit runner, it calls a common method that fires up jAdvise, \n&gt; loads the class with the custom class loader, and then calls the \n&gt; same method in the loaded class.  (It also calls setUp & tearDown in \n&gt; the other class.)\n&gt; \n&gt; Here&#39;s what it looks like:\n&gt; | public class MyTestCase extends TestCase {\n&gt; |    final boolean runningInCustomClassLoader;\n&gt; |    public MyTestCase() { super(&quot;MyTestCase&quot;);\n&gt; |       this.runningInCustomClassLoader = true; }\n&gt; |    public MyTestCase(String name) { super(name);\n&gt; |       this.runningInCustomClassLoader = false; }\n&gt; |\n&gt; |    public void testMethod() {\n&gt; |       if (this.runningInCustomClassLoader) {\n&gt; |          // Do application testing here.\n&gt; |       } else { // called by JUnit\n&gt; |          callSelfInCustomClassLoader();\n&gt; | } } }\n&gt; \n&gt; Crazy, eh?  ;-&gt;\n&gt; \n&gt; (In Java 1.4 there&#39;s an easy way to get a useful stack trace -- \n&gt; so &#39;callSelfInCustomClassLoader&#39; can determine the caller&#39;s class \n&gt; and method name.)\n&gt; \nJeff,\n\ndid you see my submission in the files section, using javassist to insert\nimposter mock classes using a custom classloader. I also have a Test\nobject which delegates to a test created in a new classloader.\n\n- Neil\n\n", 
    "profile": "neil_swingler", 
    "topicId": 9399, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 117993331, 
    "prevInTime": 9534, 
    "contentTrasformed": false, 
    "postDate": "1064785764", 
    "canDelete": false, 
    "nextInTopic": 9545, 
    "prevInTopic": 9533, 
    "headers": {
        "messageIdInHeader": "PDAwMmIwMWMzODYwYSQ2MjE1NjRiMCQ2NTAyYThjMEBub3RlYm9vaz4=", 
        "referencesHeader": "PGJsNWNmaytwYzljQGVHcm91cHMuY29tPg=="
    }
}