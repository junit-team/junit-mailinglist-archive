{
    "topicId": 11797, 
    "postDate": "1093198625", 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "from": "Timothy Wall &lt;twall@...&gt;", 
    "canDelete": false, 
    "replyTo": "LIST", 
    "senderId": "_U-RFEsGiX-WNNSNBekAbdkFwW3exMKDYZXFQjJyc5RZUJTDqFIa2156Lu6dchCz1E1R_qtD2S0c1Z6NwR1fBuAQeAyEphpsS1g", 
    "nextInTime": 11832, 
    "userId": 106503903, 
    "prevInTime": 11830, 
    "prevInTopic": 11825, 
    "headers": {
        "inReplyToHeader": "PGNnOWZkcyszZGpmQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PDc4QUExODdELUY0NjctMTFEOC04NkI0LTAwMzA2NUJGODNEQUBvY3VsdXN0ZWNoLmNvbT4=", 
        "referencesHeader": "PGNnOWZkcyszZGpmQGVHcm91cHMuY29tPg=="
    }, 
    "authorName": "Timothy Wall", 
    "numMessagesInTopic": 5, 
    "msgSnippet": "Add another listener to your window for WINDOW_OPENED (note that this event is only posted once for any given window) which sets a flag.  In your main test", 
    "contentTrasformed": false, 
    "msgId": 11831, 
    "nextInTopic": 11836, 
    "systemMessage": false, 
    "rawEmail": "Return-Path: &lt;twall@...&gt;\r\nX-Sender: twall@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 67392 invoked from network); 22 Aug 2004 18:17:06 -0000\r\nReceived: from unknown (66.218.66.166)\n  by m18.grp.scd.yahoo.com with QMQP; 22 Aug 2004 18:17:06 -0000\r\nReceived: from unknown (HELO mail00.oculustech.com) (64.221.47.99)\n  by mta5.grp.scd.yahoo.com with SMTP; 22 Aug 2004 18:17:06 -0000\r\nReceived: by mail00.oculustech.com (Postfix, from userid 1011)\n\tid 71CB9135E2; Sun, 22 Aug 2004 14:17:05 -0400 (EDT)\r\nReceived: from [172.16.1.39] (pool-151-203-36-70.bos.east.verizon.net [151.203.36.70])\n\tby mail00.oculustech.com (Postfix) with ESMTP id 64258135E2\n\tfor &lt;junit@yahoogroups.com&gt;; Sun, 22 Aug 2004 14:17:04 -0400 (EDT)\r\nMime-Version: 1.0 (Apple Message framework v619)\r\nIn-Reply-To: &lt;cg9fds+3djf@...&gt;\r\nReferences: &lt;cg9fds+3djf@...&gt;\r\nContent-Type: text/plain; charset=US-ASCII; format=flowed\r\nMessage-Id: &lt;78AA187D-F467-11D8-86B4-003065BF83DA@...&gt;\r\nContent-Transfer-Encoding: 7bit\r\nDate: Sun, 22 Aug 2004 14:17:05 -0400\r\nTo: junit@yahoogroups.com\r\nX-Mailer: Apple Mail (2.619)\r\nX-Spam-Level: \r\nX-Spam-Checker-Version: SpamAssassin 2.63 (2004-01-11) on \n\tmail00.int.oculustech.com\r\nX-Spam-Status: No, hits=-4.9 required=4.5 tests=BAYES_00 autolearn=ham \n\tversion=2.63\r\nX-eGroups-Remote-IP: 64.221.47.99\r\nFrom: Timothy Wall &lt;twall@...&gt;\r\nSubject: Re: [junit] Re: awkward threading situation\r\nX-Yahoo-Group-Post: member; u=106503903\r\n\r\nAdd another listener to your window for WINDOW_OPENED (note that this \nevent is only posted once for any given window) which sets a flag.  In \nyour main test thread, wait for that flag to be set before posting the \ninvokeAndWait empty runnable.  This ensures that your runnable gets \nprocessed *after* your original WINDOW_OPENED handler has finished \n(unless it spawns threads or some such).\n\nYou might also check out java-gui-testing@yahoogroups.com.  There are \nseveral extensions to JUnit which are specifically designed to handle \nsuch issues (see the Links/Tools area of the group).\n\nOn Aug 22, 2004, at 2:45 AM, sagyrozman wrote:\n\n&gt; thanks for the reply.\n&gt; I was thinking the same thing but didn&#39;t know how to sync with the\n&gt; AWT event queue thread.\n&gt; I tried it and it passed at first attempt, but the next attempts\n&gt; didn&#39;t always pass.\n&gt; I think the problem is the empty runnable is sometimes added before\n&gt; the setVisible(true) event is added to the queue, maybe because a\n&gt; different thread (other than the main thread) is responsible for\n&gt; adding the events to the AWT queue?\n&gt;\n&gt; Is a there a different way to synchronize with the swing event queue?\n&gt;\n&gt; If this topic is out of scope for this discussion group, please let\n&gt; me know. It might be better suited for a swing discussion group.\n&gt;\n&gt;\n&gt;\n&gt; --- In junit@yahoogroups.com, Timothy Wall &lt;twall@o...&gt; wrote:\n&gt;&gt; It&#39;s entirely possible that your main thread checks the mock status\n&gt;&gt; prior to the events actually being handled.\n&gt;&gt;\n&gt;&gt; Consider adding the following after frame.show():\n&gt;&gt;\n&gt;&gt; SwingUtilities.invokeAndWait(new Runnable() { public void run()\n&gt; { }});\n&gt;&gt;\n&gt;&gt;\n&gt;&gt; On Aug 18, 2004, at 2:15 AM, sagyrozman wrote:\n&gt;&gt;\n&gt;&gt;&gt; hi all,\n&gt;&gt;&gt; I was writing a test for a GUI class which should delegate GUI\n&gt; events\n&gt;&gt;&gt; to another object:\n&gt;&gt;&gt;\n&gt;&gt;&gt; class MyFrame extends JFrame implements WindowListener{\n&gt;&gt;&gt;\n&gt;&gt;&gt; TargetForEvents target;\n&gt;&gt;&gt;\n&gt;&gt;&gt; public void setTarget(TargetForEvents t) {\n&gt;&gt;&gt;    target = t;\n&gt;&gt;&gt; }\n&gt;&gt;&gt;\n&gt;&gt;&gt; ....\n&gt;&gt;&gt; }\n&gt;&gt;&gt;\n&gt;&gt;&gt; in the test case:\n&gt;&gt;&gt;\n&gt;&gt;&gt; ...\n&gt;&gt;&gt; MyFrame frame = new MyFrame();\n&gt;&gt;&gt; frame.setTarget(mockTarget);\n&gt;&gt;&gt; frame.setVisible();\n&gt;&gt;&gt;\n&gt;&gt;&gt; now I check that the expected functions where called on the taget\n&gt; in\n&gt;&gt;&gt; response to the WindowOpened events of MyFrame.\n&gt;&gt;&gt;\n&gt;&gt;&gt; the test fails even though it should have passed because using the\n&gt;&gt;&gt; eclipse debuger I can see that the mock is called upon in the\n&gt; swing\n&gt;&gt;&gt; event handling thread, but when checking back with the main thread\n&gt;&gt;&gt; the mock is not affected by these changes.\n&gt;&gt;&gt; Another weird thing: I tried to do a similar test only not through\n&gt;&gt;&gt; junit, instead of asserting that the methods where called, I wrote\n&gt;&gt;&gt; the mock log string out to the stdout. This time the output shows\n&gt;&gt;&gt; that all methods where called in the correct order.\n&gt;&gt;&gt; Am I missing something here? please let me know if any further\n&gt;&gt;&gt; clarification is needed.\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; Yahoo! Groups Links\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt; Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n\n\n", 
    "subject": "Re: [junit] Re: awkward threading situation"
}