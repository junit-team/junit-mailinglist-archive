{
    "numMessagesInTopic": 16, 
    "nextInTime": 11550, 
    "senderId": "BTYyISf8Ab_0KCbatY7pd4zwB9llHxHo613x9zAuu0WYtg1RlOThJYPGBVWui42JiHrFf_Gq93Dsj9IzJFPZcfZTVHYgBuy0gJygaFrCGg", 
    "systemMessage": false, 
    "subject": "Re: [junit] Re: Mock objects...", 
    "from": "&quot;J. B. Rainsberger&quot; &lt;jbrains@...&gt;", 
    "authorName": "J. B. Rainsberger", 
    "msgSnippet": "... Only when it actually has the answer. :) ... Well, Part 2 uses them extensively, almost 100% dynamic mocks, even though it doesn t specifically have a", 
    "msgId": 11549, 
    "profile": "nails762", 
    "topicId": 11542, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 127224993, 
    "messageBody": "<div id=\"ygrps-yiv-2125864634\">cypherfox wrote:<br/>\n<blockquote><span title=\"ireply\"> &gt; Greetings,<br/>\n&gt; <br/>\n&gt; --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>, &quot;J. B. Rainsberger&quot; &lt;jbrains@r...&gt;<br/>\n&gt; wrote:<br/>\n&gt;  &gt; cypherfox wrote:<br/>\n&gt;  &gt;<br/>\n&gt;  &gt; &gt; How the heck do people mock things like database<br/>\n&gt;  &gt; &gt; access classes, mail servers, arbitrary web requests,<br/>\n&gt;  &gt; &gt; etc., without writing a huge amount of logic?<br/>\n&gt;  &gt;<br/>\n&gt;  &gt; Surprisingly easily. You might just need some good examples. See<br/>\n&gt; _JUnit<br/>\n&gt;  &gt; Recipes_, part 2, for details.<br/>\n&gt; <br/>\n&gt; Heh...  Plug, plug, plug.  <br/>\n<br/>\n </span></blockquote>Only when it actually has the answer. :)<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; No argument, I&#39;ll probably read it, I&#39;m<br/>\n&gt; enough of a JUnit fan for that.  I&#39;ve read several other books and<br/>\n&gt; none seems to clearly define how a mock object is supposed to<br/>\n&gt; behave, or how complex you&#39;re supposed to make them.<br/>\n<br/>\n </span></blockquote>Well, Part 2 uses them extensively, almost 100% dynamic mocks, even <br/>\nthough it doesn&#39;t specifically have a chapter on &quot;Here&#39;s how to use mock <br/>\nobjects&quot;. I recommend Chapter 10 for you: Testing and JDBC.<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt;  &gt; &gt; What am I missing?<br/>\n&gt;  &gt;<br/>\n&gt;  &gt; It&#39;s tough to say. Without looking at a specific example, I can&#39;t<br/>\n&gt; say<br/>\n&gt;  &gt; much more. Can you get concrete about a mock you wrote that<br/>\n&gt; exploded out<br/>\n&gt;  &gt; of control? Can we see code?<br/>\n&gt; <br/>\n&gt; Sure, the most recent example of this to me, was this class:<br/>\n&gt;   <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.vixen.com/code/JournalHash.java\">http://www.vixen.com/code/JournalHash.java</a><br/>\n&gt; implementing<br/>\n&gt;   <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.vixen.com/code/JournalDataStore.java\">http://www.vixen.com/code/JournalDataStore.java</a><br/>\n<br/>\n </span></blockquote>Aha! It&#39;s a common mistake: you&#39;ve created an in-memory implementation <br/>\nof JournalDataStore, when you didn&#39;t really need one. I can understand <br/>\nyour pain. Been there.<br/>\n<br/>\nSolution? jMock. www.jmock.org<br/>\n<br/>\nFirst, it looks like you just want a &quot;fake&quot; and not a full-blown mock -- <br/>\nthat is, a stand-in JournalDataStore that returns hardcoded data on demand.<br/>\n<br/>\nYou can use a dynamic mock to implement a fake data store. You simply <br/>\n&quot;record&quot; the desired output for each desired input, then play it back. <br/>\nSince Journal and JournalEntry appear both to be simple value objects, <br/>\nit should be easy.<br/>\n<br/>\nWhen you want to test logic that uses a JournalDataStore, simply record <br/>\nthe behavior you want to /simulate/ during the &quot;Arrange&quot; portion, then <br/>\nplay it back during the &quot;Act&quot; portion. In the &quot;Assert&quot; portion, ask the <br/>\nfake to verify() itself, and if the fake was used incorrectly, it will <br/>\nfail the test.<br/>\n<br/>\nIf you give us a test for an object that talks to JournalHash, then we <br/>\ncan convert it into a test using the fake. You can then decide whether <br/>\nJournalHash is worth keeping for some other use....<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; One of the things that isn&#39;t even in there, is the concept of<br/>\n&gt; &#39;get most recent &#39;n&#39; entries&#39;, because that would require me<br/>\n&gt; to walk backwards through the TreeMap, or add a *third*<br/>\n&gt; representation of the same data, as a linked list or something.<br/>\n<br/>\n </span></blockquote>Here you&#39;re implementing getMostRecentNEntries() in terms of the <br/>\nexisting JournalDataStore methods? That&#39;s not too hard, although it <br/>\nmight surprise you that I would put getMostRecentNEntries() on a <br/>\ndifferent interface from JournalDataStore!<br/>\n<br/>\ntestGetMostRecentNEntries_Empty:<br/>\n     // this moves to setUp() once you have 3 tests that need it<br/>\n     mock := new Mock(JournalDataStore.class)<br/>\n     journalDataStore := mock.proxy()<br/>\n<br/>\n     // record interactions for this test<br/>\n     emptyJournal := create journal with no entries<br/>\n<br/>\n     mock.will(once()).method(&quot;getJournalInfo&quot;)<br/>\n         .withParameters(new String[] {&quot;1234&quot;})<br/>\n         .return(new ReturnValue(emptyJournal))<br/>\n<br/>\n     // now use the fake...<br/>\n     journalQuery := new GetMostRecentNEntriesQuery(1)<br/>\n     entries := journalQuery.execute(journalDataStore)   // uses the fake<br/>\n<br/>\n     // assert<br/>\n     assertTrue(entries.isEmpty())<br/>\n     mock.verify()<br/>\n<br/>\nNow note that this is pseudocode, and I&#39;m only a green belt in jMock (I <br/>\nused EasyMock before, and am still learning jMock), but this is the <br/>\nidea. Ignoring my choice of design for the GetMostRecentNEntriesQuery <br/>\nclass, does this smaller amount of mock code look easier to maintain?<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; I found it frustrating to have to do this much work for what<br/>\n&gt; was really just a testing class.  It DID let me put off doing<br/>\n&gt; the JDBC code until later, however.  Thankfully it was a<br/>\n&gt; &#39;generic&#39; enough interface that the code didn&#39;t change<br/>\n&gt; noticably when doing the actual DB storage code.<br/>\n<br/>\n </span></blockquote>Well, you definitely got some value from it, then. That&#39;s better than <br/>\nnothing. Still, you would have been able to focus on the interactions, <br/>\nrather than implementing the book-keeping, if you&#39;d known about dynamic <br/>\nmocks. Ah, well... it&#39;s never too late.<br/>\n-- <br/>\nJ. B. Rainsberger,<br/>\nDiaspar Software Services<br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.diasparsoftware.com\">http://www.diasparsoftware.com</a> :: +1 416 791-8603<br/>\nLet&#39;s write software that people understand</div>", 
    "prevInTime": 11548, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1090013556", 
    "canDelete": false, 
    "nextInTopic": 11551, 
    "prevInTopic": 11548, 
    "headers": {
        "inReplyToHeader": "PGNkOWVhdCttaHZvQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PDQwRjg0OTc0LjYwMzA1MDhAcm9nZXJzLmNvbT4=", 
        "referencesHeader": "PGNkOWVhdCttaHZvQGVHcm91cHMuY29tPg=="
    }
}