{
    "numMessagesInTopic": 12, 
    "nextInTime": 15678, 
    "senderId": "eOiGpYd7SyEyUnQsAImIq0ZjHuteZZ5toETCetNSvvsJ7YSE60k-qYrqpy_NVy1TGuNDKWY0Bm7YI0CkbLdNPgI8Mp3kHb8C_y7Qbp7mhxACS76_nw", 
    "systemMessage": false, 
    "subject": "Re: [junit] overriding a method executed in the constructor: dont&#39;t work.", 
    "from": "&quot;Jeff Nielsen&quot; &lt;jeff.nielsen@...&gt;", 
    "authorName": "Jeff Nielsen", 
    "msgSnippet": "By calling an (overloaded) class method from within the constructor you re getting into no man s land with the intricacies of the Java runtime.  You don t see", 
    "msgId": 15677, 
    "profile": "jeffreymads", 
    "topicId": 15674, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 65487161, 
    "messageBody": "<div id=\"ygrps-yiv-1731099538\">By calling an (overloaded) class method from within the constructor you&#39;re <br/>\ngetting into no man&#39;s land with the intricacies of the Java runtime.  You <br/>\ndon&#39;t see the problem in your initData() tests, because you&#39;re calling the <br/>\ninitData() method a /second/ time, after the class has been fully <br/>\ninstantiated.  I&#39;m not sure exactly why your particular contrived example <br/>\nexhibits the behavior that it does, but you can solve the problem more <br/>\nsimply by not doing this work in the constructor.<br/>\n<br/>\nIf you change your definition of Command to read like this, your tests run <br/>\nfine.  If you really want to cache the result of initData(), then do it in a <br/>\nlazy manner in the initData() method itself.<br/>\n<br/>\nclass Command {<br/>\n//        private String data;<br/>\n        public Command() {<br/>\n//                this.data = initData();<br/>\n        }<br/>\n        public String initData() {<br/>\n                return &quot;data from file&quot;;<br/>\n        }<br/>\n        public String execute() {<br/>\n                return &quot;execute with [&quot;+initData()+&quot;]&quot;;<br/>\n        }<br/>\n}<br/>\n<br/>\nJeff Nielsen<br/>\nDigital Focus<br/>\nwww.digitalfocus.com<br/>\n<br/>\n<blockquote><span title=\"qreply\"> ----- Original Message ----- <br/>\nFrom: &quot;tusc72&quot; &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:tusc72@...\">tusc72@...</a>&gt;<br/>\nTo: &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>&gt;<br/>\nSent: Friday, December 09, 2005 8:55 AM<br/>\nSubject: [junit] overriding a method executed in the constructor: dont&#39;t <br/>\nwork.<br/>\n<br/>\n<br/>\n&gt; Hi, I have a class that loads data from a file in it&#39;s constructor. To <br/>\n&gt; easy test this class, I delegate the loading to a method, initData(). It&#39;s <br/>\n&gt; works well, until I want to play with params:<br/>\n&gt;<br/>\n&gt; C:&#92;&gt;more CommandTest.java<br/>\n&gt; import junit.framework.TestCase;<br/>\n&gt;<br/>\n&gt; class Command {<br/>\n&gt;        private String data;<br/>\n&gt;        public Command() {<br/>\n&gt;                this.data = initData();<br/>\n&gt;        }<br/>\n&gt;        public String initData() {<br/>\n&gt;                return &quot;data from file&quot;;<br/>\n&gt;        }<br/>\n&gt;        public String execute() {<br/>\n&gt;                return &quot;execute with [&quot;+data+&quot;]&quot;;<br/>\n&gt;        }<br/>\n&gt; }<br/>\n&gt;<br/>\n&gt; public class CommandTest extends TestCase {<br/>\n&gt;        // mocks for Command.initData()<br/>\n&gt;        public Command makeMockDataWithParam(final String param) {<br/>\n&gt;                return new Command() {<br/>\n&gt;                        public String initData() {<br/>\n&gt;                                return param;<br/>\n&gt;                        }};<br/>\n&gt;        }<br/>\n&gt;        public static Command makeHardCodedMockData() {<br/>\n&gt;                return new Command() {<br/>\n&gt;                        public String initData() {<br/>\n&gt;                                return &quot;hard coded mock data&quot;;<br/>\n&gt;                        }};<br/>\n&gt;        }<br/>\n&gt;        // tests for Command.initData()<br/>\n&gt;        public void testInitData() {<br/>\n&gt;                assertEquals(&quot;data from file&quot;,new Command().initData());<br/>\n&gt;        }<br/>\n&gt;        public void testInitData_hardCodedMockData() {<br/>\n&gt;                assertEquals(&quot;hard coded mock data&quot;,<br/>\n&gt;                        makeHardCodedMockData().initData());<br/>\n&gt;        }<br/>\n&gt;        public void testInitData_mockDataAsParam() {<br/>\n&gt;                final String param = &quot;mock data as param&quot;;<br/>\n&gt;<br/>\n&gt; assertEquals(param,makeMockDataWithParam(param).initData());<br/>\n&gt;        }<br/>\n&gt;        // tests for Command.execute()<br/>\n&gt;        public void testExecute() {<br/>\n&gt;                assertEquals(&quot;execute with [data from file]&quot;,<br/>\n&gt;                        new Command().execute());<br/>\n&gt;        }<br/>\n&gt;        public void testExcute_hardCodedMockData() {<br/>\n&gt;                assertEquals(&quot;execute with [hard coded mock data]&quot;,<br/>\n&gt;                        makeHardCodedMockData().execute());<br/>\n&gt;        }<br/>\n&gt;        public void testExecute_mockDataAsParam() {<br/>\n&gt;                final String param = &quot;mock data as param&quot;;<br/>\n&gt;                assertEquals(&quot;execute with [&quot;+param+&quot;]&quot;,<br/>\n&gt;                        makeMockDataWithParam(param).execute());<br/>\n&gt;        }<br/>\n&gt; }<br/>\n&gt;<br/>\n&gt; C:&#92;&gt;javac -classpath junit.jar CommandTest.java<br/>\n&gt;<br/>\n&gt; C:&#92;&gt;java -cp .;junit.jar junit.textui.TestRunner CommandTest<br/>\n&gt; ......F<br/>\n&gt; Time: 0<br/>\n&gt; There was 1 failure:<br/>\n&gt; 1)<br/>\n&gt; testExecute_mockDataAsParam(CommandTest)junit.framework.ComparisonFailure:<br/>\n&gt; expected:&lt;...mock data as param...&gt; but was:&lt;...null...&gt;<br/>\n&gt;        at CommandTest.testExecute_mockDataAsParam(CommandTest.java:53)<br/>\n&gt;        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br/>\n&gt;        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)<br/>\n&gt;        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)<br/>\n&gt;<br/>\n&gt; FAILURES!!!<br/>\n&gt; Tests run: 6,  Failures: 1,  Errors: 0<br/>\n&gt;<br/>\n&gt; Don&#39;t understand why testExecute_mockDataAsParam() fails,<br/>\n&gt; whereas testInitData_mockDataAsParam() don&#39;t. Can anyone<br/>\n&gt; explain me ? How can I correctly mocke a property in the constructor ?<br/>\n&gt; </span></blockquote></div>", 
    "prevInTime": 15676, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1134345623", 
    "canDelete": false, 
    "nextInTopic": 15678, 
    "prevInTopic": 15676, 
    "headers": {
        "messageIdInHeader": "PDA2MDUwMWM1ZmVhZiQwZDJiMjM3MCQ2ODAxYThjMEBMYXB0b3AyMTA+", 
        "referencesHeader": "PGRuYzJicCtqOXJiQGVHcm91cHMuY29tPg=="
    }
}