{
    "numMessagesInTopic": 21, 
    "nextInTime": 20530, 
    "senderId": "jO-poe8rqX5ooEkhbty9tCZbETmmrBjK7Qp45ufrhzbtBBbuGtr0TJ0KVPKQiPia0lY8j4vJZEN30IGEVQ8Fr2Hn0SReNrSY", 
    "systemMessage": false, 
    "subject": "RE: [junit] Re: What is expected behavior on Assert.assertEquals on Number object?", 
    "from": "&quot;Kent Beck&quot; &lt;kentb@...&gt;", 
    "authorName": "Kent Beck", 
    "msgSnippet": "Nattapong, The situation is confusing. AssertEquals() started out just using equals(). Then people were surprised by this behavior for a variety of special", 
    "msgId": 20529, 
    "profile": "kentlbeck", 
    "topicId": 20513, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 173198504, 
    "messageBody": "<div id=\"ygrps-yiv-631786378\">Nattapong,<br/>\n <br/>\nThe situation is confusing. AssertEquals() started out just using equals().<br/>\nThen people were surprised by this behavior for a variety of special cases,<br/>\nso we started making assertEquals() smarter. Then people were surprised by<br/>\nthis behavior for a variety of special cases (strange how that works<br/>\nout...), so we&#39;ve gone back to simpler behavior for assertEquals. Special<br/>\ncases were handled by special assertions, like assertArrayEquals(). In<br/>\nfuture, they will be handled using special Matchers and assertThat().<br/>\n <br/>\nRegards,<br/>\n <br/>\nKent Beck<br/>\nThree Rivers Institute<br/>\n<br/>\n  _____  <br/>\n<br/>\nFrom: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a> [mailto:<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>] On Behalf Of<br/>\nNattapong Sirilappanich<br/>\nSent: Thursday, June 05, 2008 9:35 PM<br/>\nTo: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\nCc: Suwit Srivilairith<br/>\nSubject: Re: [junit] Re: What is expected behavior on Assert.assertEquals on<br/>\nNumber object?<br/>\n<br/>\n<br/>\n<br/>\n<br/>\n<br/>\nActually, my point here is i&#39;m expecting<br/>\norg.junit.Assert.assertEquals(Object obj1, Object obj2) to call its<br/>\nobj1.equals(obj2) or something like this.<br/>\nHowever, the outcome surprise me.<br/>\nAssertion success but obj1.equals(obj2) return false.<br/>\n<br/>\nWhat&#39;s going on inside assertEquals() operation?<br/>\nIs this what it&#39;s suppose to be?<br/>\n<br/>\nBest regards,<br/>\nNattapong Sirilappanich<br/>\nEngineer, National Language Development - GCoC & TSC Thailand<br/>\nSoftware Group, IBM Thailand Co., Ltd.<br/>\nNational Phone: 02-273-4715, Fax: 02-619-2030<br/>\nInternational Phone: +66 2 273 4715, Fax: +66 2 619 2030<br/>\ne-mail: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:natta@...\">natta@...</a>. &lt;mailto:natta%40th.ibm.com&gt; com<br/>\n<br/>\n&quot;Roger Glover&quot; <br/>\n&lt;glover_roger@yah <br/>\noo.com&gt; To <br/>\nSent by: junit@yahoogroups. &lt;mailto:junit%40yahoogroups.com&gt; com <br/>\njunit@yahoogroups cc <br/>\n.com <br/>\nSubject <br/>\n[junit] Re: What is expected <br/>\n06/06/2008 01:43 behavior on Assert.assertEquals on <br/>\nNumber object? <br/>\n<br/>\nPlease respond to <br/>\njunit@yahoogroups <br/>\n.com <br/>\n<br/>\n<br/>\n<br/>\n--- In junit@yahoogroups. &lt;mailto:junit%40yahoogroups.com&gt; com, &quot;J. B.<br/>\nRainsberger&quot; &lt;jbrains762@...&gt; <br/>\nwrote: <br/>\n<blockquote><span title=\"qreply\"> On Jun 3, 2008, at 22:41 , Nattapong Sirilappanich wrote: <br/>\nHi, <br/>\n<br/>\nWhen i try to make an assertion on Number object, e.g. Double the <br/>\nresult always assertion successful. Even i try to compare by <br/>\n<br/>\norg.junit.Assert.assertEquals(123456789.345,123456789.34) <br/>\n<br/>\nit still success. (I&#39;m expecting failure) <br/>\nThis is not a good way to compare floating point numbers. You should <br/>\nactually use: <br/>\n<br/>\nAssert.assertEquals(expected, actual, delta) <br/>\n<br/>\nwhere expected and actual are as in the form you did use, but there is a <br/>\nthird &quot;delta&quot; argument (also a double). This argument provides a <br/>\ntolerance value by which to judge &quot;equality&quot;. basically the assertion <br/>\nfails if: <br/>\n<br/>\nMath.abs(expected - actual) &gt; delta <br/>\n<br/>\nThus, working from your failing example: <br/>\n<br/>\nAssert.assertEquals(123456789.345, 123456789.34, 0.5); // PASS <br/>\nAssert.assertEquals(123456789.345, 123456789.34, 0.0005); // FAIL <br/>\n<br/>\nBy the way, this usage really makes the name of the method a misnomer. <br/>\nIt should really be called &quot;assertClose&quot; (as in &quot;close, but no cigar&quot;, <br/>\nnot &quot;close the door; it&#39;s cold&quot;). But that should be okay if you are <br/>\nusing double the way it is meant to be used, because, as the old saying <br/>\ngoes, close only counts in horseshoes, hand grenades, and limited <br/>\nprecision floating point operations. <br/>\n<br/>\nIn other words, the idea is that after even a few operations (or even <br/>\nafter none in some cases) it is unreasonable to expect floating point <br/>\nquantities to be exactly equal to their unlimited precision real number <br/>\ncounterparts (even when an exact match exists). So you aim for &quot;close&quot; <br/>\ninstead. &quot;How close can you get&quot; is itself a black art that combines <br/>\nroughly equal portions of operation counting, number magnitude tracking, <br/>\noperation order tracking, and wild-ass guessing. <br/>\n<br/>\nNow back to the problem at hand. Just for grins I compiled Nattapong&#39;s <br/>\noriginal assert under a J2SE 1.4 compiler and it gave a syntax error, <br/>\nsaying that essentially that the third double argument was missing. It <br/>\nappears that this is one of those rare-but-not-rare-enough cases when <br/>\nautoboxing is actually working against you. <br/>\n<br/>\nAnd now J.B.&#39;s response... <br/>\nWeird. assertEquals() appears only to compare the whole parts. <br/>\n<br/>\npublic class DoubleTest { <br/>\n@Test <br/>\npublic void unequalDoubleValueObjectsShouldBeUnequal() { <br/>\nAssert.assertFalse(new Double(3).equals(new Double(4))); <br/>\nAssert.assertFalse(new Double(3.1d).equals(new Double(3.2d))); <br/>\nAssert.assertFalse(new Double(123456789.345d).equals(new <br/>\nDouble(123456789.34d))); <br/>\nSo far so good... <br/>\nAssert.assertEquals(new Double(123456789.345d), new <br/>\nDouble(123456789.34d)); <br/>\nWhen compiled under J2SE 1.4 the above assertEquals() fails. So, once <br/>\nagain, I suspect autoboxing is the culprit. In this case I suspect the <br/>\nDoubles are being &quot;unboxed&quot; into longs, since there is a two-long <br/>\nassertEquals() but not a two-double assertEquals(). <br/>\nAssert.assertEquals(new Double(3.1d), new Double(3.2d)); <br/>\nSame with the above. <br/>\nAssert.assertEquals(new Double(3), new Double(4)); <br/>\nSame with the above, but if I am right this one fails (as J.B. noted) <br/>\nbecause the <br/>\nintegral parts are different, so you get different longs. <br/>\n} <br/>\n} <br/>\n<br/>\nOnly the last assertion fails. <br/>\nThis behavior makes me wonder if in Nattapong&#39;s original case the <br/>\nprimitive doubles are being boxed into object Doubles which are, in <br/>\nturn, being unboxed into primitive longs. If that is not what is <br/>\nhappening, something even stranger is going on. Either way, I don&#39;t like <br/>\nit. <br/>\n<br/>\n-- Roger Glover <br/>\nObject Partners, Inc. <br/>\n<br/>\n[Non-text portions of this message have been removed] <br/>\n<br/>\n<br/>\n<br/>\n<br/>\n<br/>\n[Non-text portions of this message have been removed]<br/>\n<br/>\n<br/>\n<br/>\n <br/>\n<br/>\n<br/>\n[Non-text portions of this message have been removed] </span></blockquote></div>", 
    "prevInTime": 20528, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1213029991", 
    "canDelete": false, 
    "nextInTopic": 20530, 
    "prevInTopic": 20527, 
    "headers": {
        "inReplyToHeader": "PE9GRjBGODU3MzAuOUNGODIxRTktT040NzI1NzQ2MC4wMDE4NzY2OS00NzI1NzQ2MC4wMDE5MEFGN0B0aC5pYm0uY29tPg==", 
        "messageIdInHeader": "PDAwNzYwMWM4Y2E1MCQ1ZmUxMTRjMCQ0MDAwYThjMEBrZW50c3BhdmlsaW9uPg==", 
        "referencesHeader": "PGcyOWM0bCttZ2ZvQGVHcm91cHMuY29tPiA8T0ZGMEY4NTczMC45Q0Y4MjFFOS1PTjQ3MjU3NDYwLjAwMTg3NjY5LTQ3MjU3NDYwLjAwMTkwQUY3QHRoLmlibS5jb20+"
    }
}