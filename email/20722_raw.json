{
    "numMessagesInTopic": 29, 
    "nextInTime": 20723, 
    "senderId": "95T8bEuBBvr5uYjUzwIuvplDNjmy3hP9EaBjJJmkHMer6T6twU_Ly1GgChWNueiyWOpGn7tcaJCQTLVncMl5SzF7sFhi15f0xyIA4w", 
    "systemMessage": true, 
    "subject": "Re: Junit 3 suite setup tear down", 
    "from": "&quot;toalexsmail&quot; &lt;toalexsmail@...&gt;", 
    "authorName": "toalexsmail", 
    "msgSnippet": "No, you re wrong. Suppose you want to run suite with 2 different classes and you want to make one time setup only once. That is you want to do", 
    "msgId": 20722, 
    "rawEmail": "Return-Path: &lt;toalexsmail@...&gt;\r\nReceived: (qmail 24446 invoked from network); 30 Jul 2008 22:31:24 -0000\r\nReceived: from unknown (66.218.67.97)\n  by m56.grp.scd.yahoo.com with QMQP; 30 Jul 2008 22:31:24 -0000\r\nReceived: from unknown (HELO n7.bullet.mail.re1.yahoo.com) (69.147.103.134)\n  by mta18.grp.scd.yahoo.com with SMTP; 30 Jul 2008 22:31:24 -0000\r\nReceived: from [68.142.237.87] by n7.bullet.mail.re1.yahoo.com with NNFMP; 30 Jul 2008 22:31:23 -0000\r\nReceived: from [209.73.164.83] by t3.bullet.re3.yahoo.com with NNFMP; 30 Jul 2008 22:31:23 -0000\r\nReceived: from [66.218.66.48] by t7.bullet.scd.yahoo.com with NNFMP; 30 Jul 2008 22:31:23 -0000\r\nX-Sender: toalexsmail@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 59420 invoked from network); 30 Jul 2008 20:58:41 -0000\r\nX-Received: from unknown (66.218.67.95)\n  by m44.grp.scd.yahoo.com with QMQP; 30 Jul 2008 20:58:41 -0000\r\nX-Received: from unknown (HELO n6.bullet.mail.re1.yahoo.com) (69.147.103.133)\n  by mta16.grp.scd.yahoo.com with SMTP; 30 Jul 2008 20:58:40 -0000\r\nX-Received: from [68.142.237.88] by n6.bullet.mail.re1.yahoo.com with NNFMP; 30 Jul 2008 20:58:40 -0000\r\nX-Received: from [66.218.69.6] by t4.bullet.re3.yahoo.com with NNFMP; 30 Jul 2008 20:58:40 -0000\r\nX-Received: from [66.218.67.195] by t6.bullet.scd.yahoo.com with NNFMP; 30 Jul 2008 20:58:39 -0000\r\nDate: Wed, 30 Jul 2008 20:58:39 -0000\r\nTo: junit@yahoogroups.com\r\nMessage-ID: &lt;g6qklv+7q1e@...&gt;\r\nIn-Reply-To: &lt;4f7da6b90807231144h5bc104b6r88c696d578ac842@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;ISO-8859-1&quot;\r\nContent-Transfer-Encoding: quoted-printable\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-Yahoo-Newman-Property: groups-system\r\nX-eGroups-Msg-Info: 1:6:0:0:0\r\nFrom: &quot;toalexsmail&quot; &lt;toalexsmail@...&gt;\r\nSubject: Re: Junit 3 suite setup tear down\r\nX-Yahoo-Group-Post: member; u=340165037; y=Zpm5xQv2oiN6zVrA_FMkDkuL2Aoal9NaNwx5B0rA2VCEBJeWmEw\r\nX-Yahoo-Profile: toalexsmail\r\nX-eGroups-Approved-By: spchappell &lt;simonpeterchappell@...&gt; via web; 30 Jul 2008 22:31:21 -0000\r\n\r\nNo, you&#39;re wrong. Suppose you want to run suite with 2 different\nclasses an=\r\nd you want to make one time setup only once. That is you\nwant to do your-on=\r\ne-time-setup, run class A, run class B, and to do\nyour-one-time-teardown. H=\r\now can you do it?\nMorevoer, suppose, you want to run only some specific met=\r\nhods from\nthose classes, not all the methods, how can you do it? In JUnit 3=\r\n.8.x\nthere was a way to do it.\n\n--- In junit@yahoogroups.com, &quot;David Saff&quot; =\r\n&lt;david@...&gt; wrote:\n&gt;\n&gt; @BeforeClass and @AfterClass on the @RunWith(Suite) =\r\nclass have exactly\n&gt; this behavior in JUnit 4.4 and beyond.  However, I thi=\r\nnk the original\n&gt; poster was using 3.x.\n&gt; \n&gt;    David Saff\n&gt; \n&gt; On Wed, Jul=\r\n 9, 2008 at 6:45 PM, C=C3=A9dric Beust =E2=99&quot; &lt;cbeust@...&gt; wrote:\n&gt; &gt; That=\r\n&#39;s a lot of work and therefore a good candidate for a new feature:\n&gt; &gt; @Bef=\r\noreSuite/@AfterSuite.\n&gt; &gt;\n&gt; &gt; --\n&gt; &gt; C=C3=A9dric\n&gt; &gt;\n&gt; &gt; On Wed, Jul 9, 200=\r\n8 at 12:47 PM, toalexsmail &lt;toalexsmail@...&gt; wrote:\n&gt; &gt;\n&gt; &gt;&gt; --- In junit@y=\r\nahoogroups.com &lt;junit%40yahoogroups.com&gt;, &quot;lars&quot;\n&gt; &gt;\n&gt; &gt;&gt; &lt;lars.carlsson@&gt; =\r\nwrote:\n&gt; &gt;&gt; &gt;\n&gt; &gt;&gt; &gt; Hi\n&gt; &gt;&gt; &gt; At my company we have alot of automated test=\r\n cases and in all our\n&gt; &gt;&gt; &gt; suite we have a setup testcase and a teardown =\r\ntest case where\nwe setup\n&gt; &gt;&gt; &gt; network connection that takes some time and=\r\n can not be done in\nevery\n&gt; &gt;&gt; TC. ,\n&gt; &gt;&gt; &gt; But i think that there should e=\r\nxist a suite setup and a\nteardown and\n&gt; &gt;&gt; &gt; not be in a setup/teardown TC.=\r\n\n&gt; &gt;&gt; &gt; Are there any why of doing this or how could i best be solve\nthis b=\r\ny\n&gt; &gt;&gt; &gt; extending TestSuite?\n&gt; &gt;&gt; &gt;\n&gt; &gt;&gt; &gt; Regards Lars\n&gt; &gt;&gt; &gt;\n&gt; &gt;&gt; I thin=\r\nk that there is some related thread on this topic, but\nnever mind.\n&gt; &gt;&gt;\n&gt; &gt;=\r\n&gt; * There are @Before and @After annotation that are equivalent of use\n&gt; &gt;&gt;=\r\n of setUp() and tearDown().\n&gt; &gt;&gt; * There are @BeforeClass and @AfterClass a=\r\nnnotation that are supposed\n&gt; &gt;&gt; to substitute the use of TestSuite. In fac=\r\nt, this method is called\n&gt; &gt;&gt; once per class. You can see on it as your Tes=\r\ntSuite was just a single\n&gt; &gt;&gt; class. AFAIK, there is no build in support fo=\r\nr TestSuite that is not\n&gt; &gt;&gt; so trivial.\n&gt; &gt;&gt;\n&gt; &gt;&gt; I had similar requiremen=\r\nt, namely I wanted to ensure that JDK 1.4+\n&gt; &gt;&gt; assert statement are on, I =\r\nwanted to start JBoss microcontainer\nat the\n&gt; &gt;&gt; beginning and shutdown it =\r\nat the end.\n&gt; &gt;&gt;\n&gt; &gt;&gt; Lets start from the simplest one.\n&gt; &gt;&gt; * I wanted to =\r\nensure that JDK 1.4+ assert statement are on.\n&gt; &gt;&gt; I created class with nam=\r\ne BaseTestCase and all my test classes\n&gt; &gt;&gt; inherits from it. In this class=\r\n I put the following method:\n&gt; &gt;&gt;\n&gt; &gt;&gt; @BeforeClass\n&gt; &gt;&gt; public static void=\r\n oneTimeSetup(){\n&gt; &gt;&gt; // do your one time set-up here!\n&gt; &gt;&gt; log.info(&quot;BaseT=\r\nestCase.oneTimeSetup()&quot;);\n&gt; &gt;&gt; log.debug(&quot;Going to check whether asserts ar=\r\ne enabled&quot;);\n&gt; &gt;&gt; boolean assertsEnabled =3D false;\n&gt; &gt;&gt; assert (assertsEna=\r\nbled =3D true); // Intentional side effect!!!\n&gt; &gt;&gt; if (!assertsEnabled) {\n&gt;=\r\n &gt;&gt; throw new AssertionError(&quot;Asserts must be enabled!&quot;);\n&gt; &gt;&gt; }\n&gt; &gt;&gt; }\n&gt; &gt;=\r\n&gt; }\n&gt; &gt;&gt;\n&gt; &gt;&gt; Because all my test classes inherit from BaseTestCase and has=\r\n their\n&gt; &gt;&gt; base class BaseTestCase, it is guaranteed that first thing that=\r\n will\n&gt; &gt;&gt; be run (beside JUnit itself) is oneTimeSetup() method.\n&gt; &gt;&gt;\n&gt; &gt;&gt;=\r\n * I wanted to start JBoss microcontainer at the beginning and\nshutdown\n&gt; &gt;=\r\n&gt; it at the end.\n&gt; &gt;&gt;\n&gt; &gt;&gt; Every test class inherit from some base test cla=\r\nss, say\n&gt; &gt;&gt; BaseHelloWorldEJBTest (that eventually inherit from BaseTestCa=\r\nse). In\n&gt; &gt;&gt; BaseHelloWorldEJBTest there is method\n&gt; &gt;&gt;\n&gt; &gt;&gt; @BeforeClass\n&gt;=\r\n &gt;&gt; public static void setUpClass() throws Exception ;\n&gt; &gt;&gt;\n&gt; &gt;&gt; This metho=\r\nd basically does the following:\n&gt; &gt;&gt;\n&gt; &gt;&gt; final Bootstrap jbossInstance =3D=\r\n Bootstrap.getInstance();\n&gt; &gt;&gt; if (!jbossInstance.isStarted()) {\n&gt; &gt;&gt; log.d=\r\nebug(&quot;starting JBoss microcontainer&quot;);\n&gt; &gt;&gt; jbossInstance.bootstrap();\n&gt; &gt;&gt;=\r\n log.debug(&quot;JBoss microcontainer is up&quot;);\n&gt; &gt;&gt;\n&gt; &gt;&gt; log.debug(&quot;Going to dep=\r\nloy scanClasspath&quot;);\n&gt; &gt;&gt; deploy(scanClasspath);\n&gt; &gt;&gt; log.debug(&quot;End of dep=\r\nloy scanClasspath&quot;);\n&gt; &gt;&gt; ... &lt;HERE there is more code&gt;\n&gt; &gt;&gt; }\n&gt; &gt;&gt;\n&gt; &gt;&gt; Un=\r\ntil now everything is pretty straight-forward. But how can I stop\n&gt; &gt;&gt; JBos=\r\ns when I finished testing? I don&#39;t want to stop it after every\n&gt; &gt;&gt; class, =\r\nbut after whole TestSuite is done. I didn&#39;t find something\n&gt; &gt;&gt; built-in, s=\r\no I use ShutdownHook...\n&gt; &gt;&gt;\n&gt; &gt;&gt; In the above setUpClass() mehtod in the p=\r\nlace that noted as &quot;&lt;HERE\n&gt; &gt;&gt; there is more code&gt;&quot; I have:\n&gt; &gt;&gt;\n&gt; &gt;&gt; log.d=\r\nebug(&quot;Now add hook to shutdown server&quot;);\n&gt; &gt;&gt; Runtime.getRuntime().addShutd=\r\nownHook(new Thread() {\n&gt; &gt;&gt; public void run() {\n&gt; &gt;&gt; assert lRunnables!=3Dn=\r\null;\n&gt; &gt;&gt; Runnable runnable =3Dnull;\n&gt; &gt;&gt; String runnableI =3D null;\n&gt; &gt;&gt; t=\r\nry {\n&gt; &gt;&gt; for(int i=3D0;i&lt;lRunnables.length;i++){\n&gt; &gt;&gt; runnable =3D lRunnab=\r\nles[i];\n&gt; &gt;&gt; runnableI =3D &quot;runnable &quot;+i;\n&gt; &gt;&gt; log.debug(&quot;Going to run &quot;+ru=\r\nnnableI);\n&gt; &gt;&gt; if(runnable=3D=3Dnull){\n&gt; &gt;&gt; log.warn(runnableI+&quot; is null, s=\r\nkipping&quot;);\n&gt; &gt;&gt; } else {\n&gt; &gt;&gt; try {\n&gt; &gt;&gt; runnable.run();\n&gt; &gt;&gt; log.debug(run=\r\nnableI+&quot; ends run succesfully&quot;);\n&gt; &gt;&gt; }\n&gt; &gt;&gt; catch(Throwable e){log.error(r=\r\nunnableI+&quot; fails&quot;, e);}\n&gt; &gt;&gt;\n&gt; &gt;&gt; }\n&gt; &gt;&gt; }\n&gt; &gt;&gt;\n&gt; &gt;&gt; }\n&gt; &gt;&gt;\n&gt; &gt;&gt; catch(Thro=\r\nwable e){\n&gt; &gt;&gt; log.error(&quot;This should never happened. Some runnables Throwa=\r\nble\n&gt; &gt;&gt; (exception) propogates outside the loop&quot;, e);\n&gt; &gt;&gt; }\n&gt; &gt;&gt;\n&gt; &gt;&gt;\n&gt; &gt;=\r\n&gt; synchronized (jbossInstance) {\n&gt; &gt;&gt; jbossInstance.shutdown();\n&gt; &gt;&gt; }\n&gt; &gt;&gt;=\r\n String junitStatus =3D junitStatusOs.toString();\n&gt; &gt;&gt; log.debug(junitStatu=\r\ns);\n&gt; &gt;&gt;\n&gt; &gt;&gt; }\n&gt; &gt;&gt; });\n&gt; &gt;&gt; I will talk about junitStatusPs a bit later. =\r\nWhat is actually is done\n&gt; &gt;&gt; here that in @BeforeClass that it is before r=\r\nunning every class,\nthere\n&gt; &gt;&gt; is check whether JBoss is run or no. If it i=\r\ns run nothing special is\n&gt; &gt;&gt; done. If it is not run, and this will be true=\r\n only first time this\n&gt; &gt;&gt; check will be done, JBoss is started and ShutDow=\r\nnHook is added.\nTake a\n&gt; &gt;&gt; look on the JavaDoc on ShutDownHook, but basica=\r\nlly, on the call on\n&gt; &gt;&gt; System.exit() JVM will be run your hook. In that s=\r\nhutdown hook I make\n&gt; &gt;&gt; jbossInstance.shutdown().\n&gt; &gt;&gt;\n&gt; &gt;&gt; There is one i=\r\nssue here. One JBoss is shutting down it write some\n&gt; &gt;&gt; thing to the log. =\r\nWhat is happen, that I see JUnit report (90000\n&gt; &gt;&gt; tested passes, 100 fail=\r\ns, and 10 ignored) and after this report I see\n&gt; &gt;&gt; the output from shittin=\r\ng down process. This happen, because the\n&gt; &gt;&gt; shutdown hook happens after l=\r\nast JUnit class finished to run.\n&gt; &gt;&gt; I found some work around. In the Base=\r\nTestCase I have:\n&gt; &gt;&gt; // the logger\n&gt; &gt;&gt; private static final Log log =3D L=\r\nogFactory.getLog(BaseTestCase.class);\n&gt; &gt;&gt; protected static final OutputStr=\r\neam junitStatusOs =3D new\n&gt; &gt;&gt; ByteArrayOutputStream(16*1024);\n&gt; &gt;&gt;\n&gt; &gt;&gt; Th=\r\nis junitStatusPs is actually passed to as PrintStream (instead\n&gt; &gt;&gt; System.=\r\nout) to the JUnit classes. Note, that I have\n&gt; &gt;&gt;\n&gt; &gt;&gt; String junitStatus =\r\n=3D junitStatusOs.toString();\n&gt; &gt;&gt; log.debug(junitStatus);\n&gt; &gt;&gt;\n&gt; &gt;&gt; as the=\r\n last row of the shutdown hook. This ensure, that I will\nsee the\n&gt; &gt;&gt; outpu=\r\nt of the shutdown hook first, and the JUnit report will be the\n&gt; &gt;&gt; last ro=\r\nws in the standard output.\n&gt; &gt;&gt; And the last issue is:\n&gt; &gt;&gt;\n&gt; &gt;&gt; If I want =\r\nto do some other thing I just wrap it as lRunnables and\npass\n&gt; &gt;&gt; to the me=\r\nthod mentioned above. It is looks like this:\n&gt; &gt;&gt;\n&gt; &gt;&gt; //we want to call cl=\r\neanUp() method that ear application calls\n&gt; &gt;&gt; //moment before we shutting =\r\ndown JBoss\n&gt; &gt;&gt; Runnable runnable =3D new Runnable(){\n&gt; &gt;&gt; public void run(=\r\n) {\n&gt; &gt;&gt; try {\n&gt; &gt;&gt; cleanUp();\n&gt; &gt;&gt; }\n&gt; &gt;&gt; catch(HelloWorldException e){\n&gt; =\r\n&gt;&gt; log.error(&quot;Failed to cleanUp&quot;, e);\n&gt; &gt;&gt; }\n&gt; &gt;&gt; }\n&gt; &gt;&gt; };\n&gt; &gt;&gt;\n&gt; &gt;&gt; setUp=\r\nClass(System.getProperty(&quot;user.dir&quot;) + &quot;/target/classes&quot;,\n&gt; &gt;&gt; runnable);\n&gt;=\r\n &gt;&gt;\n&gt; &gt;&gt; In order to shutdown JBoss we use\n&gt; &gt;&gt; @AfterClass\n&gt; &gt;&gt; public sta=\r\ntic void tearDownClass() throws Exception {\n&gt; &gt;&gt; log.info(&quot;one time tearDow=\r\nnClass()&quot;);\n&gt; &gt;&gt; undeploy();\n&gt; &gt;&gt; Bootstrap.getInstance().shutdown();\n&gt; &gt;&gt; =\r\n}\n&gt; &gt;&gt;\n&gt; &gt;&gt;\n&gt; &gt;&gt;\n&gt; &gt;\n&gt; &gt; [Non-text portions of this message have been remov=\r\ned]\n&gt; &gt;\n&gt; &gt;\n&gt;\n\n\n\n", 
    "profile": "toalexsmail", 
    "topicId": 20668, 
    "spamInfo": {
        "reason": "6", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 340165037, 
    "prevInTime": 20721, 
    "contentTrasformed": false, 
    "postDate": "1217451519", 
    "canDelete": false, 
    "nextInTopic": 20726, 
    "prevInTopic": 20710, 
    "headers": {
        "inReplyToHeader": "PDRmN2RhNmI5MDgwNzIzMTE0NGg1YmMxMDRiNnI4OGM2OTZkNTc4YWM4NDJAbWFpbC5nbWFpbC5jb20+", 
        "messageIdInHeader": "PGc2cWtsdis3cTFlQGVHcm91cHMuY29tPg=="
    }
}