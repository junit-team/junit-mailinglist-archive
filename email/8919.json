{
    "numMessagesInTopic": 24, 
    "nextInTime": 8920, 
    "senderId": "SQYj2tyls8Yyoex1UeTBiI8D3wZtGKFHVkZir8zi7i5b-Y7akJL59x4G2aXyzXen8vEP-VmcQCOmR4MCVVkp", 
    "systemMessage": false, 
    "subject": "RE: [junit] How to test a main(String[] args) method?", 
    "from": "&quot;bernd&quot; &lt;berndq@...&gt;", 
    "authorName": "bernd", 
    "msgSnippet": "Hi, ... sorry for not reading you code in detail, I was thinking of something like interface Finish { void do(int i); } we need it for production: class", 
    "msgId": 8919, 
    "topicId": 8737, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 106754364, 
    "messageBody": "<div id=\"ygrps-yiv-1889020643\">Hi, <br/>\n<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; -----Original Message-----<br/>\n&gt; From: David [mailto:<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:achepati67@...\">achepati67@...</a>] <br/>\n&gt; Sent: Wednesday, July 30, 2003 10:57 AM<br/>\n&gt; To: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\n&gt; Cc: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:berndq@...\">berndq@...</a>; <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:mike@...\">mike@...</a>; <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:jbrains@...\">jbrains@...</a><br/>\n&gt; Subject: RE: [junit] How to test a main(String[] args) method?<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; &gt;Dear Members,<br/>\n&gt; &gt;<br/>\n&gt; &gt;I whould like to test a class with a main(String[] args) <br/>\n&gt; method. Depending<br/>\n&gt; &gt;on the input argument it executes one thing or the other. <br/>\n&gt; The problem is<br/>\n&gt; &gt;that on my main(String[] args) method at the end or when it founds an<br/>\n&gt; error,<br/>\n&gt; &gt;the method System.exit() is invoked. So when I define jUnit <br/>\n&gt; test cases<br/>\n&gt; &gt;(methods with prefix test), jUnits only runs the first test, because<br/>\n&gt; some&gt;System.exit() was invoked.<br/>\n&gt; &gt;Is there any way to test such kind of situations?<br/>\n&gt; &gt;Thanks in advance,<br/>\n&gt; <br/>\n&gt; The solution propoused by Bern was:<br/>\n&gt; <br/>\n&gt; java.lang.System is final and does not implement <br/>\n&gt; interfaces,so there is no<br/>\n&gt; chance to replace ist behaviour.You may want to replace calls to<br/>\n&gt; System.exit() with calls againstan interface you define. <br/>\n&gt; Under test use an<br/>\n&gt; implementation which allowsyourtest code to chech if the exit <br/>\n&gt; method has<br/>\n&gt; been called by main() but whichdoes not exit the VM. In <br/>\n&gt; production use an<br/>\n&gt; implememtation which delegatesto System.exit().<br/>\n&gt; <br/>\n&gt; As far as I know what you mean could be implemented like <br/>\n&gt; this: (see comments<br/>\n&gt; below)<br/>\n&gt; <br/>\n&gt; package com.my.example<br/>\n&gt; <br/>\n&gt; public class Example {<br/>\n&gt; \tstatic Finish _finish = new <br/>\n&gt; Example.ProductionFinish();// private package<br/>\n&gt; (static because it is<br/>\n&gt; \t\t\t\t\t\t\t\t<br/>\n&gt; \t\t// going to be used on main.)<br/>\n&gt; \tstatic void setFinish(Finish value){_finish = value;}\t<br/>\n&gt; // private package<br/>\n&gt; <br/>\n&gt; \tstatic main (String[] args)<br/>\n&gt; <br/>\n&gt; \t\tboolean goOn = true; \t// because we don&#39;t <br/>\n&gt; exit on testing mode,<br/>\n&gt; \t\t\t\t\t\t// we need a <br/>\n&gt; way for controling the execution flow.<br/>\n&gt; \t\tif (someCondition) {// first checking (exceptional flow)<br/>\n&gt; \t\t\tgoOn = finish.do(-1);<br/>\n&gt; \t\t}<br/>\n&gt; \t\t// ... put other checking here<br/>\n&gt; \t\tif (goOn && otherCondition) {// main flow<br/>\n&gt; \t\t\tfinish.do(0);<br/>\n&gt; \t\t}<br/>\n&gt; \t}<br/>\n&gt; <br/>\n&gt; \t/* Now we define the interface Finish and its default <br/>\n&gt; implementation (as<br/>\n&gt; inner classes<br/>\n&gt; \twith private-package visibility, because we have to <br/>\n&gt; define ONLY for testing<br/>\n&gt; purpose this<br/>\n&gt; \tinterface!)*/<br/>\n&gt; <br/>\n&gt; \tinterface Finish {<br/>\n&gt; \t\tboolean do(int i);<br/>\n&gt; \t}<br/>\n&gt; <br/>\n&gt; \tclass ProductionFinish {// its default implementation <br/>\n&gt; (used on production<br/>\n&gt; mode)<br/>\n&gt; \t\tProductionFinish(){} // default constructor <br/>\n&gt; with private-package<br/>\n&gt; visibility<br/>\n&gt; \t\tboolean do(int i) {<br/>\n&gt; \t\t\tSystem.exit(i);<br/>\n&gt; \t\t}<br/>\n&gt; \t}<br/>\n&gt; }<br/>\n&gt; <br/>\n&gt; Now on the testing class defined on the same package:<br/>\n&gt; <br/>\n&gt; package com.my.example<br/>\n&gt; <br/>\n&gt; public class ExampleTest extends TestCase{<br/>\n&gt; \t// ...<br/>\n&gt;     \tprotected void setUp (){Example.setFinish(new<br/>\n&gt; ExampleTest.TestingFinish());}<br/>\n&gt; \t}<br/>\n&gt; \tclass TestingFinish implements Example.Finish{<br/>\n&gt; \t\tTestingFinish (){} // default constructor with <br/>\n&gt; private-package visibility<br/>\n&gt; \t\tboolean do(int i) { // We have to stop on every case!<br/>\n&gt; \t\t\treturn false;<br/>\n&gt; \t\t}<br/>\n&gt; \t}<br/>\n&gt; }<br/>\n<br/>\n </span></blockquote>sorry for not reading you code in detail, <br/>\nI was thinking of something like<br/>\n<br/>\n \tinterface Finish {<br/>\n \t\tvoid do(int i);<br/>\n \t}<br/>\n<br/>\nwe need it for production:<br/>\n<br/>\nclass ProductionFinish implements Finish{<br/>\n    public void do(int exitCode){<br/>\n        System.exit(exitCode);<br/>\n    }<br/>\n}<br/>\n<br/>\n<br/>\nand a Mock for tests:<br/>\n<br/>\nclass MockFinish implements Finish{<br/>\n    public void do(int exitCode){<br/>\n        mLastExitCode=exitCode;<br/>\n        mNumberOfDoCalled++;<br/>\n    }<br/>\n<br/>\n    public int getLastExitCode(){return mLastExitCode;}<br/>\n    public int getNumberOfDoCalled(){return mDoWasCalled;}<br/>\n<br/>\n    private int mLastExitCode;<br/>\n    private int mNumberOfDoCalled=0;<br/>\n}<br/>\n<br/>\ninside of main, just use the interface.<br/>\nAt the very beginnig of main you may use a factory<br/>\nto get an implmentation:<br/>\n<br/>\npublic static void main(String[] atgs){<br/>\n   Finish finish=FinishFactory.getInstance();<br/>\n<br/>\n   ...<br/>\n   finish.do(22);<br/>\n   ...<br/>\n}<br/>\n<br/>\ndepending on production/test the factory will<br/>\nhand out the corresponding implementation.<br/>\n<br/>\na test may look like this:<br/>\n<br/>\npublic MyTestCase extends TestCase{<br/>\n...<br/>\npublic test_xx(){<br/>\n    com.xxx.package.main(argsToBeTested)<br/>\n    MockFinish mockFinish=howToGetInstance??<br/>\n<br/>\n    // make sure exit was called only once<br/>\n    assertEquals(1, mockFinish.getNumberOfDoCalled());<br/>\n    assertEquals(expectedExitCode, mockFinish.getLastExitCode());<br/>\n}<br/>\n<br/>\nBut how to get the instance of MockFinsih?<br/>\nMaybe something like<br/>\n<br/>\n...<br/>\npublic static MockFinish getInstance(){<br/>\n   return mInstance;<br/>\n}<br/>\n<br/>\nprivate static mInstance;<br/>\n...<br/>\n<br/>\n<br/>\nhmm, yes really lots of code...<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; COMMENTS:<br/>\n&gt; <br/>\n&gt; - About this suggestion and the corresponding implementation, <br/>\n&gt; because we<br/>\n&gt; need a default implementation ALWAYS (for production), then <br/>\n&gt; instead of using<br/>\n&gt; an INTERFACE, it is BETTER to just define the class Finish as <br/>\n&gt; ABSTRACT (the<br/>\n&gt; do(int i) method should be abstract)<br/>\n&gt; <br/>\n&gt; - You have to write A LOT for makeing a very simple task. I <br/>\n&gt; have implemented<br/>\n&gt; a simpler solution, just do the following steps:<br/>\n&gt; <br/>\n&gt; a) Define on the class to test (Example), the static boolean <br/>\n&gt; field _TEST as<br/>\n&gt; private-package. This field is initialized with default value: false<br/>\n&gt; (production)<br/>\n&gt; <br/>\n&gt; b) Define a STATIC PRIVATE method finish, like this:<br/>\n&gt; \t\tprivate static boolean finish(int i) {<br/>\n&gt; \t\t\tif(!_TEST) {<br/>\n&gt; \t\t\t\tSystem.exit(i);<br/>\n&gt; \t\t\t}<br/>\n&gt; \t\t\treturn false;<br/>\n&gt; \t\t}<br/>\n&gt; c) On the testing class (ExampleTest), set on the setup() <br/>\n&gt; method, the field<br/>\n&gt; _TEST to true.<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; Now we have:<br/>\n&gt; <br/>\n&gt; package com.my.example<br/>\n&gt; <br/>\n&gt; public class Example {<br/>\n&gt; \tstatic boolean _TEST = false;<br/>\n&gt; <br/>\n&gt; \tstatic main (String[] args)<br/>\n&gt; <br/>\n&gt; \t\tboolean goOn = true;<br/>\n&gt; \t\tif (someCondition) {// fist checking<br/>\n&gt; \t\t\tgoOn = finish(-1);<br/>\n&gt; \t\t}<br/>\n&gt; \t\t// ... put other checking here<br/>\n&gt; \t\tif (goOn && otherCondition) {// the last <br/>\n&gt; condition (end of the program)<br/>\n&gt; \t\t\tfinish(-1);<br/>\n&gt; \t\t}<br/>\n&gt; \t}<br/>\n&gt; <br/>\n&gt; \tprivate static boolean finish (int i) {<br/>\n&gt; \t\tif (!_TEST) {<br/>\n&gt; \t\t\tSystem.exit(i);<br/>\n&gt; \t\t}<br/>\n&gt; \t\treturn false;<br/>\n&gt; \t}<br/>\n&gt; }<br/>\n&gt; <br/>\n&gt; package com.my.example<br/>\n&gt; <br/>\n&gt; public class ExampleTest extends TestCase{<br/>\n&gt; \t// ...<br/>\n&gt;     \tprotected void setUp (){Example._TEST = true;}<br/>\n&gt; \t}<br/>\n&gt; }<br/>\n&gt; <br/>\n&gt; I think this solution is enough. Any suggestion?<br/>\n<br/>\n </span></blockquote>How do you test that finish() really was called?<br/>\nIIRC that was your question in your initial posting?<br/>\n<br/>\nMaybe to much modification of the original code: goOn && ... ?<br/>\nDid you try J.B.&#39;s suggestion?<br/>\n<br/>\nBernd<br/>\n<br/>\n<blockquote><span title=\"qreply\"> &gt; <br/>\n&gt; Thanks in advance,<br/>\n&gt; <br/>\n&gt; David<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; ------------------------ Yahoo! Groups Sponsor <br/>\n&gt; ---------------------~--&gt;<br/>\n&gt; Buy Ink Cartridges or Refill Kits for Your HP, Epson, Canon or Lexmark<br/>\n&gt; Printer at Myinks.com. Free s/h on orders $50 or more to the <br/>\n&gt; US & Canada. <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.c1tracking.com/l.asp?cid=5511\">http://www.c1tracking.com/l.asp?cid=5511</a><br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"http://us.click.yahoo.com/sO0ANB/LIdGAA/ySSFAA/5cFolB/TM\">http://us.click.yahoo.com/sO0ANB/LIdGAA/ySSFAA/5cFolB/TM</a><br/>\n&gt; --------------------------------------------------------------<br/>\n&gt; -------~-&gt;<br/>\n&gt; <br/>\n&gt; To unsubscribe from this group, send an email to:<br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit-unsubscribe@yahoogroups.com\">junit-unsubscribe@yahoogroups.com</a><br/>\n&gt;  <br/>\n&gt; <br/>\n&gt; Your use of Yahoo! Groups is subject to <br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"http://docs.yahoo.com/info/terms/\">http://docs.yahoo.com/info/terms/</a> <br/>\n&gt; <br/>\n&gt; <br/>\n&gt; </span></blockquote></div>", 
    "prevInTime": 8918, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1059727343", 
    "canDelete": false, 
    "nextInTopic": 9013, 
    "prevInTopic": 8891, 
    "headers": {
        "inReplyToHeader": "PE5GQkJMRkROTUpMTkxKQUpKS05BS0VLSEZIQUEuYWNoZXBhdGk2N0B5YWhvby5lcz4=", 
        "messageIdInHeader": "PDAwMGUwMWMzNTgwOCRkNzU1YzE1MCQxZjAzYThjMEBkZWxsPg=="
    }
}