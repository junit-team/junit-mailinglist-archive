{
    "numMessagesInTopic": 5, 
    "nextInTime": 22052, 
    "senderId": "8XRyXP9lI-73oQ-kZ_r6DJ78WEgJSO_2PlV2DTekzX3NqFJB_zLhddQgSE6D8uYQ7LV7ZIJBh_ZGfZDtE3TxZ9Yl6BQA", 
    "systemMessage": true, 
    "subject": "Re: [junit] how do I test socket server application?", 
    "from": "Mike Forsberg &lt;bigmike@...&gt;", 
    "authorName": "Mike Forsberg", 
    "msgSnippet": "The following works for me... import java.io.IOException; import java.net.ServerSocket; import java.net.Socket; import org.junit.Before; import org.junit.Test;", 
    "msgId": 22051, 
    "rawEmail": "Return-Path: &lt;bigmike.f@...&gt;\r\nReceived: (qmail 62497 invoked from network); 17 Nov 2009 05:44:21 -0000\r\nReceived: from unknown (98.137.34.44)\n  by m11.grp.re1.yahoo.com with QMQP; 17 Nov 2009 05:44:21 -0000\r\nReceived: from unknown (HELO n4-vm6.bullet.mail.sp2.yahoo.com) (67.195.135.100)\n  by mta1.grp.sp2.yahoo.com with SMTP; 17 Nov 2009 05:44:21 -0000\r\nDKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoogroups.com; s=lima; t=1258436614; bh=zeEDCjO6eNJeMZgZEjw1YVcWzb2gxK178p/6LBuv5aU=; h=Received:Received:Received:X-Sender:X-Apparently-To:X-Received:X-Received:X-Received:X-Received:MIME-Version:X-Received:In-Reply-To:References:Date:X-Google-Sender-Auth:Message-ID:To:Content-Type:Content-Transfer-Encoding:X-Originating-IP:X-eGroups-Msg-Info:From:Subject:X-Yahoo-Group-Post:X-Yahoo-Profile:X-YGroups-SubInfo:Sender:X-Yahoo-Newman-Property:X-eGroups-Approved-By:X-eGroups-Auth; b=PcZKWh4q6s7+46Q91DPnmSVRut2u3ghzTGcMWyoK8lP5E+wUKDfx46n1UkwbhlQ44iSutKctFfLYG0nuSBCSY7OETh7WVLvZ26afF4kmQYEyHW2zaGUHxcbD7N2d2KAf\r\nReceived: from [67.195.134.239] by n4.bullet.mail.sp2.yahoo.com with NNFMP; 17 Nov 2009 05:43:34 -0000\r\nReceived: from [69.147.65.147] by t4.bullet.mail.sp2.yahoo.com with NNFMP; 17 Nov 2009 05:43:34 -0000\r\nReceived: from [98.137.34.73] by t10.bullet.mail.sp1.yahoo.com with NNFMP; 17 Nov 2009 05:43:34 -0000\r\nX-Sender: bigmike.f@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 59274 invoked from network); 17 Nov 2009 04:52:24 -0000\r\nX-Received: from unknown (66.196.94.107)\n  by m12.grp.re1.yahoo.com with QMQP; 17 Nov 2009 04:52:24 -0000\r\nX-Received: from unknown (HELO mail-pw0-f54.google.com) (209.85.160.54)\n  by mta3.grp.re1.yahoo.com with SMTP; 17 Nov 2009 04:52:24 -0000\r\nX-Received: by pwj2 with SMTP id 2so1520363pwj.33\n        for &lt;junit@yahoogroups.com&gt;; Mon, 16 Nov 2009 20:52:20 -0800 (PST)\r\nMIME-Version: 1.0\r\nX-Received: by 10.114.3.15 with SMTP id 15mr10299438wac.181.1258433535966; Mon, \n\t16 Nov 2009 20:52:15 -0800 (PST)\r\nIn-Reply-To: &lt;26367358.post@...&gt;\r\nReferences: &lt;hapaad+5lrn@...&gt;\n\t &lt;a527fddf0910101047ta40e456j133154c6c8e5301e@...&gt;\n\t &lt;26367358.post@...&gt;\r\nDate: Mon, 16 Nov 2009 22:52:15 -0600\r\nX-Google-Sender-Auth: 85e2fccab51e713b\r\nMessage-ID: &lt;a527fddf0911162052p49d4bebch1e2489948dbc47a8@...&gt;\r\nTo: junit@yahoogroups.com\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Transfer-Encoding: quoted-printable\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: Mike Forsberg &lt;bigmike@...&gt;\r\nSubject: Re: [junit] how do I test socket server application?\r\nX-Yahoo-Group-Post: member; u=89428055; y=zmqm4oily4Bp74uJH6eo5FX7e7D4L6ffa5PXcq3p06hfl5mQ\r\nX-Yahoo-Profile: bigmike_f\r\nX-Yahoo-Newman-Property: groups-system\r\nX-eGroups-Approved-By: copabella &lt;joe@...&gt; via web; 17 Nov 2009 05:43:32 -0000\r\n\r\nThe following works for me...\n\nimport java.io.IOException;\nimport java.net.=\r\nServerSocket;\nimport java.net.Socket;\n\nimport org.junit.Before;\nimport org.=\r\njunit.Test;\n\npublic class TestSomethingVersion1 {\n\n\t@Before\n\tpublic void be=\r\nfore() {\n\t\tSystem.out.println(&quot;@Before&quot;);\n\t\tThread myThread =3D new Thread(=\r\n) {\n\t\t\tpublic void run() {\n\t\t\t\tSystem.out.println(&quot;@Before myThread run()&quot;)=\r\n;\n\t\t\t\tSocket myServerSocket =3D null;\n\t\t\t\ttry {\n\t\t\t\t\tServerSocket myServer =\r\n=3D new ServerSocket(3000);\n\t\t\t\t\tSystem.out\n\t\t\t\t\t\t\t.println(&quot;@Before myThre=\r\nad run() - server socket created.&quot;);\n\t\t\t\t\tmyServerSocket =3D myServer.accep=\r\nt();\n\t\t\t\t\tSystem.out\n\t\t\t\t\t\t\t.println(&quot;@Before myThread run() - accepted con=\r\nnection&quot;);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\te.printStackTrace();\n\t\t\t\t}\n\t\t=\r\n\t}\n\t\t};\n\t\tmyThread.start();\n\t}\n\n\t@Test\n\tpublic void test1() throws Exceptio=\r\nn {\n\t\tSystem.out.println(&quot;test1&quot;);\n\t\tsynchronized (this) {\n\t\t\ttry {\n\t\t\t\twai=\r\nt(1000);\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\t// do nothing.\n\t\t\t}\n\t\t}\n=\r\n\t\tSystem.out.println(&quot;test1 - after wait&quot;);\n\t\tnew Socket(&quot;localhost&quot;, 3000)=\r\n;\n\t\tsynchronized (this) {\n\t\t\ttry {\n\t\t\t\twait(1000);\n\t\t\t} catch (InterruptedE=\r\nxception e) {\n\t\t\t\t// do nothing.\n\t\t\t}\n\t\t}\n\t\tSystem.out.println(&quot;test1 - aft=\r\ner second wait&quot;);\n\t}\n}\n\nSome of the things I ran into while writing up this=\r\n example...\n- Threading issues: The thread created in the before did not ge=\r\nt any\nprocessor until it was too late.\n- Port contentions: I didn&#39;t use an =\r\nunused port.\n\n\nSome things you might run into later on down the line....\n- =\r\nUse of the Before annotation will lead to a new ServerSocket thread\ncreated=\r\n for each test method.  Which will lead to inability to use the\nsame addres=\r\ns.  The old thread will still be alive.\n- There will be a ton of test infor=\r\nmation in the ServerSocket thread\nrequired for each test.\n\n_I think you are=\r\n testing your client incorrectly_\n\nHave you ever thought about testing only=\r\n one side of the application\nat a time?  Are you testing the client or the =\r\nserver?  Have you\nthought about separating the connection portion of the ap=\r\nplication\nfrom the reading and writing of data.  For instance the Socket re=\r\nads\nand writes over streams.  What if these were the arguments to the main\n=\r\nportion of your application?  You could then write and read from these\nstre=\r\nams without the socket overhead.\n\nHope I helped,\n\nBig Mike\n\n\nOn Mon, Nov 16=\r\n, 2009 at 12:38 AM, youhaodeyi &lt;youhaodeyi@...&gt; wrote:\n&gt;\n&gt; What my pr=\r\noblem is that I create a thread to listen on a port but the program\n&gt; will =\r\nexist not block. Below is my code\n&gt;\n&gt; @Before\n&gt; public void setUp() throws =\r\nException{\n&gt; try {\n&gt; =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0(new Th=\r\nread(new Runnable(){\n&gt; =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =\r\n=A0 =A0 =A0public void run() {\n&gt; =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =\r\n=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try{\n&gt; =A0 =A0 =A0 =A0 =A0 =A0 =A0 =\r\n=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0server=3Dnew ServerSocke=\r\nt(3000);\n&gt; =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =\r\n=A0 =A0 =A0 =A0server.accept();\n&gt; =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =\r\n=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}catch(Exception ex){\n&gt; =A0 =A0 =A0 =\r\n=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0=\r\n =A0 =A0ex.printStackTrace();\n&gt; =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0=\r\n =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}\n&gt; =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0=\r\n =A0 =A0 =A0 =A0 =A0 =A0 =A0};\n&gt; =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =\r\n=A0 =A0})).start();\n&gt; =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) =\r\n{\n&gt; =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();\n&gt; =\r\n=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}\n&gt;\n&gt; =A0 =A0 =A0 =A0}\n&gt; }\n&gt; @Test\n&gt; public =\r\nvoid test1(){\n&gt; =A0 =A0 =A0 =A0 ...\n&gt; }\n&gt;\n&gt; Mike Forsberg wrote:\n&gt;&gt;\n&gt;&gt; JUni=\r\nt is agnostic, or doesn&#39;t know, where it runs.\n&gt;&gt;\n&gt;&gt; You would write the te=\r\nst cases just as any other test.\n&gt;&gt;\n&gt;&gt; If I had some more information I cou=\r\nld help a little better.\n&gt;&gt;\n&gt;&gt; Big Mike\n&gt;&gt;\n&gt;&gt; On Sat, Oct 10, 2009 at 1:41 =\r\nAM, youhaodeyi &lt;youhaodeyi@...&gt; wrote:\n&gt;&gt;&gt;\n&gt;&gt;&gt; I have a server/client=\r\n application and want to use junit to test it. How\n&gt;&gt;&gt; do I setup a server =\r\nside junit test case?\n&gt;&gt;&gt;\n&gt;&gt;&gt; thanks.\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; ---------------------=\r\n---------------\n&gt;&gt;&gt;\n&gt;&gt;&gt; Yahoo! Groups Links\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt;\n&gt;&gt;\n&gt;&gt;\n&gt;\n&gt; --\n&gt; =\r\nView this message in context: http://old.nabble.com/how-do-I-test-socket-se=\r\nrver-application--tp25833711p26367358.html\n&gt; Sent from the JUnit - User mai=\r\nling list archive at Nabble.com.\n&gt;\n&gt;\n&gt;\n&gt; ----------------------------------=\r\n--\n&gt;\n&gt; Yahoo! Groups Links\n&gt;\n&gt;\n&gt;\n&gt;\n\n", 
    "profile": "bigmike_f", 
    "topicId": 21961, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 89428055, 
    "prevInTime": 22050, 
    "contentTrasformed": false, 
    "postDate": "1258433535", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 22050, 
    "headers": {
        "inReplyToHeader": "PDI2MzY3MzU4LnBvc3RAdGFsay5uYWJibGUuY29tPg==", 
        "messageIdInHeader": "PGE1MjdmZGRmMDkxMTE2MjA1MnA0OWQ0YmViY2gxZTI0ODk5NDhkYmM0N2E4QG1haWwuZ21haWwuY29tPg==", 
        "referencesHeader": "PGhhcGFhZCs1bHJuQGVHcm91cHMuY29tPgkgPGE1MjdmZGRmMDkxMDEwMTA0N3RhNDBlNDU2ajEzMzE1NGM2YzhlNTMwMWVAbWFpbC5nbWFpbC5jb20+CSA8MjYzNjczNTgucG9zdEB0YWxrLm5hYmJsZS5jb20+"
    }
}