{
    "numMessagesInTopic": 10, 
    "nextInTime": 20075, 
    "senderId": "x-cx-GcN_khmqSk270IXArc4GOAacRT-Z8g5MvKGBiC07fJq4_aJAq4Dpz3MN2Z8LhjJvmMzJyIhzHNfhKQv38Kt-gwKmcuPESaDlaq2B2gWkZCMx9g", 
    "systemMessage": true, 
    "subject": "Re:How to test a method that logs to a file", 
    "from": "&quot;Pascale, Peter H.&quot; &lt;peter.pascale@...&gt;", 
    "authorName": "Pascale, Peter H.", 
    "msgSnippet": "I ll offer a different implementation of JN s #2: Mock or stub the logging, in case you are not using commons logging: You can achieve similar stubbing", 
    "msgId": 20074, 
    "profile": "artisanzero", 
    "topicId": 20070, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 143310412, 
    "messageBody": "<div id=\"ygrps-yiv-1556453797\">I&#39;ll offer a different implementation of JN&#39;s #2: Mock or stub the<br/>\nlogging, in case you are not using commons logging:<br/>\n<br/>\nYou can achieve similar stubbing behavior by writing your own Unit Test<br/>\nappender. Simply extend log4j&#39;s AppenderSkeleton for an appender than<br/>\ncan track log messages and assert various logging conditions. Again,<br/>\nyou&#39;ll want to use your imagination on how fancy of an appender to<br/>\nimplement. But you can start by just overriding:<br/>\n<br/>\nprotected void append(LoggingEvent loggingEvent)<br/>\npublic void close()<br/>\npublic boolean requiresLayout()<br/>\n<br/>\nStore loggingEvents submitted to append(LoggingEvent) in as simple or<br/>\nfancy a way as you want, and write assertions to verify certain events<br/>\nwere received on append(LoggingEvent).<br/>\n<br/>\nNow how to inject the appender in your unit tests? Configure log4j via<br/>\nfile or programmatically in your unit test to just set up the one<br/>\nappender for the root logger - all logged messages will flow to your<br/>\nunit test appender. If you only care about one level of message (only<br/>\nINFO say) or anything at or above a certain level (if you wanted to keep<br/>\ndebug logging from being submitted to you appender) you can configure<br/>\nlog4j accordingly. <br/>\n<br/>\n<br/>\nIf you are already using commons logging - great - JN&#39;s solution seems<br/>\nsound. But if not, unit testing alone is not enough reason to use<br/>\ncommons logging. It is increasingly disparaged for its classloader hack<br/>\nemployed to identify the logging implementation. If you are considering<br/>\ncommons logging for a variety of reasons, consider SLF4J instead (and<br/>\nlogback).<br/>\n<br/>\n<br/>\nPeter Pascale<br/>\n<br/>\n---------------------<br/>\n<br/>\nYou can also just <br/>\n<br/>\nI&#39;ve used two techniques in similar situations, but I&#39;m sure there are<br/>\nothers (including some more elegant than my quick hacks).<br/>\n<br/>\n1) Inspect the log file:<br/>\n<br/>\n1.1) Start logging with a fresh log file name.<br/>\n1.2) Run code under test.<br/>\n1.3) Run an assertion against the content of the file from step one.<br/>\n<br/>\nThe clean way to do the above, of course, is to have a small library<br/>\nof tools that e.g. given a file name return the entire content of the<br/>\nfile as a single string, given a file name and a string, verify that<br/>\nsome line in the file contains the given string, etc.<br/>\n<br/>\n2) Mock or stub the logging:<br/>\n<br/>\nBreak the dependency that&#39;s hanging you up.<br/>\n<br/>\nApache commons logging provides an interface-oriented wrapper around<br/>\nseveral widely-used logging implementations (including Log4J). By<br/>\nwriting against the apache.commons.logging.Log interface in your<br/>\nactual code, you break the dependency on Log4J implementation details.<br/>\nFor unit testing, you can then:<br/>\n<br/>\n2.1) create a stub implementation of Log that e.g. puts all log<br/>\nmessages in a StringWriter which you can then inspect, or<br/>\n2.2) write a mock that implements Log and verifies that the expected<br/>\nseverity call was made with the expected message properties, or<br/>\n2.3) use your imagination for more options.<br/>\n<br/>\nIf you have reasons for not bringing in another set of outside code<br/>\n(e.g. time-consuming certification/approval/legal processes), you can<br/>\nwrite your own simple interface that has the key &quot;level&quot; methods<br/>\n(error(...), warn(...), etc.) and create two implementations: one that<br/>\nproxies for Log4J and the other that provides the stub/mock<br/>\ncapabilities you need for testing.<br/>\n<br/>\nHope this helps!<br/>\n-jn-<br/>\n<br/>\n<blockquote><span title=\"qreply\"> On 11/7/07, Hemanth &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:hemanthdv_yid@...\">hemanthdv_yid@...</a>&gt; wrote:<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt;<br/>\n&gt; Hi<br/>\n&gt;<br/>\n&gt; I would like to know how to JUnit test a method that writes logs to a<br/>\n&gt; file. I am using log4j and I have methods that write different logs to<br/>\n&gt; a file. How do I Junit test that these methods are working fine.<br/>\n&gt;<br/>\n&gt; Regards<br/>\n&gt; Hemanth<br/>\n&gt;<br/>\n&gt; <br/>\n<br/>\n-- <br/>\nProgramming is the art of writing essays in crystal clear prose and<br/>\nmaking them execute. - Per Brinch Hansen<br/>\n**************************************************************************** <br/>\nThis email may contain material confidential to<br/>\nPearson.  If you were not an intended recipient, <br/>\nplease notify the sender and delete all copies. <br/>\nWe may monitor email to and from our network. <br/>\n**************************************************************************** </span></blockquote></div>", 
    "prevInTime": 20073, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1194450111", 
    "canDelete": false, 
    "nextInTopic": 20076, 
    "prevInTopic": 20071, 
    "headers": {
        "messageIdInHeader": "PDZFODRGQjlGQTFCMzMwNDE5RUQ0MDkxQTc3NjZFMzRGMDlGREU0ODRAQkdUTU5TUlZFM01YMDEuTkNTUC5QRVJPT1QuQ09NPg=="
    }
}