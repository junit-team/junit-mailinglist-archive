{
    "numMessagesInTopic": 48, 
    "nextInTime": 19728, 
    "senderId": "bGz9j4HuS2XY6KRFL3yrLsXzsZWb8GgIMiOoqQB0EFbi16NtPFyVxGlrEcETCP8koeLpkH9EyrA6a57cSA0fNUCQS2CsmJqV8-Sa3wjerEQ", 
    "systemMessage": false, 
    "subject": "Re: [junit] RE: Assurance/CPU cycle ratio [branching from Re: Test Grouping/Partitioning]", 
    "from": "&quot;Lasse Koskela&quot; &lt;lasse.koskela@...&gt;", 
    "authorName": "Lasse Koskela", 
    "msgSnippet": "Hi Kent, ... I spent a week refactoring a slow test suite with a client the other week. The build took a total of 73 minutes when we started and we got it down", 
    "msgId": 19727, 
    "profile": "lassekoskela", 
    "topicId": 19521, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 190530936, 
    "messageBody": "<div id=\"ygrps-yiv-395847517\">Hi Kent,<br/>\n<br/>\n<blockquote><span title=\"qreply\"> On 8/9/07, Kent Beck &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:kentb@...\">kentb@...</a>&gt; wrote:<br/>\n&gt;  I&#39;d love to help optimize a long-running industrial test suite. I suspect<br/>\n&gt;  that much of the effort would be spent trying refactorings that might lead<br/>\n&gt;  to separately testable dimensions. I would want to be sure that each step<br/>\n&gt;  didn&#39;t reduce the assurance provided by the whole suite. Only when tests<br/>\n&gt;  were clearly redundant would I remove the slower running version.<br/>\n&gt;<br/>\n&gt;  Has anyone here done any profiling of long-running test suites? I&#39;m curious<br/>\n&gt;  what percentage of time is spent in setup/teardown versus actually running<br/>\n&gt;  the tests.<br/>\n<br/>\nI spent a week refactoring a slow test suite with a client the other<br/>\nweek. The build took a total of 73 minutes when we started and we got<br/>\nit down to 40 minutes by the end of the week. The refactoring is still<br/>\nan ongoing activity but I haven&#39;t heard whether they&#39;ve managed to<br/>\nsqueeze out more stuff.<br/>\n<br/>\nOne of the first things we did, after the other guy giving me an quick<br/>\ntour around the (test) codebase, was to profile the test suite. And,<br/>\nyes, most of the big numbers pointed at long-lasting setups. Simple<br/>\nutilities had proper unit tests but the majority of code had Too Big<br/>\nTests that basically initialized the whole system (some 4 seconds per<br/>\ntest) even if none of that would&#39;ve been necessary.<br/>\n<br/>\nWe started improving the situation by refactoring the system&#39;s service<br/>\nlocator architecture to perform lazy initialization of all of those<br/>\ndozens of services. Why? Because the build was slow and we needed a<br/>\nBig Win to start with. Refactoring towards lazy initialization was a<br/>\nsolution that seemed to have a lot of potential (service<br/>\ninitialization was the single biggest CPU consumer) and was<br/>\nstraightforward to implement.<br/>\n<br/>\nAlong the way we did a number of micro optimizations and I don&#39;t have<br/>\nthe numbers, but my gut feeling was that most of the ~30% improvement<br/>\nin build time was from short-circuiting unnecessary setup.<br/>\n<br/>\n<br/>\nLasse<br/>\n<br/>\n-- <br/>\nLasse Koskela<br/>\n* Author of &quot;Test Driven&quot; (Manning Publications, 2007) *<br/>\n* Reaktor Innovations * <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.ri.fi/en\">http://www.ri.fi/en</a> * </span></blockquote></div>", 
    "prevInTime": 19726, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1186640719", 
    "canDelete": false, 
    "nextInTopic": 19732, 
    "prevInTopic": 19726, 
    "headers": {
        "inReplyToHeader": "PDAxOGUwMWM3ZGEyMCQzYmNhZTVmMCQ2NzAxYThjMEBrZW50c3BhdmlsaW9uPg==", 
        "messageIdInHeader": "PDM5NzVlMmQxMDcwODA4MjMyNW8xOGI1MTlkZXM4ODZjZmNjZmM4NjM4Mjc3QG1haWwuZ21haWwuY29tPg==", 
        "referencesHeader": "PDAwMzEwMWM3Y2ZkNSRhZmY1ZTU2MCQ2NzAxYThjMEBrZW50c3BhdmlsaW9uPgkgPDVDRDM3QjZFMDkwNDU0NDg5QzVGQzE1QjlCNEI1QjE5MTg5OTM1QHNsY2VzMDIuYWQuZmFzdC5ubz4JIDwwMThlMDFjN2RhMjAkM2JjYWU1ZjAkNjcwMWE4YzBAa2VudHNwYXZpbGlvbj4="
    }
}