{
    "numMessagesInTopic": 12, 
    "nextInTime": 21279, 
    "senderId": "va82mCoHwaNmreWa1_ivpzfhZD6x-omrYUctN-7As4FV7l0SLWMB5ePVmCcXWrY9sDV5ZQ4Q0HeokqIYpc-jw876nN3Ugw9E6sdUj50fNqIduJcx", 
    "systemMessage": false, 
    "subject": "Re: [junit] JUnit-JPA (Hibernate) - Spring - Struts2 testing howto", 
    "from": "&quot;Joakim Ohlrogge&quot; &lt;joakim.ohlrogge@...&gt;", 
    "authorName": "Joakim Ohlrogge", 
    "msgSnippet": "Just a longshot, I have not done any JPA-development myself but it looks like you have a different version of  the javax.persistance API:s when you run eclipse", 
    "msgId": 21278, 
    "profile": "j0hlrogge", 
    "topicId": 21269, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 261856052, 
    "messageBody": "<div id=\"ygrps-yiv-300104081\">Just a longshot, I have not done any JPA-development myself but it<br/>\nlooks like you have a different version of  the javax.persistance<br/>\nAPI:s when you run eclipse than when you run in maven. Based on that<br/>\nassumption my guess is that you are using a different java-version in<br/>\neclipse than in maven. Ie, eclipse runs with java 1.6 and maven runs<br/>\nwith java 1.5. (Sometimes API:s make it into the java platform between<br/>\nversions that can lead to this kind of conflicts)<br/>\n<br/>\nIn eclipse you can check your launch for junit to see which jre is used.<br/>\n<br/>\nIt could also be the order of jar-files on your classpath. In that<br/>\ncase it&#39;s also possible to change the order of the jar-files in the<br/>\nproperties for your project. Make sure the order matches your pom.<br/>\n<br/>\nJust some things to check, could help...<br/>\n<br/>\n<blockquote><span title=\"qreply\"> On Fri, Jan 9, 2009 at 9:49 AM, Marko Majkic &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:majkic@...\">majkic@...</a>&gt; wrote:<br/>\n&gt; It seems that applicationContext-test.xml is read, but there&#39;s failure<br/>\n&gt; trace:<br/>\n&gt; java.lang.NoSuchMethodError:<br/>\n&gt; javax.persistence.PersistenceContext.properties()[Ljavax/persistence/PersistenceProperty;<br/>\n&gt; at<br/>\n&gt; org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor$PersistenceElement.&lt;init&gt;(PersistenceAnnotationBeanPostProcessor.java:543)<br/>\n&gt; at<br/>\n&gt; org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor$2.doWith(PersistenceAnnotationBeanPostProcessor.java:376)<br/>\n&gt; at<br/>\n&gt; org.springframework.util.ReflectionUtils.doWithMethods(ReflectionUtils.java:435)<br/>\n&gt; at<br/>\n&gt; org.springframework.util.ReflectionUtils.doWithMethods(ReflectionUtils.java:412)<br/>\n&gt; at<br/>\n&gt; org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor.findPersistenceMetadata(PersistenceAnnotationBeanPostProcessor.java:363)<br/>\n&gt; at<br/>\n&gt; org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor.postProcessMergedBeanDefinition(PersistenceAnnotationBeanPostProcessor.java:296)<br/>\n&gt; at<br/>\n&gt; org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyMergedBeanDefinitionPostProcessors(AbstractAutowireCapableBeanFactory.java:745)<br/>\n&gt; at<br/>\n&gt; org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:448)<br/>\n&gt; at<br/>\n&gt; org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory$1.run(AbstractAutowireCapableBeanFactory.java:409)<br/>\n&gt; at java.security.AccessController.doPrivileged(Native Method)<br/>\n&gt; at<br/>\n&gt; org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:380)<br/>\n&gt; at<br/>\n&gt; org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:264)<br/>\n&gt; at<br/>\n&gt; org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:221)<br/>\n&gt; at<br/>\n&gt; org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:261)<br/>\n&gt; at<br/>\n&gt; org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:185)<br/>\n&gt; at<br/>\n&gt; org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:164)<br/>\n&gt; at<br/>\n&gt; org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:429)<br/>\n&gt; at<br/>\n&gt; org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:729)<br/>\n&gt; at<br/>\n&gt; org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:381)<br/>\n&gt; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br/>\n&gt; at<br/>\n&gt; sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)<br/>\n&gt; at<br/>\n&gt; sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)<br/>\n&gt; at java.lang.reflect.Method.invoke(Method.java:597)<br/>\n&gt; at<br/>\n&gt; org.springframework.test.jpa.AbstractJpaTests.runBare(AbstractJpaTests.java:230)<br/>\n&gt; at junit.framework.TestResult$1.protect(TestResult.java:106)<br/>\n&gt; at junit.framework.TestResult.runProtected(TestResult.java:124)<br/>\n&gt; at junit.framework.TestResult.run(TestResult.java:109)<br/>\n&gt; at junit.framework.TestCase.run(TestCase.java:120)<br/>\n&gt; at junit.framework.TestSuite.runTest(TestSuite.java:230)<br/>\n&gt; at junit.framework.TestSuite.run(TestSuite.java:225)<br/>\n&gt; at<br/>\n&gt; org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run(JUnit3TestReference.java:130)<br/>\n&gt; at<br/>\n&gt; org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)<br/>\n&gt; at<br/>\n&gt; org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)<br/>\n&gt; at<br/>\n&gt; org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)<br/>\n&gt; at<br/>\n&gt; org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)<br/>\n&gt; at<br/>\n&gt; org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:196)<br/>\n&gt;<br/>\n&gt; Maven 2 &quot;mvn test&quot; is working fine.<br/>\n&gt;<br/>\n&gt; On Fri, Jan 9, 2009 at 12:49 AM, Cenk Çivici &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:cenk.civici@...\">cenk.civici@...</a>&gt; wrote:<br/>\n&gt;&gt; Hi,<br/>\n&gt;&gt;<br/>\n&gt;&gt; What happens when you try to run this in Eclipse ( I am guessing thats<br/>\n&gt;&gt; what you mean by running alone). Does it fail when it tries to locate<br/>\n&gt;&gt; the app context? Is app context xml on the classpath? What error do<br/>\n&gt;&gt; you see?<br/>\n&gt;&gt;<br/>\n&gt;&gt; Cheers<br/>\n&gt;&gt; Cenk<br/>\n&gt;&gt;<br/>\n&gt;&gt; On Thu, Jan 8, 2009 at 7:38 PM, Marko Majkic &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:majkic@...\">majkic@...</a>&gt; wrote:<br/>\n&gt;&gt;&gt; Thanks for the reference. I did something that works, but it works<br/>\n&gt;&gt;&gt; only when I do &quot;mvn test&quot;. I cannot run test alone.<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; I use AbstractJpaTests and those two &quot;preparing&quot; methods:<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; ========<br/>\n&gt;&gt;&gt; package net.beotel.service;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; import java.util.List;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; import javax.persistence.EntityManager;<br/>\n&gt;&gt;&gt; import javax.persistence.EntityManagerFactory;<br/>\n&gt;&gt;&gt; import javax.persistence.Persistence;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; import net.beotel.model.Bank;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; import org.springframework.test.jpa.AbstractJpaTests;<br/>\n&gt;&gt;&gt; import org.springframework.transaction.annotation.Transactional;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; public class BankServiceTest extends AbstractJpaTests {<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; private BankServiceImpl bankService = new BankServiceImpl() ;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; private static EntityManagerFactory emf;<br/>\n&gt;&gt;&gt; private static EntityManager em;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; public void onSetUp(){<br/>\n&gt;&gt;&gt; emf = Persistence.createEntityManagerFactory(&quot;testing1&quot;);<br/>\n&gt;&gt;&gt; em = emf.createEntityManager();<br/>\n&gt;&gt;&gt; em.getTransaction().begin();<br/>\n&gt;&gt;&gt; bankService.setEntityManager(em);<br/>\n&gt;&gt;&gt; }<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; public void onTearDown(){<br/>\n&gt;&gt;&gt; em.getTransaction().commit();<br/>\n&gt;&gt;&gt; }<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; public BankService getBankService() {<br/>\n&gt;&gt;&gt; return bankService;<br/>\n&gt;&gt;&gt; }<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; public BankServiceTest() {<br/>\n&gt;&gt;&gt; super();<br/>\n&gt;&gt;&gt; }<br/>\n&gt;&gt;&gt; protected String[] getConfigLocations() {<br/>\n&gt;&gt;&gt; return new String[] {<br/>\n&gt;&gt;&gt; &quot;classpath:applicationContext-test.xml&quot;,<br/>\n&gt;&gt;&gt; };<br/>\n&gt;&gt;&gt; }<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; @Transactional<br/>\n&gt;&gt;&gt; public void testAll() throws Exception {<br/>\n&gt;&gt;&gt; List&lt;Bank&gt; banks = bankService.findAll();<br/>\n&gt;&gt;&gt; int initialCount = banks.size();<br/>\n&gt;&gt;&gt; Bank bank= new Bank();<br/>\n&gt;&gt;&gt; bank.setName(&quot;OTP&quot;);<br/>\n&gt;&gt;&gt; bankService.save(bank);<br/>\n&gt;&gt;&gt; assertNotNull(bank.getId());<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; }<br/>\n&gt;&gt;&gt; }<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; ========<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; Is there any way to run this test alone? Do I have to include<br/>\n&gt;&gt;&gt; &quot;applicationContext-test.xml&quot; (from the src/test/resources) explicitly<br/>\n&gt;&gt;&gt; in the code? I don&#39;t have to do this with my application (include<br/>\n&gt;&gt;&gt; applicationContext.xml from the web.xml). Do I have to include<br/>\n&gt;&gt;&gt; explcitly persistence-unit?<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; At last, is there any working example (simple) testing some service<br/>\n&gt;&gt;&gt; (dao) using JPA? Thanks.<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt; On Wed, Jan 7, 2009 at 8:58 PM, Cenk Çivici &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:cenk.civici@...\">cenk.civici@...</a>&gt;<br/>\n&gt;&gt;&gt; wrote:<br/>\n&gt;&gt;&gt;&gt; Hi,<br/>\n&gt;&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;&gt; Have you looked at Spring integration testing support?<br/>\n&gt;&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"http://static.springframework.org/spring/docs/2.5.x/reference/testing.html#testcontext-framework\">http://static.springframework.org/spring/docs/2.5.x/reference/testing.html#testcontext-framework</a><br/>\n&gt;&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;&gt; Spring TestContext lets you load an app context, configure<br/>\n&gt;&gt;&gt;&gt; transactions per fixture/method etc.<br/>\n&gt;&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;&gt; Cheers<br/>\n&gt;&gt;&gt;&gt; Cenk Çivici<br/>\n&gt;&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;&gt; On Wed, Jan 7, 2009 at 1:39 AM, <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:majkic@...\">majkic@...</a> &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:majkic@...\">majkic@...</a>&gt;<br/>\n&gt;&gt;&gt;&gt; wrote:<br/>\n&gt;&gt;&gt;&gt;&gt; Hi guys,<br/>\n&gt;&gt;&gt;&gt;&gt; I&#39;m new in the group and I couldn&#39;t find anything on testing<br/>\n&gt;&gt;&gt;&gt;&gt; combination in the title.<br/>\n&gt;&gt;&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;&gt;&gt; I have applicationContext.xml where EntityManagerFactory is<br/>\n&gt;&gt;&gt;&gt;&gt; configured. Model classes are mapped using Annotations. My service<br/>\n&gt;&gt;&gt;&gt;&gt; classes (DAO - for example BankImpl) implements interfaces (for<br/>\n&gt;&gt;&gt;&gt;&gt; example Bank). Methods from these implementation are called in Struts2<br/>\n&gt;&gt;&gt;&gt;&gt; action classes (injected).<br/>\n&gt;&gt;&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;&gt;&gt; How can I configure my tests to be runnable as single tests and as<br/>\n&gt;&gt;&gt;&gt;&gt; Maven2 tests? Is there any simple example - tutorial? Should I have<br/>\n&gt;&gt;&gt;&gt;&gt; separate applicationContext-test.xml?<br/>\n&gt;&gt;&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;&gt;<br/>\n&gt;&gt;<br/>\n&gt;&gt;<br/>\n&gt;<br/>\n&gt; <br/>\n<br/>\n<br/>\n<br/>\n-- <br/>\n-----------------------------------------------------<br/>\nJoakim Ohlrogge<br/>\nAgical AB<br/>\nVästerlånggatan 79, 2 tr<br/>\n111 29 Stockholm, SWEDEN<br/>\n<br/>\nMobile: +46-708-754004<br/>\nBlog: johlrogge.wordpress.com<br/>\nE-mail: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:joakim.ohlrogge@...\">joakim.ohlrogge@...</a> </span></blockquote></div>", 
    "prevInTime": 21277, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1231764696", 
    "canDelete": false, 
    "nextInTopic": 21296, 
    "prevInTopic": 21277, 
    "headers": {
        "inReplyToHeader": "PGMzNWM5MGUwMDkwMTA5MDA0OWcxNDA1Y2U5NXBjZGJkMTQzM2RkZGJmZmRlQG1haWwuZ21haWwuY29tPg==", 
        "messageIdInHeader": "PGI5ZWU1ZTQxMDkwMTEyMDQ1MXM3MjhkY2Q3YnVjMDVhNjZkMzE1N2I0YzRmQG1haWwuZ21haWwuY29tPg==", 
        "referencesHeader": "PGdrMHE0MCtpaGxxQGVHcm91cHMuY29tPgkgPDEzY2NkYjVmMDkwMTA3MTE1OG8xZTQzNTdkZnAzZTZhZjllMTIzYTg0YmU1QG1haWwuZ21haWwuY29tPgkgPGMzNWM5MGUwMDkwMTA4MDkzOHI1NWNiZTY1Ymw5M2FlOTEzNTU2Yjc1OWY4QG1haWwuZ21haWwuY29tPgkgPDEzY2NkYjVmMDkwMTA4MTU0OWkxYzU1ZWEzZXcxYTIxNjgxZWE5ZTQ0YjdAbWFpbC5nbWFpbC5jb20+CSA8YzM1YzkwZTAwOTAxMDkwMDQ5ZzE0MDVjZTk1cGNkYmQxNDMzZGRkYmZmZGVAbWFpbC5nbWFpbC5jb20+"
    }
}