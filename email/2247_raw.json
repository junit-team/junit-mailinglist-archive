{
    "topicId": 2247, 
    "postDate": "996949567", 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "from": "&quot;Dineshram&quot; &lt;dineshram@...&gt;", 
    "canDelete": false, 
    "replyTo": "LIST", 
    "senderId": "g7mgVlgf4gRitEFCTwIuw04OCbo0J_jqNn5aSMB3x-5_V2OZcSOSN36tvqTC5EsIe6zLh9Nck_swPbAEvASvgtraMobowMaVfiXxhi0", 
    "nextInTime": 2248, 
    "userId": 0, 
    "prevInTime": 2246, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PDAwMDYwMWMxMWQxMiRlZTQ3NmUwMCRiMDhiNGVjMEBwaW5rc2hlZXRzLm5ldD4="
    }, 
    "authorName": "Dineshram", 
    "numMessagesInTopic": 3, 
    "msgSnippet": "I have to test the following java handler public class DailyListingSplitHandler extends StatsHandler { private Connection conn; private CallableStatement", 
    "contentTrasformed": false, 
    "msgId": 2247, 
    "nextInTopic": 2248, 
    "systemMessage": false, 
    "rawEmail": "Return-Path: &lt;dineshram@...&gt;\r\nX-Sender: dineshram@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (EGP: mail-7_2_0); 4 Aug 2001 17:25:28 -0000\r\nReceived: (qmail 35037 invoked from network); 4 Aug 2001 17:25:28 -0000\r\nReceived: from unknown (10.1.10.142) by l9.egroups.com with QMQP; 4 Aug 2001 17:25:28 -0000\r\nReceived: from unknown (HELO c007.snv.cp.net) (209.228.33.206) by mta3 with SMTP; 4 Aug 2001 17:25:28 -0000\r\nReceived: (cpmta 21168 invoked from network); 4 Aug 2001 10:25:27 -0700\r\nReceived: from unknown (HELO prog02) (216.49.73.2) by smtp.pinksheets.com (209.228.33.206) with SMTP; 4 Aug 2001 10:25:27 -0700\r\nX-Sent: 4 Aug 2001 17:25:27 GMT\r\nTo: &lt;junit@yahoogroups.com&gt;\r\nCc: &lt;dineshram@...&gt;\r\nSubject: cast exception during run time\r\nDate: Sat, 4 Aug 2001 13:26:07 -0500\r\nMessage-ID: &lt;000601c11d12$ee476e00$b08b4ec0@...&gt;\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=&quot;iso-8859-1&quot;\r\nContent-Transfer-Encoding: 7bit\r\nX-Priority: 3 (Normal)\r\nX-MSMail-Priority: Normal\r\nX-Mailer: Microsoft Outlook CWS, Build 9.0.2416 (9.0.2910.0)\r\nImportance: Normal\r\nX-MimeOLE: Produced By Microsoft MimeOLE V5.50.4522.1200\r\nFrom: &quot;Dineshram&quot; &lt;dineshram@...&gt;\r\n\r\nI have to test the following java handler\n\npublic class DailyListingSplitHandler extends StatsHandler {\n\n    private Connection conn;\n    private CallableStatement cstmt;\n    private Statement stmt;\n    private ResultSet rs;\n    private String procCallStmt;\n    private String temp;\n    private String temp1;\n    private String temp2;\n    private int len;\n    private int len1;\n\n    private String next;\n\n\n  final static String className = DailyListingSplitHandler.class.getName();\n  final static Category CAT = Category.getInstance(className);\n  final static Category DB = Category.getInstance(className+&quot;.DB&quot;);\n\n\n    private String dateString;\n\n    public DailyListingSplitHandler (String next,\n                                          HttpServletRequest request,\n                                          HttpServletResponse response,\n                                          ServletContext context,\n                                          DatabaseObject dbobj) {\n        super (request, response, context, dbobj);\n        this.next = next;\n    }\n\n    public String processRequest() throws\n                ServletException, IOException {\n            //-------CAT.info(&quot;request from ip: &quot;+request.getRemoteAddr());\n            try {\n                conn = databaseObj.getConnection();\n            } catch (Exception se) {\n                DB.error(&quot;failed to get connection&quot;, se);\n            }\n\n            try\n            {\n                SimpleDateFormat simpleDateFormat = new\nSimpleDateFormat(&quot;yyyy-MM-dd&quot;);\n                java.util.Date date= new java.util.Date();\n                String dateString = simpleDateFormat.format(date);\n\n\n                com.nqb.ps.otcstats.HandlerSearchResultBean dailyResultBean\n=\n                                    new\ncom.nqb.ps.otcstats.HandlerSearchResultBean();\n                GregorianCalendar cal = new GregorianCalendar();\n                cal.setTime(new java.util.Date());\n                cal.roll(Calendar.DAY_OF_YEAR, -7);\n                java.util.Date fromDate = cal.getTime();\n                String fromdate = simpleDateFormat.format(fromDate);\n\n                procCallStmt = &quot;{call history_by_date(?,?,?)}&quot;;\n                DB.info(&quot;call\nhistory_by_date(&quot;+dateString+&quot;,&quot;+dateString+&quot;,L)&quot;);\n                try {\n                cstmt = conn.prepareCall(procCallStmt);\n                cstmt.setString(1, fromdate);\n                cstmt.setString(2, dateString);\n                cstmt.setString(3,&quot;L&quot;);\n                    rs = cstmt.executeQuery();\n                } catch(SQLException sqle) {\n                    DB.error(&quot;Failed to execute query&quot;, sqle);\n                    next = Links.ERROR_PAGE;\n                } catch(Exception e) {\n                    DB.error(&quot;general Exception while executing the query&quot;,\ne);\n                    next = Links.ERROR_PAGE;\n                }\n\n\n               while(rs.next())\n\n                {\n                    temp = (rs.getString(18) == null ||\nrs.getString(18).trim().equals(&quot;&quot;)) ? &quot;N/A&quot; :\n(rs.getString(18).startsWith(&quot;3&quot;)?\nrs.getString(18).substring(1):rs.getString(18));\n                    temp = temp.trim();\n                    len = temp.length();\n                    len1 = 0;\n                    while(!(temp.charAt(len1)==&#39;;&#39;)&&(len1 &lt; len-1))\n                    {\n                        len1++;\n                    }\n\n                    if(len1+1 == len)\n                    temp = (rs.getString(18) == null ||\nrs.getString(18).trim().equals(&quot;&quot;)) ? &quot;N/A&quot; :\n(rs.getString(18).startsWith(&quot;3&quot;)?\nrs.getString(18).substring(1):rs.getString(18));\n                    else\n                    temp = temp.substring(0,len1);\n\n                    String comp = rs.getString(16).trim();\n                    if(comp.equals(&quot;Unknown\nCompany&quot;)||comp.equals(&quot;Unmatched Company&quot;)||comp.equals(&quot;&quot;)||comp==null)\n                        comp = rs.getString(17);\n\n\n                    CAT.debug(&quot;creating bean HandlerSearchResultBeanRow\nusing parameters: null, &quot;+\n                                rs.getString(1)+\n                                &quot;,&quot;+\n                                ((rs.getString(3) == null ||\nrs.getString(3).trim().equals(&quot;&quot;)) ? &quot;N/A&quot; :\n(rs.getString(3).startsWith(&quot;3&quot;)?\nrs.getString(3).substring(1):rs.getString(3)))+\n                                &quot;,&quot;+\n                                ((rs.getString(4) == null ||\nrs.getString(4).trim().equals(&quot;&quot;)) ? &quot;N/A&quot; :\n(rs.getString(4).startsWith(&quot;3&quot;)?\nrs.getString(4).substring(1):rs.getString(4)))+\n                                &quot;,null,&quot;+\n                                comp+\n                                &quot;,null,null,null,null,null,null,&quot;+\n                                temp+\n\n&quot;,null,null,rs.getString(8),rs.getString(11),rs.getString(10),rs.getString(9\n)&quot;);\n\n                    dailyResultBean.addRow ( new\nHandlerSearchResultBeanRow(null,\n\nrs.getString(1),\n\n(rs.getString(3) == null || rs.getString(3).trim().equals(&quot;&quot;)) ? &quot;N/A&quot; :\n(rs.getString(3).startsWith(&quot;3&quot;)?\nrs.getString(3).substring(1):rs.getString(3)),\n\n(rs.getString(4) == null || rs.getString(4).trim().equals(&quot;&quot;)) ? &quot;N/A&quot; :\n(rs.getString(4).startsWith(&quot;3&quot;)?\nrs.getString(4).substring(1):rs.getString(4)),\n\nnull,comp,\n                                                                    null,\nnull, null,null,\n                                                                    null,\nnull,\n                                                                    temp,\n\nnull,rs.getString(2),null,null,null,rs.getString(8),rs.getString(11),rs.getS\ntring(10),rs.getString(9)));\n                }\n            dailyResultBean.sortRow1();\n            request.setAttribute(&quot;dsrb&quot;,dailyResultBean);\n            for (int iRow = 0; iRow &lt; dailyResultBean.getRowSize() ; ++iRow)\n{\n\t\t\t    com.nqb.ps.otcstats.HandlerSearchResultBeanRow row =\ndailyResultBean.getRow(iRow);\n\t\t\t    CAT.debug(&quot;Retrieved data: &quot;+row.getDate()+&quot;   &quot;+row.getOldSymbol()+\n&quot;   &quot;+row.getNewSymbol()+ &quot;   &quot;+row.getCompanyName()+ &quot;\n&quot;+row.getSecClass()+&quot;    &quot;);\n\t\t\t}\n\n            cstmt.close();\n            rs.close();\n            }\n            catch(SQLException e)\n            {\n                DB.error(&quot;problem closing the cstmt or resultset&quot;, e);\n                next = Links.ERROR_PAGE;\n            }\n            catch(Exception e)\n            {\n                CAT.error(&quot;general exception occured&quot;, e);\n                next = Links.ERROR_PAGE;\n            }\n        return next;\n        }\n}\n\n\n\n\nfor that I have written the following DailyListingSplitHandlerTest.java\nfile,\n\n\n\n\nimport java.io.*;\nimport java.sql.*;\nimport com.informix.jdbc.IfxDriver;\n\nimport java.util.*;\nimport java.lang.*;\nimport java.text.*;\n\nimport javax.servlet.*;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n\n//import com.nqb.ps.otcstats.*;\n//import com.pinksheets.util.db.*;\n\nimport junit.framework.Test;\nimport junit.framework.TestCase;\nimport junit.framework.TestSuite;\n\npublic class DailyListingSplitHandlerTest  extends TestCase{\n    String next;\n    RequestObject request;\n    ResponseObject response;\n    ContextObject context;\n    Connection conn;\n\n\n\n    public DailyListingSplitHandlerTest(String name) {\n        super(name);\n    }\n\n    protected void setUp() throws\n                ServletException, IOException {\n\n   com.pinksheets.util.db.DatabaseConnectionPool databaseConnectionPool =\nnull;\n   com.pinksheets.util.db.DatabaseObject dbObj = null;\n   RequestObject reqobj = new RequestObject();\n   ResponseObject resobj = new ResponseObject();\n   ContextObject conobj = new ContextObject();\n\n    try {\n\t\t\tdatabaseConnectionPool = new\ncom.pinksheets.util.db.DatabaseConnectionPool(\n&quot;com.informix.jdbc.IfxDriver&quot;,&quot;url&quot;,&quot;username&quot;,&quot;password&quot;,5,false );\n\t\t}\n\t\tcatch ( Exception e ) {\n\t\t\tSystem.out.println( &quot;Error while trying to connect to database. &quot;) ;\n\t\t}\n\ttry {\n\n    Connection connection =\nDriverManager.getConnection(&quot;jdbc:informix-sqli://10.53.9.83:1532/pinkstatsd\nb:INFORMIXSERVER=pstat1db&quot;,&quot;informix&quot;,&quot;eqsdb&quot;);\n\nconnection.setTransactionIsolation(Connection.TRANSACTION_READ_UNCOMMITTED);\n    dbObj = new com.pinksheets.util.db.DatabaseObject(connection);\n    }\n    catch(SQLException sqle) {\n        System.out.println(&quot;sql exception&quot; );\n\n    }\n    String act = &quot;&quot;;\n    com.nqb.ps.otcstats.handlers.DailyListingSplitHandler _bean;\n    System.out.println(&quot;blababaa&quot; + reqobj.getParameter(act));\n\n        _bean = new\ncom.nqb.ps.otcstats.handlers.DailyListingSplitHandler(&quot;Links.DAILY_LISTING_S\nPLIT_PAGE&quot;,(javax.servlet.http.HttpServletRequest)reqobj,(javax.servlet.http\n.HttpServletResponse)resobj,(ServletContext)conobj,dbObj);\n        String next = _bean.processRequest();\n        System.out.println(&quot;next is &quot; + next);\n\n    }\n\n    protected void tearDown() {\n\n    }\n\n\t\tpublic void testNumRecords() {\n\t\tint expectedcount = 18;\n\t\tint currentcount = 18;\n\t\tassertEquals(expectedcount,currentcount);\n\t\t}\n\n    public static void main(String[] args) {\n        String[] testCaseName =\n{DailyListingSplitHandlerTest.class.getName()};\n        junit.ui.TestRunner.main(testCaseName);\n    }\n\n  }\n\n\n\nI have hard coded expected count and currentcount in the testNumRecords to\nensure the top portion is working properly. The RequestObject,ResponseObject\nand ContexObject are implemented with dummy values as we can not pass\nHttpServletRequest and HttpServletResponse Objects while running the junit.\n\nIts compiling well. It complains during compilation If we do not explictly\ncast the RequestObject and ResponseObject with HttpServletRequest and\nHttpServletResponse respectively. So I have explicitly casted them.\n\nBut I am getting errors at the following line when I run the\nDailyListingSplitHandlerTest\n\n_bean = new\ncom.nqb.ps.otcstats.handlers.DailyListingSplitHandler(&quot;Links.DAILY_LISTING_S\nPLIT_PAGE&quot;,(javax.servlet.http.HttpServletRequest)reqobj,(javax.servlet.http\n.HttpServletResponse)resobj,(ServletContext)conobj,dbObj);\n\nThe error message is\n\njava.lang.ClassCastException: RequestObject \tat\nDailyListingSplitHandlerTest.setUp(DailyListingSplitHandlerTest.java:76)\n\n\nHelp..Help..Urgent.\n\nThanks in advance,\nDinesh\n\n\n\n\n\n\n\n\n", 
    "subject": "cast exception during run time"
}