{
    "numMessagesInTopic": 7, 
    "nextInTime": 7244, 
    "senderId": "JUFNmPFx0NQbbmmTnWlRGoNav0n8_kDySVqz1pQxeMSCyfLqFJq63dnvDYySAjJ1fcJoecukoIXC1U4KGJfltmmaBGbkMo1pVtEG-jxu", 
    "systemMessage": false, 
    "subject": "Memory Leak in JUnit?", 
    "from": "Eric Armstrong &lt;eric.armstrong@...&gt;", 
    "authorName": "Eric Armstrong", 
    "msgSnippet": "My test suite was running out of memory after 6 or 7 tests. I m doing a lot of nio channel opens and closes, so I thought either my app or nio had a memory", 
    "msgId": 7243, 
    "profile": "ericsilverlight", 
    "topicId": 7243, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 78994084, 
    "messageBody": "<div id=\"ygrps-yiv-803606274\">My test suite was running out of memory after<br/>\n6 or 7 tests. I&#39;m doing a lot of nio channel<br/>\nopens and closes, so I thought either my app or nio<br/>\nhad a memory leak. OptimizeIt showed that char[]&#39;s <br/>\nwere consuming a ton of memory (1900 allocated, about <br/>\nhalf that freed, consuming 139,425 KB).<br/>\n<br/>\n  Note:<br/>\n  It turned out that my IDE settings was compiling with<br/>\n  &quot;-target 1.3&quot;. Changing the target to 1.4, cut the <br/>\n  char[] count is down to 452, with 116 freed. Still not<br/>\n  great, but a lot better.<br/>\n<br/>\nTracing the allocation chain in the original version <br/>\n(targeted at 1.3) showed this distribution of allocations:<br/>\n %   in<br/>\n---  ------ <br/>\n44%  junit.textui.ResultPrinter.elapsedTimeAsString()<br/>\n2.5% junit.textui.ResultPrinter.printeDefect()<br/>\n2.5% junit.textui.TestRunner.createTestResult()<br/>\n2.0% junit.textui.TestRunner.junit.textui.TestRunner()<br/>\n     (huh????)<br/>\n<br/>\nSimilarly, out of 1624 strings allocated, for 80K,<br/>\n51% were in junit.textui.ResultPrinter.elapsedTimeAsString()<br/>\n(the numbers are probably related)<br/>\n<br/>\nUnfortunately, the percentages refer to instance counts,<br/>\nrather than amount of memory, so it&#39;s not possible to be<br/>\ntotally specific as to where the memory is going.<br/>\n<br/>\nInspection of the results shows that the elapsedTimeAsString<br/>\nstrings are hanging around in droves, anywhere from 2 to 32<br/>\nchars long. (mostly 2, as far as I can tell).<br/>\n<br/>\nSo I modified the main() method to create an instance<br/>\nof the test and invoke each of the test methods. That cut<br/>\nthe char[] instances down to 410, with 372 freed, for a<br/>\ntotal of 188,445 K. (Running that version with target=1.4<br/>\nresulted in 288 allocated, 75 freed.<br/>\n<br/>\nHere is a table showing allocated/freed:<br/>\n<br/>\n    MAIN: Invoke            Invoke Test<br/>\nTARGET    TestRunner.run()  Methods Directly<br/>\n------    ----------------  ----------------<br/>\n  1.3        1900/800           410/372<br/>\n  1.4         452/116            288/75</div>", 
    "prevInTime": 7242, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1048022290", 
    "canDelete": false, 
    "nextInTopic": 7247, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PDNFNzc4RDEyLjI0MEM2RjRGQHN1bi5jb20+"
    }
}