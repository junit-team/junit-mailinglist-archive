{
    "numMessagesInTopic": 9, 
    "nextInTime": 3959, 
    "senderId": "zf7aBSfng14lCgNZmBWirZwMhfxjG_q5e6El8IQ_BaD-KGRU9z0U3Ibmti0zQLxSLW_0dNa0EwpsyqG9osVnO2qI", 
    "systemMessage": false, 
    "subject": "Re: How to get fixture from TestSetup", 
    "from": "Todd Jonker &lt;tvj@...&gt;", 
    "authorName": "Todd Jonker", 
    "msgSnippet": "... More specifically, I m trying to start using JUnit to build Acceptance tests for a Swing-based GUI application.  The application uses a custom framework ", 
    "msgId": 3958, 
    "profile": "todd15202", 
    "topicId": 3909, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 26242706, 
    "messageBody": "<div id=\"ygrps-yiv-1716504099\">On 1/29/2002 at 6:10 PM I wrote:<br/>\n<blockquote><span title=\"ireply\"> &gt; Hello, I&#39;m trying to figure out how to properly use TestSetup, but the<br/>\n&gt; documentation is very sparse and I&#39;ve found no help on the mailing list<br/>\n&gt; archive.<br/>\n&gt; <br/>\n&gt; I understand how to wrap the appropriate TestCases inside a TestSetup,<br/>\n&gt; so that the setUp method in the wrapper is called only once for the entire<br/>\n&gt; set of TestCases.<br/>\n&gt; <br/>\n&gt; Presumably, that method (eg MyTestSetup.setUp) will initialize some<br/>\n&gt; fixture and store in in member variables.<br/>\n&gt; <br/>\n&gt; Now how do my nested TestCase instances access that common fixture?  I<br/>\n&gt; see no way to access it, and can&#39;t find any sample code that does it.<br/>\n<br/>\n<br/>\n </span></blockquote>J. B. Rainsberger &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:jbr@...\">jbr@...</a>&gt; kindly replied:<br/>\n<blockquote><span title=\"ireply\"> &gt; Perhaps this question merits an answer on my web site. If you would<br/>\n&gt; like to describe the specific thing you&#39;re trying to do, I can turn it<br/>\n&gt; into an article. :)<br/>\n<br/>\n </span></blockquote>More specifically, I&#39;m trying to start using JUnit to build Acceptance tests<br/>\nfor a Swing-based GUI application.  The application uses a custom framework<br/>\n(inspired by the Nucleus framework in ATG Dynamo) that configures all the<br/>\ncomponents and links them together into the running application.<br/>\n<br/>\nWe already have lots of Unit tests over small parts of the application, at<br/>\nthe frame and panel level, but those tests don&#39;t (and can&#39;t) really exercise<br/>\nthe the bundles of property files that configure the components.  Thus the<br/>\nneed for Acceptance tests.<br/>\n<br/>\n(I searched all over for a JUnit addon that can drive A-tests, but had no<br/>\nluck finding such a beast.  Any pointers?)<br/>\n<br/>\nSince the application startup takes a non-trivial amount of time, I&#39;d like<br/>\nto group the A-tests into sets, where each set uses a single invocation of<br/>\nthe application and tests a related area of functionality.  It looked like<br/>\nand appropriate use of TestSetup... Until I ran into the problem above.<br/>\n<br/>\nHere&#39;s more-or-less what I envision (forgive typos, I&#39;m just making this up<br/>\non the fly):<br/>\n<br/>\n<br/>\npublic class ApplicationTestSetup<br/>\n    extends TestSetup<br/>\n{<br/>\n    public void setUp()<br/>\n    {<br/>\n        myApplicationRoot = new Application();<br/>\n        myApplicationRoot.start();<br/>\n    }<br/>\n<br/>\n    public void tearDown()<br/>\n    {<br/>\n        myApplicationRoot.shutdown();<br/>\n        myApplicationRoot = null;<br/>\n    }<br/>\n<br/>\n    Application myApplicationRoot;<br/>\n}<br/>\n<br/>\n<br/>\n/**<br/>\n    A group of tests that should all run within the same Application<br/>\n    instance.<br/>\n*/<br/>\npublic class SchedulingTestSuite<br/>\n    extends ApplicationTestSetup<br/>\n{<br/>\n    public static Test suite()<br/>\n    {<br/>\n        return new SchedulingTestSuite();<br/>\n    }<br/>\n<br/>\n    public SchedulingTestSuite()<br/>\n    {<br/>\n        addTestSuite(ScheduleBookingTest.class);<br/>\n        addTestSuite(AppointmentEditorTest.class);<br/>\n        // ...<br/>\n    }<br/>\n}<br/>\n<br/>\npublic class ScheduleBookingTest<br/>\n    extends TestCase<br/>\n{<br/>\n    public void testSomething()<br/>\n    {<br/>\n        // XXX How to access the current value of myApplicationRoot?<br/>\n    }<br/>\n    public void testSomethingElse() { ... }<br/>\n}<br/>\n<br/>\n<br/>\nNow the question is:  how do the (implied) instances of ScheduleBookingTest<br/>\n(etc) access the fixture setup by ApplicationTestSetup.  I don&#39;t want to<br/>\nhave to manually name the testcases (since that ALWAYS leads to errors and<br/>\nmissed tests), so I use the reflective version of addTestSuite.<br/>\n<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; Is there something you need to do once and only once for the whole<br/>\n&gt; suite because it&#39;s otherwise difficult or expensive to do it for all<br/>\n&gt; the tests?<br/>\n<br/>\n </span></blockquote>Probably once for a subset of the tests, then again for another subset, etc.<br/>\nThe intent is to balance the risk of inter-test interference with the cost<br/>\nof application startup.  Note that our app connects to a database, which I<br/>\nbelieve  must also be wiped and re-populated with the test dataset before<br/>\neach set of tests is run.<br/>\n<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; You could have class-level attributes on the TestCase class and let the<br/>\n&gt; setUp() and tearDown() methods of the TestSetup assign values to those<br/>\n&gt; class-level attributes. For example, suppose you want to establish a<br/>\n&gt; single database connection and use it for all tests. You have two<br/>\n&gt; choices:<br/>\n<br/>\n </span></blockquote>Well, yeah... But!  Forgive me, but thatÂ¹s an extremely smelly solution.  I<br/>\nfind it hard to believe the otherwise-brilliant creators of JUnit would give<br/>\nus a design that forces the use of global variables!<br/>\n<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; public class MyDatabaseTestCase extends TestCase {<br/>\n&gt;   private static Connection connection;<br/>\n&gt; <br/>\n&gt;   public static Test suite() {<br/>\n&gt;       return new TestSetup(new TestSuite(MyDatabaseTestCase.class)) {<br/>\n&gt;           protected void setUp() throws Exception {<br/>\n&gt;               connection = DriverManager.getConnection(...);<br/>\n&gt;           }<br/>\n&gt;    <br/>\n&gt;           protected void tearDown() throws Exception {<br/>\n&gt;               connection.close();<br/>\n&gt;               connection = null;<br/>\n&gt;           }<br/>\n&gt;       };<br/>\n&gt;   }<br/>\n&gt; }<br/>\n<br/>\n </span></blockquote>Ahh... You&#39;re using an inner class for the TestSetup.  This is close, but it<br/>\nstill makes me very uncomfortable.<br/>\n<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; or, perhaps...<br/>\n&gt; <br/>\n&gt; // Danger -- connection not closed! Shutdown hook, perhaps?<br/>\n&gt; public class MyDatabaseTestCase extends TestCase {<br/>\n&gt;   private static Connection connection;<br/>\n&gt; <br/>\n&gt;   protected void setUp() throws Exception {<br/>\n&gt;       if (connection == null) {<br/>\n&gt;           connection = DriverManager.getConnection(...);<br/>\n&gt;       }<br/>\n&gt;   }<br/>\n&gt; }<br/>\n<br/>\n </span></blockquote>As you note, this doesn&#39;t properly tearDown after the tests are run, which<br/>\nis where TestSetup.tearDown would come into play.<br/>\n<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; Does that help?<br/>\n<br/>\n </span></blockquote>Well, it&#39;s a workable solution, but there&#39;s *got* to be a clean way that<br/>\ndoesn&#39;t involve static variables.  Anybody else have ideas?<br/>\n<br/>\n<br/>\n.T.<br/>\n<br/>\nTodd V. Jonker<br/>\nInpath Solutions, LLC<br/>\nwww.inpathsol.com</div>", 
    "prevInTime": 3957, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1012854071", 
    "canDelete": false, 
    "nextInTopic": 3959, 
    "prevInTopic": 3913, 
    "headers": {
        "inReplyToHeader": "PDEwMTIzOTQ5MDIuMzQwLjU0NjMwLm0xMkB5YWhvb2dyb3Vwcy5jb20+", 
        "messageIdInHeader": "PEI4ODQ1NzY3LjJGNzkldHZqQHBvYm94LmNvbT4="
    }
}