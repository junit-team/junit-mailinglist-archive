{
    "numMessagesInTopic": 9, 
    "nextInTime": 7329, 
    "senderId": "9UC-Vo36roetNsAch6-0gIQHLUglQcchVG2ToC2ZajNsTqJjdT-aPnzcXyAhc3BvKd5J0aTbIJ9JX3x5jwI4qT1yGwos4D67PJKepbmJ6kTrNNHKhA", 
    "systemMessage": false, 
    "subject": "Re: [junit] ThreadLocal", 
    "from": "&quot;Jeff Nielsen&quot; &lt;jeff.nielsen@...&gt;", 
    "authorName": "Jeff Nielsen", 
    "msgSnippet": "A common pattern we use with our web apps is this. - Factories manage the creation of resources for the next level down (e.g., web tier - EJB tier, EJB tier", 
    "msgId": 7328, 
    "rawEmail": "Return-Path: &lt;jeff.nielsen@...&gt;\r\nX-Sender: jeff.nielsen@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (EGP: mail-8_2_6_5); 25 Mar 2003 01:22:01 -0000\r\nReceived: (qmail 34985 invoked from network); 25 Mar 2003 01:22:01 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m9.grp.scd.yahoo.com with QMQP; 25 Mar 2003 01:22:00 -0000\r\nReceived: from unknown (HELO smtp4-cm.mail.eni.net) (216.133.226.137)\n  by mta1.grp.scd.yahoo.com with SMTP; 25 Mar 2003 01:22:02 -0000\r\nReceived: from jnielsen2 (0-1pool213-7.nas15.philadelphia1.pa.us.da.qwest.net [65.128.213.7])\n\tby smtp4-cm.mail.eni.net (8.12.8/8.12.8) with SMTP id h2P1LxvN016455\n\tfor &lt;junit@yahoogroups.com&gt;; Mon, 24 Mar 2003 17:22:00 -0800\r\nMessage-ID: &lt;009701c2f26d$768dd980$e705000a@jnielsen2&gt;\r\nTo: &lt;junit@yahoogroups.com&gt;\r\nReferences: &lt;3E7E09B2.8010505@...&gt; &lt;20030324031214.95DEB1B6E6@...&gt; &lt;3E7F03A4.30401@...&gt;\r\nSubject: Re: [junit] ThreadLocal\r\nDate: Mon, 24 Mar 2003 20:25:45 -0500\r\nMIME-Version: 1.0\r\nContent-Type: text/plain;\n\tcharset=&quot;iso-8859-1&quot;\r\nContent-Transfer-Encoding: 7bit\r\nX-Priority: 3\r\nX-MSMail-Priority: Normal\r\nX-Mailer: Microsoft Outlook Express 5.50.4522.1200\r\nX-MimeOLE: Produced By Microsoft MimeOLE V5.50.4522.1200\r\nFrom: &quot;Jeff Nielsen&quot; &lt;jeff.nielsen@...&gt;\r\nX-Yahoo-Group-Post: member; u=65487161\r\nX-Yahoo-Profile: jeffreymads\r\n\r\nA common pattern we use with our web apps is this.\n\n- Factories manage the creation of resources for the next level down (e.g.,\nweb tier -&gt; EJB tier, EJB tier -&gt; integration tier)\n\n- Classes that need to access/instantiate resources in a lower layer (e.g.,\nan EJB that needs a DB connection) take a factory object at construction\ntime.\n\n- The factories are configured at runtime using simple java property files\n(e.g., use.database=true, use.ejbs=false)\n\n- Test code can configure factories using parameters (e.g., testFactory =\nnew DataSourceFactory(false) . . . ) and pass these factories in to the\nobject(s) under test.\n\nThis allows us to ensure that tests always use the mock objects, without\n&quot;cluttering&quot; the production code with lots of conditional logic or extra\nmethod parameters.\n\nJeff Nielsen\nDigital Focus\nwww.digitalfocus.com\n\n----- Original Message -----\nFrom: &quot;David Corbin&quot; &lt;dcorbin@...&gt;\nTo: &lt;junit@yahoogroups.com&gt;\nSent: Monday, March 24, 2003 8:09 AM\nSubject: Re: [junit] ThreadLocal\n\n\n&gt; Jason Rogers wrote:\n&gt;\n&gt; &gt;On Sun, 23 Mar 2003 14:23:30 -0500, &quot;David Corbin&quot;\n&gt; &gt;&lt;dcorbin@...&gt; said:\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;&gt;   I&#39;m getting tired of having to pass some objects through 6-8 methods,\n&gt; &gt;&gt;   and it&#39;s making method signatures very ugly.\n&gt; &gt;&gt;   The question is, what do folks think about using ThreadLocal to\ncreate\n&gt; &gt;&gt;   &quot;per   request  singleton-like&quot;  objects.   By  using  a  common\nbase\n&gt; &gt;&gt;   TestCase,\n&gt; &gt;&gt;   I could set up the TLS easily enough without overburdening the unit\n&gt; &gt;&gt;   tests, I think.\n&gt; &gt;&gt;   David\n&gt; &gt;&gt;\n&gt; &gt;&gt;\n&gt; &gt;\n&gt; &gt;I think was you are sensing is a &quot;code smell.&quot;\n&gt; &gt;\n&gt; There&#39;s no doubt about that.  It&#39;s a question of how to solve the smell.\n&gt;\n&gt; &gt; I don&#39;t have an opinion\n&gt; &gt;about the TLS you mentioned but I would suggest using this &quot;pain&quot; to\n&gt; &gt;force yourself to refactor some more.  For instance, you could use\n&gt; &gt;Factories, Delegators|Facades, or Proxies instead polluting your API with\n&gt; &gt;unneeded args.\n&gt; &gt;\n&gt; &gt;\n&gt; &lt;snip&gt;\n&gt;\n&gt; &gt;In some cases, that may be the thing to do, in\n&gt; &gt;others however it makes more sense for the object you are testing to have\n&gt; &gt;those things implicitly available -- your situation sounds a lot like the\n&gt; &gt;latter.\n&gt; &gt;\n&gt; &gt;\n&gt; Well, as near as I can tell there are 4 choices on how something is made\n&gt; available:\n&gt;\n&gt; 1) at construction\n&gt; 2) as an argument\n&gt; 3) as a global/singleton\n&gt; 4) as ThreadLocal (similar to #3, but more flexible, certainly in the\n&gt; web environment)\n&gt;\n&gt; #2 is what I&#39;ve been doing, and has created the smell\n&gt; #1 generally doesn&#39;t work well, because the &quot;something&quot; may not be very\n&gt; tightly bound to the object being constucted.\n&gt; That leaves #3 and #4.  I have a long-standing global-phobia.  Perhaps\n&gt; it&#39;s too strong. #4 of course, isn&#39;t that differrent from #3 ( think of\n&gt; them as semi-global).\n&gt;\n&gt; Have a missed a choice?\n&gt;\n&gt; David.\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;\n&gt;       Yahoo! Groups Sponsor\n&gt;             ADVERTISEMENT\n&gt;\n&gt;\n&gt;\n&gt;\n&gt; To unsubscribe from this group, send an email to:\n&gt; junit-unsubscribe@yahoogroups.com\n&gt;\n&gt;\n&gt; Your use of Yahoo! Groups is subject to the Yahoo! Terms of Service.\n&gt;\n&gt;\n\n\n", 
    "profile": "jeffreymads", 
    "topicId": 7316, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 65487161, 
    "prevInTime": 7327, 
    "contentTrasformed": false, 
    "postDate": "1048555545", 
    "canDelete": false, 
    "nextInTopic": 7333, 
    "prevInTopic": 7327, 
    "headers": {
        "messageIdInHeader": "PDAwOTcwMWMyZjI2ZCQ3NjhkZDk4MCRlNzA1MDAwYUBqbmllbHNlbjI+", 
        "referencesHeader": "PDNFN0UwOUIyLjgwMTA1MDVAbWFjaHR1cnRsZS5jb20+IDwyMDAzMDMyNDAzMTIxNC45NURFQjFCNkU2QHd3dy5mYXN0bWFpbC5mbT4gPDNFN0YwM0E0LjMwNDAxQG1hY2h0dXJ0bGUuY29tPg=="
    }
}