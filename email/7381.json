{
    "numMessagesInTopic": 9, 
    "nextInTime": 7382, 
    "senderId": "vH-QG8mR1m9nB1OqDgVDEZ3btcs7PwZKhXR20NozNQhSo4Y18GguvjPeEvYjuhIll3StegkHb0qTNHdDcAte4lURhxpx1sKdwGnAg3faVqNWpe3HvQdpm8c", 
    "systemMessage": false, 
    "subject": "RE: [junit] ThreadLocal", 
    "from": "&quot;Shellman, Joel&quot; &lt;joel.shellman@...&gt;", 
    "authorName": "Shellman, Joel", 
    "msgSnippet": "Jeff, did you design this up front, or did this evolve from TDD (Test Driven Development)? I m curious as to what solution would naturally evolve out of TDD", 
    "msgId": 7381, 
    "profile": "joelshellman", 
    "topicId": 7316, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 135169457, 
    "messageBody": "<div id=\"ygrps-yiv-337482217\">Jeff, did you design this up front, or did this evolve from TDD (Test Driven Development)?<br/>\n<br/>\nI&#39;m curious as to what solution would naturally evolve out of TDD for this (and whether there is only one design that would given strict conformance to certain guidelines). Extrapolating Kent Beck&#39;s example in his TDD book, one might expect what Jeff has outlined below--with factories passed in to the constructors since he refactored out duplication by passing it in to the constructor (at least in a couple cases).<br/>\n<br/>\nOne of the great benefits of passing in factories and collaborators is that you can significantly increase the reuse and usefulness of each class. New functionality could be added by simply passing in a different factory.<br/>\n<br/>\nHaving said that, I&#39;ve used the ThreadLocal approach before and it seems to work fine both in production and for testing, but I&#39;m still a little uncomfortable with it from a design standpoint.<br/>\n<br/>\nJoel Shellman<br/>\n<br/>\n<br/>\n<blockquote><span title=\"qreply\"> &gt; -----Original Message-----<br/>\n&gt; From: Jeff Nielsen <br/>\n&gt; Sent: Monday, March 24, 2003 5:24 PM<br/>\n&gt; To: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\n&gt; Subject: Re: [junit] ThreadLocal<br/>\n&gt; <br/>\n&gt; <br/>\n&gt; A common pattern we use with our web apps is this.<br/>\n&gt; <br/>\n&gt; - Factories manage the creation of resources for the next <br/>\n&gt; level down (e.g., web tier -&gt; EJB tier, EJB tier -&gt; integration tier)<br/>\n&gt; <br/>\n&gt; - Classes that need to access/instantiate resources in a <br/>\n&gt; lower layer (e.g., an EJB that needs a DB connection) take a <br/>\n&gt; factory object at construction time.<br/>\n&gt; <br/>\n&gt; - The factories are configured at runtime using simple java <br/>\n&gt; property files (e.g., use.database=true, use.ejbs=false)<br/>\n&gt; <br/>\n&gt; - Test code can configure factories using parameters (e.g., <br/>\n&gt; testFactory = new DataSourceFactory(false) . . . ) and pass <br/>\n&gt; these factories in to the<br/>\n&gt; object(s) under test.<br/>\n&gt; <br/>\n&gt; This allows us to ensure that tests always use the mock <br/>\n&gt; objects, without &quot;cluttering&quot; the production code with lots <br/>\n&gt; of conditional logic or extra method parameters.<br/>\n&gt; <br/>\n&gt; Jeff Nielsen<br/>\n&gt; Digital Focus<br/>\n&gt; www.digitalfocus.com </span></blockquote></div>", 
    "prevInTime": 7380, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1048627823", 
    "canDelete": false, 
    "nextInTopic": 7401, 
    "prevInTopic": 7333, 
    "headers": {
        "messageIdInHeader": "PEVYLTIwMDMwMzI1LTE1MzM0Ni0wMDA1QGV4Y2hhbmdlLmZpc2Vydi1taXNzaXZlMS5maXNlcnYubmV0Pg=="
    }
}