{
    "numMessagesInTopic": 8, 
    "nextInTime": 20595, 
    "senderId": "nSLh5Pq11MpLb0C1n33DuaVsAwmfkANfdnqxlbtDjHsz_YuT2nbYzHaEKChPXHEhn_ZhEnLwWBOxwTf0AJVIgGGa2N8DuiJ_", 
    "systemMessage": false, 
    "subject": "Re: [junit] Testing code that depends on today&#39;s date", 
    "from": "&quot;Nat Pryce&quot; &lt;nat.pryce@...&gt;", 
    "authorName": "Nat Pryce", 
    "msgSnippet": "There are two things you can do.  A) separate code that performs calculations on dates from the code that gets the current date.  B) get the current date get", 
    "msgId": 20594, 
    "rawEmail": "Return-Path: &lt;nat.pryce@...&gt;\r\nX-Sender: nat.pryce@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 11160 invoked from network); 18 Jun 2008 07:26:25 -0000\r\nX-Received: from unknown (66.218.67.95)\n  by m49.grp.scd.yahoo.com with QMQP; 18 Jun 2008 07:26:25 -0000\r\nX-Received: from unknown (HELO an-out-0708.google.com) (209.85.132.249)\n  by mta16.grp.scd.yahoo.com with SMTP; 18 Jun 2008 07:26:24 -0000\r\nX-Received: by an-out-0708.google.com with SMTP id b20so33566ana.48\n        for &lt;junit@yahoogroups.com&gt;; Wed, 18 Jun 2008 00:26:24 -0700 (PDT)\r\nX-Received: by 10.100.110.15 with SMTP id i15mr358772anc.97.1213773984314;\n        Wed, 18 Jun 2008 00:26:24 -0700 (PDT)\r\nX-Received: by 10.100.177.19 with HTTP; Wed, 18 Jun 2008 00:26:24 -0700 (PDT)\r\nMessage-ID: &lt;17fa53d0806180026r7c156fdeh681da564c053b466@...&gt;\r\nDate: Wed, 18 Jun 2008 08:26:24 +0100\r\nTo: junit@yahoogroups.com\r\nIn-Reply-To: &lt;860D47F8904F6041AEEE55F9B684667F162D46EF05@...&gt;\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Transfer-Encoding: 7bit\r\nContent-Disposition: inline\r\nReferences: &lt;860D47F8904F6041AEEE55F9B684667F162D46EF05@...&gt;\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: &quot;Nat Pryce&quot; &lt;nat.pryce@...&gt;\r\nSubject: Re: [junit] Testing code that depends on today&#39;s date\r\nX-Yahoo-Group-Post: member; u=216973656; y=htfw7l2h65odBEC18hwoPujdQrY2UxkWd4QCC2yjyjPi9M5k\r\nX-Yahoo-Profile: nat_pryce\r\n\r\nThere are two things you can do.  A) separate code that performs\ncalculations on dates from the code that gets the current date.  B)\nget the current date get it through an abstract interface.\n\nE.g. suppose I have a method like...\n\n   Money currentValue() {\n       Date today = new Date();\n       ...\n   }\n\nI&#39;d turn that into:\n\n    Money valueAt(Date date) {\n        ...\n    }\n\nand have another object decide what date to pass in.\n\nThat other object can get the date through an abstract interface. (I\nusually call that interface &quot;Clock&quot; to avoid confusion with the\nexisting java.util.Calendar class).  I find its usually one of the\nfirst things I write on every project -- if only it was in the\nstandard library.\n\nI find that separating calculation with dates from the choice of date\nto use means I don&#39;t have to pass the clock around everywhere.  It\nalso makes the code more flexible.  It can, if asked to, implement\nwhat-if calculations without major redesign, for example.\n\n--Nat\n\n\n2008/6/17 Per Jacobsson &lt;perjacobsson@...&gt;:\n&gt; Hi,\n&gt; This has been annoying me for a while and I can&#39;t think of a clean solution\n&gt; for it. Hope this makes sense: I have some code that returns different\n&gt; results depending on what today&#39;s date is (the number of days since a user\n&gt; first registered, etc). The simple approach is to just create a new instance\n&gt; of java.util.Date whenever I need to know the current date, but that tends\n&gt; to make both unit and automated functional testing difficult.\n&gt;\n&gt; I&#39;m currently injecting today&#39;s date into the classes that need it, and then\n&gt; the tests can just use a static date. It gets pretty ugly though, a lot of\n&gt; times this date has to be dragged along deep into the domain model.\n&gt;\n&gt; An alternative would be to take the old school approach and have a static\n&gt; factory that everything that needs to know today&#39;s date calls, and allow the\n&gt; unit tests to override with a test date. Of course, then you run into all\n&gt; the other issues that dependency injection solves.\n&gt;\n&gt; Any thoughts?\n&gt; Thanks,\n&gt; / Per\n&gt;\n&gt; [Non-text portions of this message have been removed]\n&gt;\n&gt; \n\n", 
    "profile": "nat_pryce", 
    "topicId": 20590, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 216973656, 
    "prevInTime": 20593, 
    "contentTrasformed": false, 
    "postDate": "1213773984", 
    "canDelete": false, 
    "nextInTopic": 20596, 
    "prevInTopic": 20593, 
    "headers": {
        "inReplyToHeader": "PDg2MEQ0N0Y4OTA0RjYwNDFBRUVFNTVGOUI2ODQ2NjdGMTYyRDQ2RUYwNUBFWENIQU5HRS1WUzEuZWhhcm1vbnkuY29tPg==", 
        "messageIdInHeader": "PDE3ZmE1M2QwODA2MTgwMDI2cjdjMTU2ZmRlaDY4MWRhNTY0YzA1M2I0NjZAbWFpbC5nbWFpbC5jb20+", 
        "referencesHeader": "PDg2MEQ0N0Y4OTA0RjYwNDFBRUVFNTVGOUI2ODQ2NjdGMTYyRDQ2RUYwNUBFWENIQU5HRS1WUzEuZWhhcm1vbnkuY29tPg=="
    }
}