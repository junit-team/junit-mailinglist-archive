{
    "numMessagesInTopic": 21, 
    "nextInTime": 20521, 
    "senderId": "Tj899zFPPoAaiBS-MVtfizyzVwsTw76YmuPx3wjaHBPCyT5LUrQev48uBl5j6qWqpxZ7MgJNsuabt_xwIwDFaOOMOat7gtDqsMWQf0Wh81eE", 
    "systemMessage": true, 
    "subject": "Re: [junit] Re: What is expected behavior on Assert.assertEquals on Number object?", 
    "from": "Nattapong Sirilappanich &lt;natta@...&gt;", 
    "authorName": "Nattapong Sirilappanich", 
    "msgSnippet": "Actually, my point here is i m expecting org.junit.Assert.assertEquals(Object obj1, Object obj2) to call its obj1.equals(obj2) or something like this. However,", 
    "msgId": 20520, 
    "profile": "nat_tul", 
    "topicId": 20513, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 348330670, 
    "messageBody": "<div id=\"ygrps-yiv-598711105\">Actually, my point here is i&#39;m expecting<br/>\norg.junit.Assert.assertEquals(Object obj1, Object obj2) to call its<br/>\nobj1.equals(obj2) or something like this.<br/>\nHowever, the outcome surprise me.<br/>\nAssertion success but obj1.equals(obj2) return false.<br/>\n<br/>\nWhat&#39;s going on inside assertEquals() operation?<br/>\nIs this what it&#39;s suppose to be?<br/>\n<br/>\nBest regards,<br/>\nNattapong Sirilappanich<br/>\nEngineer, National Language Development - GCoC & TSC Thailand<br/>\nSoftware Group, IBM Thailand Co., Ltd.<br/>\nNational Phone: 02-273-4715, Fax: 02-619-2030<br/>\nInternational Phone: +66 2 273 4715, Fax: +66 2 619 2030<br/>\ne-mail: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:natta@...\">natta@...</a><br/>\n<br/>\n<br/>\n                                                                           <br/>\n             &quot;Roger Glover&quot;                                                <br/>\n             &lt;glover_roger@yah                                             <br/>\n             oo.com&gt;                                                    To <br/>\n             Sent by:                  <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>               <br/>\n             junit@yahoogroups                                          cc <br/>\n             .com                                                          <br/>\n                                                                   Subject <br/>\n                                       [junit] Re: What is expected        <br/>\n             06/06/2008 01:43          behavior on Assert.assertEquals on  <br/>\n                                       Number object?                      <br/>\n                                                                           <br/>\n             Please respond to                                             <br/>\n             junit@yahoogroups                                             <br/>\n                   .com                                                    <br/>\n                                                                           <br/>\n                                                                           <br/>\n<br/>\n<br/>\n<br/>\n<br/>\n                                                                                    <br/>\n                                                                                    <br/>\n                                                                                    <br/>\n                                                                                    <br/>\n                                                                                    <br/>\n                                                                                    <br/>\n --- In <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a>, &quot;J. B. Rainsberger&quot; &lt;jbrains762@...&gt;                 <br/>\n wrote:                                                                             <br/>\n<blockquote><span title=\"qreply\">  On Jun 3, 2008, at 22:41 , Nattapong Sirilappanich wrote:                          <br/>\n Hi,                                                                                <br/>\n                                                                                    <br/>\n When i try to make an assertion on Number object, e.g. Double the                  <br/>\n result always assertion successful. Even i try to compare by                       <br/>\n                                                                                    <br/>\n org.junit.Assert.assertEquals(123456789.345,123456789.34)                          <br/>\n                                                                                    <br/>\n it still success. (I&#39;m expecting failure)                                          <br/>\n This is not a good way to compare floating point numbers. You should               <br/>\n actually use:                                                                      <br/>\n                                                                                    <br/>\n Assert.assertEquals(expected, actual, delta)                                       <br/>\n                                                                                    <br/>\n where expected and actual are as in the form you did use, but there is a           <br/>\n third &quot;delta&quot; argument (also a double). This argument provides a                   <br/>\n tolerance value by which to judge &quot;equality&quot;. basically the assertion              <br/>\n fails if:                                                                          <br/>\n                                                                                    <br/>\n Math.abs(expected - actual) &gt; delta                                                <br/>\n                                                                                    <br/>\n Thus, working from your failing example:                                           <br/>\n                                                                                    <br/>\n Assert.assertEquals(123456789.345, 123456789.34, 0.5); // PASS                     <br/>\n Assert.assertEquals(123456789.345, 123456789.34, 0.0005); // FAIL                  <br/>\n                                                                                    <br/>\n By the way, this usage really makes the name of the method a misnomer.             <br/>\n It should really be called &quot;assertClose&quot; (as in &quot;close, but no cigar&quot;,             <br/>\n not &quot;close the door; it&#39;s cold&quot;). But that should be okay if you are               <br/>\n using double the way it is meant to be used, because, as the old saying            <br/>\n goes, close only counts in horseshoes, hand grenades, and limited                  <br/>\n precision floating point operations.                                               <br/>\n                                                                                    <br/>\n In other words, the idea is that after even a few operations (or even              <br/>\n after none in some cases) it is unreasonable to expect floating point              <br/>\n quantities to be exactly equal to their unlimited precision real number            <br/>\n counterparts (even when an exact match exists). So you aim for &quot;close&quot;             <br/>\n instead. &quot;How close can you get&quot; is itself a black art that combines               <br/>\n roughly equal portions of operation counting, number magnitude tracking,           <br/>\n operation order tracking, and wild-ass guessing.                                   <br/>\n                                                                                    <br/>\n Now back to the problem at hand. Just for grins I compiled Nattapong&#39;s             <br/>\n original assert under a J2SE 1.4 compiler and it gave a syntax error,              <br/>\n saying that essentially that the third double argument was missing. It             <br/>\n appears that this is one of those rare-but-not-rare-enough cases when              <br/>\n autoboxing is actually working against you.                                        <br/>\n                                                                                    <br/>\n And now J.B.&#39;s response...                                                         <br/>\n Weird. assertEquals() appears only to compare the whole parts.                     <br/>\n                                                                                    <br/>\n public class DoubleTest {                                                          <br/>\n @Test                                                                              <br/>\n public void unequalDoubleValueObjectsShouldBeUnequal() {                           <br/>\n Assert.assertFalse(new Double(3).equals(new Double(4)));                           <br/>\n Assert.assertFalse(new Double(3.1d).equals(new Double(3.2d)));                     <br/>\n Assert.assertFalse(new Double(123456789.345d).equals(new                           <br/>\n Double(123456789.34d)));                                                           <br/>\n So far so good...                                                                  <br/>\n Assert.assertEquals(new Double(123456789.345d), new                                <br/>\n Double(123456789.34d));                                                            <br/>\n When compiled under J2SE 1.4 the above assertEquals() fails. So, once              <br/>\n again, I suspect autoboxing is the culprit. In this case I suspect the             <br/>\n Doubles are being &quot;unboxed&quot; into longs, since there is a two-long                  <br/>\n assertEquals() but not a two-double assertEquals().                                <br/>\n Assert.assertEquals(new Double(3.1d), new Double(3.2d));                           <br/>\n Same with the above.                                                               <br/>\n Assert.assertEquals(new Double(3), new Double(4));                                 <br/>\n Same with the above, but if I am right this one fails (as J.B. noted)              <br/>\n because the                                                                        <br/>\n integral parts are different, so you get different longs.                          <br/>\n }                                                                                  <br/>\n }                                                                                  <br/>\n                                                                                    <br/>\n Only the last assertion fails.                                                     <br/>\n This behavior makes me wonder if in Nattapong&#39;s original case the                  <br/>\n primitive doubles are being boxed into object Doubles which are, in                <br/>\n turn, being unboxed into primitive longs. If that is not what is                   <br/>\n happening, something even stranger is going on. Either way, I don&#39;t like           <br/>\n it.                                                                                <br/>\n                                                                                    <br/>\n -- Roger Glover                                                                    <br/>\n Object Partners, Inc.                                                              <br/>\n                                                                                    <br/>\n [Non-text portions of this message have been removed]                              <br/>\n                                                                                    <br/>\n                                                                                    <br/>\n                                                                                    <br/>\n <br/>\n<br/>\n[Non-text portions of this message have been removed] </span></blockquote></div>", 
    "prevInTime": 20519, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1212726873", 
    "canDelete": false, 
    "nextInTopic": 20521, 
    "prevInTopic": 20519, 
    "headers": {
        "inReplyToHeader": "PGcyOWM0bCttZ2ZvQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PE9GRjBGODU3MzAuOUNGODIxRTktT040NzI1NzQ2MC4wMDE4NzY2OS00NzI1NzQ2MC4wMDE5MEFGN0B0aC5pYm0uY29tPg=="
    }
}