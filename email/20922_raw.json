{
    "numMessagesInTopic": 2, 
    "nextInTime": 20923, 
    "senderId": "Iwo-4fEL-w1els1rVaMfqxQ6JeHqO9mN4tvVzkS3ghyrZsXG5vLighJm417pBWISpFU0iN87QZM-9sL79KAfzDSKwEE", 
    "systemMessage": false, 
    "subject": "Re: [junit] not able to run the junit please help", 
    "from": "&quot;David Saff&quot; &lt;david@...&gt;", 
    "authorName": "David Saff", 
    "msgSnippet": "Sushil, I would definitely recommend trying to write JUnit tests for a simple, self-contained class first, to make sure you understand the basics. Then,", 
    "msgId": 20922, 
    "rawEmail": "Return-Path: &lt;david.saff@...&gt;\r\nX-Sender: david.saff@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 78027 invoked from network); 24 Sep 2008 20:59:43 -0000\r\nX-Received: from unknown (66.218.67.94)\n  by m54.grp.scd.yahoo.com with QMQP; 24 Sep 2008 20:59:43 -0000\r\nX-Received: from unknown (HELO wf-out-1314.google.com) (209.85.200.171)\n  by mta15.grp.scd.yahoo.com with SMTP; 24 Sep 2008 20:59:43 -0000\r\nX-Received: by wf-out-1314.google.com with SMTP id 26so123773wfd.1\n        for &lt;junit@yahoogroups.com&gt;; Wed, 24 Sep 2008 13:59:43 -0700 (PDT)\r\nX-Received: by 10.142.172.12 with SMTP id u12mr2751004wfe.180.1222289982696;\n        Wed, 24 Sep 2008 13:59:42 -0700 (PDT)\r\nX-Received: by 10.142.101.9 with HTTP; Wed, 24 Sep 2008 13:59:42 -0700 (PDT)\r\nMessage-ID: &lt;4f7da6b90809241359n63ab03f1l6be1c45d8d2b2896@...&gt;\r\nDate: Wed, 24 Sep 2008 16:59:42 -0400\r\nTo: junit@yahoogroups.com\r\nIn-Reply-To: &lt;307465.26762.qm@...&gt;\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Transfer-Encoding: 7bit\r\nContent-Disposition: inline\r\nReferences: &lt;307465.26762.qm@...&gt;\r\nX-Google-Sender-Auth: 82f64f9d95dbdea0\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: &quot;David Saff&quot; &lt;david@...&gt;\r\nSubject: Re: [junit] not able to run the junit please help\r\nX-Yahoo-Group-Post: member; u=341876227; y=OZLthY-edGK6rsCUuN2Q0Zg50RPrC7wjxP4XjHxF5Tg\r\nX-Yahoo-Profile: dsaff\r\n\r\nSushil,\n\nI would definitely recommend trying to write JUnit tests for a simple,\nself-contained class first, to make sure you understand the basics.\nThen, practice some with jMock.  It looks like you&#39;re jumping in with\nboth feet here.\n\n   David Saff\n\nOn Wed, Sep 10, 2008 at 11:28 AM, Sushil Dodake &lt;sushil_d10@...&gt; wrote:\n&gt; Hi guys...\n&gt; i am trying to write a junit test class for the class which uses the ldap\n&gt; template.\n&gt; i am confued as i cant solve this.\n&gt; can sombody help me here\n&gt; i a posting my original calss and the test class.\n&gt; the exception i m getting is as below\n&gt;\n&gt; when i debugged the stuff i found out that the ContextSource is not se in\n&gt; the MOCKed LDAP template object. i tried setting it.\n&gt; i m new to writing the junit test class.\n&gt; i dont know if i am missing anything here.\n&gt;\n&gt; com.XXX.YYY.reporting.exception.ReportingException: Error getting\n&gt; distributor info from LDAP\n&gt; at\n&gt; com.XXX.YYY.reporting.dao.LdapDaoImpl.getAllActiveDomesticDistributor(LdapDaoImpl.java:52)\n&gt; at\n&gt; com.XXX.YYY.reporting.dao.LdapDaoImplTest.testGetAllActiveDomesticDistributor(LdapDaoImplTest.java:43)\n&gt; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n&gt; at\n&gt; sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n&gt; at\n&gt; sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n&gt; at java.lang.reflect.Method.invoke(Method.java:597)\n&gt; at junit.framework.TestCase.runTest(TestCase.java:154)\n&gt; at org.jmock.core.VerifyingTestCase.runBare(VerifyingTestCase.java:39)\n&gt; at junit.framework.TestResult$1.protect(TestResult.java:106)\n&gt; at junit.framework.TestResult.runProtected(TestResult.java:124)\n&gt; at junit.framework.TestResult.run(TestResult.java:109)\n&gt; at junit.framework.TestCase.run(TestCase.java:118)\n&gt; at junit.framework.TestSuite.runTest(TestSuite.java:208)\n&gt; at junit.framework.TestSuite.run(TestSuite.java:203)\n&gt; at\n&gt; org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run(JUnit3TestReference.java:128)\n&gt; at\n&gt; org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n&gt; at\n&gt; org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)\n&gt; at\n&gt; org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)\n&gt; at\n&gt; org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)\n&gt; at\n&gt; org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:196)\n&gt; Caused by: org.jmock.core.DynamicMockError: mockLdapTemplate: unexpected\n&gt; invocation\n&gt; Invoked: mockLdapTemplate.search(&quot;&quot;,\n&gt; &quot;(&(ttcUserType=distributor)(ttcgeographicregion=United States))&quot;,\n&gt; &lt;com.XXX.YYY.reporting.dao.LdapDaoImpl$DistributorInfoAttributeMapper@1e12f6d&gt;)\n&gt; Allowed:\n&gt; expected once: search( eq(&lt;class java.lang.String&gt;), eq(&lt;class\n&gt; java.lang.String&gt;), eq(&lt;class\n&gt; com.XXX.YYY.reporting.dao.LdapDaoImpl$DistributorInfoAttributeMapper&gt;) ),\n&gt; returns &lt;com.XXX.YYY.reporting.struts.form.DistributorInfo@15428dd&gt;\n&gt;\n&gt; at\n&gt; org.jmock.core.AbstractDynamicMock.mockInvocation(AbstractDynamicMock.java:58)\n&gt; at org.jmock.cglib.CGLIBCoreMock.intercept(CGLIBCoreMock.java:71)\n&gt; at\n&gt; org.springframework.ldap.core.LdapTemplate$$EnhancerByCGLIB$$3bfb79d.search(&lt;generated&gt;)\n&gt; at\n&gt; com.XXX.YYY.reporting.dao.LdapDaoImpl.getAllActiveDomesticDistributor(LdapDaoImpl.java:47)\n&gt; ... 19 morethe actual source file looks as below\n&gt;\n&gt; Code:\n&gt; /**\n&gt; * private logger instance for logging.\n&gt; */\n&gt; private static final Logger LOG = Logger.getLogger(LdapDaoImpl.class);\n&gt;\n&gt; private LdapTemplate ldapTemplate;\n&gt;\n&gt; /**\n&gt; * @param ldapTemplate the ldapTemplate to set\n&gt; */\n&gt; public void setLdapTemplate(LdapTemplate ldapTemplate) {\n&gt; this.ldapTemplate = ldapTemplate;\n&gt; }\n&gt;\n&gt; /**\n&gt; * This method retreives all domestic distributors from LDAP\n&gt; * @exception reporting exception\n&gt; * @return list of distributors with company name and the distributor ID\n&gt; */\n&gt; public List getAllActiveDomesticDistributor()throws ReportingException{\n&gt; List distList= null;\n&gt;\n&gt; try{\n&gt; AndFilter filter = new AndFilter();\n&gt; filter.and(new EqualsFilter(ReportingConstant.TTC_USER_TYPE,\n&gt; ReportingConstant.DISTRIBUTOR));\n&gt; filter.and(new EqualsFilter(ReportingConstant.GEOGRAPHIC_REGION,\n&gt; ReportingConstant.US));\n&gt; System.out.println(filter.encode());\n&gt; distList = ldapTemplate.search(ReportingConstant.BLANK, filter.encode(), new\n&gt; DistributorInfoAttributeMapper());\n&gt; distList = sanitizeDistributorList(distList);\n&gt; LOG.debug(&quot;List Distributor Info retrieved from LDAP&quot;);\n&gt; }catch(Throwable t){\n&gt; LOG.error(&quot;Error getting distributor info from LDAP&quot;);\n&gt; throw new ReportingException(&quot;Error getting distributor info from LDAP&quot;, t);\n&gt; }\n&gt; return distList;\n&gt; }\n&gt;\n&gt; /**\n&gt; * Inner Class for the retrived attribute mapper\n&gt; */\n&gt; protected class DistributorInfoAttributeMapper implements AttributesMapper{\n&gt; public Object mapFromAttributes(Attributes attri) throws NamingException {\n&gt; DistributorInfo distInfo = new DistributorInfo();\n&gt; distInfo.setDistributorId((String)attri.get(ReportingConstant.TTC_CUST_ID).get());\n&gt; distInfo.setCompanyName((String)attri.get(ReportingConstant.TTC_COMPANY_NAME).get());\n&gt; return distInfo;\n&gt; }\n&gt; }\n&gt;\n&gt; /**\n&gt; * Format the retrived distributor info from LDAP\n&gt; * prepends 000 to distributor ID also prepends the distributor ID to the\n&gt; company name\n&gt; */\n&gt; private List sanitizeDistributorList (List distInfo){\n&gt; List distributors = new ArrayList();\n&gt; for (int i=0; i&lt;distInfo.size(); i++){\n&gt; DistributorInfo distributorInfo = (DistributorInfo)distInfo.get(i);\n&gt; String distId = distributorInfo.getDistributorId();\n&gt; String compName = distributorInfo.getCompanyName();\n&gt; if(hasNumber(distId)){\n&gt; if(Integer.parseInt(distId)&lt; 600){\n&gt; distributorInfo.setDistributorId(ReportingConstant.TRIPLE_ZERO + distId);\n&gt; distributorInfo.setCompanyName(distId + ReportingConstant.DASH + compName);\n&gt; distributors.add(distributorInfo);\n&gt; }\n&gt; }\n&gt; }\n&gt; return distributors;\n&gt; }\n&gt;\n&gt; /**\n&gt; * Verifies if the string has a numbers in it\n&gt; */\n&gt; private boolean hasNumber(String s) {\n&gt; for (int j = 0;j &lt; s.length();j++)\n&gt; if (!Character.isDigit(s.charAt(j))) return false;\n&gt; return true;\n&gt; }my application context looks as below\n&gt;\n&gt; Code:\n&gt; &lt;bean id=&quot;ldapDao&quot; class=&quot; com.toro.rebate.reporting.dao.LdapDaoImpl&quot;&gt;\n&gt; &lt;property name=&quot;ldapTemplate&quot; ref=&quot;ldapTemplate&quot;/&gt;\n&gt;\n&gt; &lt;/bean&gt;\n&gt;\n&gt;\n&gt; &lt;bean id=&quot;contextSource&quot;\n&gt; class=&quot;org.springframework.ldap.core.support.LdapContextSource&quot;&gt;\n&gt; &lt;property name=&quot;url&quot;&gt;&lt;value&gt;${LDAP.url}&lt;/value&gt;&lt;/property&gt;\n&gt; &lt;property name=&quot;base&quot;&gt;&lt;value&gt;${LDAP.base}&lt;/value&gt;&lt;/property&gt;\n&gt; &lt;/bean&gt;\n&gt; &lt;bean id=&quot;ldapTemplate&quot; class=&quot;org.springframework.ldap.core.LdapTemplate&quot;&gt;\n&gt; &lt;constructor-arg ref=&quot;contextSource&quot; /&gt;\n&gt; &lt;/bean&gt;\n&gt; and my test clas is as below\n&gt;\n&gt; Code:\n&gt; public class LdapDaoImplTest extends MockObjectTestCase{\n&gt;\n&gt; private LdapDaoImpl ldapDao;\n&gt; AndFilter filter;\n&gt; Mock andFilterMock;\n&gt;\n&gt; LdapTemplate ldapTemplate;\n&gt; Mock ldapTemplateMock;\n&gt;\n&gt; protected void setUp() throws Exception{\n&gt; ldapTemplateMock = mock(LdapTemplate.class);\n&gt; ldapDao = new LdapDaoImpl();\n&gt; ldapTemplate = new LdapTemplate();\n&gt; // ldapTemplate.setContextSource(arg0)\n&gt;\n&gt;\n&gt; }\n&gt;\n&gt; protected void tearDown() throws Exception {\n&gt;\n&gt; }\n&gt;\n&gt; public void testGetAllActiveDomesticDistributor(){\n&gt; List distributorList = getDistributorList();\n&gt; DistributorInfo distInfo = getDistributorInfo();\n&gt; //\n&gt; ldapTemplateMock.expects(once()).method(&quot;search&quot;).with(ANYTHING).will(returnValue(distributorList));\n&gt; // ldapTemplateMock.expects(once()).method(&quot;search&quot;).with(eq(String.class),\n&gt; &quot;(&(ttcUserType=distributor)(ttcgeographicregion=United States))&quot;,\n&gt; DistributorInfoAttributeMapper.class);\n&gt; ldapTemplateMock.expects(once()).method(&quot;setContextSource&quot;).with(eq(ContextSource.class));\n&gt; ldapTemplateMock.expects(once()).method(&quot;search&quot;).with(eq(String.class),\n&gt; eq(String.class), eq(ldapDao.new DistributorInfoAttributeMapper()));\n&gt; ldapDao.setLdapTemplate((LdapTemplate)ldapTemplateMock.proxy());\n&gt; List actualDistList = ldapDao.getAllActiveDomesticDistributor();\n&gt; System.out.println(actualDistList.size());\n&gt; }\n&gt;\n&gt; public List getDistributorList(){\n&gt; List distInfoList = new ArrayList();\n&gt;\n&gt; DistributorInfo distInfo1 = new DistributorInfo();\n&gt; distInfo1.setCompanyName(&quot;Wsco Turf Supply&quot;);\n&gt; distInfo1.setDistributorId(&quot;150&quot;);\n&gt;\n&gt; DistributorInfo distInfo2 = new DistributorInfo();\n&gt; distInfo2.setCompanyName(&quot;Test non Domestic DIst&quot;);\n&gt; distInfo2.setDistributorId(&quot;810&quot;);\n&gt;\n&gt; distInfoList.add(distInfo2);\n&gt; return distInfoList;\n&gt; }\n&gt;\n&gt; public DistributorInfo getDistributorInfo(){\n&gt; List distInfoList = new ArrayList();\n&gt;\n&gt; DistributorInfo distInfo1 = new DistributorInfo();\n&gt; distInfo1.setCompanyName(&quot;Wsco Turf Supply&quot;);\n&gt; distInfo1.setDistributorId(&quot;150&quot;);\n&gt;\n&gt; // DistributorInfo distInfo2 = new DistributorInfo();\n&gt; // distInfo2.setCompanyName(&quot;Test non Domestic DIst&quot;);\n&gt; // distInfo2.setDistributorId(&quot;810&quot;);\n&gt; //\n&gt; // distInfoList.add(distInfo2);\n&gt; return distInfo1;\n&gt; }\n&gt;\n&gt; private ContextSource getLDAPContextSource() {\n&gt; LdapContextSource ldapContextSource = new LdapContextSource();\n&gt; ldapContextSource.setUrl(&quot;ldap://ldap-ttcdit.toro.com:389&quot;);\n&gt; ldapContextSource.setBase(&quot;ou=Companies,o=ttc&quot;);\n&gt;\n&gt; try {\n&gt; ldapContextSource.afterPropertiesSet();\n&gt; } catch (Exception e) {\n&gt; e.printStackTrace();\n&gt; }\n&gt; return ldapContextSource;\n&gt; }\n&gt;\n&gt; }\n&gt;\n&gt; [Non-text portions of this message have been removed]\n&gt;\n&gt; \n\n", 
    "profile": "dsaff", 
    "topicId": 20861, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 341876227, 
    "prevInTime": 20921, 
    "contentTrasformed": false, 
    "postDate": "1222289982", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 20861, 
    "headers": {
        "inReplyToHeader": "PDMwNzQ2NS4yNjc2Mi5xbUB3ZWIzMTAwMS5tYWlsLm11ZC55YWhvby5jb20+", 
        "messageIdInHeader": "PDRmN2RhNmI5MDgwOTI0MTM1OW42M2FiMDNmMWw2YmUxYzQ1ZDhkMmIyODk2QG1haWwuZ21haWwuY29tPg==", 
        "referencesHeader": "PDMwNzQ2NS4yNjc2Mi5xbUB3ZWIzMTAwMS5tYWlsLm11ZC55YWhvby5jb20+"
    }
}