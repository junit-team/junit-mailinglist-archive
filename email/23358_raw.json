{
    "topicId": 23353, 
    "postDate": "1301476939", 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "from": "Nils Wilhelm &lt;murphy@...&gt;", 
    "canDelete": false, 
    "replyTo": "LIST", 
    "senderId": "54-U0VjqSjcf2Xs0Un-ShxaMRRdRC1UWCS4Mb5MjKcjRjOw5XGnVotcAOtc9Y979ptdoHMHIxdbjY5FrooFcAqsD8IFqUfmIYDh3n7c", 
    "nextInTime": 23359, 
    "userId": 478556816, 
    "prevInTime": 23357, 
    "prevInTopic": 23357, 
    "headers": {
        "inReplyToHeader": "PEFBTkxrVGlud2ZLTjZ4RXBUYzgyLWRQZkxGanhkdXU4elYydEEzMU4zQ3l1dkBtYWlsLmdtYWlsLmNvbT4=", 
        "messageIdInHeader": "PDREOTJGNjRCLjMwMDAxMDNAcGxhbmV0LW9mLWFydC5kZT4=", 
        "referencesHeader": "PDREOTI0RDlFLjkwNjAzMDNAcGxhbmV0LW9mLWFydC5kZT4gPEFBTkxrVGlud2ZLTjZ4RXBUYzgyLWRQZkxGanhkdXU4elYydEEzMU4zQ3l1dkBtYWlsLmdtYWlsLmNvbT4="
    }, 
    "authorName": "Nils Wilhelm", 
    "numMessagesInTopic": 10, 
    "msgSnippet": "Hi Joakim, thanks for your mail. ... I don t expected test A to run before test B. But i am not sure if two tests can run at the same time or if one test runs,", 
    "contentTrasformed": false, 
    "msgId": 23358, 
    "nextInTopic": 23359, 
    "systemMessage": false, 
    "rawEmail": "Return-Path: &lt;murphy@...&gt;\r\nReceived: (qmail 35142 invoked by uid 7800); 30 Mar 2011 09:45:10 -0000\r\nX-Sender: murphy@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nX-Received: (qmail 88076 invoked from network); 30 Mar 2011 09:22:28 -0000\r\nX-Received: from unknown (98.137.34.45)\n  by m3.grp.sp2.yahoo.com with QMQP; 30 Mar 2011 09:22:28 -0000\r\nX-Received: from unknown (HELO server70.greatnet.de) (83.133.97.218)\n  by mta2.grp.sp2.yahoo.com with SMTP; 30 Mar 2011 09:22:28 -0000\r\nX-Received: from [192.168.2.101] (dslb-088-068-102-099.pools.arcor-ip.net [88.68.102.99])\n\t(using TLSv1 with cipher AES256-SHA (256/256 bits))\n\t(No client certificate requested)\n\tby server70.greatnet.de (Postfix) with ESMTPSA id 9EE221F1F59\n\tfor &lt;junit@yahoogroups.com&gt;; Wed, 30 Mar 2011 11:22:26 +0200 (CEST)\r\nMessage-ID: &lt;4D92F64B.3000103@...&gt;\r\nDate: Wed, 30 Mar 2011 11:22:19 +0200\r\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; de; rv:1.9.2.15) Gecko/20110303 Lightning/1.0b2 Thunderbird/3.1.9\r\nMIME-Version: 1.0\r\nTo: junit@yahoogroups.com\r\nReferences: &lt;4D924D9E.9060303@...&gt; &lt;AANLkTinwfKN6xEpTc82-dPfLFjxduu8zV2tA31N3Cyuv@...&gt;\r\nIn-Reply-To: &lt;AANLkTinwfKN6xEpTc82-dPfLFjxduu8zV2tA31N3Cyuv@...&gt;\r\nX-eGroups-Msg-Info: 1:12:0:0:0\r\nFrom: Nils Wilhelm &lt;murphy@...&gt;\r\nSubject: Re: [junit] Sometimes my tests fail, sometimes not - why?!\r\nX-Yahoo-Group-Post: member; u=478556816\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Transfer-Encoding: quoted-printable\r\nX-eGroups-Approved-By: mark_l_salter &lt;marksalter@...&gt; via email; 30 Mar 2011 09:45:10 -0000\r\n\r\nHi Joakim,\n\nthanks for your mail.\n\nAm 30.03.2011 08:56, schrieb Joakim Ohlr=\r\nogge:\n&gt;\n&gt; I have had several issues when working with a the filesystem from=\r\n unit\n&gt; tests. In theory you cannot expect the tests to be run sequencially=\r\n as in\n&gt; test A has always run before test B (someone may request to run ju=\r\nst \n&gt; one of\n&gt; them by rightclicking on the test in eclipse for instance) s=\r\no that is \n&gt; a bad\n&gt; assumption. I don&#39;t think that is your problem in this=\r\n case though. I \n&gt; don&#39;t\n&gt; know about all the magic that goes on with the f=\r\nilesystem behind the \n&gt; scenes\n&gt; but especially on windows I have seen issu=\r\nes when files are \n&gt; occationaly not\n&gt; deleted properly. I don&#39;t remember h=\r\now I solved it but I would look for\n&gt; things like wether the files are prop=\r\nerly closed and flushed before \n&gt; you try\n&gt; to delete them (could be a race=\r\n condition where the the write stream is\n&gt; almost always GC:ed and closed i=\r\nn that process but sometimes not) that \n&gt; would\n&gt; lock the file for deletio=\r\nn occationall (when the the output stream has not\n&gt; yet been GC:ed). Make s=\r\nure everything is explicitly closed.\n&gt; It has happened that I think everyth=\r\ning looks fine but I have problems\n&gt; anyway. That is when I start imagining=\r\n that there the issue is related to\n&gt; pounding on the filesystem too fast..=\r\n. I don&#39;t think that has ever \n&gt; been the\n&gt; case though but one gets parano=\r\nid.\n&gt;\nI don&#39;t expected test A to run before test B. But i am not sure if tw=\r\no \ntests can run at the same time or if one test runs, ends and after that =\r\n\nthe next tests starts. Can you give me an answer to this?\nAs you said i wi=\r\nll check if all streams are closed. Maybe this is the point.\n&gt;\n&gt;\n&gt; In gener=\r\nal when I have to tests against the file system I tend to to the\n&gt; setup a =\r\nbit in reverse. I use an empty target directory and recusrively\n&gt; delete ev=\r\nery file in it both in my setUp (@Before) and my tearDown \n&gt; (@After).\n&gt; Th=\r\nis way, in case a run gets interupted midway and the directory is left\n&gt; di=\r\nrty it is cleaned prior to the next run.\n&gt;\nI use the finally clause. I chec=\r\nk if the created files exist and delete \nthem. So the next test can expect =\r\nthe source and target folder to be empty.\n&gt;\n&gt;\n&gt; This is not a JUnit issue i=\r\nn any case. In general avoid using the \n&gt; filesystem\n&gt; from your tests will=\r\n spare you lots of grief. Perhaps most of what you \n&gt; want\n&gt; to test could =\r\nbe done in memory with\n&gt; ByteArrayOutputStream/ByteArrayInputStream and onl=\r\ny touch the \n&gt; filesystem in\n&gt; that last case when you know everything work=\r\ns, you just want to see \n&gt; that you\n&gt; can replace ByteArrayInput/OutputStre=\r\nam with FileInputOutputStream.\n&gt; A neat sideeffect by coding this way is th=\r\nat it&#39;s very simple to change\n&gt; sources/targets (like reading from any URL =\r\ninstead of the filesystem) or\n&gt; filtering (like GZipping everything that is=\r\n written to the target) \n&gt; which is\n&gt; not as elegant to do if you pass arou=\r\nnd File objects. By all means \n&gt; make your\n&gt; API able to take a filename/Fi=\r\nle instance but make usre that the first \n&gt; thing\n&gt; you do with it is creat=\r\n a FileInputStream/FileOutputStream and pass it \n&gt; on to\n&gt; the next method =\r\n(using try finally of course). By running in memory \n&gt; you are\n&gt; also bette=\r\nr prepared to run tests in prallell etc.\n&gt;\nThat&#39;s a good point. Thank&#39;s!\n&gt;\n=\r\n&gt;\n&gt; No rock solid advice in here but hopefully something that helps some...=\r\n\n&gt; -----------------------------------------------------\n&gt; Joakim Ohlrogge\n=\r\n&gt; Agical AB\n&gt; V=E4sterl=E5nggatan 79, 2 tr\n&gt; 111 29 Stockholm, SWEDEN\n&gt;\n&gt; M=\r\nobile: +46-708-754004\n&gt; Blog: johlrogge.wordpress.com\n&gt; E-mail: joakim.ohlr=\r\nogge@... &lt;mailto:joakim.ohlrogge%40agical.se&gt;\n&gt;\n&gt; On Tue, Mar 29, 201=\r\n1 at 11:22 PM, Nils Wilhelm \n&gt; &lt;murphy@... &lt;mailto:murphy%40pl=\r\nanet-of-art.de&gt;&gt;wrote:\n&gt;\n&gt; &gt; Hi there,\n&gt; &gt;\n&gt; &gt; i have written a simple back=\r\nup tool and 10 tests. They all have the same\n&gt; &gt; structure:\n&gt; &gt; 1. Create s=\r\nome test files and directories in an directory called \n&gt; &quot;source&quot;\n&gt; &gt; 2. St=\r\nart the backup process (to backup the files/dirs in &quot;source&quot; to a\n&gt; &gt; direc=\r\ntory called &quot;target&quot;)\n&gt; &gt; 3. Check whether all files in &quot;source&quot; exist also=\r\n in &quot;target&quot;\n&gt; &gt; 4. Remove all files from the &quot;source&quot; and &quot;target&quot; directo=\r\nry so that the\n&gt; &gt; directories are empty for the next test.\n&gt; &gt;\n&gt; &gt; If i ex=\r\necute the whole test set ten times, i have 6-7 successes and 3-4\n&gt; &gt; failur=\r\nes. The error messages say that files in the target directory\n&gt; &gt; could not=\r\n be created or deleted (in the last step of the tests, see\n&gt; &gt; above) if th=\r\nere is a failure. One possibility i could think of is that\n&gt; &gt; the tests ar=\r\ne not run sequentially, so they could have influence at each\n&gt; &gt; other. But=\r\n as far as i know JUnit runs all tests in separate threads and\n&gt; &gt; those se=\r\nquentially. Is that correct? Does anybody have any suggestions?\n&gt; &gt;\n&gt; &gt; I u=\r\nse eclipse helios, JUnit 4.8.1, Java 1.6 and AspectJ\n&gt; &gt;\n&gt; &gt; Best regards,\n=\r\n&gt; &gt;\n&gt; &gt; Nils\n&gt; &gt;\n&gt; &gt;\n&gt; &gt; ------------------------------------\n&gt; &gt;\n&gt; &gt; Yahoo=\r\n! Groups Links\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt; &gt;\n&gt;\n&gt; [Non-text portions of this message have =\r\nbeen removed]\n&gt;\n&gt; \n\n\n\n\n[Non-text portions of this message have been removed=\r\n]\n\n\n", 
    "subject": "Re: [junit] Sometimes my tests fail, sometimes not - why?!"
}