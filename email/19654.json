{
    "numMessagesInTopic": 43, 
    "nextInTime": 19655, 
    "senderId": "g4LLBU3L2-usePBwHWCjAMlhTzBxKOm5tLj62GrXorqMsQ6OkEf1UYpMao18Hcmj_zrRGTJtxpB2qyjm_-CQu7c5qcc1pGur", 
    "systemMessage": false, 
    "subject": "Re: [junit] Testing singleton patterns", 
    "from": "&quot;Nat Pryce&quot; &lt;nat.pryce@...&gt;", 
    "authorName": "Nat Pryce", 
    "msgSnippet": "The simplest approach I ve found is that if there is need for only one instance of some class in a system, to just create only one instance of that type. ", 
    "msgId": 19654, 
    "profile": "nat_pryce", 
    "topicId": 19636, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 216973656, 
    "messageBody": "<div id=\"ygrps-yiv-273024742\">The simplest approach I&#39;ve found is that if there is need for only one<br/>\ninstance of some class in a system, to just create only one instance of that<br/>\ntype.<br/>\n<br/>\nAdding extra code just to stop me creating more than one is always, in my<br/>\nexperience, counter-productive.  It&#39;s more code to write, test and maintain<br/>\nand it gets in the way when I do need to create more than one.  For example,<br/>\nin unit tests.  Or when requirements change.<br/>\n<br/>\n--Nat<br/>\n<br/>\n<br/>\n<br/>\n<blockquote><span title=\"qreply\"> On 30/07/07, jason r tibbetts &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:tibbettj@...\">tibbettj@...</a>&gt; wrote:<br/>\n&gt;<br/>\n&gt;   Pat,<br/>\n&gt;<br/>\n&gt; &gt; This may be a bit off charter, but I&#39;ve been reading some well argued<br/>\n&gt; &gt; articles that have names such as &quot;Why is Singleton evil?&quot; and at the top<br/>\n&gt; &gt; of the list are troubles that the singleton pattern causes for unit<br/>\n&gt; &gt; testing. (which is on topic.)<br/>\n&gt; &gt;<br/>\n&gt; &gt; The usual suggestions for rewriting the code are offered, such as using<br/>\n&gt; &gt; a factory class to allocate/create objects, and always always just<br/>\n&gt; &gt; returning the one and only.<br/>\n&gt; &gt;<br/>\n&gt; &gt; So far, so good. But, the Factory class has to keep a store of<br/>\n&gt; &gt; anti-singletons. And the usual call is something like<br/>\n&gt; &gt; AntiSingleton anAnti = Factory.createAntiSingleton();<br/>\n&gt; &gt;<br/>\n&gt; &gt; Which is used statically, and implies that the Factory is a singleton so<br/>\n&gt; &gt; its cache of AntiSingletons can be kept in one and only one store.<br/>\n&gt; &gt;<br/>\n&gt; &gt; I&#39;m not seeing how changing the Singleton class to a class that needs<br/>\n&gt; &gt; the singleton Factory class has done anything. We&#39;ve still got a<br/>\n&gt; &gt; singleton, and so all arguments that there is implied coupling, and bad<br/>\n&gt; &gt; karma for testing still hold.<br/>\n&gt;<br/>\n&gt; I don&#39;t see any mention yet in this thread of the simplest solution of<br/>\n&gt; them all: put all of the singleton&#39;s implementation in a non-singleton<br/>\n&gt; abstract base class, then subclass it as a singleton. The abstract base<br/>\n&gt; class can be subclassed separately for testing. In other words,<br/>\n&gt;<br/>\n&gt; // abstract base class<br/>\n&gt; public abstract class Foo {<br/>\n&gt; protected Foo() { }<br/>\n&gt;<br/>\n&gt; public String getBar() { return &quot;bar!&quot;; }<br/>\n&gt; }<br/>\n&gt;<br/>\n&gt; // singleton implementation<br/>\n&gt; public final class TheOneTrueFoo extends Foo {<br/>\n&gt; private TheOneTrueFoo() { super(); }<br/>\n&gt;<br/>\n&gt; public static Foo getInstance() { return foo; }<br/>\n&gt;<br/>\n&gt; private final static Foo = new TheOneTrueFoo();<br/>\n&gt; }<br/>\n&gt;<br/>\n&gt; // test-only implementation<br/>\n&gt; public final class TestFoo {<br/>\n&gt; public TestFoo() { super(); }<br/>\n&gt; }<br/>\n&gt;<br/>\n&gt; Voila! The 3 statements in the singleton implementation go untested, but<br/>\n&gt; all of the rest of Foo can be tested normally.<br/>\n&gt;<br/>\n&gt;  <br/>\n&gt;<br/>\n<br/>\n<br/>\n[Non-text portions of this message have been removed] </span></blockquote></div>", 
    "prevInTime": 19653, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1185806788", 
    "canDelete": false, 
    "nextInTopic": 19655, 
    "prevInTopic": 19653, 
    "headers": {
        "inReplyToHeader": "PDQ2QURFRjUxLjgwNjA0MDdAdmVyZGkuaWlzZC5zcmEuY29tPg==", 
        "messageIdInHeader": "PDE3ZmE1M2QwNzA3MzAwNzQ2dzdlZjAzNDAzeDI4ZDQyODI4MzU1ZWZlOGZAbWFpbC5nbWFpbC5jb20+", 
        "referencesHeader": "PDQ2QUI0MTZDLjIwNDA0MDBAcGZhcnJlbGwuY29tPgkgPDQ2QURFRjUxLjgwNjA0MDdAdmVyZGkuaWlzZC5zcmEuY29tPg=="
    }
}