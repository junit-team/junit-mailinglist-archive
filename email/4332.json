{
    "numMessagesInTopic": 1, 
    "nextInTime": 4333, 
    "senderId": "eaY8z5qnDWCD2rj8XK6d1FfvgDGYGIeb3im3UKspzZL0fefB0kXk9HInogD02Lsn3cugeqE", 
    "systemMessage": false, 
    "subject": "Big oops! on string diff patch (+ant)", 
    "from": "alex@...", 
    "authorName": "alex@jguru.com", 
    "msgSnippet": "Oops! Somehow a bogus patched junit.jar made it onto the web site. I just corrected the error. The bogus one was apparently a fully functional version of JUnit", 
    "msgId": 4332, 
    "profile": "stinkysage", 
    "topicId": 4332, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 9029569, 
    "messageBody": "<div id=\"ygrps-yiv-473137307\">Oops! Somehow a bogus patched junit.jar made it onto the web site. I<br/>\njust corrected the error. The bogus one was apparently a fully<br/>\nfunctional version of JUnit 3.7, but four times as big, and with the<br/>\nunpatched version of Assert (though, oddly, containing my new string<br/>\nutility class, which fooled me into thinking it was correct).<br/>\n<br/>\nI&#39;ve since made a unit test for my web deploy script to stop this from<br/>\nhappening again. <br/>\n<br/>\nThe version that&#39;s up now works fine, knock wood.<br/>\n<br/>\n\t<a rel=\"nofollow\" target=\"_blank\" href=\"http://www.purpletech.com/junit-patch/\">http://www.purpletech.com/junit-patch/</a><br/>\n<br/>\n - A<br/>\n<br/>\nP.S. The patch itself always worked; this was just me building and/or<br/>\ndeploying the wrong JAR file somehow.<br/>\n<br/>\nP.P.S. I also fixed a problem where JUnit 3.7 wasn&#39;t compatible with<br/>\nthe junit Ant task; now it is.<br/>\n<br/>\n<blockquote><span title=\"qreply\"> On Mon, Feb 18, 2002 at 08:55:55AM -0800, <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:guru@...\">guru@...</a> wrote:<br/>\n&gt; The method assertEquals(String, String) is very useful, but breaks<br/>\n&gt; down with large strings.  The problem is that, if the strings differ<br/>\n&gt; in only a few characters, or start to differ more than a few lines in,<br/>\n&gt; the error message is almost completely useless.  <br/>\n&gt; <br/>\n&gt; expected:&lt;HUGE STRING&gt; but was:&lt;NEARLY IDENTICAL HUGE STRING&gt;<br/>\n&gt; <br/>\n&gt; When you add in line breaks it gets impossible to &quot;eyeball&quot; the error<br/>\n&gt; message and know what&#39;s going wrong.  It also breaks up the format of<br/>\n&gt; the output report with miles of strings, possibly including line<br/>\n&gt; breaks.<br/>\n&gt; <br/>\n&gt; I&#39;ve written some code that fixes this.  The output for a failed test<br/>\n&gt; with message &quot;HTML Report&quot; is:<br/>\n&gt; <br/>\n&gt; HTML Report: strings differ at character 22<br/>\n&gt; Expected: ...&gt;Poll:&lt;/b&gt; dummy&lt;br&gt;&#92;n&lt;b&gt;Question:&lt;/b&gt; Vote for your favor...<br/>\n&gt;   Actual: ...&gt;Poll:&lt;/b&gt; dummy&lt;br&gt;&#92;r&#92;n&lt;b&gt;Question:&lt;/b&gt; Vote for your favo...<br/>\n&gt; <br/>\n&gt; Note that you can tell right off the bat that the problem is a<br/>\n&gt; difference in line endings (since my code escapes those).  This<br/>\n&gt; particular bug was actually impossible for me to track down using the<br/>\n&gt; normal failure message, since line endings are invisible.<br/>\n&gt; <br/>\n&gt; I&#39;d like to contribute the code to JUnit.  I&#39;m just not sure where you<br/>\n&gt; want to put it.<br/>\n&gt; <br/>\n&gt; I see three options:<br/>\n&gt; <br/>\n&gt; 1. Change the behavior of the existing Assert.assertEquals(String, String)<br/>\n&gt; <br/>\n&gt; \t(I don&#39;t think this would break anybody&#39;s tests, and I doubt<br/>\n&gt; \tanyone has written code that depends on the actual format of<br/>\n&gt; \tthe string error messages.  I could be wrong, of course.)<br/>\n&gt; <br/>\n&gt; 2. Add a new assertEqualsDiff to class Assert<br/>\n&gt; <br/>\n&gt; \t(This would mean that the benefit of the new messages would<br/>\n&gt; \tnot be given to existing tests without massive test code<br/>\n&gt; \trewrites.)<br/>\n&gt; <br/>\n&gt; 3. Make a new DiffTestCase that overrides assertEquals<br/>\n&gt; <br/>\n&gt; \t(Same problem as above -- existing test code would need to be<br/>\n&gt; \trewritten.  It&#39;s also a sloppy substitute for mixins...)<br/>\n&gt; <br/>\n&gt; If you guys want the code, let me know, and I&#39;ll download the JUnit<br/>\n&gt; source and give you a patch.<br/>\n&gt; <br/>\n&gt;  - A<br/>\n&gt; <br/>\n&gt; P.S.  I&#39;ve attached the current version below.  I don&#39;t think this is<br/>\n&gt; the final version, though -- I want it to be smarter about diffs close<br/>\n&gt; to the start and end of the strings.<br/>\n&gt; <br/>\n&gt; -- <br/>\n&gt; Alex Chaffee                       mailto:<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:alex@...\">alex@...</a><br/>\n&gt; jGuru - Java News and FAQs         <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.jguru.com/alex/\">http://www.jguru.com/alex/</a><br/>\n&gt; Creator of Gamelan                 <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.gamelan.com/\">http://www.gamelan.com/</a><br/>\n&gt; Founder of Purple Technology       <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.purpletech.com/\">http://www.purpletech.com/</a><br/>\n&gt; Curator of Stinky Art Collective   <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.stinky.com/\">http://www.stinky.com/</a><br/>\n&gt; <br/>\n&gt; <br/>\n&gt;     void assertEqualsDiff(String message, String expected, String actual)<br/>\n&gt;     {<br/>\n&gt; \tif (!expected.equals(actual)) {<br/>\n&gt; \t    if (expected.length() &lt; 20 || actual.length() &lt; 20) {<br/>\n&gt; \t\tassertEquals(message, expected, actual);<br/>\n&gt; \t\treturn;\t// we&#39;ll get an exception, but just in case<br/>\n&gt; \t    }<br/>\n&gt; \t    int at = strdiffat(actual, expected);<br/>\n&gt; \t    String expectedContext =<br/>\n&gt; \t\tUtils.abbreviate(expected.substring(at - 20), 60);<br/>\n&gt; \t    String actualContext =<br/>\n&gt; \t\tUtils.abbreviate(actual.substring(at - 20), 60);<br/>\n&gt; \t    assertTrue(message + &quot;: strings differ at character &quot; + at + &quot;&#92;n&quot; +<br/>\n&gt; \t\t       &quot;Expected: ...&quot; + Utils.jsEscape(expectedContext) + &quot;&#92;n&quot; +<br/>\n&gt; \t\t       &quot;  Actual: ...&quot; + Utils.jsEscape(actualContext) + &quot;&#92;n&quot;,<br/>\n&gt; \t\t       false);<br/>\n&gt; \t}<br/>\n&gt;     }<br/>\n&gt; <br/>\n&gt;     /**<br/>\n&gt;      * returns the index where the strings diverge&lt;p&gt;<br/>\n&gt;      * strdiff(&quot;i am a machine&quot;, &quot;i am a robot&quot;) -&gt; 7&lt;p&gt;<br/>\n&gt;      * @return -1 if they are the same<br/>\n&gt;      *<br/>\n&gt;      **/<br/>\n&gt;     public static int strdiffat(String s1, String s2) {<br/>\n&gt; \tint i;<br/>\n&gt; \tfor (i=0; i&lt;s1.length() && i&lt;s2.length(); ++i) {<br/>\n&gt; \t    if (s1.charAt(i) != s2.charAt(i)) {<br/>\n&gt; \t\tbreak;<br/>\n&gt; \t    }<br/>\n&gt; \t}<br/>\n&gt; \tif (i&lt;s2.length() || i&lt;s1.length())<br/>\n&gt; \t    return i;<br/>\n&gt; \treturn -1;<br/>\n&gt;     }<br/>\n&gt; <br/>\n&gt; for abbreviate() and jsEscape() see <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.purpletech.com/code/src/com/purpletech/util/Utils.java\">http://www.purpletech.com/code/src/com/purpletech/util/Utils.java</a><br/>\n&gt; <br/>\n&gt; _______________________________________________<br/>\n&gt; Junit-devel mailing list<br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:Junit-devel@...\">Junit-devel@...</a><br/>\n&gt; <a rel=\"nofollow\" target=\"_blank\" href=\"https://lists.sourceforge.net/lists/listinfo/junit-devel\">https://lists.sourceforge.net/lists/listinfo/junit-devel</a><br/>\n<br/>\n-- <br/>\nAlex Chaffee                       mailto:<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:alex@...\">alex@...</a><br/>\njGuru - Java News and FAQs         <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.jguru.com/alex/\">http://www.jguru.com/alex/</a><br/>\nCreator of Gamelan                 <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.gamelan.com/\">http://www.gamelan.com/</a><br/>\nFounder of Purple Technology       <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.purpletech.com/\">http://www.purpletech.com/</a><br/>\nCurator of Stinky Art Collective   <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.stinky.com/\">http://www.stinky.com/</a><br/>\n<br/>\n_______________________________________________<br/>\nJunit-devel mailing list<br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:Junit-devel@...\">Junit-devel@...</a><br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"https://lists.sourceforge.net/lists/listinfo/junit-devel\">https://lists.sourceforge.net/lists/listinfo/junit-devel</a><br/>\n<br/>\n----- End forwarded message -----<br/>\n<br/>\n-- <br/>\nAlex Chaffee                       mailto:<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:alex@...\">alex@...</a><br/>\njGuru - Java News and FAQs         <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.jguru.com/alex/\">http://www.jguru.com/alex/</a><br/>\nCreator of Gamelan                 <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.gamelan.com/\">http://www.gamelan.com/</a><br/>\nFounder of Purple Technology       <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.purpletech.com/\">http://www.purpletech.com/</a><br/>\nCurator of Stinky Art Collective   <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.stinky.com/\">http://www.stinky.com/</a> </span></blockquote></div>", 
    "prevInTime": 4331, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1016032208", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PDIwMDIwMzEzMDcxMDA4LkIyNDU2QHN0aW5reS5jb20+"
    }
}