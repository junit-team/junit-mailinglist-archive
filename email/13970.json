{
    "numMessagesInTopic": 3, 
    "nextInTime": 13971, 
    "senderId": "sHblPM0qfIIkb1iSSlX-SYxldQhnHTx7cxO9JgwEg5BUSpgPPbA0xFzwDZNeLJuYALB5eLhQgMhW-aIs7_WUv5lPHcg", 
    "systemMessage": true, 
    "subject": "Advice on TDD&#39;ing a POJO that uses a web service", 
    "from": "&quot;etl_dan&quot; &lt;etl_dan@...&gt;", 
    "authorName": "etl_dan", 
    "msgSnippet": "Hi! I m working on a few projects that will obtain data from a web service using JAX-RPC.  To get my feet wet, I m building a project that will get the weather", 
    "msgId": 13970, 
    "profile": "etl_dan", 
    "topicId": 13970, 
    "spamInfo": {
        "reason": "12", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 86431363, 
    "messageBody": "<div id=\"ygrps-yiv-1476179339\">Hi!<br/>\n<br/>\nI&#39;m working on a few projects that will obtain data from a web service<br/>\nusing JAX-RPC.  To get my feet wet, I&#39;m building a project that will<br/>\nget the weather forecast from the NDFDXML web service at weather.gov<br/>\nand used Axis to generate a client stub.  (<a rel=\"nofollow\" target=\"_blank\" href=\"http://weather.gov/xml/)\">http://weather.gov/xml/)</a><br/>\n<br/>\nI am doing OK so far, but I wondered if someone would mind checking to<br/>\nsee if I&#39;m going too far or in the wrong direction?<br/>\n<br/>\n<br/>\nMy first approach is to have a service POJO that handles all<br/>\ncommunication with the web service via the generated stub classes and<br/>\nparses response data into more digestible data objects.<br/>\n<br/>\nGoing the test-first route, I started writing tests for this POJO<br/>\nservice, called NOAAWeatherService.  My first gut was to write a happy<br/>\npath test to see that the class correctly passes the right arguments.<br/>\n To do this, I realized that if my web services consumer object<br/>\nactually obtained the stub directly, it would be hard for my tests to<br/>\nsubstitute in mocks.  I created a method setProxy() which allows tests<br/>\nand a dependency injection container like Spring to wire it up.  (Here<br/>\nI pass an object that implements PortType interface generated by Axis&#39;<br/>\nWSDL2Java tool)<br/>\n<br/>\nMy next wince came when I wondered what my mock web service stub<br/>\nimplementation could return - the NDFDXML web service at weather.gov<br/>\nreturns their specially prepared XML as a response.  My fake object<br/>\nwould need to return well-formatted XML data that could be correctly<br/>\nprocesse!  So, I decided that this class would have too many<br/>\nresponsibilities on its own -- communicating with the web service, and<br/>\nparsing the XML results.  So I created a setParser() method which I<br/>\ncould fake for these tests and supply a real parser for production.<br/>\n<br/>\n<br/>\nAm I testing at too high a level here, or is this the right way to go?<br/>\n  Based on this test, it seems like I&#39;m not testing a whole lot -<br/>\nsince the object under test will probably just delegate to other<br/>\nobjects.<br/>\n<br/>\nThanks for the advice!<br/>\n<br/>\n-Dan<br/>\n--<br/>\n<br/>\n<br/>\n    public void testGetCurrentConditions_HappyPath() {<br/>\n        NOAAWeatherService service = new NOAAWeatherService();<br/>\n        <br/>\n        final String webServiceResponse = &quot;Test string&quot;;<br/>\n        final double latitude = 30.5d;<br/>\n        final double longitude = -70.0d;<br/>\n<br/>\n        // Set a fake proxy to verify the right arguments are passed<br/>\n        service.setProxy(new NdfdXMLStub() {<br/>\n            // NDFDgen is a weather.gov method to get forecast data<br/>\n            public String NDFDgen(BigDecimal latitude, BigDecimal<br/>\nlongitude, String product, Calendar startTime, Calendar endTime,<br/>\nWeatherParametersType weatherParameters) throws RemoteException {<br/>\n                assertEquals(latitude, latitude.doubleValue(), 0.01);<br/>\n                assertEquals(longitude, longitude.doubleValue(),<br/>\n0.01);<br/>\n                ...  // Check ?all? the web service parameters? <br/>\n                return webServiceResponse;<br/>\n            }<br/>\n        });<br/>\n        <br/>\n        // Secondly, create a fake response parser so<br/>\n        // our tests don&#39;t have to create valid XML...<br/>\n        // we&#39;re just testing that our code is interacting<br/>\n        // with the web service correctly...<br/>\n <br/>\n        final WeatherData expected = new WeatherData();<br/>\n        service.setNdfdXMLResponseParser(new NdfdXMLResponseParser() {<br/>\n            public WeatherData[] parseNdfdGen(String xml) {<br/>\n                assertEquals(webServiceResponse, xml);<br/>\n                WeatherData[] response = new WeatherData[1];<br/>\n                response[0] = expected;<br/>\n                return response;<br/>\n            }<br/>\n        });<br/>\n        <br/>\n        <br/>\n        assertEquals(expected, service.getCurrentConditions(latitude,<br/>\nlongitude));<br/>\n    }</div>", 
    "prevInTime": 13969, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1119149161", 
    "canDelete": false, 
    "nextInTopic": 13981, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PGQ5Mm05OStqZm9nQGVHcm91cHMuY29tPg=="
    }
}