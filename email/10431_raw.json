{
    "numMessagesInTopic": 8, 
    "nextInTime": 10432, 
    "senderId": "iZXYm-GEHe7XuqA5fWaPl3k53r0VsPVFaa1NezwECaTwpiprtjWqwDTZd2FrRfMWe93n1G2jwG6awLkvT2ivi_WMfGUqK04jqg", 
    "systemMessage": false, 
    "subject": "Re: JUnit & Reflection -  now Clean ClassLoader Environment for Tests.", 
    "from": "&quot;Oisin Kim&quot; &lt;oisin.kim@...&gt;", 
    "authorName": "Oisin Kim", 
    "msgSnippet": "Hi J.B and thanks for your reply, I ve fixed the problem here which was due to a Custom ClassLoader which was written and didn t behave as it was expected to,", 
    "msgId": 10431, 
    "rawEmail": "Return-Path: &lt;oisin.kim@...&gt;\r\nReceived: (qmail 37155 invoked from network); 6 Feb 2004 17:09:03 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m20.grp.scd.yahoo.com with QMQP; 6 Feb 2004 17:09:03 -0000\r\nReceived: from unknown (HELO n18.grp.scd.yahoo.com) (66.218.66.73)\n  by mta1.grp.scd.yahoo.com with SMTP; 6 Feb 2004 17:09:03 -0000\r\nX-eGroups-Return: oisin.kim@...\r\nReceived: from [66.218.67.182] by n18.grp.scd.yahoo.com with NNFMP; 06 Feb 2004 17:08:49 -0000\r\nX-Sender: oisin.kim@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 98603 invoked from network); 6 Feb 2004 09:18:46 -0000\r\nReceived: from unknown (66.218.66.172)\n  by m7.grp.scd.yahoo.com with QMQP; 6 Feb 2004 09:18:46 -0000\r\nReceived: from unknown (HELO n8.grp.scd.yahoo.com) (66.218.66.92)\n  by mta4.grp.scd.yahoo.com with SMTP; 6 Feb 2004 09:18:46 -0000\r\nReceived: from [66.218.67.184] by n8.grp.scd.yahoo.com with NNFMP; 06 Feb 2004 09:18:28 -0000\r\nDate: Fri, 06 Feb 2004 09:18:26 -0000\r\nTo: junit@yahoogroups.com\r\nMessage-ID: &lt;bvvm52+cb19@...&gt;\r\nIn-Reply-To: &lt;40229A92.5000407@...&gt;\r\nUser-Agent: eGroups-EW/0.82\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=ISO-8859-1\r\nContent-Length: 4126\r\nX-Mailer: Yahoo Groups Message Poster\r\nX-eGroups-Remote-IP: 66.218.66.92\r\nFrom: &quot;Oisin Kim&quot; &lt;oisin.kim@...&gt;\r\nSubject: Re: JUnit & Reflection -  now Clean ClassLoader Environment for Tests.\r\nX-Yahoo-Group-Post: member; u=93528314\r\nX-Yahoo-Profile: oisinkim2000\r\nX-eGroups-Approved-By: vbossica &lt;vladimir@...&gt; via web; 06 Feb 2004 17:08:49 -0000\r\nX-eGroups-Remote-IP: 66.218.66.73\r\n\r\nHi J.B and thanks for your reply,\n\nI&#39;ve fixed the problem here which was due to a Custom ClassLoader\nwhich was written and didn&#39;t behave as it was expected to, I&#39;ve\ninherited this code, its used to proved a clean classloader\nenvironment to tests, so that test methods have clean static instances\nfor every test run.\n\nSince I&#39;ve fixed the problem, I thought I&#39;d post the &quot;fix&quot; for review,\n  I&#39;m simply here trying to give each test method call a clean\nenvironment and allow it to initialize everything itself\n\n//variable to hold constructor instance for each test - setUp()\npopulates this\n\nprivate Constructor constructor;\n\n\n//use setUp to create a new classloader and get a clean instance of\nthe test class\npublic void setUp() {\n    try {\n      ClassLoader loader = null;\n      loader = ITDTestClassLoader.newInstance();\n      final Class clazz =\n        loader.findClass(&quot;xxx.util.test.core.RunReflectedTest&quot;);\n      constructor =\n        clazz.getConstructor(new Class[] { TestCase.class,\nString.class });\n    } catch (NoSuchMethodException ex) {\n      fail(&quot;Unable instantiate test. Constructor doesn&#39;t exist.&quot;);\n    } catch (Exception ex) {\n      ex.printStackTrace();\n      fail(&quot;Unable to create classloader:&quot; + ex);\n    }\n  }\n}\n\n /**\n   * Executes test itself\n   * @param testName - name of the test to be executed\n   * @throws Throwable when test fails or an error occur\n   */\n  private void runTest(final String testName) throws Throwable {\n    final RunTest runTest =\n      (RunTest) constructor.newInstance(new Object[] { this, testName });\n    runTest.run();\n\n\nIn this case the test methods etc are in a separate class, not sure\nwhat benefit this gives, a sample test method would look like:\n\n /**\n   * runs specified test.\n   * @see xxx.util.test.core.RunReflectedTest\n   */\n  public void testName() throws Throwable {\n    this.runTest(&quot;testName&quot;);\n  }\n\n\nThe RunReflectedTest class holds the test methods, and also uses the\nsetUp() and tearDown() methods to get a copy of the inital system\nproperties and reset them in the tearDown.\n\nComments are welcome, how can we improve this?\n\nThanks again to J.B. for your help and input, I hope someone finds\nthis helpful!\n\nKind Regards,\n\nOisin\n\n--- In junit@yahoogroups.com, &quot;J. B. Rainsberger&quot; &lt;jbrains@r...&gt; wrote:\n&gt; Oisin Kim wrote:\n&gt; \n&gt; &gt; Hi All,\n&gt; &gt; I&#39;ve searched the archives (& Google) for something like this but\n&gt; &gt; didn&#39;t find anything so here goes:\n&gt; &gt; \n&gt; &gt; a test method will run fine if ran by itself in a plain class which\n&gt; &gt; extends TestCase, it includes a section like this:\n&gt; &gt; String expectedExceptionMessage = &quot;someException&quot;;\n&gt; &gt; String actualExceptionMessage = null;\n&gt; &gt; try {\n&gt; &gt;   SomeClass.someStaticMethod();\n&gt; &gt;   AssetFail(&quot;Never Should have got here&quot;);\n&gt; &gt; } catch (Throwable t) {\n&gt; &gt;   actualExceptionMessage = t.getMessage();\n&gt; &gt; }\n&gt; &gt; assertEquals(expectedExceptionMessage, actualExceptionMessage);\n&gt; &gt; \n&gt; &gt; what happens is that if this snippet is run from a regular test case,\n&gt; &gt; everything is fine, but if run via reflection like (shown below) it\n&gt; &gt; gives me something like:\n&gt; &gt; \n&gt; &gt; [junit] Testcase: testName took 8.407 sec\n&gt; &gt; [junit]     Caused an ERROR\n&gt; &gt; [junit] null\n&gt; &gt; [junit] java.lang.reflect.InvocationTargetException\n&gt; &gt; \n&gt; &gt; The test method is called as follows :\n&gt; &gt; \n&gt; &gt; final Method[] methods = this.getClass().getDeclaredMethods();\n&gt; &gt;   final int size = methods.length;\n&gt; &gt;   for (int i = 0; i &lt; size; i++) {\n&gt; &gt;     method = methods[i];\n&gt; &gt;     if (method.getName().startsWith(&quot;test&quot;)\n&gt; &gt;       && method.getParameterTypes().length == 0) {\n&gt; &gt;       this.setUp();\n&gt; &gt;       try {\n&gt; \n&gt; &gt;         method.invoke(RunResourcesTest.class, null);\n&gt; \n&gt; Doesn&#39;t this only work when invoking a class-level (static) method? I \n&gt; assume your test*() methods are not class-level.\n&gt; \n&gt; When you invoke an instance-level method, you need an instance of the \n&gt; underlying class somewhere, and I don&#39;t see that.\n&gt; \n&gt; Finally, why are you duplicating code in JUnit&#39;s test runner?\n&gt; -- \n&gt; J. B. Rainsberger,\n&gt; Diaspar Software Services\n&gt; http://www.diasparsoftware.com :: +1 416 791-8603\n&gt; Let&#39;s write software that people understand\n\n\n\n", 
    "profile": "oisinkim2000", 
    "topicId": 10412, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 93528314, 
    "prevInTime": 10430, 
    "contentTrasformed": false, 
    "postDate": "1076059106", 
    "canDelete": false, 
    "nextInTopic": 10436, 
    "prevInTopic": 10422, 
    "headers": {
        "inReplyToHeader": "PDQwMjI5QTkyLjUwMDA0MDdAcm9nZXJzLmNvbT4=", 
        "messageIdInHeader": "PGJ2dm01MitjYjE5QGVHcm91cHMuY29tPg=="
    }
}