{
    "numMessagesInTopic": 18, 
    "nextInTime": 5339, 
    "senderId": "87ErgFRdqmD0Cn8uVbKNv81jEDNJUl3zZhBTaBTiNtlKHqv0sqcA8fbzgFK4yvK86GF-0grtIvRLTJpvvVIb3Wj1SxE", 
    "systemMessage": false, 
    "subject": "testing protected/package-private methods (was Re: Where to place test classes?)", 
    "from": "&quot;pholser&quot; &lt;pholser@...&gt;", 
    "authorName": "pholser", 
    "msgSnippet": "without having thought about it too much, i used to be dogmatic about always placing test classes in packages different from their respective", 
    "msgId": 5338, 
    "profile": "pholser", 
    "topicId": 4311, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 66805313, 
    "messageBody": "<div id=\"ygrps-yiv-790420116\">without having thought about it too much, i used to be dogmatic about<br/>\nalways placing test classes in packages different from their<br/>\nrespective classes-under-test, thus limiting the tests to speaking<br/>\nto the CUTs via public interface.  however, there are times when<br/>\nprotected interface is useful to have, and needs tested.  i started<br/>\nthinking about how the test code would look if i were to allow for<br/>\ntest classes co-located in the packages of their CUTs.<br/>\n<br/>\n[apologies for the crazy &quot;haver&quot; names, i just like nouning things<br/>\nsometimes--also, nouning/verbing weirds english...8^) ]<br/>\n<br/>\nin package pholser.junk.protect:<br/>\n--------------------------------<br/>\npublic class ProtectedMethodHaver {<br/>\n  private String blurb;<br/>\n<br/>\n  protected ProtectedMethodHaver( String blurb ) {<br/>\n    this.blurb = blurb;<br/>\n  }<br/>\n<br/>\n  protected String shout() {<br/>\n    return blurb;<br/>\n  }<br/>\n}<br/>\n<br/>\nin package pholser.junk.protect:<br/>\n--------------------------------<br/>\npublic class ProtectedMethodHaverTest extends TestCase {<br/>\n  public ProtectedMethodHaverTest( String name ) {<br/>\n    super( name );<br/>\n  }<br/>\n<br/>\n  public void testProtectedMethod() {<br/>\n    assertEquals( &quot;abc&quot;, new ProtectedMethodHaver( &quot;abc&quot; ).shout() );<br/>\n  }<br/>\n}<br/>\n<br/>\nvs. in package test.pholser.junk.protect:<br/>\n-----------------------------------------<br/>\npublic class ProtectedMethodHaverTest extends TestCase {<br/>\n  private static class MyProtectedMethodHaver<br/>\n  extends ProtectedMethodHaver {<br/>\n    MyProtectedMethodHaver( String blurb ) {<br/>\n      super( blurb );<br/>\n    }<br/>\n<br/>\n    public String shout() {<br/>\n      return super.shout();<br/>\n    }<br/>\n  }<br/>\n<br/>\n  public ProtectedMethodHaverTest( String name ) {<br/>\n    super( name );<br/>\n  }<br/>\n<br/>\n  public void testProtectedMethod() {<br/>\n    assertEquals(<br/>\n      &quot;abc&quot;,<br/>\n      new MyProtectedMethodHaver( &quot;abc&quot; ).shout() );<br/>\n  }<br/>\n}<br/>\n<br/>\nwhich communicates more clearly?  to me, the package-co-located<br/>\nversion does.  otherwise, i&#39;m combating java&#39;s visibility modifiers<br/>\nwith more test code to maintain.<br/>\n<br/>\nhowever, it&#39;s interesting to note that if the class with the protected<br/>\ninterface is abstract, you&#39;ll have to pull trickery like the<br/>\npackage-separated version uses, just to get an instance against which<br/>\nto test those default protected implementations.  also, if you want<br/>\nto test package-private methods, you _must_ co-locate your tests with<br/>\ntheir CUTs, or use the magic incantations to suppress access checks.<br/>\n<br/>\nfor me, it comes down to this: are your test classes to be treated<br/>\nlike any other client (i.e. CUT says &quot;talk to me via my public<br/>\ninterface&quot;), or do they get special exemptions because they&#39;re tests?<br/>\nit&#39;s clear that some people feel one way, others feel the other...<br/>\nas long as one is aware of the ramifications of her choice, to me it&#39;s<br/>\nall good.<br/>\n<br/>\ncheers,<br/>\np<br/>\n<br/>\n<blockquote><span title=\"qreply\"> --- In junit@y..., Eric Heikkila &lt;ericheikkila@y...&gt; wrote:<br/>\n&gt; Hmmm....there&#39;s usually a way around it if you want to test<br/>\n&gt; something, even if they are in different packages.  For instance,<br/>\n&gt; maybe the private methods should really be pulled out and placed in<br/>\n&gt; their own class, which could have public methods, but the old class<br/>\n&gt; would have a private instance of the new class.<br/>\n&gt; <br/>\n&gt; My take on this . . . put them in the same package, or don&#39;t, user<br/>\n&gt; inner classes, or don&#39;t, whatever (I&#39;ve seen too many flames about<br/>\n&gt; this issue to last me a while) . . . just make sure you test what<br/>\n&gt; should be tested.  There&#39;s always a way to make it (more) testable.<br/>\n&gt; <br/>\n&gt; -Eric<br/>\n&gt; <br/>\n&gt; --- Vladimir Bossicard &lt;vladimir@b...&gt; wrote:<br/>\n&gt; &gt; &gt; I see no need to test methods other than public<br/>\n&gt; &gt; &lt;snip&gt; I&#39;ll write <br/>\n&gt; &gt; <br/>\n&gt; &gt;  &gt; test methods for the protected methods as well.<br/>\n&gt; &gt; <br/>\n&gt; &gt; So why do you test protected methods if there&#39;s no need to test<br/>\n&gt; &gt; methods other than public?  Simply because it depends. Sometimes<br/>\n&gt; &gt; you want to test protected methods, sometimes you don&#39;t.<br/>\n&gt; &gt; <br/>\n&gt; &gt; My point is: placing tests classes so that it is _impossible_ to<br/>\n&gt; &gt; test protected methods is a &quot;bad&quot; decision because you restrict<br/>\n&gt; &gt; your flexibility.  By placing test classes in the same package,<br/>\n&gt; &gt; you still have that flexibility, but you don&#39;t have to use it<br/>\n&gt; &gt; if you don&#39;t want to.<br/>\n&gt; &gt; <br/>\n&gt; &gt; - Vladimir<br/>\n&gt; &gt; <br/>\n&gt; &gt; -- <br/>\n&gt; &gt; Vladimir Bossicard<br/>\n&gt; &gt; www.bossicard.com </span></blockquote></div>", 
    "prevInTime": 5337, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1025900812", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 4762, 
    "headers": {
        "inReplyToHeader": "PDIwMDIwMzE1MDIxMjE5LjI2MzIyLnFtYWlsQHdlYjE0MzA4Lm1haWwueWFob28uY29tPg==", 
        "messageIdInHeader": "PGFnNHZlYytxMTl0QGVHcm91cHMuY29tPg=="
    }
}