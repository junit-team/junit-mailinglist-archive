{
    "numMessagesInTopic": 52, 
    "nextInTime": 3183, 
    "senderId": "KK8_JBDiRuG0-fV6K2diJJ6J1zKdV9UKGkUL8HsXR2IJy1_v6SFBF_yZaWF2t7LtfYLafw5pYtIv29YLNV_kuQP9dgWh", 
    "systemMessage": false, 
    "subject": "Re: [junit] testing private methods", 
    "from": "Eric Vought &lt;evought@...&gt;", 
    "authorName": "Eric Vought", 
    "msgSnippet": "Typically, the way you accomplish both objectives (hiding functionality and exposing it for unit testing) is to use a Facade. You expose the methods that you", 
    "msgId": 3182, 
    "rawEmail": "Return-Path: &lt;evought@...&gt;\r\nX-Sender: evought@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (EGP: mail-8_0_0_1); 6 Nov 2001 16:21:13 -0000\r\nReceived: (qmail 3128 invoked from network); 6 Nov 2001 16:21:12 -0000\r\nReceived: from unknown (216.115.97.167)\n  by m11.grp.snv.yahoo.com with QMQP; 6 Nov 2001 16:21:12 -0000\r\nReceived: from unknown (HELO ral.qlue.com) (65.201.137.7)\n  by mta1.grp.snv.yahoo.com with SMTP; 6 Nov 2001 16:21:12 -0000\r\nReceived: from brain.qlue-lan (brain.qlue-lan [192.168.1.55])\n\tby ral.qlue.com (Postfix) with ESMTP id 0B61B1CF68\n\tfor &lt;junit@yahoogroups.com&gt;; Tue,  6 Nov 2001 11:21:10 -0500 (EST)\r\nDate: Tue, 6 Nov 2001 11:21:10 -0500 (EST)\r\nTo: &lt;junit@yahoogroups.com&gt;\r\nSubject: Re: [junit] testing private methods\r\nIn-Reply-To: &lt;9s8mea+49gg@...&gt;\r\nMessage-ID: &lt;Pine.LNX.4.30.0111061032530.1865-100000@...-lan&gt;\r\nMIME-Version: 1.0\r\nContent-Type: TEXT/PLAIN; charset=US-ASCII\r\nFrom: Eric Vought &lt;evought@...&gt;\r\nX-Yahoo-Profile: eric_vought\r\n\r\n\nTypically, the way you accomplish both objectives (hiding functionality\nand exposing it for unit testing) is to use a Facade. You expose the\nmethods that you want available for testing within the package (package\nprivate methods and/or classes). You create a public class (the Facade)\nwhich exposes just the methods (for the package) you want. You hide the\nactual classes you return from the Facade behind simple interfaces. Your\ntest classes are declared in the same package as your code and therefore\nhave access to the package protected functionality.\n\nThe second option you suggest runInternalTests(..) is also a good thing to\ndo. We call our equivalent interface InvariantsChecker and the method\ncheckInvariants(). We use this method to ensure that an object is in an\ninternally consistent state (e.g. that a stack&#39;s top index does not\nexceed the capacity of the underlying array). You can then call this\nmethod from within your test code:\n\nvoid testPop() throws Exception\n{\n\td_stack.push(d_item1);\n\td_stack.checkInvariants();\n\n\tObject poppedItem = stack.pop();\n\td_stack.checkInvariants();\n\n\tassertSame(item1, poppedItem);\n} // testPop()\n\nWith a little care, you can have runInternalTests() or checkInvariants()\nrun recursively to run consistency checks on contained or referenced\ncomponents. The key is to make sure the checks terminate at some point.\nWe define a simple InvariantsTracker class which monitors the recursion\nfor us and ensures that it terminates. InvariantsTracker just keeps a list\nof object instances that it has already seen. We pass a new\nInvariantsTracker to the first checkInvariants(..) call which in turn\npasses the same instance to recursive calls.\n\nboolean checkInvariants(InvariantsTracker hitList)\n{\n\tif (hitList.alreadyHit(this)) return false;\n\n\tAssert.invariant(d_top &lt; d_size);\n\n\treturn true;\n} // checkInvariants(..)\n\nIn a subclass, the form is slightly different, since the base class\nperforms the check:\n\nboolean checkInvariants(InvariantsTracker hitList)\n{\n\tif (!(super.checkInvariants(hitList))) return false;\n\n\t// ...\n\n\treturn true;\n} // checkInvariants(..)\n\nThe test code then looks like this:\n\nvoid testPop() throws Exception\n{\n\td_stack.push(item1);\n\td_stack.checkInvariants(new InvariantsTracker());\n\n\t// ...\n} // testPop()\n\nThis ends up being a very simple and powerful technique. Having the unit\ntests run the consistency checks in addition to checking external logic\nallows you to catch many more errors with far fewer tests. You begin to\ncatch errors early on that don&#39;t normally show up until load or soak\ntesting and are much harder to diagnose then. Our code is available for\ndownload if you are interested. There is also a package out\nthere called iContract which generates invariant checking code based on\nspecial javadoc comments. iContract has the advantage that the invariants,\npreconditions, and postconditions are clearly specified in your docs, but\nits disadvantage is that it is a preprocessor.\n\nOn Tue, 6 Nov 2001 john_naylor@... wrote:\n\n&gt; i have been assigned the task of pushing our development team toward\n&gt; unit testing.  i have been working with junit for a few weeks now but\n&gt; continue to struggle with one issue.  it seems to me there is tension\n&gt; between unit testing and my preferred api.  for a given class i would\n&gt; like to expose only a handful of methods, yet do not want to forfeit\n&gt; testing my private methods.  my feeling is that i should be concerned\n&gt; with continually testing those methods, and yet fail to see why i\n&gt; should expose methods which are meaningless outside the &quot;blackbox&quot;.\n&gt;\n&gt; perhaps i am missing something obvious about good design.  in the\n&gt; mean time i have set up a simple interface which classes i test\n&gt; internally must implement.\n&gt;\n&gt; public interface Testable\n&gt; {\n&gt; \tpublic static final boolean INTERNAL_MODE = true;\n&gt;\n&gt; \tpublic void runInternalTests() throws Exception;\n&gt; }\n&gt;\n&gt; this allows me to run internal tests and handle assertions by calling\n&gt; the static methods of Assert.  INTERNAL_MODE must be checked within\n&gt; runInternalTests().  This allows internal testing to be turned off\n&gt; for production builds.\n&gt;\n&gt; any insight about this dilemna would be appreciated.\n&gt;\n&gt;\n&gt;\n&gt;\n&gt; To unsubscribe from this group, send an email to:\n&gt; junit-unsubscribe@yahoogroups.com\n&gt;\n&gt;\n&gt; Your use of Yahoo! Groups is subject to http://docs.yahoo.com/info/terms/\n&gt;\n&gt;\n&gt;\n\n-- \nEric Vought\nChief Technical Officer - QLUE Consulting, Inc.\n\nevought@... toll-free: 888-771-3538  RTP area: 919-816-9901\n\n\n", 
    "profile": "eric_vought", 
    "topicId": 3179, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 0, 
    "prevInTime": 3181, 
    "contentTrasformed": false, 
    "postDate": "1005063670", 
    "canDelete": false, 
    "nextInTopic": 3197, 
    "prevInTopic": 3179, 
    "headers": {
        "inReplyToHeader": "PDlzOG1lYSs0OWdnQGVHcm91cHMuY29tPg==", 
        "messageIdInHeader": "PFBpbmUuTE5YLjQuMzAuMDExMTA2MTAzMjUzMC4xODY1LTEwMDAwMEBicmFpbi5xbHVlLWxhbj4="
    }
}