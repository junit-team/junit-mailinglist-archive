{
    "topicId": 8737, 
    "postDate": "1059727343", 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "from": "&quot;bernd&quot; &lt;berndq@...&gt;", 
    "canDelete": false, 
    "replyTo": "LIST", 
    "senderId": "VC0j8Tyq6AcvyXAK1PukOX62qegQeVd-bKc8FDss4BbthuDLtvpaQFtU7HbDX3RHSvfiAtdvMm7i7fHjYCaD", 
    "nextInTime": 8920, 
    "userId": 106754364, 
    "prevInTime": 8918, 
    "prevInTopic": 8891, 
    "headers": {
        "inReplyToHeader": "PE5GQkJMRkROTUpMTkxKQUpKS05BS0VLSEZIQUEuYWNoZXBhdGk2N0B5YWhvby5lcz4=", 
        "messageIdInHeader": "PDAwMGUwMWMzNTgwOCRkNzU1YzE1MCQxZjAzYThjMEBkZWxsPg=="
    }, 
    "authorName": "bernd", 
    "numMessagesInTopic": 24, 
    "msgSnippet": "Hi, ... sorry for not reading you code in detail, I was thinking of something like interface Finish { void do(int i); } we need it for production: class", 
    "contentTrasformed": false, 
    "msgId": 8919, 
    "nextInTopic": 9013, 
    "systemMessage": false, 
    "rawEmail": "Return-Path: &lt;berndq@...&gt;\r\nX-Sender: berndq@...\r\nX-Apparently-To: junit@yahoogroups.com\r\nReceived: (qmail 61332 invoked from network); 1 Aug 2003 08:42:40 -0000\r\nReceived: from unknown (66.218.66.216)\n  by m12.grp.scd.yahoo.com with QMQP; 1 Aug 2003 08:42:40 -0000\r\nReceived: from unknown (HELO mail.gmx.net) (213.165.64.20)\n  by mta1.grp.scd.yahoo.com with SMTP; 1 Aug 2003 08:42:38 -0000\r\nReceived: (qmail 17839 invoked by uid 65534); 1 Aug 2003 08:42:35 -0000\r\nReceived: from p50917204.dip.t-dialin.net (EHLO dell) (80.145.114.4)\n  by mail.gmx.net (mp013) with SMTP; 01 Aug 2003 10:42:35 +0200\r\nTo: &lt;junit@yahoogroups.com&gt;\r\nSubject: RE: [junit] How to test a main(String[] args) method?\r\nDate: Fri, 1 Aug 2003 10:42:23 +0200\r\nMessage-ID: &lt;000e01c35808$d755c150$1f03a8c0@dell&gt;\r\nMIME-Version: 1.0\r\nContent-Type: text/plain;\n\tcharset=&quot;us-ascii&quot;\r\nContent-Transfer-Encoding: 7bit\r\nX-Priority: 3 (Normal)\r\nX-MSMail-Priority: Normal\r\nX-Mailer: Microsoft Outlook, Build 10.0.4510\r\nImportance: Normal\r\nX-MimeOLE: Produced By Microsoft MimeOLE V6.00.2800.1106\r\nIn-Reply-To: &lt;NFBBLFDNMJLNLJAJJKNAKEKHFHAA.achepati67@...&gt;\r\nFrom: &quot;bernd&quot; &lt;berndq@...&gt;\r\nX-Yahoo-Group-Post: member; u=106754364\r\n\r\nHi, \n\n\n&gt; -----Original Message-----\n&gt; From: David [mailto:achepati67@...] \n&gt; Sent: Wednesday, July 30, 2003 10:57 AM\n&gt; To: junit@yahoogroups.com\n&gt; Cc: berndq@...; mike@...; jbrains@...\n&gt; Subject: RE: [junit] How to test a main(String[] args) method?\n&gt; \n&gt; \n&gt; &gt;Dear Members,\n&gt; &gt;\n&gt; &gt;I whould like to test a class with a main(String[] args) \n&gt; method. Depending\n&gt; &gt;on the input argument it executes one thing or the other. \n&gt; The problem is\n&gt; &gt;that on my main(String[] args) method at the end or when it founds an\n&gt; error,\n&gt; &gt;the method System.exit() is invoked. So when I define jUnit \n&gt; test cases\n&gt; &gt;(methods with prefix test), jUnits only runs the first test, because\n&gt; some&gt;System.exit() was invoked.\n&gt; &gt;Is there any way to test such kind of situations?\n&gt; &gt;Thanks in advance,\n&gt; \n&gt; The solution propoused by Bern was:\n&gt; \n&gt; java.lang.System is final and does not implement \n&gt; interfaces,so there is no\n&gt; chance to replace ist behaviour.You may want to replace calls to\n&gt; System.exit() with calls againstan interface you define. \n&gt; Under test use an\n&gt; implementation which allowsyourtest code to chech if the exit \n&gt; method has\n&gt; been called by main() but whichdoes not exit the VM. In \n&gt; production use an\n&gt; implememtation which delegatesto System.exit().\n&gt; \n&gt; As far as I know what you mean could be implemented like \n&gt; this: (see comments\n&gt; below)\n&gt; \n&gt; package com.my.example\n&gt; \n&gt; public class Example {\n&gt; \tstatic Finish _finish = new \n&gt; Example.ProductionFinish();// private package\n&gt; (static because it is\n&gt; \t\t\t\t\t\t\t\t\n&gt; \t\t// going to be used on main.)\n&gt; \tstatic void setFinish(Finish value){_finish = value;}\t\n&gt; // private package\n&gt; \n&gt; \tstatic main (String[] args)\n&gt; \n&gt; \t\tboolean goOn = true; \t// because we don&#39;t \n&gt; exit on testing mode,\n&gt; \t\t\t\t\t\t// we need a \n&gt; way for controling the execution flow.\n&gt; \t\tif (someCondition) {// first checking (exceptional flow)\n&gt; \t\t\tgoOn = finish.do(-1);\n&gt; \t\t}\n&gt; \t\t// ... put other checking here\n&gt; \t\tif (goOn && otherCondition) {// main flow\n&gt; \t\t\tfinish.do(0);\n&gt; \t\t}\n&gt; \t}\n&gt; \n&gt; \t/* Now we define the interface Finish and its default \n&gt; implementation (as\n&gt; inner classes\n&gt; \twith private-package visibility, because we have to \n&gt; define ONLY for testing\n&gt; purpose this\n&gt; \tinterface!)*/\n&gt; \n&gt; \tinterface Finish {\n&gt; \t\tboolean do(int i);\n&gt; \t}\n&gt; \n&gt; \tclass ProductionFinish {// its default implementation \n&gt; (used on production\n&gt; mode)\n&gt; \t\tProductionFinish(){} // default constructor \n&gt; with private-package\n&gt; visibility\n&gt; \t\tboolean do(int i) {\n&gt; \t\t\tSystem.exit(i);\n&gt; \t\t}\n&gt; \t}\n&gt; }\n&gt; \n&gt; Now on the testing class defined on the same package:\n&gt; \n&gt; package com.my.example\n&gt; \n&gt; public class ExampleTest extends TestCase{\n&gt; \t// ...\n&gt;     \tprotected void setUp (){Example.setFinish(new\n&gt; ExampleTest.TestingFinish());}\n&gt; \t}\n&gt; \tclass TestingFinish implements Example.Finish{\n&gt; \t\tTestingFinish (){} // default constructor with \n&gt; private-package visibility\n&gt; \t\tboolean do(int i) { // We have to stop on every case!\n&gt; \t\t\treturn false;\n&gt; \t\t}\n&gt; \t}\n&gt; }\n\nsorry for not reading you code in detail, \nI was thinking of something like\n\n \tinterface Finish {\n \t\tvoid do(int i);\n \t}\n\nwe need it for production:\n\nclass ProductionFinish implements Finish{\n    public void do(int exitCode){\n        System.exit(exitCode);\n    }\n}\n\n\nand a Mock for tests:\n\nclass MockFinish implements Finish{\n    public void do(int exitCode){\n        mLastExitCode=exitCode;\n        mNumberOfDoCalled++;\n    }\n\n    public int getLastExitCode(){return mLastExitCode;}\n    public int getNumberOfDoCalled(){return mDoWasCalled;}\n\n    private int mLastExitCode;\n    private int mNumberOfDoCalled=0;\n}\n\ninside of main, just use the interface.\nAt the very beginnig of main you may use a factory\nto get an implmentation:\n\npublic static void main(String[] atgs){\n   Finish finish=FinishFactory.getInstance();\n\n   ...\n   finish.do(22);\n   ...\n}\n\ndepending on production/test the factory will\nhand out the corresponding implementation.\n\na test may look like this:\n\npublic MyTestCase extends TestCase{\n...\npublic test_xx(){\n    com.xxx.package.main(argsToBeTested)\n    MockFinish mockFinish=howToGetInstance??\n\n    // make sure exit was called only once\n    assertEquals(1, mockFinish.getNumberOfDoCalled());\n    assertEquals(expectedExitCode, mockFinish.getLastExitCode());\n}\n\nBut how to get the instance of MockFinsih?\nMaybe something like\n\n...\npublic static MockFinish getInstance(){\n   return mInstance;\n}\n\nprivate static mInstance;\n...\n\n\nhmm, yes really lots of code...\n\n&gt; COMMENTS:\n&gt; \n&gt; - About this suggestion and the corresponding implementation, \n&gt; because we\n&gt; need a default implementation ALWAYS (for production), then \n&gt; instead of using\n&gt; an INTERFACE, it is BETTER to just define the class Finish as \n&gt; ABSTRACT (the\n&gt; do(int i) method should be abstract)\n&gt; \n&gt; - You have to write A LOT for makeing a very simple task. I \n&gt; have implemented\n&gt; a simpler solution, just do the following steps:\n&gt; \n&gt; a) Define on the class to test (Example), the static boolean \n&gt; field _TEST as\n&gt; private-package. This field is initialized with default value: false\n&gt; (production)\n&gt; \n&gt; b) Define a STATIC PRIVATE method finish, like this:\n&gt; \t\tprivate static boolean finish(int i) {\n&gt; \t\t\tif(!_TEST) {\n&gt; \t\t\t\tSystem.exit(i);\n&gt; \t\t\t}\n&gt; \t\t\treturn false;\n&gt; \t\t}\n&gt; c) On the testing class (ExampleTest), set on the setup() \n&gt; method, the field\n&gt; _TEST to true.\n&gt; \n&gt; \n&gt; Now we have:\n&gt; \n&gt; package com.my.example\n&gt; \n&gt; public class Example {\n&gt; \tstatic boolean _TEST = false;\n&gt; \n&gt; \tstatic main (String[] args)\n&gt; \n&gt; \t\tboolean goOn = true;\n&gt; \t\tif (someCondition) {// fist checking\n&gt; \t\t\tgoOn = finish(-1);\n&gt; \t\t}\n&gt; \t\t// ... put other checking here\n&gt; \t\tif (goOn && otherCondition) {// the last \n&gt; condition (end of the program)\n&gt; \t\t\tfinish(-1);\n&gt; \t\t}\n&gt; \t}\n&gt; \n&gt; \tprivate static boolean finish (int i) {\n&gt; \t\tif (!_TEST) {\n&gt; \t\t\tSystem.exit(i);\n&gt; \t\t}\n&gt; \t\treturn false;\n&gt; \t}\n&gt; }\n&gt; \n&gt; package com.my.example\n&gt; \n&gt; public class ExampleTest extends TestCase{\n&gt; \t// ...\n&gt;     \tprotected void setUp (){Example._TEST = true;}\n&gt; \t}\n&gt; }\n&gt; \n&gt; I think this solution is enough. Any suggestion?\n\nHow do you test that finish() really was called?\nIIRC that was your question in your initial posting?\n\nMaybe to much modification of the original code: goOn && ... ?\nDid you try J.B.&#39;s suggestion?\n\nBernd\n\n&gt; \n&gt; Thanks in advance,\n&gt; \n&gt; David\n&gt; \n&gt; \n&gt; ------------------------ Yahoo! Groups Sponsor \n&gt; ---------------------~--&gt;\n&gt; Buy Ink Cartridges or Refill Kits for Your HP, Epson, Canon or Lexmark\n&gt; Printer at Myinks.com. Free s/h on orders $50 or more to the \n&gt; US & Canada. http://www.c1tracking.com/l.asp?cid=5511\n&gt; http://us.click.yahoo.com/sO0ANB/LIdGAA/ySSFAA/5cFolB/TM\n&gt; --------------------------------------------------------------\n&gt; -------~-&gt;\n&gt; \n&gt; To unsubscribe from this group, send an email to:\n&gt; junit-unsubscribe@yahoogroups.com\n&gt;  \n&gt; \n&gt; Your use of Yahoo! Groups is subject to \n&gt; http://docs.yahoo.com/info/terms/ \n&gt; \n&gt; \n&gt; \n\n\n\n", 
    "subject": "RE: [junit] How to test a main(String[] args) method?"
}