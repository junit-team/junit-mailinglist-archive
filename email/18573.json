{
    "numMessagesInTopic": 12, 
    "nextInTime": 18574, 
    "senderId": "qBz59K2qfae6YxIW0DuIqAsEdB8MTozEt_nRfQwr3TXB6NxCx70aLoX1q7VXnbuX41w2F72BcNWA5jQD9zIw2A", 
    "systemMessage": true, 
    "subject": "Re: [junit] Test a remote server", 
    "from": "andrew.p.mcdonagh@...", 
    "authorName": "andrew.p.mcdonagh@gsk.com", 
    "msgSnippet": "Hi, So I m still not sure if you mean you want to Unit test or System test, using the JUnit framework. I m going to show how I would   Unit Test    the code,", 
    "msgId": 18573, 
    "profile": "andy_ipaccess", 
    "topicId": 18546, 
    "spamInfo": {
        "reason": "2", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 233879428, 
    "messageBody": "<div id=\"ygrps-yiv-1627301947\">Hi,<br/>\n<br/>\nSo I&#39;m still not sure if you mean you want to Unit test or System test, <br/>\nusing the JUnit framework.<br/>\n<br/>\nI&#39;m going to show how I would   Unit Test    the code, using JUnit.....<br/>\n<br/>\n<br/>\nThe code as it stands, makes unit testing difficult because of the use of <br/>\nSingletons, static methods and raw Corba or RMi objects.  So I&#39;m going to <br/>\nrefactor it somewhat to make it testable.  Making it testable usually <br/>\nmakes the design more flexible, finer grained and loosely coupled - all <br/>\ngood things.<br/>\n<br/>\nFirst step - move the property setting code into its own class - then test <br/>\nit there instead of inside the main() method.  This is because the main() <br/>\nmethod has calls to a singleton and creates CORBA objects, which I can&#39;t <br/>\neasily get around, as this code is inside the static &#39;main()&#39; method.  If <br/>\nthis code lived inside an instance method of Server, then I could inject a <br/>\nmock object for these.<br/>\n<br/>\nSo, here&#39;s the main method, with the MTT Host and UUID property setting <br/>\ncode moved into a new class. The new class&#39;s method also only knows about <br/>\nnormal Java classes (InetAddress) instead of being coupled to the VestUUID <br/>\nclass - this makes unit testing really easy!!!!<br/>\n<br/>\n<br/>\n public static void main(String[] args) {<br/>\n    if (args.length &gt;= 1) {<br/>\n      try {<br/>\n        // set the initial environment<br/>\n        AnotherServer.getInstance().setEnvironment();<br/>\n<br/>\n        Server obj = Server.getInstance();<br/>\n<br/>\n        _serverUUID = new VespUuid(args[0]);<br/>\n<br/>\n        InetAddress inetAddress = _serverUUID.getInetAddress();<br/>\n        SystemPropertyConfigurator.setMttHostProperty(inetAddress, <br/>\nServer._serverUUID.getPort());<br/>\n<br/>\n        if (args.length &gt;= 2) {<br/>\n          SystemPropertyConfigurator.setOrbUuidProperty(args[1]);<br/>\n        }<br/>\n      } catch (Exception e) {<br/>\n        // todo...<br/>\n        throw new RuntimeException(e);<br/>\n      }<br/>\n    }<br/>\n  }<br/>\n<br/>\n<br/>\nHere&#39;s the new class......(as it currently stands)<br/>\n<br/>\n<br/>\nimport java.net.InetAddress;<br/>\n<br/>\npublic class SystemPropertyConfigurator {<br/>\n<br/>\n  static void setMttHostProperty(InetAddress inetAddress, String port) {<br/>\n    StringBuffer sb = new StringBuffer(inetAddress.toString());<br/>\n    sb.delete(0, 1);<br/>\n    sb.append(&quot;:&quot;);<br/>\n    sb.append(port);<br/>\n <br/>\n    String sInetAddress = sb.toString();<br/>\n    System.setProperty(VespConfigParams.MTT_INSTANCE_HOST_PROPERTY, <br/>\nsInetAddress);<br/>\n  }<br/>\n<br/>\n<br/>\n<br/>\n  static void setOrbUuidProperty(String uuid) {<br/>\n    System.setProperty(VespConfigParams.ORB_UUID_PROPERTY, uuid);<br/>\n  }<br/>\n <br/>\n}<br/>\n<br/>\n<br/>\n<br/>\n<br/>\nAnd now here&#39;s its unit test!!!!!!!!!!! (these run and pass in my eclipse)<br/>\n<br/>\n<br/>\nimport java.net.InetAddress;<br/>\nimport java.net.UnknownHostException;<br/>\n<br/>\nimport junit.framework.TestCase;<br/>\n<br/>\npublic class SystemPropertyConfiguratorTest extends TestCase {<br/>\n<br/>\n  public void testMttHostPropertySetWithoutFirstLetter() throws <br/>\nUnknownHostException {<br/>\n    InetAddress address = InetAddress.getByName(&quot;localhost&quot;);<br/>\n<br/>\n    SystemPropertyConfigurator.setMttHostProperty(address, &quot;8080&quot;);<br/>\n<br/>\n    String actualProperty = <br/>\nSystem.getProperty(VespConfigParams.MTT_INSTANCE_HOST_PROPERTY);<br/>\n <br/>\n    String expectedProperty = &quot;ocalhost/127.0.0.1:8080&quot;;<br/>\n <br/>\n    assertNotNull(&quot;Property not found!&quot;, actualProperty);<br/>\n    assertEquals(&quot;Wrong property value!&quot;, expectedProperty, <br/>\nactualProperty);<br/>\n  }<br/>\n <br/>\n <br/>\n public void testOrbUuidPropertySet() {<br/>\n   SystemPropertyConfigurator.setOrbUuidProperty(&quot;a UUID!&quot;);<br/>\n <br/>\n   String actualProperty = <br/>\nSystem.getProperty(VespConfigParams.ORB_UUID_PROPERTY);<br/>\n <br/>\n   assertNotNull(&quot;Property not found!&quot;, actualProperty);<br/>\n   assertEquals(&quot;Wrong property value!&quot;, &quot;a UUID!&quot;, actualProperty);<br/>\n }<br/>\n <br/>\n}<br/>\n<br/>\n<br/>\n<br/>\n<br/>\nNow, as things stand, I may decide to not unit test the &#39;main()&#39; method in <br/>\nServer class at all, as all its doing is calling others to do things, I <br/>\nmight rely upon the normal System and integeration tests to test it.  Or I <br/>\nmay decide to refactor the Server class as well, to allow me to make the <br/>\nmain() method more testable (which will involve similar techniques as I&#39;ve <br/>\nshown here).  The choice comes down as always to one of time vs payback. <br/>\n<br/>\nHopefully this is enough to get you started in thinking baout how to <br/>\nchange your design slightly, to enable unit testing of the code, without <br/>\nhaving to have real corba, networks, files, dbs, etc around.<br/>\n<br/>\nFeel free to ask for more help...<br/>\n<br/>\nAndrew<br/>\n<br/>\n<br/>\n<br/>\n<br/>\n<br/>\n<br/>\n&quot;avinash anand&quot; &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:avinash_anand@...\">avinash_anand@...</a>&gt; <br/>\nSent by: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\n15-Dec-2006 14:23<br/>\nPlease respond to <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\n<br/>\n <br/>\nTo<br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\ncc<br/>\n<br/>\nSubject<br/>\nRe: [junit] Test a remote server<br/>\n<br/>\n<br/>\n<br/>\n<br/>\n<br/>\n<br/>\nHi <br/>\nPosting the real .java file would not be possible for me but I am writting <br/>\na sample java file which will be doing the same (You can say its a <br/>\nprototype of it.)<br/>\n<br/>\nclass server{<br/>\nprivate DBConnection _dbconnectoin;<br/>\nprivate server _serverinstance = null;<br/>\nprivate static VespAlarmService _alarmService;<br/>\nprivate static VespUuid _serverUUID;<br/>\nprivate server(){<br/>\n_alarmService = VespAlarmServiceImpl.getInstance();<br/>\n}<br/>\npublic static server getInstance(){<br/>\nif (null == _servernstance){<br/>\n_serverinstance = new server(); <br/>\n}<br/>\nreturn _serverinstance;<br/>\n}<br/>\npublic static void main(String[] args){ <br/>\nif (args.length &gt;= 1){<br/>\ntry {<br/>\n//set the initial environment<br/>\nAnotherServer.getInstance().setEnvironment();<br/>\nserver obj = server.getInstance();<br/>\n_serverUUID = new VespUuid(args[0]);<br/>\nStringBuffer sb = new <br/>\nStringBuffer(_serverUUID.getInetAddress().toString());<br/>\nsb.delete(0, 1);<br/>\nsb.append(&quot;:&quot;);<br/>\nsb.append(_serverUUID.getPort());<br/>\nString sInetAddress = sb.toString();<br/>\nSystem.setProperty(VespConfigParams.MTT_INSTANCE_HOST_PROPERTY, <br/>\nsInetAddress);<br/>\nif(args.length &gt;= 2) { <br/>\nSystem.setProperty(VespConfigParams.ORB_UUID_PROPERTY, args[1]);<br/>\n}<br/>\nvoid startserver ()<br/>\n{<br/>\n}<br/>\nvoid stopserver()<br/>\n{<br/>\n}<br/>\nvoid isserverready()<br/>\n{<br/>\n}<br/>\nvoid generatevespAlarm()<br/>\n{<br/>\n} <br/>\n}<br/>\n<br/>\nThis is how the main class looks. There are many other supporting JAVA <br/>\nfiles for this main server. It uses a JNI layer to talk to the native <br/>\ncode. Which is implemented elesewhere.<br/>\n<br/>\nFor it to run in the actul enviroment, it uses a wrapper .exe which calls <br/>\nan xml file where all the server properties are listed in the main method <br/>\nthe location of .class files are specified which are already compiled and <br/>\nput in the java&#92;lib folder in the form of .jar. Here is the snippet of xml <br/>\nfile where the exe tries to read it.<br/>\n<br/>\n&lt;stringProperty property=&quot;jloader.server.main.class&quot; displayName=&quot;Main <br/>\nclass&quot; default=&quot;com/xyz/server/testing&quot; enabled=&quot;false&quot; advanced=&quot;true&quot; /&gt;<br/>\n<br/>\nWhat I am trying is to write a JUnit test suite for this Java based <br/>\nserver, which will be running in the form of an .exe. And my test cases <br/>\nwill be running in eclipse.<br/>\n<br/>\nHope the entire thing might make the picture a bit clear. <br/>\n<br/>\nThanks<br/>\nAvinash<br/>\n<br/>\n----- Original Message ----<br/>\nFrom: &quot;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:andrew.p.mcdonagh@...\">andrew.p.mcdonagh@...</a>&quot; &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:andrew.p.mcdonagh@...\">andrew.p.mcdonagh@...</a>&gt;<br/>\nTo: <a rel=\"nofollow\" target=\"_blank\" href=\"mailto:junit@yahoogroups.com\">junit@yahoogroups.com</a><br/>\nSent: Friday, 15 December, 2006 7:25:14 PM<br/>\nSubject: Re: [junit] Test a remote server<br/>\n<br/>\nHi,<br/>\n<br/>\nNot sure why your Java app does not use Java&#39;s corba ability (a good Java <br/>\nORB being <a rel=\"nofollow\" target=\"_blank\" href=\"http://www.jacorb\">http://www.jacorb</a> org/ ), instead of JNI...<br/>\n<br/>\nAnyway, onto your real question, how do I test the code that is dependant <br/>\nupon the other servers?<br/>\n<br/>\nAs you are asking on the JUnit list I take it you mean Unit test?<br/>\nNot System or Integration testing?<br/>\n<br/>\nIf so, then you will find unit testing much simpler and (imo) better, if <br/>\nnone of your unit tests need to access any file, network, database or UI. <br/>\nThis means they run very fast. Once you figure out how to do them, you <br/>\nshould be able to write lots of them , quickly too.<br/>\n<br/>\nWe could just give you some simple examples, but I tend to find it better <br/>\nto show you how to unit test one of your classes that depend on corba or <br/>\nsome other system, by using one of your real classes. So, please post <br/>\n(just one) class and we&#39;ll knock up a unit test for it.<br/>\n<br/>\nRegards<br/>\n<br/>\nAndrew<br/>\n<br/>\n&quot;avinash anand&quot; &lt;avinash_anand@ yahoo.co. uk&gt; <br/>\nSent by: junit@yahoogroups. com<br/>\n15-Dec-2006 09:04<br/>\nPlease respond to junit@yahoogroups. com<br/>\n<br/>\nTo<br/>\njunit@yahoogroups. com<br/>\ncc<br/>\n<br/>\nSubject<br/>\n[junit] Test a remote server<br/>\n<br/>\nHi Group<br/>\nGreetings to all. These days I am writting test suit for a CORBA CRM. Let <br/>\nme first introduce the system.<br/>\n<br/>\nThere is a central ORB server and many other servers which talk to each <br/>\nother through vesp. ORB being the central one. Entire code base is in C++. <br/>\n<br/>\nI have to test a new server introduced in the system which is written in <br/>\nJava. This new server talks to the rest through JNI. As a matter of Fact <br/>\nnone of the servers can run independently, they neccesirily have to log <br/>\ninto the central kit and report to the the central ORB server. After <br/>\nvalidation stuff the server starts working.<br/>\n<br/>\nEven this new Java based server uses an executable file to work <br/>\n(Jloader.exe written in c++)<br/>\n<br/>\nThis .exe loads various .dll files in the system and in its main method <br/>\ncalls the compiled .class files. This is the way how system functions.<br/>\n<br/>\nMy problem is that when I will write a JUnit test case in IDE (eclipse) <br/>\nwhich would operate on the actual code which has 99% dependency and cannot <br/>\n<br/>\nbe tested isolated. Is there any way to test this server code while it is <br/>\nworking under the live system and the test suite running in the eclipse <br/>\nIDE.<br/>\n<br/>\nHELP !!!<br/>\n<br/>\nThanks<br/>\nAvinash<br/>\n<br/>\n____________ _________ _________ _________ _________ _________ _ <br/>\nNow you can scan emails quickly with a reading pane. Get the new Yahoo! <br/>\nMail. <a rel=\"nofollow\" target=\"_blank\" href=\"http://uk.docs\">http://uk.docs</a> yahoo.com/ nowyoucan. html<br/>\n<br/>\n[Non-text portions of this message have been removed]<br/>\n<br/>\n[Non-text portions of this message have been removed]<br/>\n<br/>\n<br/>\n<br/>\n<br/>\n__________________________________________________________ <br/>\nAll new Yahoo! Mail &quot;The new Interface is stunning in its simplicity and <br/>\nease of use.&quot; - PC Magazine <br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"http://uk.docs.yahoo.com/nowyoucan.html\">http://uk.docs.yahoo.com/nowyoucan.html</a><br/>\n<br/>\n[Non-text portions of this message have been removed]<br/>\n<br/>\n <br/>\n<br/>\n<br/>\n[Non-text portions of this message have been removed]</div>", 
    "prevInTime": 18572, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1166527345", 
    "canDelete": false, 
    "nextInTopic": 0, 
    "prevInTopic": 18571, 
    "headers": {
        "inReplyToHeader": "PDIwMDYxMjE5MDY0MzI4LjQ2ODc3LnFtYWlsQHdlYjI2NzA3Lm1haWwudWtsLnlhaG9vLmNvbT4=", 
        "messageIdInHeader": "PE9GNURDNzI2NTQuMDE4RDAyMzYtT044MDI1NzI0OS4wMDNFNjM4My04MDI1NzI0OS4wMDNFN0JCM0Bnc2suY29tPg=="
    }
}