{
    "numMessagesInTopic": 67, 
    "nextInTime": 5262, 
    "senderId": "pZ_yeinGfo2f8L0JI6c-YuOxQKoR-0qQGSG6-PJaLsbjE23iYlPvb-XT-te_dRaNwg6KMB3YkEh9mynx6tuz4YWO2OfEYtHLCzF_m1pypNg", 
    "systemMessage": false, 
    "subject": "design issue", 
    "from": "Boris Garbuzov &lt;boris_garbuzov@...&gt;", 
    "authorName": "Boris Garbuzov", 
    "msgSnippet": "Can somebody suggest on some issue of JUnit API usage or test case design? Sorry for a long appendix code. The essence is that I want to start some application", 
    "msgId": 5261, 
    "profile": "boris_garbuzov", 
    "topicId": 5186, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 117045670, 
    "messageBody": "<div id=\"ygrps-yiv-1934609243\">Can somebody suggest on some issue of JUnit API usage<br/>\nor test case design? Sorry for a long appendix code.<br/>\nThe essence is that I want to start some application<br/>\nonce in VM session and run all my test methods<br/>\nafterwards. I could not find sufficient place to put<br/>\nmy initial call <br/>\nClientMain.main (null);<br/>\nFirst I tried setUp(), but it is called before every<br/>\ntest method. Then I tried to implement TestListener to<br/>\nuse startTest() method. It in turn was not obvious,<br/>\nand you can see the indirect tricks I had to use with<br/>\nrun() method and result class, please suggest me<br/>\neasier way. But anyways it did not help as startTest()<br/>\nwas also called before every test method (what is the<br/>\ndifference?) Then I finally used static counters.<br/>\nPlease suggest me proper solution. <br/>\n<br/>\n<br/>\n<br/>\n<br/>\n<br/>\n------------------------------------------------------------<br/>\npackage com.imc.testutil;<br/>\n<br/>\n// log4j<br/>\nimport org.apache.log4j.PropertyConfigurator;<br/>\nimport org.apache.log4j.Logger;<br/>\n// junit<br/>\nimport junit.framework.Test;<br/>\nimport junit.framework.TestCase;<br/>\nimport junit.framework.TestResult;<br/>\nimport junit.framework.AssertionFailedError;<br/>\nimport junit.framework.TestListener;<br/>\n<br/>\n<br/>\n/**<br/>\nThis is intended wrapper for all imc test cases.<br/>\n&lt;p&gt;<br/>\nHere we <br/>\n&lt;ol&gt;<br/>\n\t&lt;li&gt;configure logger from properties file<br/>\n\t&lt;li&gt;add TestListener<br/>\n\t&lt;li&gt;count test method calls<br/>\n\t&lt;li&gt;distinguish first test method call for child to<br/>\nput all settings called once per suite<br/>\n\t&lt;li&gt;do some dummy loggings of method calls<br/>\n&lt;/ol&gt;<br/>\n&lt;/p&gt;<br/>\n&lt;p&gt;<br/>\nWe experience the following design difficulties,<br/>\nderiving either from JUnit API imperfection<br/>\nor our poor usage of the latter, namely:<br/>\n&lt;ol&gt;<br/>\n\t&lt;li&gt;It was not obvious how to add TestListener. <br/>\n\tThen we needed to overwrite run() method which does<br/>\nnot seem proper way. <br/>\n\t&lt;li&gt;The listener being added, we discover startTest()<br/>\nmethod to have unexpected functionality.<br/>\n\tWe need the place to put code called once per suite. <br/>\n\tInstead, startTest() is called before every testXXX()<br/>\nmethod just like setUp()<br/>\n\tThen what is the difference?<br/>\n\tLikewise we could use setUp(), statically counting<br/>\ncalls <br/>\n\tand implement firstSetUp().<br/>\n&lt;/ol&gt;<br/>\n@since on 10 June 2002<br/>\n@author Boris Garbuzov<br/>\n */<br/>\npublic class ImcTestCase <br/>\n\textends TestCase <br/>\n\t// second listener after TestRunner in the JVM<br/>\nprocess<br/>\n\timplements TestListener<br/>\n{<br/>\n<br/>\n\t/*<br/>\n\tWe can use log befoe or in first constructor. <br/>\n\t*/<br/>\n\tstatic<br/>\n\t{<br/>\n\t\tPropertyConfigurator.configure(&quot;log4j.properties&quot;);<br/>\n\t}<br/>\n<br/>\n    /** this flag is static because testrunner create<br/>\nnew instance of<br/>\n     * of this class for every testXXX method. This<br/>\nflag is needed to fire <br/>\n     * method firstStartTest() only one time. This<br/>\nmethod is famous for operations<br/>\n     * that needs only one time. Look at method<br/>\nrun(TestResult ..)<br/>\n\t @deprecated. currentStartTestIndex is used instead<br/>\n     */<br/>\n    //private static boolean isStartTestFirst = false;<br/>\n<br/>\n\t/** <br/>\n\tgeneralizes the idea of isStartTestFirst<br/>\n\tchecked and incremented in startTest()<br/>\n\tand published in getCurrentStartTestIndex<br/>\n\tIt is good to police the usage<br/>\n\tso that this variable could be only incremented, and<br/>\nnot voluntarily reset. <br/>\n\t*/<br/>\n\tprivate static int currentStartTestIndex = 0;<br/>\n<br/>\n\t/** <br/>\n\tJUnit after TestRunner calls this constructor <br/>\n\twith name = testXxxx - the current test method <br/>\n\t*/<br/>\n\tpublic ImcTestCase (String name)<br/>\n\t{<br/>\n\t\tsuper(name);<br/>\n\t\t//createResult().addListener (this); // does not<br/>\nhelp<br/>\n\t\tgetDefaultLogger().info(&quot;instance created with name<br/>\n= &quot; + name);<br/>\n\t}<br/>\n    <br/>\n\t/**<br/>\n\tExtension Test code calls this method for casual<br/>\nlogging needs. <br/>\n\tThis should not add much overhead. <br/>\n\tLogger does quick lookup by name.<br/>\n\tThat is why we get rid of the field. <br/>\n\t*/<br/>\n\tprotected Logger getDefaultLogger()<br/>\n\t{<br/>\n\t\treturn Logger.getLogger (getName());<br/>\n\t}<br/>\n<br/>\n\t/**<br/>\n\t* Overide<br/>\n\t* Runs the test case and collects the results in<br/>\nTestResult.<br/>\n\t* And adds this class as TestListener <br/>\n\tIs it the only way?<br/>\n\tMay be &quot;createResult().addListener (this)&quot; whould<br/>\nsuffice?<br/>\n\t*/<br/>\n\tpublic void run(TestResult result) <br/>\n\t{<br/>\n\t\tresult.addListener(this);<br/>\n\t\tsuper.run (result);<br/>\n\t} <br/>\n    <br/>\n\t/** implements startTest interface method<br/>\n\tchildren can add here call of original application to<br/>\nbe tested<br/>\n\tFor the child class it is desirable to call this<br/>\nsuper first<br/>\n\tin case of overwriting to prevent obuse. <br/>\n\t*/<br/>\n    public void startTest(Test test)<br/>\n    {<br/>\n\t\tgetDefaultLogger().info(&quot;Start test &quot; + getName());<br/>\n\t\tcurrentStartTestIndex++;<br/>\n\t\t// moved from run()<br/>\n\t\tif(currentStartTestIndex == 1)<br/>\n\t\t{<br/>\n\t\t\tfirstStartTest();<br/>\n\t\t}<br/>\n    }<br/>\n    <br/>\n    /** implements addFailure interface method<br/>\n    */<br/>\n    public void addFailure(Test test,<br/>\nAssertionFailedError assertionFailedError)<br/>\n    {<br/>\n\t\tgetDefaultLogger().error(<br/>\nassertionFailedError.getMessage() );<br/>\n    }<br/>\n    <br/>\n    /** implements endTest interface method<br/>\n    */<br/>\n    public void endTest(Test test)<br/>\n    {<br/>\n\t\tgetDefaultLogger().info(&quot;Finish test &quot; + getName());<br/>\n    }<br/>\n    <br/>\n    /** implements TestLister<br/>\n\tHere we just log the fact of invokation and print the<br/>\nerror.<br/>\n\tThe children can overwrite it adding sensible stuff. <br/>\n    */<br/>\n    public void addError(Test test, Throwable<br/>\nthrowable)<br/>\n    {<br/>\n\t\tgetDefaultLogger().error(throwable.getMessage());<br/>\n    }<br/>\n\t<br/>\n\t/**  <br/>\n\t@since June 2002 for children to override it<br/>\n\tcalling original application once per suite<br/>\n\tThe child should not necessarily call this super,<br/>\n\tbut it does not hurt too. <br/>\n\t*/<br/>\n    public void firstStartTest()<br/>\n    {<br/>\n\t\tgetDefaultLogger().info (&quot;&#92;r&#92;n<br/>\nIncTestCase.firstStartTest() is called &#92;r&#92;n&quot;);<br/>\n    }    <br/>\n<br/>\n\t/**  <br/>\n\tpublishes current index of test method running<br/>\n\t*/<br/>\n    public int getCurrentStartTestIndex()<br/>\n    {<br/>\n\t\treturn currentStartTestIndex;<br/>\n    }    <br/>\n}<br/>\n<br/>\n<br/>\n<br/>\n<br/>\n<br/>\n-------------------------------------------------------<br/>\npackage com.imc.mymailloop.demo.boris2.test4;<br/>\n<br/>\n// jdk<br/>\nimport javax.swing.JFrame;<br/>\nimport java.awt.Rectangle;<br/>\nimport java.awt.Robot;<br/>\nimport java.awt.event.InputEvent;<br/>\nimport java.awt.Color;<br/>\n// junit<br/>\nimport com.imc.testutil.TestChartView;<br/>\nimport com.imc.testutil.ImcTestCase;<br/>\nimport junit.framework.Test;<br/>\n// jemmy<br/>\nimport org.netbeans.jemmy.operators.JDialogOperator;<br/>\nimport<br/>\norg.netbeans.jemmy.operators.AbstractButtonOperator;<br/>\nimport org.netbeans.jemmy.operators.JFrameOperator;<br/>\nimport org.netbeans.jemmy.operators.JMenuBarOperator;<br/>\n// log4j<br/>\nimport org.apache.log4j.Logger;<br/>\n// ours<br/>\nimport com.imc.mymailloop.demo.boris2.ClientMain;<br/>\n<br/>\n/**<br/>\n <br/>\n */<br/>\npublic class AppTest <br/>\n\textends ImcTestCase <br/>\n{<br/>\n    // this is timeout betwean test operations<br/>\n    private static int SHOW_TIMEOUT = 2000;<br/>\n<br/>\n\t/** <br/>\n\tdefined first and then used in test methods<br/>\n\t*/    <br/>\n\tprivate JFrameOperator jframeMain = null;<br/>\n<br/>\n    /** Creates new AppTest */<br/>\n    public AppTest(String name) <br/>\n    {<br/>\n        super(name);<br/>\n    }<br/>\n<br/>\n    /**<br/>\n\toverrides JUnit&#39;s default<br/>\n\tcalled before every test method<br/>\n\t2 times in our case<br/>\n\t*/<br/>\n    public void setUp()<br/>\n\t\tthrows Exception<br/>\n    {<br/>\n        // gets main frame      <br/>\n        jframeMain = new JFrameOperator(&quot;Try it&quot;);<br/>\n    }<br/>\n<br/>\n\t/**<br/>\n\toverwrites super&#39;s<br/>\n\tPut here call of initial app instead of RunTests<br/>\n\t*/<br/>\n\tpublic void firstStartTest()<br/>\n\t{<br/>\n\t\tsuper.firstStartTest(); // just for logging<br/>\n\t\t// otherwise we can put this to static area. <br/>\n\t\tClientMain.main (null);<br/>\n\t}<br/>\n<br/>\n\t/**<br/>\n\tfirst test method<br/>\n\t&lt;ol&gt;<br/>\n\t&lt;li&gt;It finds Help|About menu,<br/>\n\t&lt;li&gt;Pusles it,<br/>\n\t&lt;li&gt;Finds About dialog<br/>\n\t&lt;li&gt;Finds OK button on it<br/>\n\t&lt;li&gt;Pushes it. <br/>\n\t&lt;li&gt;Does sofisticated logging on the way. <br/>\n\t&lt;/ol&gt;<br/>\n\t*/<br/>\n\tpublic void testMenu()<br/>\n\t{<br/>\n\t\t// stuff<br/>\n\t}<br/>\n    <br/>\n<br/>\n}<br/>\n<br/>\n<br/>\n__________________________________________________<br/>\nDo You Yahoo!?<br/>\nYahoo! - Official partner of 2002 FIFA World Cup<br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"http://fifaworldcup.yahoo.com\">http://fifaworldcup.yahoo.com</a></div>", 
    "prevInTime": 5260, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1025112014", 
    "canDelete": false, 
    "nextInTopic": 5262, 
    "prevInTopic": 5260, 
    "headers": {
        "inReplyToHeader": "PEM0NTBEOTY2NjRDQkQzMTE4MkI2MDBBMEM5NzY2OEIxNjQ4MEIyQENBU0UwNTI+", 
        "messageIdInHeader": "PDIwMDIwNjI2MTcyMDE0Ljc3OTQ4LnFtYWlsQHdlYjIwNDE0Lm1haWwueWFob28uY29tPg=="
    }
}