{
    "numMessagesInTopic": 39, 
    "nextInTime": 20532, 
    "senderId": "8aEOLf-eY2qYamxh3BpaSUbWSX6eUI0k-fTEAqhZSRxhNQumJ1y5L1bJ3ZCs3f6BvrVd3XLne0IN6nweTTt5gPYRtDio69ToqmrNGyI", 
    "systemMessage": true, 
    "subject": "A case for adding logging of assertions to junit", 
    "from": "&quot;Phil Surette&quot; &lt;philsurette@...&gt;", 
    "authorName": "Phil Surette", 
    "msgSnippet": "I d like to make a case for adding logging of assertions into junit. I ve been using junit for many years, and something that I ve found both for myself and", 
    "msgId": 20531, 
    "profile": "PhilSurette", 
    "topicId": 20531, 
    "spamInfo": {
        "reason": "6", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 100046987, 
    "messageBody": "<div id=\"ygrps-yiv-657311042\">I&#39;d like to make a case for adding logging of assertions into junit.<br/>\nI&#39;ve been using junit for many years, and something that I&#39;ve found<br/>\nboth for myself and for people who I&#39;ve mentored in XP practices is<br/>\nthat it is often helpful to get warm fuzzy feedback that your tests<br/>\nare running and asserting what you think they are asserting. <br/>\n<br/>\nI notice that I&#39;m not alone in this; I see there are several threads<br/>\nwhere people were looking for this feature<br/>\n(<a rel=\"nofollow\" target=\"_blank\" href=\"http://tech.groups.yahoo.com/group/junit/message/17845\">http://tech.groups.yahoo.com/group/junit/message/17845</a> &quot;how to log<br/>\njunit tests&quot;, <a rel=\"nofollow\" target=\"_blank\" href=\"http://tech.groups.yahoo.com/group/junit/message/18762\">http://tech.groups.yahoo.com/group/junit/message/18762</a><br/>\n&quot;junit 4 & logging&quot;,<br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"http://tech.groups.yahoo.com/group/junit/message/12000\">http://tech.groups.yahoo.com/group/junit/message/12000</a> &quot;Log4J Logging<br/>\nin JUnit&quot;)<br/>\n<br/>\nConsider the following concocted unit test. It is not the purpose of<br/>\nthis test case to demonstrate good test case design ;)<br/>\n<br/>\n     1\tpublic class MyTest extends junit.framework.TestCase{<br/>\n     2\t    List&lt;Map&gt;; mapList;<br/>\n     3\t    <br/>\n     4\t    protected void setUp() throws Exception {<br/>\n     5\t        //create some silly data<br/>\n     6\t        Map map1 = new HashMap();<br/>\n     7\t        map1.put(&quot;id&quot;, &quot;vladimir&quot;);<br/>\n     8\t        Map map2 = new HashMap();<br/>\n     9\t        map2.put(&quot;id&quot;, &quot;estragon&quot;);<br/>\n    10\t        Map map3 = new HashMap();<br/>\n    11\t        //might have to wait for a while for this one :)<br/>\n    12\t        map3.put(&quot;id&quot;, &quot;godot&quot;);<br/>\n    13\t        mapList = new ArrayList();<br/>\n    14\t        mapList.add(map1);<br/>\n    15\t        mapList.add(map2);<br/>\n    16\t        mapList.add(map3);<br/>\n    17\t    }<br/>\n    18\t<br/>\n    19\t    public void testMapIds(){<br/>\n    20\t        assertTrue(&quot;mapList has content&quot;, mapList.size() &gt; 0);<br/>\n    21\t        for (Map map: mapList){<br/>\n    22\t            assertNotNull(&quot;map has id field&quot;, map.get(&quot;id&quot;));<br/>\n    23\t        }<br/>\n    24\t    }<br/>\n    25\t    <br/>\n    26\t    public void testIdFormat(){<br/>\n    27\t        //at some point this will test that all ids are<br/>\nlowercase...<br/>\n    28\t    }<br/>\n    29\t    <br/>\n    30\t    public void testIdLengths(){<br/>\n    31\t        assertTrue(&quot;mapList has content&quot;, mapList.size() &gt; 0);<br/>\n    32\t        for (Map map: mapList){<br/>\n    33\t            String id = (String)map.get(&quot;id&quot;);<br/>\n    34\t            assertTrue(&quot;id &quot;+id+&quot; at least 8 characters long&quot;,<br/>\nid.length() &gt;=8);<br/>\n    35\t        }<br/>\n    36\t    }<br/>\n    37\t}<br/>\n<br/>\nWhat I would like to be able to do is to turn on some kind of<br/>\nassertion logging that would allow me to see output such as the following:<br/>\n(Note that this output was generated using my own tweaked<br/>\nversion of junit that uses log4j logging categories for<br/>\nenabling/disabling both assertion logging and test summary logging):<br/>\n<br/>\nINFO  junit.echo.run.start - __BEGIN MyClassTest.testMapIds__<br/>\nDEBUG junit.echo.assertTrue - (passed) mapList has content <br/>\nDEBUG junit.echo.assertNotNull - (passed) map has id field vladimir<br/>\nDEBUG junit.echo.assertNotNull - (passed) map has id field estragon<br/>\nDEBUG junit.echo.assertNotNull - (passed) map has id field godot<br/>\nINFO  junit.echo.run.summary - __SUMMARY MyClassTest.testMapIds__ (4<br/>\nasserts)<br/>\nINFO  junit.echo.run.start - __BEGIN MyClassTest.testIdFormat__<br/>\nWARN  junit.echo.run.summary - __SUMMARY MyClassTest.testIdFormat__ &lt;a<br/>\nid=&quot;bogus&quot;&gt;&lt;/a&gt;(???no asserts???)<br/>\nINFO  junit.echo.run.start - __BEGIN MyClassTest.testIdLengths__<br/>\nDEBUG junit.echo.assertTrue - (passed) mapList has content<br/>\nDEBUG junit.echo.assertTrue - (passed) id vladimir at least 8<br/>\ncharacters long<br/>\nDEBUG junit.echo.assertTrue - (passed) id estragon at least 8<br/>\ncharacters long<br/>\nDEBUG junit.echo.assertTrue - (FAILED) id godot at least 8 characters long<br/>\nWARN  junit.echo.run.summary - __SUMMARY MyClassTest.testIdLengths__<br/>\n(4 asserts)  ASSERTION FAILED id godot at least 8 characters long<br/>\n<br/>\nBeing able to see output like this has a number of benefits such as<br/>\n<br/>\n1) eliminating redundant logging statements - Many logging statements<br/>\nin a JUnit test case simply output information that you&#39;ve already<br/>\ntold JUnit about in your assertions. Developers often put these in as<br/>\na &#39;sanity check&#39; to verify that the test is doing what they expected.<br/>\nFor example: because on lines such as line 22 I can see the toString<br/>\nof the object that is not null, I get a warm fuzzy feeling that the<br/>\ntest is sane when I look at the logged results. I&#39;ve noticed that when<br/>\ndevelopers write their tests they often add log statements or<br/>\nSystem.outs to provide them this warm fuzzy feeling (often deleting<br/>\nthe same logging when the test is complete - and putting them back in<br/>\nwhen debugging test failures)<br/>\n<br/>\n2) improving assertion messages - it&#39;s often the case that the<br/>\nfirst time you see the message for an assertion will be when the<br/>\nassertion fails, which may not happen until you run a regression test<br/>\nmany moons after you coded the test.  Unless you see the message<br/>\ndisplayed when you are developing the test, you won&#39;t realize that the<br/>\nmessage - if you provided one - is not be very helpful. Better<br/>\nassertion messages also help to communicate to a developer what the<br/>\npoint of the assertion is both when it fails and when reading the test.<br/>\n<br/>\n3) see finer-grain test results. Every assertion is a mini-test on its<br/>\nown, but JUnit these mini-tests are invisible until they fail. <br/>\nOf course, most of the time that&#39;s the behaviour you want. But<br/>\nwhen you&#39;re developing a test or debugging a test failure, it&#39;s<br/>\ngreat to see what these smaller tests are doing.<br/>\n<br/>\n4) by making logging easy, it can help to avoid the<br/>\nusing-system-outs-instead-of-asserts syndrome, where new junit test<br/>\nwriters will write &quot;test cases&quot; that actually just write a bunch of<br/>\nstuff to the console that the test writer then eyeballs for expected<br/>\nresults<br/>\n<br/>\nNotice that in the output above, there are also &#39;summary&#39; lines which<br/>\nshow how many assertions were made in a particular test. These are<br/>\nsomewhat tangential to the main thread of this post, but it&#39;s nice to<br/>\nbe able to know how many assertions occur in a test case if only to<br/>\nidentify when a test case is written that never actually makes an<br/>\nassertion - which is often a bad smell in a test case. It&#39;s also nice<br/>\nwhen there is a test failure during a build run to see in a log the<br/>\nstart of the test case and the assertions that passed before the<br/>\nfailure occurred.<br/>\n<br/>\nThere are some problems with logging assertions that I have encountered:<br/>\n<br/>\n1) if iterating over a collection and asserting each element, your log<br/>\ncan be overwhelmed. Maybe it would be useful to have some way of<br/>\nhinting that a particular assertion should not create notifications;<br/>\nmaybe not.<br/>\n<br/>\n2) the implementation I wrote creates a dependency on log4j (perhaps<br/>\nthis could be avoided by using a notification mechanism and shipping a<br/>\nseparate component that listens for logging notifications and logs them)<br/>\n<br/>\nBTW, From my own experience in instrumenting junit 3.8.1 <br/>\n(some time ago) I found that it is not a trivial thing to modify <br/>\njunit to do this kind of logging. For instance, in my<br/>\nown implementation I managed to confuse junit so it no longer reports<br/>\njunit failures differently than errors. It is a<br/>\nsignificant effort to do this badly, and much more effort to do it<br/>\nwell ;).<br/>\n<br/>\nIs there any appetite out there for adding assertion logging (or<br/>\nassertion notification) into the junit 4 framework? I would be<br/>\nhappy to do the work if I thought it would be accepted into the<br/>\nmain junit distribution. Or maybe this capability already exists<br/>\nin some way in junit 4 that I am not aware of?</div>", 
    "prevInTime": 20530, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1213010636", 
    "canDelete": false, 
    "nextInTopic": 20533, 
    "prevInTopic": 0, 
    "headers": {
        "messageIdInHeader": "PGcyajNzYysyOHNtQGVHcm91cHMuY29tPg=="
    }
}