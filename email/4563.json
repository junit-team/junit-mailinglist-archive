{
    "numMessagesInTopic": 52, 
    "nextInTime": 4564, 
    "senderId": "Dk2TqX0a_tl_R1l0Wm9bh4_xByzPl1FkRkPIp3F6lCK6qDvtzWWqw4C5vBTklW9QCjALrjR_HtdijK21_eytWZldwvW4ANH6vDE", 
    "systemMessage": false, 
    "subject": "FieldAccessor - was Re: [junit] testing private methods", 
    "from": "John Goodsen &lt;jgoodsen@...&gt;", 
    "authorName": "John Goodsen", 
    "msgSnippet": "... I almost hate to do this, but here s a couple of classes that let you access private fields and invoke private methods. FieldAccessor and MethodAccessor,", 
    "msgId": 4563, 
    "profile": "jgoodsen", 
    "topicId": 3179, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 29621510, 
    "messageBody": "<div id=\"ygrps-yiv-147568483\"><blockquote><span title=\"ireply\">&gt;<br/>\n&gt; You folks can test private methods until your brain pops out, <br/>\n&gt;<br/>\n<br/>\n </span></blockquote>I almost hate to do this, but here&#39;s a couple of classes that <br/>\nlet you access private fields and invoke private methods.<br/>\nFieldAccessor and MethodAccessor, respectively.  I admit<br/>\nto helping write this code and since then, I try very hard<br/>\nto never use it.<br/>\n<br/>\nIf you want to pop your brains out and you can handle the<br/>\nsmell in your unit tests ... have at it! :-)<br/>\n<br/>\n------- class Fieldccessor.java ------------<br/>\n<br/>\n//<br/>\n// (C) 1999-2001, RADSoft.  All Rights Reserved.<br/>\n// This code may be used freely as long as the above copyright is included.<br/>\n//<br/>\nimport java.lang.reflect.Field;<br/>\n<br/>\npublic final class FieldAccessor {<br/>\n<br/>\n    public static Object get(Object object, String fieldName) {<br/>\n        if (object == null) throw new IllegalArgumentException(&quot;Object passed <br/>\nto FieldAccessor.get is null&quot;);<br/>\n        Exception exception = null;<br/>\n        for (Class objectClass = object.getClass(); objectClass != null; <br/>\nobjectClass = objectClass.getSuperclass()) {<br/>\n            try {<br/>\n                Field field = objectClass.getDeclaredField(fieldName);<br/>\n                field.setAccessible(true);<br/>\n                Object obj = field.get(object);<br/>\n                return obj;<br/>\n            } catch (Exception ex) {<br/>\n                exception = ex;<br/>\n            }<br/>\n        }<br/>\n        throw new RuntimeException(&quot;Could get value for field &quot; + <br/>\nobject.getClass().getName() + &quot;.&quot; + fieldName);<br/>\n    }<br/>\n<br/>\n    public static Object getStatic(Class clazz, String fieldName) {<br/>\n        Exception exception = null;<br/>\n        for (; clazz != null; clazz = clazz.getSuperclass()) {<br/>\n            try {<br/>\n                Field field = clazz.getDeclaredField(fieldName);<br/>\n                field.setAccessible(true);<br/>\n                Object obj = field.get(clazz);<br/>\n                return obj;<br/>\n            } catch (Exception ex) {<br/>\n                exception = ex;<br/>\n            }<br/>\n        }<br/>\n        throw new RuntimeException(&quot;Could get value for static field &quot; + <br/>\nclazz.getName() + &quot;.&quot; + fieldName);<br/>\n    }<br/>\n<br/>\n    public static void set(Object object, String fieldName, Object value) {<br/>\n        if (object == null) throw new IllegalArgumentException(&quot;Object passed <br/>\nto FieldAccessor.set is null&quot;);<br/>\n        Class objectClass = object.getClass();<br/>\n        Exception exception = null;<br/>\n        for (; objectClass != null; objectClass = objectClass.getSuperclass())<br/>\n            try {<br/>\n                Field field = objectClass.getDeclaredField(fieldName);<br/>\n                field.setAccessible(true);<br/>\n                field.set(object, value);<br/>\n                return;<br/>\n            } catch (Exception ex) {<br/>\n                exception = ex;<br/>\n            }<br/>\n        throw new RuntimeException(&quot;Could set value for field &quot; + <br/>\nobject.getClass().getName() + &quot;.&quot; + fieldName);<br/>\n    }<br/>\n<br/>\n    public static void setStatic(Class clazz, String fieldName, Object value) <br/>\n{<br/>\n        if (clazz == null) throw new IllegalArgumentException(&quot;Object passed <br/>\nto FieldAccessor.setStatic<br/>\nis null&quot;);<br/>\n        Exception exception = null;<br/>\n        for (; clazz != null; clazz = clazz.getSuperclass()) {<br/>\n            try {<br/>\n                Field field = clazz.getDeclaredField(fieldName);<br/>\n                field.setAccessible(true);<br/>\n                field.set(clazz, value);<br/>\n                return;<br/>\n            } catch (Exception ex) {<br/>\n                exception = ex;<br/>\n            }<br/>\n        }<br/>\n        throw new RuntimeException(&quot;Could set value for static field &quot; + <br/>\nclazz.getName() + &quot;.&quot; + fieldName);<br/>\n    }<br/>\n}<br/>\n<br/>\n------- class MethodAccessor.java ------------<br/>\n<br/>\n//<br/>\n// (C) 1999-2001, RADSoft.  All Rights Reserved.<br/>\n// This code may be used freely as long as the above copyright is included.<br/>\n//<br/>\n<br/>\nimport java.lang.reflect.Method;<br/>\n<br/>\npublic final class MethodAccessor {<br/>\n<br/>\n    public static Object invoke(Object object, String methodName, Class <br/>\nparameterTypes[], Object parameters[]) {<br/>\n        try {<br/>\n            Method method = object.getClass().getDeclaredMethod(methodName, <br/>\nparameterTypes);<br/>\n            method.setAccessible(true);<br/>\n            Object obj = method.invoke(object, parameters);<br/>\n            return obj;<br/>\n        } catch (Exception ex) {<br/>\n            ex.printStackTrace();<br/>\n        }<br/>\n        throw new RuntimeException(&quot;Failed method invocation: &quot; + <br/>\nobject.getClass().getName() + &quot;.&quot; + methodName + &quot;()&quot;);<br/>\n    }<br/>\n<br/>\n    public static Object invokeStatic(Class clazz, String methodName, Class <br/>\nparameterTypes[], Object parameters[]) {<br/>\n        try {<br/>\n            Method method = clazz.getDeclaredMethod(methodName, <br/>\nparameterTypes);<br/>\n            method.setAccessible(true);<br/>\n            Object obj = method.invoke(clazz, parameters);<br/>\n            return obj;<br/>\n        } catch (Exception ex) {<br/>\n            ex.printStackTrace();<br/>\n        }<br/>\n        throw new RuntimeException(&quot;Failed static method invocation: &quot; + <br/>\nclazz.getName() + &quot;.&quot; + methodName + &quot;()&quot;);<br/>\n    }<br/>\n}</div>", 
    "prevInTime": 4562, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1017783478", 
    "canDelete": false, 
    "nextInTopic": 4564, 
    "prevInTopic": 4562, 
    "headers": {
        "inReplyToHeader": "PEY4OU9BbmpMR1hZQjFKNU5QQWswMDAwNGM2ZUBob3RtYWlsLmNvbT4=", 
        "referencesHeader": "PEY4OU9BbmpMR1hZQjFKNU5QQWswMDAwNGM2ZUBob3RtYWlsLmNvbT4="
    }
}