{
    "numMessagesInTopic": 4, 
    "nextInTime": 18517, 
    "senderId": "LwDOJekzobCw6Zb7tXebabGOxDyDUaA-0OPfD2MvFmdxfSFPjDdvfWafFUH99Fw20aYUD5rzCsexL7CPSTfMecwKAOXJTw", 
    "systemMessage": true, 
    "subject": "Re: [junit] Really Strange Behavior", 
    "from": "Ole Ersoy &lt;ole_ersoy@...&gt;", 
    "authorName": "Ole Ersoy", 
    "msgSnippet": "Hei Bjorn, (Norsk?) Hmmm, good observation! The ResourceSet that I create in the setUp likes be inside the test method, instead of in the setup method. It", 
    "msgId": 18516, 
    "profile": "ole_ersoy", 
    "topicId": 18510, 
    "spamInfo": {
        "reason": "0", 
        "isSpam": false
    }, 
    "replyTo": "LIST", 
    "userId": 98908154, 
    "messageBody": "<div id=\"ygrps-yiv-1763013078\">Hei Bjorn,<br/>\n<br/>\n(Norsk?)<br/>\nHmmm, good observation!<br/>\n<br/>\nThe ResourceSet that I create in the <br/>\nsetUp likes be inside the test method,<br/>\ninstead of in the setup method.<br/>\n<br/>\nIt contains a set of xml resources that<br/>\nare loaded using an xml handler.<br/>\n<br/>\nThe XMLHandler looks up metadata <br/>\non an EClass, that is a static instance<br/>\nbelonging to an object.<br/>\n<br/>\nIt looks like the eStaticClass() that returns the <br/>\nobject&#39;s EClass is unhappy if there is more than a<br/>\nsingle instance of ResourceSet in the JVM.<br/>\n<br/>\nAnyways - That&#39;s all the bull I can come up with :-)<br/>\n<br/>\nI&#39;m really just happy I can test now without loosing<br/>\nmore hair.<br/>\n<br/>\nThanks again,<br/>\n- Ole<br/>\n<br/>\n--- Björn Gustafsson &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:bjorng@...\">bjorng@...</a>&gt; wrote:<br/>\n<br/>\n<blockquote><span title=\"ireply\"> &gt; Hi Ole,<br/>\n&gt; <br/>\n&gt; I can&#39;t tell specifically from your code, but if it<br/>\n&gt; happens at the<br/>\n&gt; second test method then it has to do with your<br/>\n&gt; setUp() method in some<br/>\n&gt; way.  Do your super.setUp(), lookupMojo() or<br/>\n&gt; JPackageMojoHelperImpl.createResourceSet() methods<br/>\n&gt; produce anything<br/>\n&gt; that requires a reinitialization or teardown after a<br/>\n&gt; test completes?<br/>\n&gt; I would guess there is some static state somewhere<br/>\n&gt; in your abstract<br/>\n&gt; class or similar that is causing your grief.<br/>\n&gt; <br/>\n&gt; mvh,<br/>\n&gt; Björn<br/>\n&gt; <br/>\n&gt; On 12/6/06, Ole Ersoy &lt;<a rel=\"nofollow\" target=\"_blank\" href=\"mailto:ole_ersoy@...\">ole_ersoy@...</a>&gt; wrote:<br/>\n&gt; &gt; Hey Guys,<br/>\n&gt; &gt;<br/>\n&gt; &gt; I&#39;m testing a method.<br/>\n&gt; &gt;<br/>\n&gt; &gt; When I have the method by itself it tests fine.<br/>\n&gt; &gt;<br/>\n&gt; &gt; When I put another test in front of it like this:<br/>\n&gt; &gt;         public void testCreateResourceSet()<br/>\n&gt; &gt;         {<br/>\n&gt; &gt;                 //Stub<br/>\n&gt; &gt;                 assertTrue(true);<br/>\n&gt; &gt;         }<br/>\n&gt; &gt;<br/>\n&gt; &gt; I get an exception like this:<br/>\n&gt; &gt; java.lang.ExceptionInInitializerError<br/>\n&gt; &gt;         at<br/>\n&gt; &gt;<br/>\n&gt;<br/>\n </span></blockquote>org.eclipse.emf.ecore.xml.type.impl.AnyTypeImpl.eStaticClass(AnyTypeImpl.java:83)<br/>\n<blockquote><span title=\"ireply\"> &gt; &gt;         at<br/>\n&gt; &gt;<br/>\n&gt;<br/>\n </span></blockquote>org.eclipse.emf.ecore.impl.EObjectImpl.eClass(EObjectImpl.java:210)<br/>\n<blockquote><span title=\"ireply\"> &gt; &gt;<br/>\n&gt; &gt; ....<br/>\n&gt; &gt;<br/>\n&gt; &gt; I also get the same exception when testing with<br/>\n&gt; Maven,<br/>\n&gt; &gt; so I know it is localized to JUnit.<br/>\n&gt; &gt;<br/>\n&gt; &gt; Has anyone else seen behavior like this?<br/>\n&gt; &gt;<br/>\n&gt; &gt; I&#39;ll paste the full test case below, in case<br/>\n&gt; anyone<br/>\n&gt; &gt; wants to look at it further.<br/>\n&gt; &gt;<br/>\n&gt; &gt; Cheers,<br/>\n&gt; &gt; - Ole<br/>\n&gt; &gt;<br/>\n&gt; &gt;<br/>\n&gt; &gt; package org.jpackage.test;<br/>\n&gt; &gt;<br/>\n&gt; &gt; import java.io.File;<br/>\n&gt; &gt; import java.io.IOException;<br/>\n&gt; &gt;<br/>\n&gt; &gt; import org.apache.maven.artifact.Artifact;<br/>\n&gt; &gt; import<br/>\n&gt; &gt; org.apache.maven.artifact.factory.ArtifactFactory;<br/>\n&gt; &gt; import<br/>\n&gt; &gt;<br/>\n&gt;<br/>\n </span></blockquote>org.apache.maven.artifact.repository.ArtifactRepository;<br/>\n<blockquote><span title=\"ireply\"> &gt; &gt; import<br/>\n&gt; &gt;<br/>\n&gt;<br/>\n </span></blockquote>org.apache.maven.artifact.repository.layout.DefaultRepositoryLayout;<br/>\n<blockquote><span title=\"ireply\"> &gt; &gt; import<br/>\n&gt; &gt;<br/>\n&gt;<br/>\n </span></blockquote>org.apache.maven.artifact.repository.layout.ArtifactRepositoryLayout;<br/>\n<blockquote><span title=\"ireply\"> &gt; &gt; import<br/>\n&gt; org.apache.maven.plugin.MojoExecutionException;<br/>\n&gt; &gt; import<br/>\n&gt; &gt;<br/>\n&gt;<br/>\n </span></blockquote>org.apache.maven.plugin.testing.AbstractMojoTestCase;<br/>\n<blockquote><span title=\"ireply\"> &gt; &gt; import org.eclipse.emf.common.util.URI;<br/>\n&gt; &gt; import org.eclipse.emf.ecore.resource.Resource;<br/>\n&gt; &gt; import org.eclipse.emf.ecore.resource.ResourceSet;<br/>\n&gt; &gt; import<br/>\n&gt; org.jpackage.impl.JPackageMojoHelperBufferImpl;<br/>\n&gt; &gt; import org.jpackage.impl.JPackageMojoImpl;<br/>\n&gt; &gt; import org.jpackage.JPackageMojoConstants;<br/>\n&gt; &gt; import org.jpackage.impl.JPackageMojoHelperImpl;<br/>\n&gt; &gt;<br/>\n&gt; &gt; import<br/>\n&gt; &gt; com.pyramidetechnologies.emf.utils.EMFUtilities;<br/>\n&gt; &gt;<br/>\n&gt; &gt; public class JPackageMojoHelperTest extends<br/>\n&gt; &gt; AbstractMojoTestCase implements<br/>\n&gt; JPackageMojoConstants<br/>\n&gt; &gt; {<br/>\n&gt; &gt;<br/>\n&gt; &gt;         private JPackageMojoImpl mojo = null;<br/>\n&gt; &gt;         private ArtifactRepository<br/>\n&gt; artifactRepository = null;<br/>\n&gt; &gt;         private ResourceSet resourceSet = null;<br/>\n&gt; &gt;<br/>\n&gt; &gt;         protected void setUp() throws Exception {<br/>\n&gt; &gt;<br/>\n&gt; &gt;                 // required for mojo lookups to<br/>\n&gt; work<br/>\n&gt; &gt;                 super.setUp();<br/>\n&gt; &gt;<br/>\n&gt; &gt;                 File pluginXml = new<br/>\n&gt; File(getBasedir(),<br/>\n&gt; &gt;                                <br/>\n&gt; &quot;src/test/resources/plugin-config.xml&quot;);<br/>\n&gt; &gt;                 mojo = (JPackageMojoImpl)<br/>\n&gt; lookupMojo(<br/>\n&gt; &gt;                                 &quot;xml2spec.mojo&quot;,<br/>\n&gt; &gt;                                 &quot;org.jpackage&quot;,<br/>\n&gt; &gt;                                 &quot;1.0-SNAPSHOT&quot;,<br/>\n&gt; &gt;                                 &quot;generate&quot;,<br/>\n&gt; &gt;                                 pluginXml,<br/>\n&gt; &gt;                                 false);<br/>\n&gt; &gt;<br/>\n&gt; &gt;                 resourceSet =<br/>\n&gt; &gt; JPackageMojoHelperImpl.createResourceSet();<br/>\n&gt; &gt;         }<br/>\n&gt; &gt;<br/>\n&gt; &gt;         public void testCreateResourceSet()<br/>\n&gt; &gt;         {<br/>\n&gt; &gt;                 //Stub<br/>\n&gt; &gt;                 assertTrue(true);<br/>\n&gt; &gt;         }<br/>\n&gt; &gt;<br/>\n&gt; &gt;         public void testLoadPomResource() throws<br/>\n&gt; &gt; MojoExecutionException<br/>\n&gt; &gt;         {<br/>\n&gt; &gt;                 String artifactId =<br/>\n&gt; &quot;apacheds-server-main&quot;;<br/>\n&gt; &gt;                 String groupId =<br/>\n&gt; &quot;org.apache.directory.server&quot;;<br/>\n&gt; &gt;                 String version = &quot;1.5.0-SNAPSHOT&quot;;<br/>\n&gt; &gt;<br/>\n&gt; &gt;                 ArtifactFactory artifactFactory =<br/>\n&gt; &gt; mojo.getArtifactFactory();<br/>\n&gt; &gt;                 assertNotNull(artifactFactory);<br/>\n&gt; &gt;<br/>\n&gt; &gt;                 Artifact pomArtifact =<br/>\n&gt; &gt; artifactFactory.createArtifact(groupId,<br/>\n&gt; artifactId,<br/>\n&gt; &gt;                                 version, null,<br/>\n&gt; &quot;pom&quot;);<br/>\n&gt; &gt;                 assertNotNull(pomArtifact);<br/>\n&gt; &gt;<br/>\n&gt; &gt;                 String path = pathOf(pomArtifact);<br/>\n&gt; &gt;                 File file = new File(path);<br/>\n&gt; &gt;                 assertTrue(file.exists());<br/>\n&gt; &gt;<br/>\n&gt; &gt;                 pomArtifact.setFile(file);<br/>\n&gt; &gt;<br/>\n&gt; &gt;                 Resource resource = null;<br/>\n&gt; &gt;                 resource =<br/>\n&gt; &gt;<br/>\n&gt; JPackageMojoHelperImpl.loadPomResource(pomArtifact,<br/>\n&gt; &gt; resourceSet);<br/>\n&gt; &gt;<br/>\n&gt; &gt;                 assertNotNull(resource);<br/>\n&gt; &gt;         }<br/>\n&gt; &gt;<br/>\n&gt; &gt;         private static String pathOf(Artifact<br/>\n&gt; artifact)<br/>\n&gt; &gt;         {<br/>\n&gt; &gt;                 ArtifactRepositoryLayout<br/>\n&gt; artifactRepositoryLayout =<br/>\n&gt; &gt; new DefaultRepositoryLayout();<br/>\n&gt; &gt;                 String artifactPath =<br/>\n&gt; &gt; artifactRepositoryLayout.pathOf(artifact);<br/>\n&gt; &gt;                 return REPOSITORY_BASE_DIRECTORY +<br/>\n&gt; artifactPath;<br/>\n&gt; &gt;         }<br/>\n&gt; &gt;<br/>\n&gt; &gt;         private static String<br/>\n&gt; REPOSITORY_BASE_DIRECTORY =<br/>\n&gt; &gt; &quot;/home/ole/.m2/repository/&quot;;<br/>\n&gt; &gt;<br/>\n&gt; &gt; }<br/>\n&gt; <br/>\n<br/>\n<br/>\n<br/>\n <br/>\n </span></blockquote>____________________________________________________________________________________<br/>\nDo you Yahoo!?<br/>\nEveryone is raving about the all-new Yahoo! Mail beta.<br/>\n<a rel=\"nofollow\" target=\"_blank\" href=\"http://new.mail.yahoo.com\">http://new.mail.yahoo.com</a></div>", 
    "prevInTime": 18515, 
    "specialLinks": [], 
    "contentTrasformed": false, 
    "postDate": "1165506743", 
    "canDelete": false, 
    "nextInTopic": 18517, 
    "prevInTopic": 18515, 
    "headers": {
        "inReplyToHeader": "PGEzYzNlODE1MDYxMjA2MjEyMngyZjNjMjJlY2liM2UzMjA3Zjg0NDFiNTY0QG1haWwuZ21haWwuY29tPg==", 
        "messageIdInHeader": "PDY0MDM4MS45NjA4Ni5xbUB3ZWI2MDcxNC5tYWlsLnlhaG9vLmNvbT4="
    }
}